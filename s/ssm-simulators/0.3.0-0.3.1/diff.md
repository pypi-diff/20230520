# Comparing `tmp/ssm-simulators-0.3.0.tar.gz` & `tmp/ssm-simulators-0.3.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "ssm-simulators-0.3.0.tar", last modified: Sat Mar 18 23:39:03 2023, max compression
+gzip compressed data, was "ssm-simulators-0.3.1.tar", last modified: Sat May 20 15:52:42 2023, max compression
```

## Comparing `ssm-simulators-0.3.0.tar` & `ssm-simulators-0.3.1.tar`

### file list

```diff
@@ -1,38 +1,38 @@
-drwxr-xr-x   0 afengler (2138194415) AD\user-afengler (1085805755)        0 2023-03-18 23:39:03.166174 ssm-simulators-0.3.0/
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)     1074 2021-05-25 20:26:14.000000 ssm-simulators-0.3.0/LICENSE
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)      208 2023-03-18 23:38:13.000000 ssm-simulators-0.3.0/MANIFEST.in
--rw-r--r--   0 afengler (2138194415) AD\user-afengler (1085805755)      589 2023-03-18 23:39:03.165657 ssm-simulators-0.3.0/PKG-INFO
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)     7076 2022-04-08 01:24:47.000000 ssm-simulators-0.3.0/README.md
-drwxr-xr-x   0 afengler (2138194415) AD\user-afengler (1085805755)        0 2023-03-18 23:39:03.146967 ssm-simulators-0.3.0/notebooks/
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)    30051 2022-12-05 18:42:37.000000 ssm-simulators-0.3.0/notebooks/basic_tutorial copy.ipynb
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)    11456 2023-01-11 11:49:03.000000 ssm-simulators-0.3.0/notebooks/basic_tutorial.ipynb
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)   197778 2022-05-23 18:14:30.000000 ssm-simulators-0.3.0/notebooks/basic_tutorial_tmp.ipynb
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)       85 2023-01-31 18:21:12.000000 ssm-simulators-0.3.0/pyproject.toml
--rw-r--r--   0 afengler (2138194415) AD\user-afengler (1085805755)       38 2023-03-18 23:39:03.166317 ssm-simulators-0.3.0/setup.cfg
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)     1650 2023-03-18 23:38:57.000000 ssm-simulators-0.3.0/setup.py
-drwxr-xr-x   0 afengler (2138194415) AD\user-afengler (1085805755)        0 2023-03-18 23:39:03.152698 ssm-simulators-0.3.0/src/
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)  2400643 2023-03-18 23:21:04.000000 ssm-simulators-0.3.0/src/cssm.cpp
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)   110226 2023-01-17 11:27:39.000000 ssm-simulators-0.3.0/src/cssm.pyx
-drwxr-xr-x   0 afengler (2138194415) AD\user-afengler (1085805755)        0 2023-03-18 23:39:03.156339 ssm-simulators-0.3.0/ssm_simulators.egg-info/
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)      589 2023-03-18 23:39:03.000000 ssm-simulators-0.3.0/ssm_simulators.egg-info/PKG-INFO
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)      753 2023-03-18 23:39:03.000000 ssm-simulators-0.3.0/ssm_simulators.egg-info/SOURCES.txt
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)        1 2023-03-18 23:39:03.000000 ssm-simulators-0.3.0/ssm_simulators.egg-info/dependency_links.txt
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)       92 2023-03-18 23:39:03.000000 ssm-simulators-0.3.0/ssm_simulators.egg-info/requires.txt
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)       10 2023-03-18 23:39:03.000000 ssm-simulators-0.3.0/ssm_simulators.egg-info/top_level.txt
-drwxr-xr-x   0 afengler (2138194415) AD\user-afengler (1085805755)        0 2023-03-18 23:39:03.156948 ssm-simulators-0.3.0/ssms/
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)      136 2023-03-18 23:05:13.000000 ssm-simulators-0.3.0/ssms/__init__.py
-drwxr-xr-x   0 afengler (2138194415) AD\user-afengler (1085805755)        0 2023-03-18 23:39:03.160365 ssm-simulators-0.3.0/ssms/basic_simulators/
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)       90 2023-03-18 23:05:13.000000 ssm-simulators-0.3.0/ssms/basic_simulators/__init__.py
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)     2625 2023-03-18 23:05:13.000000 ssm-simulators-0.3.0/ssms/basic_simulators/boundary_functions.py
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)     3738 2023-03-18 23:05:13.000000 ssm-simulators-0.3.0/ssms/basic_simulators/drift_functions.py
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)    40696 2023-03-18 23:06:01.000000 ssm-simulators-0.3.0/ssms/basic_simulators/simulator.py
-drwxr-xr-x   0 afengler (2138194415) AD\user-afengler (1085805755)        0 2023-03-18 23:39:03.161702 ssm-simulators-0.3.0/ssms/config/
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)       22 2023-03-18 23:05:13.000000 ssm-simulators-0.3.0/ssms/config/__init__.py
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)    28758 2023-03-18 23:05:15.000000 ssm-simulators-0.3.0/ssms/config/config.py
-drwxr-xr-x   0 afengler (2138194415) AD\user-afengler (1085805755)        0 2023-03-18 23:39:03.163605 ssm-simulators-0.3.0/ssms/dataset_generators/
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)       43 2023-03-18 23:05:13.000000 ssm-simulators-0.3.0/ssms/dataset_generators/__init__.py
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)    24635 2023-03-18 23:05:23.000000 ssm-simulators-0.3.0/ssms/dataset_generators/lan_mlp.py
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)    29000 2023-03-18 23:05:13.000000 ssm-simulators-0.3.0/ssms/dataset_generators/snpe.py
-drwxr-xr-x   0 afengler (2138194415) AD\user-afengler (1085805755)        0 2023-03-18 23:39:03.164897 ssm-simulators-0.3.0/ssms/support_utils/
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)       24 2023-03-18 23:05:13.000000 ssm-simulators-0.3.0/ssms/support_utils/__init__.py
--rw-------   0 afengler (2138194415) AD\user-afengler (1085805755)     7149 2023-03-18 23:05:14.000000 ssm-simulators-0.3.0/ssms/support_utils/kde_class.py
+drwxr-xr-x   0 afengler (2138194415) 1085805755        0 2023-05-20 15:52:42.918268 ssm-simulators-0.3.1/
+-rw-r--r--   0 afengler (2138194415) 1085805755     1074 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/LICENSE
+-rw-r--r--   0 afengler (2138194415) 1085805755      208 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/MANIFEST.in
+-rw-r--r--   0 afengler (2138194415) 1085805755      589 2023-05-20 15:52:42.917624 ssm-simulators-0.3.1/PKG-INFO
+-rw-r--r--   0 afengler (2138194415) 1085805755     7076 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/README.md
+drwxr-xr-x   0 afengler (2138194415) 1085805755        0 2023-05-20 15:52:42.868865 ssm-simulators-0.3.1/notebooks/
+-rw-r--r--   0 afengler (2138194415) 1085805755    63124 2023-04-16 00:15:21.000000 ssm-simulators-0.3.1/notebooks/basic_tutorial copy.ipynb
+-rw-r--r--   0 afengler (2138194415) 1085805755    11456 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/notebooks/basic_tutorial.ipynb
+-rw-r--r--   0 afengler (2138194415) 1085805755   197778 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/notebooks/basic_tutorial_tmp.ipynb
+-rw-r--r--   0 afengler (2138194415) 1085805755       85 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/pyproject.toml
+-rw-r--r--   0 afengler (2138194415) 1085805755       38 2023-05-20 15:52:42.918446 ssm-simulators-0.3.1/setup.cfg
+-rw-r--r--   0 afengler (2138194415) 1085805755     1649 2023-05-20 15:28:33.000000 ssm-simulators-0.3.1/setup.py
+drwxr-xr-x   0 afengler (2138194415) 1085805755        0 2023-05-20 15:52:42.880157 ssm-simulators-0.3.1/src/
+-rw-r--r--   0 afengler (2138194415) 1085805755  2466308 2023-05-20 15:52:21.000000 ssm-simulators-0.3.1/src/cssm.cpp
+-rw-r--r--   0 afengler (2138194415) 1085805755   115338 2023-05-20 15:18:43.000000 ssm-simulators-0.3.1/src/cssm.pyx
+drwxr-xr-x   0 afengler (2138194415) 1085805755        0 2023-05-20 15:52:42.887757 ssm-simulators-0.3.1/ssm_simulators.egg-info/
+-rw-r--r--   0 afengler (2138194415) 1085805755      589 2023-05-20 15:52:42.000000 ssm-simulators-0.3.1/ssm_simulators.egg-info/PKG-INFO
+-rw-r--r--   0 afengler (2138194415) 1085805755      753 2023-05-20 15:52:42.000000 ssm-simulators-0.3.1/ssm_simulators.egg-info/SOURCES.txt
+-rw-r--r--   0 afengler (2138194415) 1085805755        1 2023-05-20 15:52:42.000000 ssm-simulators-0.3.1/ssm_simulators.egg-info/dependency_links.txt
+-rw-r--r--   0 afengler (2138194415) 1085805755       92 2023-05-20 15:52:42.000000 ssm-simulators-0.3.1/ssm_simulators.egg-info/requires.txt
+-rw-r--r--   0 afengler (2138194415) 1085805755       10 2023-05-20 15:52:42.000000 ssm-simulators-0.3.1/ssm_simulators.egg-info/top_level.txt
+drwxr-xr-x   0 afengler (2138194415) 1085805755        0 2023-05-20 15:52:42.889580 ssm-simulators-0.3.1/ssms/
+-rw-r--r--   0 afengler (2138194415) 1085805755      136 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/ssms/__init__.py
+drwxr-xr-x   0 afengler (2138194415) 1085805755        0 2023-05-20 15:52:42.900632 ssm-simulators-0.3.1/ssms/basic_simulators/
+-rw-r--r--   0 afengler (2138194415) 1085805755       90 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/ssms/basic_simulators/__init__.py
+-rw-r--r--   0 afengler (2138194415) 1085805755     2625 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/ssms/basic_simulators/boundary_functions.py
+-rw-r--r--   0 afengler (2138194415) 1085805755     3738 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/ssms/basic_simulators/drift_functions.py
+-rw-r--r--   0 afengler (2138194415) 1085805755    41275 2023-04-15 01:35:19.000000 ssm-simulators-0.3.1/ssms/basic_simulators/simulator.py
+drwxr-xr-x   0 afengler (2138194415) 1085805755        0 2023-05-20 15:52:42.904336 ssm-simulators-0.3.1/ssms/config/
+-rw-r--r--   0 afengler (2138194415) 1085805755       22 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/ssms/config/__init__.py
+-rw-r--r--   0 afengler (2138194415) 1085805755    29679 2023-05-11 00:51:46.000000 ssm-simulators-0.3.1/ssms/config/config.py
+drwxr-xr-x   0 afengler (2138194415) 1085805755        0 2023-05-20 15:52:42.908887 ssm-simulators-0.3.1/ssms/dataset_generators/
+-rw-r--r--   0 afengler (2138194415) 1085805755       43 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/ssms/dataset_generators/__init__.py
+-rw-r--r--   0 afengler (2138194415) 1085805755    26096 2023-04-16 01:44:17.000000 ssm-simulators-0.3.1/ssms/dataset_generators/lan_mlp.py
+-rw-r--r--   0 afengler (2138194415) 1085805755    29000 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/ssms/dataset_generators/snpe.py
+drwxr-xr-x   0 afengler (2138194415) 1085805755        0 2023-05-20 15:52:42.915258 ssm-simulators-0.3.1/ssms/support_utils/
+-rw-r--r--   0 afengler (2138194415) 1085805755       46 2023-05-20 15:30:39.000000 ssm-simulators-0.3.1/ssms/support_utils/__init__.py
+-rw-r--r--   0 afengler (2138194415) 1085805755     7149 2023-04-02 00:47:26.000000 ssm-simulators-0.3.1/ssms/support_utils/kde_class.py
```

### Comparing `ssm-simulators-0.3.0/LICENSE` & `ssm-simulators-0.3.1/LICENSE`

 * *Files identical despite different names*

### Comparing `ssm-simulators-0.3.0/PKG-INFO` & `ssm-simulators-0.3.1/PKG-INFO`

 * *Files 18% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: ssm-simulators
-Version: 0.3.0
+Version: 0.3.1
 Summary: SSMS is a package collecting simulators and training data generators for a bunch of generative models of interest in the cognitive science / neuroscience and approximate bayesian computation communities
 Home-page: https://github.com/AlexanderFengler/ssms
 Author: Alexander Fenger
 Classifier: Development Status :: 1 - Planning
 Classifier: Environment :: Console
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python
```

### Comparing `ssm-simulators-0.3.0/README.md` & `ssm-simulators-0.3.1/README.md`

 * *Files identical despite different names*

### Comparing `ssm-simulators-0.3.0/notebooks/basic_tutorial.ipynb` & `ssm-simulators-0.3.1/notebooks/basic_tutorial.ipynb`

 * *Files identical despite different names*

### Comparing `ssm-simulators-0.3.0/notebooks/basic_tutorial_tmp.ipynb` & `ssm-simulators-0.3.1/notebooks/basic_tutorial_tmp.ipynb`

 * *Files identical despite different names*

### Comparing `ssm-simulators-0.3.0/setup.py` & `ssm-simulators-0.3.1/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -10,24 +10,23 @@
                                 compiler_directives = {"language_level": "3"})
 except ImportError:
     ext_modules = [Extension('cssm', ['src/cssm.pyx'], language = 'c++')]
 
 
 setup(  
         name = 'ssm-simulators',
-        version='0.3.0',
+        version='0.3.1',
         author = 'Alexander Fenger',
         url = 'https://github.com/AlexanderFengler/ssms',
         packages= ['ssms', 'ssms.basic_simulators', 'ssms.config', 'ssms.dataset_generators', 'ssms.support_utils'],
         description='SSMS is a package collecting simulators and training data generators for a bunch of generative models of interest in the cognitive science / neuroscience and approximate bayesian computation communities',
         install_requires= ['numpy >= 1.17.0', 'scipy >= 1.6.3', 'cython >= 0.29.23', 'pandas >= 1.0.0', 'scikit-learn >= 0.24.0', 'psutil >= 5.0.0'],
         setup_requires= ['numpy >= 1.17.0', 'scipy >= 1.6.3', 'cython >= 0.29.23', 'pandas >= 1.0.0', 'scikit-learn >= 0.24.0', 'psutil >= 5.0.0'],
         include_dirs = [numpy.get_include()] ,
         ext_modules = ext_modules ,
         classifiers=[ 'Development Status :: 1 - Planning', 
                       'Environment :: Console',
                       'License :: OSI Approved :: MIT License',
                       'Programming Language :: Python',
                       'Topic :: Scientific/Engineering'
                     ]
-
     )
```

### Comparing `ssm-simulators-0.3.0/src/cssm.cpp` & `ssm-simulators-0.3.1/src/cssm.cpp`

 * *Files 2% similar despite different names*

```diff
@@ -1122,195 +1122,195 @@
 #define __Pyx_PyGILState_Ensure PyGILState_Ensure
 #define __Pyx_PyGILState_Release PyGILState_Release
 #define __Pyx_FastGIL_Remember()
 #define __Pyx_FastGIL_Forget()
 #define __Pyx_FastGilFuncInit()
 
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":689
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":689
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":690
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":690
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":691
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":691
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":692
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":696
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":696
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":697
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":697
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":698
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":698
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":699
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":703
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":703
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":704
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":704
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":713
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":713
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":714
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":714
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":715
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":715
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":717
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":717
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":718
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":718
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":719
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":719
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":721
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":721
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":722
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":722
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":724
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":724
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":725
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":725
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":726
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":726
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
@@ -1341,42 +1341,42 @@
 
 /*--- Type declarations ---*/
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":728
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":728
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":729
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":729
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":730
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":730
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":732
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":732
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -2576,14 +2576,15 @@
 static const char __pyx_k_sv_view[] = "sv_view";
 static const char __pyx_k_sz_view[] = "sz_view";
 static const char __pyx_k_Ellipsis[] = "Ellipsis";
 static const char __pyx_k_Integral[] = "Integral";
 static const char __pyx_k_boundary[] = "boundary";
 static const char __pyx_k_constant[] = "constant";
 static const char __pyx_k_ddm_flex[] = "ddm_flex";
+static const char __pyx_k_deadline[] = "deadline";
 static const char __pyx_k_full_ddm[] = "full_ddm";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_itemsize[] = "itemsize";
 static const char __pyx_k_metadata[] = "metadata";
 static const char __pyx_k_multiply[] = "multiply";
 static const char __pyx_k_n_trials[] = "n_trials";
 static const char __pyx_k_pyx_type[] = "__pyx_type";
@@ -2621,23 +2622,25 @@
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
 static const char __pyx_k_alphar_view[] = "alphar_view";
 static const char __pyx_k_n_particles[] = "n_particles";
 static const char __pyx_k_tmp_pos_dep[] = "tmp_pos_dep";
 static const char __pyx_k_boundary_fun[] = "boundary_fun";
 static const char __pyx_k_choices_view[] = "choices_view";
+static const char __pyx_k_deadline_adj[] = "deadline_adj";
 static const char __pyx_k_delta_t_sqrt[] = "delta_t_sqrt";
 static const char __pyx_k_drift_params[] = "drift_params";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
 static const char __pyx_k_random_state[] = "random_state";
 static const char __pyx_k_sqrt_st_view[] = "sqrt_st_view";
 static const char __pyx_k_src_cssm_pyx[] = "src/cssm.pyx";
 static const char __pyx_k_stringsource[] = "stringsource";
 static const char __pyx_k_boundary_view[] = "boundary_view";
 static const char __pyx_k_ddm_flexbound[] = "ddm_flexbound";
+static const char __pyx_k_deadline_view[] = "deadline_view";
 static const char __pyx_k_delta_t_alpha[] = "delta_t_alpha";
 static const char __pyx_k_particles_sum[] = "particles_sum";
 static const char __pyx_k_pyx_getbuffer[] = "__pyx_getbuffer";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
 static const char __pyx_k_drift_fun_type[] = "drift_fun_type";
 static const char __pyx_k_glob_flexbound[] = "glob_flexbound";
 static const char __pyx_k_levy_flexbound[] = "levy_flexbound";
@@ -2665,14 +2668,15 @@
 static const char __pyx_k_strided_and_direct[] = "<strided and direct>";
 static const char __pyx_k_alpha_stable_values[] = "alpha_stable_values";
 static const char __pyx_k_boundary_params_tmp[] = "boundary_params_tmp";
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
 static const char __pyx_k_particles_reduced_sum[] = "particles_reduced_sum";
 static const char __pyx_k_MemoryView_of_r_object[] = "<MemoryView of %r object>";
+static const char __pyx_k_ddm_flexbound_deadline[] = "ddm_flexbound_deadline";
 static const char __pyx_k_ddm_flexbound_mic2_adj[] = "ddm_flexbound_mic2_adj";
 static const char __pyx_k_ddm_flexbound_tradeoff[] = "ddm_flexbound_tradeoff";
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
 static const char __pyx_k_boundary_multiplicative[] = "boundary_multiplicative";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_Cannot_index_with_type_s[] = "Cannot index with type '%s'";
 static const char __pyx_k_Invalid_shape_in_axis_d_d[] = "Invalid shape in axis %d: %d.";
@@ -2769,22 +2773,28 @@
 static PyObject *__pyx_n_s_ddm;
 static PyObject *__pyx_n_u_ddm;
 static PyObject *__pyx_n_s_ddm_cov;
 static PyObject *__pyx_n_s_ddm_flex;
 static PyObject *__pyx_n_u_ddm_flex;
 static PyObject *__pyx_n_s_ddm_flexbound;
 static PyObject *__pyx_n_u_ddm_flexbound;
+static PyObject *__pyx_n_s_ddm_flexbound_deadline;
+static PyObject *__pyx_n_u_ddm_flexbound_deadline;
 static PyObject *__pyx_n_s_ddm_flexbound_max;
 static PyObject *__pyx_n_s_ddm_flexbound_mic2_adj;
 static PyObject *__pyx_n_u_ddm_flexbound_mic2_adj;
 static PyObject *__pyx_n_s_ddm_flexbound_par2;
 static PyObject *__pyx_n_s_ddm_flexbound_seq2;
 static PyObject *__pyx_n_s_ddm_flexbound_tradeoff;
 static PyObject *__pyx_n_s_ddm_sdv;
 static PyObject *__pyx_n_u_ddm_sdv;
+static PyObject *__pyx_n_s_deadline;
+static PyObject *__pyx_n_u_deadline;
+static PyObject *__pyx_n_s_deadline_adj;
+static PyObject *__pyx_n_s_deadline_view;
 static PyObject *__pyx_n_s_delta_t;
 static PyObject *__pyx_n_u_delta_t;
 static PyObject *__pyx_n_s_delta_t_alpha;
 static PyObject *__pyx_n_s_delta_t_sqrt;
 static PyObject *__pyx_n_s_dict;
 static PyObject *__pyx_n_s_drift;
 static PyObject *__pyx_n_u_drift;
@@ -2970,28 +2980,29 @@
 static PyObject *__pyx_n_u_zh;
 static PyObject *__pyx_n_u_zl1;
 static PyObject *__pyx_n_u_zl2;
 static PyObject *__pyx_pf_4cssm_test(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_random_state); /* proto */
 static PyObject *__pyx_pf_4cssm_2full_ddm_hddm_base(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sz, PyArrayObject *__pyx_v_sv, PyArrayObject *__pyx_v_st, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_random_state); /* proto */
 static PyObject *__pyx_pf_4cssm_4ddm(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_random_state); /* proto */
 static PyObject *__pyx_pf_4cssm_6ddm_cov(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_8ddm_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_10ddm_flex(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_drift_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_drift_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_12ddm_flexbound_max(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_v, float __pyx_v_a, float __pyx_v_z, float __pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_14glob_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_alphar, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_16levy_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_alpha_diff, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_18full_ddm(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sz, PyArrayObject *__pyx_v_sv, PyArrayObject *__pyx_v_st, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_20ddm_sdv(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sv, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_22ornstein_uhlenbeck(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_24race_model(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_26lca(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_b, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_28ddm_flexbound_seq2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_30ddm_flexbound_par2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_32ddm_flexbound_mic2_adj(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
-static PyObject *__pyx_pf_4cssm_34ddm_flexbound_tradeoff(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_8ddm_flexbound_deadline(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_10ddm_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_12ddm_flex(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_drift_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_drift_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_14ddm_flexbound_max(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_v, float __pyx_v_a, float __pyx_v_z, float __pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_16glob_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_alphar, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_18levy_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_alpha_diff, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_20full_ddm(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sz, PyArrayObject *__pyx_v_sv, PyArrayObject *__pyx_v_st, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_22ddm_sdv(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sv, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_24ornstein_uhlenbeck(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_26race_model(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_28lca(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_b, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_30ddm_flexbound_seq2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_32ddm_flexbound_par2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_34ddm_flexbound_mic2_adj(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
+static PyObject *__pyx_pf_4cssm_36ddm_flexbound_tradeoff(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_10__getitem__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_item); /* proto */
@@ -3054,17 +3065,17 @@
 static PyObject *__pyx_k__11;
 static PyObject *__pyx_k__12;
 static PyObject *__pyx_k__13;
 static PyObject *__pyx_k__14;
 static PyObject *__pyx_k__15;
 static PyObject *__pyx_k__16;
 static PyObject *__pyx_k__17;
+static PyObject *__pyx_k__18;
 static PyObject *__pyx_slice_;
 static PyObject *__pyx_tuple__2;
-static PyObject *__pyx_tuple__18;
 static PyObject *__pyx_tuple__19;
 static PyObject *__pyx_tuple__20;
 static PyObject *__pyx_tuple__21;
 static PyObject *__pyx_tuple__22;
 static PyObject *__pyx_tuple__23;
 static PyObject *__pyx_tuple__24;
 static PyObject *__pyx_tuple__25;
@@ -3077,56 +3088,59 @@
 static PyObject *__pyx_tuple__32;
 static PyObject *__pyx_tuple__33;
 static PyObject *__pyx_tuple__34;
 static PyObject *__pyx_tuple__35;
 static PyObject *__pyx_tuple__36;
 static PyObject *__pyx_tuple__37;
 static PyObject *__pyx_tuple__38;
-static PyObject *__pyx_tuple__40;
-static PyObject *__pyx_tuple__42;
-static PyObject *__pyx_tuple__44;
-static PyObject *__pyx_tuple__46;
-static PyObject *__pyx_tuple__48;
-static PyObject *__pyx_tuple__50;
-static PyObject *__pyx_tuple__52;
-static PyObject *__pyx_tuple__54;
-static PyObject *__pyx_tuple__56;
-static PyObject *__pyx_tuple__58;
-static PyObject *__pyx_tuple__60;
-static PyObject *__pyx_tuple__62;
-static PyObject *__pyx_tuple__64;
-static PyObject *__pyx_tuple__66;
-static PyObject *__pyx_tuple__68;
-static PyObject *__pyx_tuple__70;
-static PyObject *__pyx_tuple__72;
-static PyObject *__pyx_tuple__74;
+static PyObject *__pyx_tuple__39;
+static PyObject *__pyx_tuple__41;
+static PyObject *__pyx_tuple__43;
+static PyObject *__pyx_tuple__45;
+static PyObject *__pyx_tuple__47;
+static PyObject *__pyx_tuple__49;
+static PyObject *__pyx_tuple__51;
+static PyObject *__pyx_tuple__53;
+static PyObject *__pyx_tuple__55;
+static PyObject *__pyx_tuple__57;
+static PyObject *__pyx_tuple__59;
+static PyObject *__pyx_tuple__61;
+static PyObject *__pyx_tuple__63;
+static PyObject *__pyx_tuple__65;
+static PyObject *__pyx_tuple__67;
+static PyObject *__pyx_tuple__69;
+static PyObject *__pyx_tuple__71;
+static PyObject *__pyx_tuple__73;
 static PyObject *__pyx_tuple__75;
-static PyObject *__pyx_tuple__76;
 static PyObject *__pyx_tuple__77;
 static PyObject *__pyx_tuple__78;
 static PyObject *__pyx_tuple__79;
-static PyObject *__pyx_codeobj__39;
-static PyObject *__pyx_codeobj__41;
-static PyObject *__pyx_codeobj__43;
-static PyObject *__pyx_codeobj__45;
-static PyObject *__pyx_codeobj__47;
-static PyObject *__pyx_codeobj__49;
-static PyObject *__pyx_codeobj__51;
-static PyObject *__pyx_codeobj__53;
-static PyObject *__pyx_codeobj__55;
-static PyObject *__pyx_codeobj__57;
-static PyObject *__pyx_codeobj__59;
-static PyObject *__pyx_codeobj__61;
-static PyObject *__pyx_codeobj__63;
-static PyObject *__pyx_codeobj__65;
-static PyObject *__pyx_codeobj__67;
-static PyObject *__pyx_codeobj__69;
-static PyObject *__pyx_codeobj__71;
-static PyObject *__pyx_codeobj__73;
-static PyObject *__pyx_codeobj__80;
+static PyObject *__pyx_tuple__80;
+static PyObject *__pyx_tuple__81;
+static PyObject *__pyx_tuple__82;
+static PyObject *__pyx_codeobj__40;
+static PyObject *__pyx_codeobj__42;
+static PyObject *__pyx_codeobj__44;
+static PyObject *__pyx_codeobj__46;
+static PyObject *__pyx_codeobj__48;
+static PyObject *__pyx_codeobj__50;
+static PyObject *__pyx_codeobj__52;
+static PyObject *__pyx_codeobj__54;
+static PyObject *__pyx_codeobj__56;
+static PyObject *__pyx_codeobj__58;
+static PyObject *__pyx_codeobj__60;
+static PyObject *__pyx_codeobj__62;
+static PyObject *__pyx_codeobj__64;
+static PyObject *__pyx_codeobj__66;
+static PyObject *__pyx_codeobj__68;
+static PyObject *__pyx_codeobj__70;
+static PyObject *__pyx_codeobj__72;
+static PyObject *__pyx_codeobj__74;
+static PyObject *__pyx_codeobj__76;
+static PyObject *__pyx_codeobj__83;
 /* Late includes */
 
 /* "cssm.pyx":20
  * DTYPE = np.float32
  * 
  * cdef set_seed(random_state):             # <<<<<<<<<<<<<<
  *     """
@@ -3328,120 +3342,120 @@
 }
 
 /* "cssm.pyx":38
  *     return - log(random_uniform())
  * 
  * cdef float random_stable(float alpha_diff):             # <<<<<<<<<<<<<<
  *     cdef float eta, u, w, x
- *     # chi = - tan(M_PI_2 * alpha_diff)
+ * 
  */
 
 static float __pyx_f_4cssm_random_stable(float __pyx_v_alpha_diff) {
   float __pyx_v_eta;
   float __pyx_v_u;
   float __pyx_v_w;
   float __pyx_v_x;
   float __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("random_stable", 0);
 
-  /* "cssm.pyx":42
- *     # chi = - tan(M_PI_2 * alpha_diff)
+  /* "cssm.pyx":41
+ *     cdef float eta, u, w, x
  * 
  *     u = M_PI * (random_uniform() - 0.5)             # <<<<<<<<<<<<<<
  *     w = random_exponential()
  * 
  */
   __pyx_v_u = (M_PI * (__pyx_f_4cssm_random_uniform() - 0.5));
 
-  /* "cssm.pyx":43
+  /* "cssm.pyx":42
  * 
  *     u = M_PI * (random_uniform() - 0.5)
  *     w = random_exponential()             # <<<<<<<<<<<<<<
  * 
  *     if alpha_diff == 1.0:
  */
   __pyx_v_w = __pyx_f_4cssm_random_exponential();
 
-  /* "cssm.pyx":45
+  /* "cssm.pyx":44
  *     w = random_exponential()
  * 
  *     if alpha_diff == 1.0:             # <<<<<<<<<<<<<<
  *         eta = M_PI_2 # useless but kept to remain faithful to wikipedia entry
  *         x = (1.0 / eta) * ((M_PI_2) * tan(u))
  */
   __pyx_t_1 = ((__pyx_v_alpha_diff == 1.0) != 0);
   if (__pyx_t_1) {
 
-    /* "cssm.pyx":46
+    /* "cssm.pyx":45
  * 
  *     if alpha_diff == 1.0:
  *         eta = M_PI_2 # useless but kept to remain faithful to wikipedia entry             # <<<<<<<<<<<<<<
  *         x = (1.0 / eta) * ((M_PI_2) * tan(u))
- *         # x = (1.0 / eta) * ((M_PI_2 + u) * tan(u) - log((M_PI_2 * w * cos(u)) / (M_PI_2 + u)))
+ *     else:
  */
     __pyx_v_eta = M_PI_2;
 
-    /* "cssm.pyx":47
+    /* "cssm.pyx":46
  *     if alpha_diff == 1.0:
  *         eta = M_PI_2 # useless but kept to remain faithful to wikipedia entry
  *         x = (1.0 / eta) * ((M_PI_2) * tan(u))             # <<<<<<<<<<<<<<
- *         # x = (1.0 / eta) * ((M_PI_2 + u) * tan(u) - log((M_PI_2 * w * cos(u)) / (M_PI_2 + u)))
  *     else:
+ *         x = (sin(alpha_diff * u) / (pow(cos(u), 1 / alpha_diff))) * pow(cos(u - (alpha_diff * u)) / w, (1.0 - alpha_diff) / alpha_diff)
  */
     __pyx_v_x = ((1.0 / ((double)__pyx_v_eta)) * (M_PI_2 * tan(__pyx_v_u)));
 
-    /* "cssm.pyx":45
+    /* "cssm.pyx":44
  *     w = random_exponential()
  * 
  *     if alpha_diff == 1.0:             # <<<<<<<<<<<<<<
  *         eta = M_PI_2 # useless but kept to remain faithful to wikipedia entry
  *         x = (1.0 / eta) * ((M_PI_2) * tan(u))
  */
     goto __pyx_L3;
   }
 
-  /* "cssm.pyx":51
+  /* "cssm.pyx":48
+ *         x = (1.0 / eta) * ((M_PI_2) * tan(u))
  *     else:
- *         # eta = (1.0 / alpha_diff) * atan(- chi)
  *         x = (sin(alpha_diff * u) / (pow(cos(u), 1 / alpha_diff))) * pow(cos(u - (alpha_diff * u)) / w, (1.0 - alpha_diff) / alpha_diff)             # <<<<<<<<<<<<<<
- *         # x = pow((1.0 + chi * chi), 1.0 / (2.0 * alpha_diff)) * \
- *         #        (sin(alpha_diff * (u + eta)) / pow(cos(u), 1.0 / alpha_diff)) * \
+ *     return x
+ * 
  */
   /*else*/ {
     __pyx_v_x = ((sin((__pyx_v_alpha_diff * __pyx_v_u)) / pow(cos(__pyx_v_u), (1.0 / __pyx_v_alpha_diff))) * pow((cos((__pyx_v_u - (__pyx_v_alpha_diff * __pyx_v_u))) / ((double)__pyx_v_w)), ((1.0 - __pyx_v_alpha_diff) / ((double)__pyx_v_alpha_diff))));
   }
   __pyx_L3:;
 
-  /* "cssm.pyx":55
- *         #        (sin(alpha_diff * (u + eta)) / pow(cos(u), 1.0 / alpha_diff)) * \
- *         #        pow(cos(u - (alpha_diff * (u + eta))) / w, (1.0 - alpha_diff) / alpha_diff)
+  /* "cssm.pyx":49
+ *     else:
+ *         x = (sin(alpha_diff * u) / (pow(cos(u), 1 / alpha_diff))) * pow(cos(u - (alpha_diff * u)) / w, (1.0 - alpha_diff) / alpha_diff)
  *     return x             # <<<<<<<<<<<<<<
  * 
  * cdef float[:] draw_random_stable(int n, float alpha_diff):
  */
   __pyx_r = __pyx_v_x;
   goto __pyx_L0;
 
   /* "cssm.pyx":38
  *     return - log(random_uniform())
  * 
  * cdef float random_stable(float alpha_diff):             # <<<<<<<<<<<<<<
  *     cdef float eta, u, w, x
- *     # chi = - tan(M_PI_2 * alpha_diff)
+ * 
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":57
+/* "cssm.pyx":51
  *     return x
  * 
  * cdef float[:] draw_random_stable(int n, float alpha_diff):             # <<<<<<<<<<<<<<
  * 
  *     cdef int i
  */
 
@@ -3460,85 +3474,85 @@
   int __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("draw_random_stable", 0);
 
-  /* "cssm.pyx":60
+  /* "cssm.pyx":54
  * 
  *     cdef int i
  *     cdef float[:] result = np.zeros(n, dtype = DTYPE)             # <<<<<<<<<<<<<<
  * 
  *     for i in range(n):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 60, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_result = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "cssm.pyx":62
+  /* "cssm.pyx":56
  *     cdef float[:] result = np.zeros(n, dtype = DTYPE)
  * 
  *     for i in range(n):             # <<<<<<<<<<<<<<
  *         result[i] = random_stable(alpha_diff)
  *     return result
  */
   __pyx_t_6 = __pyx_v_n;
   __pyx_t_7 = __pyx_t_6;
   for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
     __pyx_v_i = __pyx_t_8;
 
-    /* "cssm.pyx":63
+    /* "cssm.pyx":57
  * 
  *     for i in range(n):
  *         result[i] = random_stable(alpha_diff)             # <<<<<<<<<<<<<<
  *     return result
  * 
  */
     __pyx_t_9 = __pyx_v_i;
     *((float *) ( /* dim=0 */ (__pyx_v_result.data + __pyx_t_9 * __pyx_v_result.strides[0]) )) = __pyx_f_4cssm_random_stable(__pyx_v_alpha_diff);
   }
 
-  /* "cssm.pyx":64
+  /* "cssm.pyx":58
  *     for i in range(n):
  *         result[i] = random_stable(alpha_diff)
  *     return result             # <<<<<<<<<<<<<<
  * 
  * cdef float random_gaussian():
  */
   __PYX_INC_MEMVIEW(&__pyx_v_result, 0);
   __pyx_r = __pyx_v_result;
   goto __pyx_L0;
 
-  /* "cssm.pyx":57
+  /* "cssm.pyx":51
  *     return x
  * 
  * cdef float[:] draw_random_stable(int n, float alpha_diff):             # <<<<<<<<<<<<<<
  * 
  *     cdef int i
  */
 
@@ -3559,15 +3573,15 @@
   }
   __pyx_L2:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_result, 1);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":66
+/* "cssm.pyx":60
  *     return result
  * 
  * cdef float random_gaussian():             # <<<<<<<<<<<<<<
  *     cdef float x1, x2, w
  *     w = 2.0
  */
 
@@ -3576,133 +3590,133 @@
   float __pyx_v_x2;
   float __pyx_v_w;
   float __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("random_gaussian", 0);
 
-  /* "cssm.pyx":68
+  /* "cssm.pyx":62
  * cdef float random_gaussian():
  *     cdef float x1, x2, w
  *     w = 2.0             # <<<<<<<<<<<<<<
  * 
  *     while(w >= 1.0):
  */
   __pyx_v_w = 2.0;
 
-  /* "cssm.pyx":70
+  /* "cssm.pyx":64
  *     w = 2.0
  * 
  *     while(w >= 1.0):             # <<<<<<<<<<<<<<
  *         x1 = 2.0 * random_uniform() - 1.0
  *         x2 = 2.0 * random_uniform() - 1.0
  */
   while (1) {
     __pyx_t_1 = ((__pyx_v_w >= 1.0) != 0);
     if (!__pyx_t_1) break;
 
-    /* "cssm.pyx":71
+    /* "cssm.pyx":65
  * 
  *     while(w >= 1.0):
  *         x1 = 2.0 * random_uniform() - 1.0             # <<<<<<<<<<<<<<
  *         x2 = 2.0 * random_uniform() - 1.0
  *         w = x1 * x1 + x2 * x2
  */
     __pyx_v_x1 = ((2.0 * __pyx_f_4cssm_random_uniform()) - 1.0);
 
-    /* "cssm.pyx":72
+    /* "cssm.pyx":66
  *     while(w >= 1.0):
  *         x1 = 2.0 * random_uniform() - 1.0
  *         x2 = 2.0 * random_uniform() - 1.0             # <<<<<<<<<<<<<<
  *         w = x1 * x1 + x2 * x2
  * 
  */
     __pyx_v_x2 = ((2.0 * __pyx_f_4cssm_random_uniform()) - 1.0);
 
-    /* "cssm.pyx":73
+    /* "cssm.pyx":67
  *         x1 = 2.0 * random_uniform() - 1.0
  *         x2 = 2.0 * random_uniform() - 1.0
  *         w = x1 * x1 + x2 * x2             # <<<<<<<<<<<<<<
  * 
  *     w = ((-2.0 * log(w)) / w) ** 0.5
  */
     __pyx_v_w = ((__pyx_v_x1 * __pyx_v_x1) + (__pyx_v_x2 * __pyx_v_x2));
   }
 
-  /* "cssm.pyx":75
+  /* "cssm.pyx":69
  *         w = x1 * x1 + x2 * x2
  * 
  *     w = ((-2.0 * log(w)) / w) ** 0.5             # <<<<<<<<<<<<<<
  *     return x1 * w
  * 
  */
   __pyx_v_w = pow(((-2.0 * log(__pyx_v_w)) / ((double)__pyx_v_w)), 0.5);
 
-  /* "cssm.pyx":76
+  /* "cssm.pyx":70
  * 
  *     w = ((-2.0 * log(w)) / w) ** 0.5
  *     return x1 * w             # <<<<<<<<<<<<<<
  * 
  * cdef int sign(float x):
  */
   __pyx_r = (__pyx_v_x1 * __pyx_v_w);
   goto __pyx_L0;
 
-  /* "cssm.pyx":66
+  /* "cssm.pyx":60
  *     return result
  * 
  * cdef float random_gaussian():             # <<<<<<<<<<<<<<
  *     cdef float x1, x2, w
  *     w = 2.0
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":78
+/* "cssm.pyx":72
  *     return x1 * w
  * 
  * cdef int sign(float x):             # <<<<<<<<<<<<<<
  *     return (x > 0) - (x < 0)
  * 
  */
 
 static int __pyx_f_4cssm_sign(float __pyx_v_x) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("sign", 0);
 
-  /* "cssm.pyx":79
+  /* "cssm.pyx":73
  * 
  * cdef int sign(float x):
  *     return (x > 0) - (x < 0)             # <<<<<<<<<<<<<<
  * 
  * cdef float csum(float[:] x):
  */
   __pyx_r = ((__pyx_v_x > 0.0) - (__pyx_v_x < 0.0));
   goto __pyx_L0;
 
-  /* "cssm.pyx":78
+  /* "cssm.pyx":72
  *     return x1 * w
  * 
  * cdef int sign(float x):             # <<<<<<<<<<<<<<
  *     return (x > 0) - (x < 0)
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":81
+/* "cssm.pyx":75
  *     return (x > 0) - (x < 0)
  * 
  * cdef float csum(float[:] x):             # <<<<<<<<<<<<<<
  *     cdef int i
  *     cdef int n = x.shape[0]
  */
 
@@ -3714,80 +3728,80 @@
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   Py_ssize_t __pyx_t_4;
   __Pyx_RefNannySetupContext("csum", 0);
 
-  /* "cssm.pyx":83
+  /* "cssm.pyx":77
  * cdef float csum(float[:] x):
  *     cdef int i
  *     cdef int n = x.shape[0]             # <<<<<<<<<<<<<<
  *     cdef float total = 0
  * 
  */
   __pyx_v_n = (__pyx_v_x.shape[0]);
 
-  /* "cssm.pyx":84
+  /* "cssm.pyx":78
  *     cdef int i
  *     cdef int n = x.shape[0]
  *     cdef float total = 0             # <<<<<<<<<<<<<<
  * 
  *     for i in range(n):
  */
   __pyx_v_total = 0.0;
 
-  /* "cssm.pyx":86
+  /* "cssm.pyx":80
  *     cdef float total = 0
  * 
  *     for i in range(n):             # <<<<<<<<<<<<<<
  *         total += x[i]
  * 
  */
   __pyx_t_1 = __pyx_v_n;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "cssm.pyx":87
+    /* "cssm.pyx":81
  * 
  *     for i in range(n):
  *         total += x[i]             # <<<<<<<<<<<<<<
  * 
  *     return total
  */
     __pyx_t_4 = __pyx_v_i;
     __pyx_v_total = (__pyx_v_total + (*((float *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_4 * __pyx_v_x.strides[0]) ))));
   }
 
-  /* "cssm.pyx":89
+  /* "cssm.pyx":83
  *         total += x[i]
  * 
  *     return total             # <<<<<<<<<<<<<<
  * 
  * ## @cythonboundscheck(False)
  */
   __pyx_r = __pyx_v_total;
   goto __pyx_L0;
 
-  /* "cssm.pyx":81
+  /* "cssm.pyx":75
  *     return (x > 0) - (x < 0)
  * 
  * cdef float csum(float[:] x):             # <<<<<<<<<<<<<<
  *     cdef int i
  *     cdef int n = x.shape[0]
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":92
+/* "cssm.pyx":86
  * 
  * ## @cythonboundscheck(False)
  * cdef void assign_random_gaussian_pair(float[:] out, int assign_ix):             # <<<<<<<<<<<<<<
  *     cdef float x1, x2, w
  *     w = 2.0
  */
 
@@ -3796,104 +3810,104 @@
   float __pyx_v_x2;
   float __pyx_v_w;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   Py_ssize_t __pyx_t_2;
   __Pyx_RefNannySetupContext("assign_random_gaussian_pair", 0);
 
-  /* "cssm.pyx":94
+  /* "cssm.pyx":88
  * cdef void assign_random_gaussian_pair(float[:] out, int assign_ix):
  *     cdef float x1, x2, w
  *     w = 2.0             # <<<<<<<<<<<<<<
  * 
  *     while(w >= 1.0):
  */
   __pyx_v_w = 2.0;
 
-  /* "cssm.pyx":96
+  /* "cssm.pyx":90
  *     w = 2.0
  * 
  *     while(w >= 1.0):             # <<<<<<<<<<<<<<
  *         x1 = (2.0 * random_uniform()) - 1.0
  *         x2 = (2.0 * random_uniform()) - 1.0
  */
   while (1) {
     __pyx_t_1 = ((__pyx_v_w >= 1.0) != 0);
     if (!__pyx_t_1) break;
 
-    /* "cssm.pyx":97
+    /* "cssm.pyx":91
  * 
  *     while(w >= 1.0):
  *         x1 = (2.0 * random_uniform()) - 1.0             # <<<<<<<<<<<<<<
  *         x2 = (2.0 * random_uniform()) - 1.0
  *         w = (x1 * x1) + (x2 * x2)
  */
     __pyx_v_x1 = ((2.0 * __pyx_f_4cssm_random_uniform()) - 1.0);
 
-    /* "cssm.pyx":98
+    /* "cssm.pyx":92
  *     while(w >= 1.0):
  *         x1 = (2.0 * random_uniform()) - 1.0
  *         x2 = (2.0 * random_uniform()) - 1.0             # <<<<<<<<<<<<<<
  *         w = (x1 * x1) + (x2 * x2)
  * 
  */
     __pyx_v_x2 = ((2.0 * __pyx_f_4cssm_random_uniform()) - 1.0);
 
-    /* "cssm.pyx":99
+    /* "cssm.pyx":93
  *         x1 = (2.0 * random_uniform()) - 1.0
  *         x2 = (2.0 * random_uniform()) - 1.0
  *         w = (x1 * x1) + (x2 * x2)             # <<<<<<<<<<<<<<
  * 
  *     w = ((-2.0 * log(w)) / w) ** 0.5
  */
     __pyx_v_w = ((__pyx_v_x1 * __pyx_v_x1) + (__pyx_v_x2 * __pyx_v_x2));
   }
 
-  /* "cssm.pyx":101
+  /* "cssm.pyx":95
  *         w = (x1 * x1) + (x2 * x2)
  * 
  *     w = ((-2.0 * log(w)) / w) ** 0.5             # <<<<<<<<<<<<<<
  *     out[assign_ix] = x1 * w
  *     out[assign_ix + 1] = x2 * w # this was x2 * 2 ..... :0
  */
   __pyx_v_w = pow(((-2.0 * log(__pyx_v_w)) / ((double)__pyx_v_w)), 0.5);
 
-  /* "cssm.pyx":102
+  /* "cssm.pyx":96
  * 
  *     w = ((-2.0 * log(w)) / w) ** 0.5
  *     out[assign_ix] = x1 * w             # <<<<<<<<<<<<<<
  *     out[assign_ix + 1] = x2 * w # this was x2 * 2 ..... :0
  * 
  */
   __pyx_t_2 = __pyx_v_assign_ix;
   *((float *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_2 * __pyx_v_out.strides[0]) )) = (__pyx_v_x1 * __pyx_v_w);
 
-  /* "cssm.pyx":103
+  /* "cssm.pyx":97
  *     w = ((-2.0 * log(w)) / w) ** 0.5
  *     out[assign_ix] = x1 * w
  *     out[assign_ix + 1] = x2 * w # this was x2 * 2 ..... :0             # <<<<<<<<<<<<<<
  * 
  * # @cythonboundscheck(False)
  */
   __pyx_t_2 = (__pyx_v_assign_ix + 1);
   *((float *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_2 * __pyx_v_out.strides[0]) )) = (__pyx_v_x2 * __pyx_v_w);
 
-  /* "cssm.pyx":92
+  /* "cssm.pyx":86
  * 
  * ## @cythonboundscheck(False)
  * cdef void assign_random_gaussian_pair(float[:] out, int assign_ix):             # <<<<<<<<<<<<<<
  *     cdef float x1, x2, w
  *     w = 2.0
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "cssm.pyx":106
+/* "cssm.pyx":100
  * 
  * # @cythonboundscheck(False)
  * cdef float[:] draw_gaussian(int n):             # <<<<<<<<<<<<<<
  *     # Draws standard normal variables - need to have the variance rescaled
  *     cdef int i
  */
 
@@ -3913,113 +3927,113 @@
   int __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("draw_gaussian", 0);
 
-  /* "cssm.pyx":109
+  /* "cssm.pyx":103
  *     # Draws standard normal variables - need to have the variance rescaled
  *     cdef int i
  *     cdef float[:] result = np.zeros(n, dtype=DTYPE)             # <<<<<<<<<<<<<<
  *     for i in range(n // 2):
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 109, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 103, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_result = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "cssm.pyx":110
+  /* "cssm.pyx":104
  *     cdef int i
  *     cdef float[:] result = np.zeros(n, dtype=DTYPE)
  *     for i in range(n // 2):             # <<<<<<<<<<<<<<
  * 
  *         assign_random_gaussian_pair(result, i * 2)
  */
   __pyx_t_6 = (__pyx_v_n / 2);
   __pyx_t_7 = __pyx_t_6;
   for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
     __pyx_v_i = __pyx_t_8;
 
-    /* "cssm.pyx":112
+    /* "cssm.pyx":106
  *     for i in range(n // 2):
  * 
  *         assign_random_gaussian_pair(result, i * 2)             # <<<<<<<<<<<<<<
  *     if n % 2 == 1:
  *         result[n - 1] = random_gaussian()
  */
     __pyx_f_4cssm_assign_random_gaussian_pair(__pyx_v_result, (__pyx_v_i * 2));
   }
 
-  /* "cssm.pyx":113
+  /* "cssm.pyx":107
  * 
  *         assign_random_gaussian_pair(result, i * 2)
  *     if n % 2 == 1:             # <<<<<<<<<<<<<<
  *         result[n - 1] = random_gaussian()
  *     return result
  */
   __pyx_t_9 = (((__pyx_v_n % 2) == 1) != 0);
   if (__pyx_t_9) {
 
-    /* "cssm.pyx":114
+    /* "cssm.pyx":108
  *         assign_random_gaussian_pair(result, i * 2)
  *     if n % 2 == 1:
  *         result[n - 1] = random_gaussian()             # <<<<<<<<<<<<<<
  *     return result
  * 
  */
     __pyx_t_10 = (__pyx_v_n - 1);
     *((float *) ( /* dim=0 */ (__pyx_v_result.data + __pyx_t_10 * __pyx_v_result.strides[0]) )) = __pyx_f_4cssm_random_gaussian();
 
-    /* "cssm.pyx":113
+    /* "cssm.pyx":107
  * 
  *         assign_random_gaussian_pair(result, i * 2)
  *     if n % 2 == 1:             # <<<<<<<<<<<<<<
  *         result[n - 1] = random_gaussian()
  *     return result
  */
   }
 
-  /* "cssm.pyx":115
+  /* "cssm.pyx":109
  *     if n % 2 == 1:
  *         result[n - 1] = random_gaussian()
  *     return result             # <<<<<<<<<<<<<<
  * 
  * # DUMMY TEST SIMULATOR ------------------------------------------------------------------------
  */
   __PYX_INC_MEMVIEW(&__pyx_v_result, 0);
   __pyx_r = __pyx_v_result;
   goto __pyx_L0;
 
-  /* "cssm.pyx":106
+  /* "cssm.pyx":100
  * 
  * # @cythonboundscheck(False)
  * cdef float[:] draw_gaussian(int n):             # <<<<<<<<<<<<<<
  *     # Draws standard normal variables - need to have the variance rescaled
  *     cdef int i
  */
 
@@ -4040,15 +4054,15 @@
   }
   __pyx_L2:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_result, 1);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":125
+/* "cssm.pyx":119
  * #@cython.wraparound(False)
  * 
  * def test(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *          np.ndarray[float, ndim = 1] a, # boundary separation
  *          np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
 
@@ -4072,15 +4086,15 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("test (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_random_state,0};
     PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":134
+    /* "cssm.pyx":128
  *          int n_samples = 20000, # number of samples considered
  *          int n_trials = 10,
  *          random_state = None,             # <<<<<<<<<<<<<<
  *          ):
  * 
  */
     values[9] = ((PyObject *)Py_None);
@@ -4116,27 +4130,27 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("test", 0, 4, 10, 1); __PYX_ERR(0, 125, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("test", 0, 4, 10, 1); __PYX_ERR(0, 119, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("test", 0, 4, 10, 2); __PYX_ERR(0, 125, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("test", 0, 4, 10, 2); __PYX_ERR(0, 119, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("test", 0, 4, 10, 3); __PYX_ERR(0, 125, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("test", 0, 4, 10, 3); __PYX_ERR(0, 119, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[4] = value; kw_args--; }
         }
@@ -4168,15 +4182,15 @@
         case  9:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[9] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "test") < 0)) __PYX_ERR(0, 125, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "test") < 0)) __PYX_ERR(0, 119, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
         CYTHON_FALLTHROUGH;
         case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
         CYTHON_FALLTHROUGH;
@@ -4197,55 +4211,55 @@
       }
     }
     __pyx_v_v = ((PyArrayObject *)values[0]);
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_t = ((PyArrayObject *)values[3]);
     if (values[4]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 129, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 123, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[5]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 130, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 124, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[6]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 131, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 125, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[7]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 132, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 126, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[8]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 133, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 127, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)10);
     }
     __pyx_v_random_state = values[9];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("test", 0, 4, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 125, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("test", 0, 4, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 119, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.test", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 125, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 126, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 127, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 128, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 119, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 120, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 121, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 122, __pyx_L1_error)
   __pyx_r = __pyx_pf_4cssm_test(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_random_state);
 
-  /* "cssm.pyx":125
+  /* "cssm.pyx":119
  * #@cython.wraparound(False)
  * 
  * def test(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *          np.ndarray[float, ndim = 1] a, # boundary separation
  *          np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
 
@@ -4324,304 +4338,304 @@
   __pyx_pybuffernd_z.rcbuffer = &__pyx_pybuffer_z;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 125, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 119, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 125, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 119, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 125, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 119, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 125, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 119, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":137
+  /* "cssm.pyx":131
  *          ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Param views
  *     cdef float[:] v_view = v
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 131, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":139
+  /* "cssm.pyx":133
  *     set_seed(random_state)
  *     # Param views
  *     cdef float[:] v_view = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 139, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 133, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":140
+  /* "cssm.pyx":134
  *     # Param views
  *     cdef float[:] v_view = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 140, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 134, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":141
+  /* "cssm.pyx":135
  *     cdef float[:] v_view = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 141, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 135, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":142
+  /* "cssm.pyx":136
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 142, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 136, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":144
+  /* "cssm.pyx":138
  *     cdef float[:] t_view = t
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 144, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_rts = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "cssm.pyx":145
+  /* "cssm.pyx":139
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 145, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 145, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 145, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 145, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 145, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 145, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 145, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 145, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 145, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_choices = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "cssm.pyx":146
+  /* "cssm.pyx":140
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 146, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 140, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "cssm.pyx":147
+  /* "cssm.pyx":141
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 147, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 141, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":149
+  /* "cssm.pyx":143
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":150
+  /* "cssm.pyx":144
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  *     cdef float sqrt_st = delta_t_sqrt * s             # <<<<<<<<<<<<<<
  * 
  *     cdef float y, t_particle
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":156
+  /* "cssm.pyx":150
  *     #cdef int n
  *     cdef Py_ssize_t n, k
  *     cdef int m = 0             # <<<<<<<<<<<<<<
  *     cdef int num_draws = int(max_t / delta_t + 1)
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":157
+  /* "cssm.pyx":151
  *     cdef Py_ssize_t n, k
  *     cdef int m = 0
  *     cdef int num_draws = int(max_t / delta_t + 1)             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":158
+  /* "cssm.pyx":152
  *     cdef int m = 0
  *     cdef int num_draws = int(max_t / delta_t + 1)
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
-  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 158, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 152, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":160
+  /* "cssm.pyx":154
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Loop over samples
  *         for n in range(n_samples):
  */
   __pyx_t_9 = __pyx_v_n_trials;
   __pyx_t_10 = __pyx_t_9;
   for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
     __pyx_v_k = __pyx_t_11;
 
-    /* "cssm.pyx":162
+    /* "cssm.pyx":156
  *     for k in range(n_trials):
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             y = z_view[k] * a_view[k] # reset starting point
  *             t_particle = 0.0 # reset time
  */
     __pyx_t_12 = __pyx_v_n_samples;
     __pyx_t_13 = __pyx_t_12;
     for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
       __pyx_v_n = __pyx_t_14;
 
-      /* "cssm.pyx":163
+      /* "cssm.pyx":157
  *         # Loop over samples
  *         for n in range(n_samples):
  *             y = z_view[k] * a_view[k] # reset starting point             # <<<<<<<<<<<<<<
  *             t_particle = 0.0 # reset time
  * 
  */
       __pyx_t_15 = __pyx_v_k;
       __pyx_t_16 = __pyx_v_k;
       __pyx_v_y = ((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_15 * __pyx_v_z_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_16 * __pyx_v_a_view.strides[0]) ))));
 
-      /* "cssm.pyx":164
+      /* "cssm.pyx":158
  *         for n in range(n_samples):
  *             y = z_view[k] * a_view[k] # reset starting point
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":167
+      /* "cssm.pyx":161
  * 
  *             # Random walker
  *             while y <= a_view[k] and y >= 0 and t <= max_t:             # <<<<<<<<<<<<<<
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position
  *                 t_particle += delta_t
  */
       while (1) {
@@ -4634,239 +4648,239 @@
         }
         __pyx_t_18 = ((__pyx_v_y >= 0.0) != 0);
         if (__pyx_t_18) {
         } else {
           __pyx_t_17 = __pyx_t_18;
           goto __pyx_L9_bool_binop_done;
         }
-        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 167, __pyx_L1_error)
+        __pyx_t_6 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 161, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_3 = PyObject_RichCompare(((PyObject *)__pyx_v_t), __pyx_t_6, Py_LE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 167, __pyx_L1_error)
+        __pyx_t_3 = PyObject_RichCompare(((PyObject *)__pyx_v_t), __pyx_t_6, Py_LE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 161, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 167, __pyx_L1_error)
+        __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 161, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_17 = __pyx_t_18;
         __pyx_L9_bool_binop_done:;
         if (!__pyx_t_17) break;
 
-        /* "cssm.pyx":168
+        /* "cssm.pyx":162
  *             # Random walker
  *             while y <= a_view[k] and y >= 0 and t <= max_t:
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 m += 1
  */
         __pyx_t_16 = __pyx_v_k;
         __pyx_t_15 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_16 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_15 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":169
+        /* "cssm.pyx":163
  *             while y <= a_view[k] and y >= 0 and t <= max_t:
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 m += 1
  *                 if m == num_draws:
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":170
+        /* "cssm.pyx":164
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position
  *                 t_particle += delta_t
  *                 m += 1             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":171
+        /* "cssm.pyx":165
  *                 t_particle += delta_t
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_17 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_17) {
 
-          /* "cssm.pyx":172
+          /* "cssm.pyx":166
  *                 m += 1
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 172, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 166, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":173
+          /* "cssm.pyx":167
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             # Note that for purposes of consistency with Navarro and Fuss,
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":171
+          /* "cssm.pyx":165
  *                 t_particle += delta_t
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":177
+      /* "cssm.pyx":171
  *             # Note that for purposes of consistency with Navarro and Fuss,
  *             # the choice corresponding the lower barrier is +1, higher barrier is -1
  *             rts_view[n, k, 0] = t_particle + t_view[k] # store rt             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = (-1) * sign(y) # store choice
  * 
  */
       __pyx_t_15 = __pyx_v_k;
       __pyx_t_16 = __pyx_v_n;
       __pyx_t_19 = __pyx_v_k;
       __pyx_t_20 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_16 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_15 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":178
+      /* "cssm.pyx":172
  *             # the choice corresponding the lower barrier is +1, higher barrier is -1
  *             rts_view[n, k, 0] = t_particle + t_view[k] # store rt
  *             choices_view[n, k, 0] = (-1) * sign(y) # store choice             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  */
       __pyx_t_15 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_19 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_15 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) = (-1L * __pyx_f_4cssm_sign(__pyx_v_y));
     }
   }
 
-  /* "cssm.pyx":180
+  /* "cssm.pyx":174
  *             choices_view[n, k, 0] = (-1) * sign(y) # store choice
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                          'a': a,
  *                                                          'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 180, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 174, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 174, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
 
-  /* "cssm.pyx":181
+  /* "cssm.pyx":175
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                          'a': a,             # <<<<<<<<<<<<<<
  *                                                          'z': z,
  *                                                          't': t,
  */
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
 
-  /* "cssm.pyx":182
+  /* "cssm.pyx":176
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                          'a': a,
  *                                                          'z': z,             # <<<<<<<<<<<<<<
  *                                                          't': t,
  *                                                          's': s,
  */
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
 
-  /* "cssm.pyx":183
+  /* "cssm.pyx":177
  *                                                          'a': a,
  *                                                          'z': z,
  *                                                          't': t,             # <<<<<<<<<<<<<<
  *                                                          's': s,
  *                                                          'delta_t': delta_t,
  */
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
 
-  /* "cssm.pyx":184
+  /* "cssm.pyx":178
  *                                                          'z': z,
  *                                                          't': t,
  *                                                          's': s,             # <<<<<<<<<<<<<<
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 184, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 178, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_s, __pyx_t_4) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_s, __pyx_t_4) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "cssm.pyx":185
+  /* "cssm.pyx":179
  *                                                          't': t,
  *                                                          's': s,
  *                                                          'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 185, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 179, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_delta_t, __pyx_t_4) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_delta_t, __pyx_t_4) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "cssm.pyx":186
+  /* "cssm.pyx":180
  *                                                          's': s,
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                          'n_samples': n_samples,
  *                                                          'simulator': 'ddm',
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 186, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 180, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_max_t, __pyx_t_4) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_max_t, __pyx_t_4) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "cssm.pyx":187
+  /* "cssm.pyx":181
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                          'simulator': 'ddm',
  *                                                          'boundary_fun_type': 'constant',
  */
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 187, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 181, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_n_samples, __pyx_t_4) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_n_samples, __pyx_t_4) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_simulator, __pyx_n_u_ddm) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_simulator, __pyx_n_u_ddm) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
 
-  /* "cssm.pyx":190
+  /* "cssm.pyx":184
  *                                                          'simulator': 'ddm',
  *                                                          'boundary_fun_type': 'constant',
  *                                                          'possible_choices': [-1, 1]}}             # <<<<<<<<<<<<<<
  * 
  * # ---------------------------------------------------------------------------------------------
  */
-  __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 184, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_4, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_possible_choices, __pyx_t_4) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_possible_choices, __pyx_t_4) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_6) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_6) < 0) __PYX_ERR(0, 174, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":125
+  /* "cssm.pyx":119
  * #@cython.wraparound(False)
  * 
  * def test(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *          np.ndarray[float, ndim = 1] a, # boundary separation
  *          np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
 
@@ -4908,15 +4922,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":197
+/* "cssm.pyx":191
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def full_ddm_hddm_base(np.ndarray[float, ndim = 1] v, # = 0,             # <<<<<<<<<<<<<<
  *                      np.ndarray[float, ndim = 1] a, # = 1,
  *                      np.ndarray[float, ndim = 1] z, # = 0.5,
  */
 
@@ -4943,15 +4957,15 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("full_ddm_hddm_base (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_sz,&__pyx_n_s_sv,&__pyx_n_s_st,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_random_state,0};
     PyObject* values[13] = {0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":209
+    /* "cssm.pyx":203
  *                      int n_samples = 20000,
  *                      int n_trials = 1,
  *                      random_state = None,             # <<<<<<<<<<<<<<
  *                      ):
  * 
  */
     values[12] = ((PyObject *)Py_None);
@@ -4993,45 +5007,45 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 1); __PYX_ERR(0, 197, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 1); __PYX_ERR(0, 191, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 2); __PYX_ERR(0, 197, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 2); __PYX_ERR(0, 191, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 3); __PYX_ERR(0, 197, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 3); __PYX_ERR(0, 191, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sz)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 4); __PYX_ERR(0, 197, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 4); __PYX_ERR(0, 191, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sv)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 5); __PYX_ERR(0, 197, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 5); __PYX_ERR(0, 191, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_st)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 6); __PYX_ERR(0, 197, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, 6); __PYX_ERR(0, 191, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[7] = value; kw_args--; }
         }
@@ -5063,15 +5077,15 @@
         case 12:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[12] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "full_ddm_hddm_base") < 0)) __PYX_ERR(0, 197, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "full_ddm_hddm_base") < 0)) __PYX_ERR(0, 191, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 13: values[12] = PyTuple_GET_ITEM(__pyx_args, 12);
         CYTHON_FALLTHROUGH;
         case 12: values[11] = PyTuple_GET_ITEM(__pyx_args, 11);
         CYTHON_FALLTHROUGH;
@@ -5098,58 +5112,58 @@
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_t = ((PyArrayObject *)values[3]);
     __pyx_v_sz = ((PyArrayObject *)values[4]);
     __pyx_v_sv = ((PyArrayObject *)values[5]);
     __pyx_v_st = ((PyArrayObject *)values[6]);
     if (values[7]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 204, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 198, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[8]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 205, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 199, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[9]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 206, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 200, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[10]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[10]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 207, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[10]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 201, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[11]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[11]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 208, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[11]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 202, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_random_state = values[12];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 197, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("full_ddm_hddm_base", 0, 7, 13, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 191, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.full_ddm_hddm_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 197, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 198, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 199, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 200, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sz), __pyx_ptype_5numpy_ndarray, 1, "sz", 0))) __PYX_ERR(0, 201, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sv), __pyx_ptype_5numpy_ndarray, 1, "sv", 0))) __PYX_ERR(0, 202, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_st), __pyx_ptype_5numpy_ndarray, 1, "st", 0))) __PYX_ERR(0, 203, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 191, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 192, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 193, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 194, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sz), __pyx_ptype_5numpy_ndarray, 1, "sz", 0))) __PYX_ERR(0, 195, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sv), __pyx_ptype_5numpy_ndarray, 1, "sv", 0))) __PYX_ERR(0, 196, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_st), __pyx_ptype_5numpy_ndarray, 1, "st", 0))) __PYX_ERR(0, 197, __pyx_L1_error)
   __pyx_r = __pyx_pf_4cssm_2full_ddm_hddm_base(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_sz, __pyx_v_sv, __pyx_v_st, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_random_state);
 
-  /* "cssm.pyx":197
+  /* "cssm.pyx":191
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def full_ddm_hddm_base(np.ndarray[float, ndim = 1] v, # = 0,             # <<<<<<<<<<<<<<
  *                      np.ndarray[float, ndim = 1] a, # = 1,
  *                      np.ndarray[float, ndim = 1] z, # = 0.5,
  */
 
@@ -5257,369 +5271,369 @@
   __pyx_pybuffernd_sv.rcbuffer = &__pyx_pybuffer_sv;
   __pyx_pybuffer_st.pybuffer.buf = NULL;
   __pyx_pybuffer_st.refcount = 0;
   __pyx_pybuffernd_st.data = NULL;
   __pyx_pybuffernd_st.rcbuffer = &__pyx_pybuffer_st;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 191, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 191, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 191, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 191, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sz.rcbuffer->pybuffer, (PyObject*)__pyx_v_sz, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sz.rcbuffer->pybuffer, (PyObject*)__pyx_v_sz, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 191, __pyx_L1_error)
   }
   __pyx_pybuffernd_sz.diminfo[0].strides = __pyx_pybuffernd_sz.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_sz.diminfo[0].shape = __pyx_pybuffernd_sz.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sv.rcbuffer->pybuffer, (PyObject*)__pyx_v_sv, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sv.rcbuffer->pybuffer, (PyObject*)__pyx_v_sv, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 191, __pyx_L1_error)
   }
   __pyx_pybuffernd_sv.diminfo[0].strides = __pyx_pybuffernd_sv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_sv.diminfo[0].shape = __pyx_pybuffernd_sv.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_st.rcbuffer->pybuffer, (PyObject*)__pyx_v_st, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_st.rcbuffer->pybuffer, (PyObject*)__pyx_v_st, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 191, __pyx_L1_error)
   }
   __pyx_pybuffernd_st.diminfo[0].strides = __pyx_pybuffernd_st.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_st.diminfo[0].shape = __pyx_pybuffernd_st.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":212
+  /* "cssm.pyx":206
  *                      ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
  * 
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 206, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":216
+  /* "cssm.pyx":210
  * 
  *     # Param views
  *     cdef float[:] v_view  = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 216, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 210, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":217
+  /* "cssm.pyx":211
  *     # Param views
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 217, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 211, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":218
+  /* "cssm.pyx":212
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  *     cdef float[:] sz_view = sz
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 218, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 212, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":219
+  /* "cssm.pyx":213
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  *     cdef float[:] sz_view = sz
  *     cdef float[:] sv_view = sv
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 219, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 213, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":220
+  /* "cssm.pyx":214
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  *     cdef float[:] sz_view = sz             # <<<<<<<<<<<<<<
  *     cdef float[:] sv_view = sv
  *     cdef float[:] st_view = st
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_sz), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 220, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_sz), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 214, __pyx_L1_error)
   __pyx_v_sz_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":221
+  /* "cssm.pyx":215
  *     cdef float[:] t_view = t
  *     cdef float[:] sz_view = sz
  *     cdef float[:] sv_view = sv             # <<<<<<<<<<<<<<
  *     cdef float[:] st_view = st
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_sv), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 221, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_sv), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 215, __pyx_L1_error)
   __pyx_v_sv_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":222
+  /* "cssm.pyx":216
  *     cdef float[:] sz_view = sz
  *     cdef float[:] sv_view = sv
  *     cdef float[:] st_view = st             # <<<<<<<<<<<<<<
  * 
  *     # Data-structs for trajectory storage
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_st), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 222, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_st), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 216, __pyx_L1_error)
   __pyx_v_st_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":225
+  /* "cssm.pyx":219
  * 
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:, :] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 225, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 225, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_traj = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":226
+  /* "cssm.pyx":220
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:, :] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 226, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 220, __pyx_L1_error)
 
-  /* "cssm.pyx":227
+  /* "cssm.pyx":221
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:, :] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 227, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 221, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":229
+  /* "cssm.pyx":223
  *     cdef float[:, :] traj_view = traj
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 229, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 229, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 229, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 229, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 229, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 229, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 229, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 229, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 229, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 229, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rts = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":230
+  /* "cssm.pyx":224
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 230, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 230, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 224, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":232
+  /* "cssm.pyx":226
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 232, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 226, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":233
+  /* "cssm.pyx":227
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 233, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 227, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":235
+  /* "cssm.pyx":229
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":236
+  /* "cssm.pyx":230
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage for the upper bound
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":239
+  /* "cssm.pyx":233
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  * 
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":240
+  /* "cssm.pyx":234
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *     cdef float y, t_particle, t_tmp
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_10 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -5628,291 +5642,291 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 240, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 234, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_10) {
       __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_12 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_12)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_12);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_7 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 240, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_t_s = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":244
+  /* "cssm.pyx":238
  *     cdef float y, t_particle, t_tmp
  *     cdef Py_ssize_t n, ix, k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     cdef float drift_increment = 0.0
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":245
+  /* "cssm.pyx":239
  *     cdef Py_ssize_t n, ix, k
  *     cdef Py_ssize_t m = 0
  *     cdef float drift_increment = 0.0             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_drift_increment = 0.0;
 
-  /* "cssm.pyx":246
+  /* "cssm.pyx":240
  *     cdef Py_ssize_t m = 0
  *     cdef float drift_increment = 0.0
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     # Loop over trials
  */
-  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 246, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 240, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":249
+  /* "cssm.pyx":243
  * 
  *     # Loop over trials
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Loop over samples
  *         for n in range(n_samples):
  */
   __pyx_t_11 = __pyx_v_n_trials;
   __pyx_t_13 = __pyx_t_11;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_k = __pyx_t_14;
 
-    /* "cssm.pyx":251
+    /* "cssm.pyx":245
  *     for k in range(n_trials):
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             # initialize starting point
  *             y = (z_view[k] * (a_view[k]))  # reset starting position
  */
     __pyx_t_15 = __pyx_v_n_samples;
     __pyx_t_16 = __pyx_t_15;
     for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
       __pyx_v_n = __pyx_t_17;
 
-      /* "cssm.pyx":253
+      /* "cssm.pyx":247
  *         for n in range(n_samples):
  *             # initialize starting point
  *             y = (z_view[k] * (a_view[k]))  # reset starting position             # <<<<<<<<<<<<<<
  * 
  *             # get drift by random displacement of v
  */
       __pyx_t_18 = __pyx_v_k;
       __pyx_t_19 = __pyx_v_k;
       __pyx_v_y = ((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_18 * __pyx_v_z_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));
 
-      /* "cssm.pyx":256
+      /* "cssm.pyx":250
  * 
  *             # get drift by random displacement of v
  *             drift_increment = (v_view[k] + sv_view[k] * gaussian_values[m]) * delta_t             # <<<<<<<<<<<<<<
  *             t_tmp = t_view[k] + (2 * (random_uniform() - 0.5) * st_view[k])
  * 
  */
       __pyx_t_19 = __pyx_v_k;
       __pyx_t_18 = __pyx_v_k;
       __pyx_t_20 = __pyx_v_m;
       __pyx_v_drift_increment = (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_19 * __pyx_v_v_view.strides[0]) ))) + ((*((float *) ( /* dim=0 */ (__pyx_v_sv_view.data + __pyx_t_18 * __pyx_v_sv_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))) * __pyx_v_delta_t);
 
-      /* "cssm.pyx":257
+      /* "cssm.pyx":251
  *             # get drift by random displacement of v
  *             drift_increment = (v_view[k] + sv_view[k] * gaussian_values[m]) * delta_t
  *             t_tmp = t_view[k] + (2 * (random_uniform() - 0.5) * st_view[k])             # <<<<<<<<<<<<<<
  * 
  *             # apply uniform displacement on y
  */
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_18 = __pyx_v_k;
       __pyx_v_t_tmp = ((*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))) + ((2.0 * (__pyx_f_4cssm_random_uniform() - 0.5)) * (*((float *) ( /* dim=0 */ (__pyx_v_st_view.data + __pyx_t_18 * __pyx_v_st_view.strides[0]) )))));
 
-      /* "cssm.pyx":260
+      /* "cssm.pyx":254
  * 
  *             # apply uniform displacement on y
  *             y += 2 * (random_uniform() - 0.5) * sz_view[k]             # <<<<<<<<<<<<<<
  * 
  *             # increment m appropriately
  */
       __pyx_t_18 = __pyx_v_k;
       __pyx_v_y = (__pyx_v_y + ((2.0 * (__pyx_f_4cssm_random_uniform() - 0.5)) * (*((float *) ( /* dim=0 */ (__pyx_v_sz_view.data + __pyx_t_18 * __pyx_v_sz_view.strides[0]) )))));
 
-      /* "cssm.pyx":263
+      /* "cssm.pyx":257
  * 
  *             # increment m appropriately
  *             m += 1             # <<<<<<<<<<<<<<
  *             if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
       __pyx_v_m = (__pyx_v_m + 1);
 
-      /* "cssm.pyx":264
+      /* "cssm.pyx":258
  *             # increment m appropriately
  *             m += 1
  *             if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
       __pyx_t_21 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
       if (__pyx_t_21) {
 
-        /* "cssm.pyx":265
+        /* "cssm.pyx":259
  *             m += 1
  *             if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-        __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 265, __pyx_L1_error)
+        __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 259, __pyx_L1_error)
         __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
         __pyx_v_gaussian_values = __pyx_t_2;
         __pyx_t_2.memview = NULL;
         __pyx_t_2.data = NULL;
 
-        /* "cssm.pyx":266
+        /* "cssm.pyx":260
  *             if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             t_particle = 0.0 # reset time
  */
         __pyx_v_m = 0;
 
-        /* "cssm.pyx":264
+        /* "cssm.pyx":258
  *             # increment m appropriately
  *             m += 1
  *             if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
       }
 
-      /* "cssm.pyx":268
+      /* "cssm.pyx":262
  *                     m = 0
  * 
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":269
+      /* "cssm.pyx":263
  * 
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             if n == 0:
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":271
+      /* "cssm.pyx":265
  *             ix = 0 # reset boundary index
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       __pyx_t_21 = ((__pyx_v_n == 0) != 0);
       if (__pyx_t_21) {
 
-        /* "cssm.pyx":272
+        /* "cssm.pyx":266
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         __pyx_t_21 = ((__pyx_v_k == 0) != 0);
         if (__pyx_t_21) {
 
-          /* "cssm.pyx":273
+          /* "cssm.pyx":267
  *             if n == 0:
  *                 if k == 0:
  *                     traj_view[0, 0] = y             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
           __pyx_t_18 = 0;
           __pyx_t_20 = 0;
           *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_18 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-          /* "cssm.pyx":272
+          /* "cssm.pyx":266
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         }
 
-        /* "cssm.pyx":271
+        /* "cssm.pyx":265
  *             ix = 0 # reset boundary index
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       }
 
-      /* "cssm.pyx":276
+      /* "cssm.pyx":270
  * 
  *             # Random walker
  *             while y >= 0 and y <= a_view[k] and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  */
       while (1) {
@@ -5930,187 +5944,187 @@
           goto __pyx_L12_bool_binop_done;
         }
         __pyx_t_22 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_21 = __pyx_t_22;
         __pyx_L12_bool_binop_done:;
         if (!__pyx_t_21) break;
 
-        /* "cssm.pyx":277
+        /* "cssm.pyx":271
  *             # Random walker
  *             while y >= 0 and y <= a_view[k] and t_particle <= max_t:
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 ix += 1
  */
         __pyx_t_20 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + (__pyx_v_drift_increment + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":278
+        /* "cssm.pyx":272
  *             while y >= 0 and y <= a_view[k] and t_particle <= max_t:
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":279
+        /* "cssm.pyx":273
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  * 
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":280
+        /* "cssm.pyx":274
  *                 t_particle += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  * 
  *                 if n == 0:
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":282
+        /* "cssm.pyx":276
  *                 m += 1
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         __pyx_t_21 = ((__pyx_v_n == 0) != 0);
         if (__pyx_t_21) {
 
-          /* "cssm.pyx":283
+          /* "cssm.pyx":277
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  */
           __pyx_t_21 = ((__pyx_v_k == 0) != 0);
           if (__pyx_t_21) {
 
-            /* "cssm.pyx":284
+            /* "cssm.pyx":278
  *                 if n == 0:
  *                     if k == 0:
  *                         traj_view[ix, 0] = y             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
             __pyx_t_20 = __pyx_v_ix;
             __pyx_t_18 = 0;
             *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_18 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-            /* "cssm.pyx":283
+            /* "cssm.pyx":277
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  */
           }
 
-          /* "cssm.pyx":282
+          /* "cssm.pyx":276
  *                 m += 1
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         }
 
-        /* "cssm.pyx":285
+        /* "cssm.pyx":279
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_21 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_21) {
 
-          /* "cssm.pyx":286
+          /* "cssm.pyx":280
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 286, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 280, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":287
+          /* "cssm.pyx":281
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             rts_view[n, k, 0] = t_particle + t_tmp # Store rt
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":285
+          /* "cssm.pyx":279
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":289
+      /* "cssm.pyx":283
  *                     m = 0
  * 
  *             rts_view[n, k, 0] = t_particle + t_tmp # Store rt             # <<<<<<<<<<<<<<
  * 
  *             if y < 0:
  */
       __pyx_t_18 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_19 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_18 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + __pyx_v_t_tmp);
 
-      /* "cssm.pyx":291
+      /* "cssm.pyx":285
  *             rts_view[n, k, 0] = t_particle + t_tmp # Store rt
  * 
  *             if y < 0:             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] = 0 # Store choice
  *             else:
  */
       __pyx_t_21 = ((__pyx_v_y < 0.0) != 0);
       if (__pyx_t_21) {
 
-        /* "cssm.pyx":292
+        /* "cssm.pyx":286
  * 
  *             if y < 0:
  *                 choices_view[n, k, 0] = 0 # Store choice             # <<<<<<<<<<<<<<
  *             else:
  *                 choices_view[n, k, 0] = 1
  */
         __pyx_t_19 = __pyx_v_n;
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_18 = 0;
         *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_18 * __pyx_v_choices_view.strides[2]) )) = 0;
 
-        /* "cssm.pyx":291
+        /* "cssm.pyx":285
  *             rts_view[n, k, 0] = t_particle + t_tmp # Store rt
  * 
  *             if y < 0:             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] = 0 # Store choice
  *             else:
  */
         goto __pyx_L18;
       }
 
-      /* "cssm.pyx":294
+      /* "cssm.pyx":288
  *                 choices_view[n, k, 0] = 0 # Store choice
  *             else:
  *                 choices_view[n, k, 0] = 1             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  */
       /*else*/ {
@@ -6119,166 +6133,166 @@
         __pyx_t_19 = 0;
         *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_18 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) = 1;
       }
       __pyx_L18:;
     }
   }
 
-  /* "cssm.pyx":296
+  /* "cssm.pyx":290
  *                 choices_view[n, k, 0] = 1
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                             'a': a,
  *                             'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 296, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(14); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(14); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
 
-  /* "cssm.pyx":297
+  /* "cssm.pyx":291
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                             'a': a,             # <<<<<<<<<<<<<<
  *                             'z': z,
  *                             't': t,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
 
-  /* "cssm.pyx":298
+  /* "cssm.pyx":292
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                             'a': a,
  *                             'z': z,             # <<<<<<<<<<<<<<
  *                             't': t,
  *                             'sz': sz,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
 
-  /* "cssm.pyx":299
+  /* "cssm.pyx":293
  *                             'a': a,
  *                             'z': z,
  *                             't': t,             # <<<<<<<<<<<<<<
  *                             'sz': sz,
  *                             'sv': sv,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
 
-  /* "cssm.pyx":300
+  /* "cssm.pyx":294
  *                             'z': z,
  *                             't': t,
  *                             'sz': sz,             # <<<<<<<<<<<<<<
  *                             'sv': sv,
  *                             'st': st,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_sz, ((PyObject *)__pyx_v_sz)) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_sz, ((PyObject *)__pyx_v_sz)) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
 
-  /* "cssm.pyx":301
+  /* "cssm.pyx":295
  *                             't': t,
  *                             'sz': sz,
  *                             'sv': sv,             # <<<<<<<<<<<<<<
  *                             'st': st,
  *                             's': s,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_sv, ((PyObject *)__pyx_v_sv)) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_sv, ((PyObject *)__pyx_v_sv)) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
 
-  /* "cssm.pyx":302
+  /* "cssm.pyx":296
  *                             'sz': sz,
  *                             'sv': sv,
  *                             'st': st,             # <<<<<<<<<<<<<<
  *                             's': s,
  *                             'delta_t': delta_t,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_st, ((PyObject *)__pyx_v_st)) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_st, ((PyObject *)__pyx_v_st)) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
 
-  /* "cssm.pyx":303
+  /* "cssm.pyx":297
  *                             'sv': sv,
  *                             'st': st,
  *                             's': s,             # <<<<<<<<<<<<<<
  *                             'delta_t': delta_t,
  *                             'max_t': max_t,
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_1) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_1) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":304
+  /* "cssm.pyx":298
  *                             'st': st,
  *                             's': s,
  *                             'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                             'max_t': max_t,
  *                             'n_samples': n_samples,
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 304, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 298, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":305
+  /* "cssm.pyx":299
  *                             's': s,
  *                             'delta_t': delta_t,
  *                             'max_t': max_t,             # <<<<<<<<<<<<<<
  *                             'n_samples': n_samples,
  *                             'simulator': 'full_ddm_hddm_base',
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 299, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":306
+  /* "cssm.pyx":300
  *                             'delta_t': delta_t,
  *                             'max_t': max_t,
  *                             'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                             'simulator': 'full_ddm_hddm_base',
  *                             'possible_choices': [0, 1],
  */
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_simulator, __pyx_n_u_full_ddm_hddm_base) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_simulator, __pyx_n_u_full_ddm_hddm_base) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
 
-  /* "cssm.pyx":308
+  /* "cssm.pyx":302
  *                             'n_samples': n_samples,
  *                             'simulator': 'full_ddm_hddm_base',
  *                             'possible_choices': [0, 1],             # <<<<<<<<<<<<<<
  *                             'trajectory': traj}}
  * # -------------------------------------------------------------------------------------------------
  */
-  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 308, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_possible_choices, __pyx_t_1) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_possible_choices, __pyx_t_1) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":309
+  /* "cssm.pyx":303
  *                             'simulator': 'full_ddm_hddm_base',
  *                             'possible_choices': [0, 1],
  *                             'trajectory': traj}}             # <<<<<<<<<<<<<<
  * # -------------------------------------------------------------------------------------------------
  * 
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_metadata, __pyx_t_3) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_metadata, __pyx_t_3) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_7;
   __pyx_t_7 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":197
+  /* "cssm.pyx":191
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def full_ddm_hddm_base(np.ndarray[float, ndim = 1] v, # = 0,             # <<<<<<<<<<<<<<
  *                      np.ndarray[float, ndim = 1] a, # = 1,
  *                      np.ndarray[float, ndim = 1] z, # = 0.5,
  */
 
@@ -6335,15 +6349,15 @@
   __Pyx_XDECREF(__pyx_v_t_s);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":320
+/* "cssm.pyx":314
  * #@cython.wraparound(False)
  * 
  * def ddm(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *         np.ndarray[float, ndim = 1] a, # boundary separation
  *         np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
 
@@ -6367,15 +6381,15 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ddm (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_random_state,0};
     PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":329
+    /* "cssm.pyx":323
  *         int n_samples = 20000, # number of samples considered
  *         int n_trials = 10,
  *         random_state = None,):             # <<<<<<<<<<<<<<
  * 
  *     set_seed(random_state)
  */
     values[9] = ((PyObject *)Py_None);
@@ -6411,27 +6425,27 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm", 0, 4, 10, 1); __PYX_ERR(0, 320, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm", 0, 4, 10, 1); __PYX_ERR(0, 314, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm", 0, 4, 10, 2); __PYX_ERR(0, 320, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm", 0, 4, 10, 2); __PYX_ERR(0, 314, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm", 0, 4, 10, 3); __PYX_ERR(0, 320, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm", 0, 4, 10, 3); __PYX_ERR(0, 314, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[4] = value; kw_args--; }
         }
@@ -6463,15 +6477,15 @@
         case  9:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[9] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm") < 0)) __PYX_ERR(0, 320, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm") < 0)) __PYX_ERR(0, 314, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
         CYTHON_FALLTHROUGH;
         case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
         CYTHON_FALLTHROUGH;
@@ -6492,55 +6506,55 @@
       }
     }
     __pyx_v_v = ((PyArrayObject *)values[0]);
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_t = ((PyArrayObject *)values[3]);
     if (values[4]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 324, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 318, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[5]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 325, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 319, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[6]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 326, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 320, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[7]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 327, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 321, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[8]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 328, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 322, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)10);
     }
     __pyx_v_random_state = values[9];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ddm", 0, 4, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 320, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ddm", 0, 4, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 314, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ddm", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 320, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 321, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 322, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 323, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 314, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 315, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 316, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 317, __pyx_L1_error)
   __pyx_r = __pyx_pf_4cssm_4ddm(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_random_state);
 
-  /* "cssm.pyx":320
+  /* "cssm.pyx":314
  * #@cython.wraparound(False)
  * 
  * def ddm(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *         np.ndarray[float, ndim = 1] a, # boundary separation
  *         np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
 
@@ -6623,427 +6637,427 @@
   __pyx_pybuffernd_z.rcbuffer = &__pyx_pybuffer_z;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 320, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 320, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 320, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 320, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":331
+  /* "cssm.pyx":325
  *         random_state = None,):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Param views
  *     cdef float[:] v_view = v
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 325, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":333
+  /* "cssm.pyx":327
  *     set_seed(random_state)
  *     # Param views
  *     cdef float[:] v_view = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 333, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 327, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":334
+  /* "cssm.pyx":328
  *     # Param views
  *     cdef float[:] v_view = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 334, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 328, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":335
+  /* "cssm.pyx":329
  *     cdef float[:] v_view = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 335, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 329, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":336
+  /* "cssm.pyx":330
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     # Data-structs for trajectory storage
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 336, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 330, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":339
+  /* "cssm.pyx":333
  * 
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:, :] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 339, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_traj = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":340
+  /* "cssm.pyx":334
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:, :] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 340, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 334, __pyx_L1_error)
 
-  /* "cssm.pyx":341
+  /* "cssm.pyx":335
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:, :] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 341, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 335, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":343
+  /* "cssm.pyx":337
  *     cdef float[:, :] traj_view = traj
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 343, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rts = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":344
+  /* "cssm.pyx":338
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 344, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":345
+  /* "cssm.pyx":339
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 345, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 339, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":346
+  /* "cssm.pyx":340
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 346, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 340, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":348
+  /* "cssm.pyx":342
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":349
+  /* "cssm.pyx":343
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  *     cdef float sqrt_st = delta_t_sqrt * s             # <<<<<<<<<<<<<<
  * 
  *     cdef float y, t_particle
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":355
+  /* "cssm.pyx":349
  *     #cdef int n
  *     cdef Py_ssize_t n, ix, k
  *     cdef int m = 0             # <<<<<<<<<<<<<<
  *     cdef int num_draws = int(max_t / delta_t + 1)
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":356
+  /* "cssm.pyx":350
  *     cdef Py_ssize_t n, ix, k
  *     cdef int m = 0
  *     cdef int num_draws = int(max_t / delta_t + 1)             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":357
+  /* "cssm.pyx":351
  *     cdef int m = 0
  *     cdef int num_draws = int(max_t / delta_t + 1)
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
-  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 357, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 351, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":359
+  /* "cssm.pyx":353
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Loop over samples
  *         for n in range(n_samples):
  */
   __pyx_t_10 = __pyx_v_n_trials;
   __pyx_t_11 = __pyx_t_10;
   for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
     __pyx_v_k = __pyx_t_12;
 
-    /* "cssm.pyx":361
+    /* "cssm.pyx":355
  *     for k in range(n_trials):
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             y = z_view[k] * a_view[k] # reset starting point
  *             t_particle = 0.0 # reset time
  */
     __pyx_t_13 = __pyx_v_n_samples;
     __pyx_t_14 = __pyx_t_13;
     for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
       __pyx_v_n = __pyx_t_15;
 
-      /* "cssm.pyx":362
+      /* "cssm.pyx":356
  *         # Loop over samples
  *         for n in range(n_samples):
  *             y = z_view[k] * a_view[k] # reset starting point             # <<<<<<<<<<<<<<
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index
  */
       __pyx_t_16 = __pyx_v_k;
       __pyx_t_17 = __pyx_v_k;
       __pyx_v_y = ((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_16 * __pyx_v_z_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_17 * __pyx_v_a_view.strides[0]) ))));
 
-      /* "cssm.pyx":363
+      /* "cssm.pyx":357
  *         for n in range(n_samples):
  *             y = z_view[k] * a_view[k] # reset starting point
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":364
+      /* "cssm.pyx":358
  *             y = z_view[k] * a_view[k] # reset starting point
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             if n == 0:
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":366
+      /* "cssm.pyx":360
  *             ix = 0 # reset boundary index
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       __pyx_t_18 = ((__pyx_v_n == 0) != 0);
       if (__pyx_t_18) {
 
-        /* "cssm.pyx":367
+        /* "cssm.pyx":361
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         __pyx_t_18 = ((__pyx_v_k == 0) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":368
+          /* "cssm.pyx":362
  *             if n == 0:
  *                 if k == 0:
  *                     traj_view[0, 0] = y             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
           __pyx_t_17 = 0;
           __pyx_t_16 = 0;
           *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_17 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_16 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-          /* "cssm.pyx":367
+          /* "cssm.pyx":361
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         }
 
-        /* "cssm.pyx":366
+        /* "cssm.pyx":360
  *             ix = 0 # reset boundary index
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       }
 
-      /* "cssm.pyx":371
+      /* "cssm.pyx":365
  * 
  *             # Random walker
  *             while y <= a_view[k] and y >= 0 and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position
  *                 t_particle += delta_t
  */
       while (1) {
@@ -7061,296 +7075,296 @@
           goto __pyx_L11_bool_binop_done;
         }
         __pyx_t_19 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_18 = __pyx_t_19;
         __pyx_L11_bool_binop_done:;
         if (!__pyx_t_18) break;
 
-        /* "cssm.pyx":372
+        /* "cssm.pyx":366
  *             # Random walker
  *             while y <= a_view[k] and y >= 0 and t_particle <= max_t:
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 m += 1
  */
         __pyx_t_16 = __pyx_v_k;
         __pyx_t_17 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_16 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_17 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":373
+        /* "cssm.pyx":367
  *             while y <= a_view[k] and y >= 0 and t_particle <= max_t:
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 m += 1
  *                 ix += 1
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":374
+        /* "cssm.pyx":368
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position
  *                 t_particle += delta_t
  *                 m += 1             # <<<<<<<<<<<<<<
  *                 ix += 1
  * 
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":375
+        /* "cssm.pyx":369
  *                 t_particle += delta_t
  *                 m += 1
  *                 ix += 1             # <<<<<<<<<<<<<<
  * 
  *                 if n == 0:
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":377
+        /* "cssm.pyx":371
  *                 ix += 1
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         __pyx_t_18 = ((__pyx_v_n == 0) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":378
+          /* "cssm.pyx":372
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  * 
  */
           __pyx_t_18 = ((__pyx_v_k == 0) != 0);
           if (__pyx_t_18) {
 
-            /* "cssm.pyx":379
+            /* "cssm.pyx":373
  *                 if n == 0:
  *                     if k == 0:
  *                         traj_view[ix, 0] = y             # <<<<<<<<<<<<<<
  * 
  *                 if m == num_draws:
  */
             __pyx_t_17 = __pyx_v_ix;
             __pyx_t_16 = 0;
             *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_17 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_16 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-            /* "cssm.pyx":378
+            /* "cssm.pyx":372
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  * 
  */
           }
 
-          /* "cssm.pyx":377
+          /* "cssm.pyx":371
  *                 ix += 1
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         }
 
-        /* "cssm.pyx":381
+        /* "cssm.pyx":375
  *                         traj_view[ix, 0] = y
  * 
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_18 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":382
+          /* "cssm.pyx":376
  * 
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 382, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 376, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":383
+          /* "cssm.pyx":377
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             # Note that for purposes of consistency with Navarro and Fuss,
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":381
+          /* "cssm.pyx":375
  *                         traj_view[ix, 0] = y
  * 
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":387
+      /* "cssm.pyx":381
  *             # Note that for purposes of consistency with Navarro and Fuss,
  *             # the choice corresponding the lower barrier is +1, higher barrier is -1
  *             rts_view[n, k, 0] = t_particle + t_view[k] # store rt             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = sign(y) # store choice
  * 
  */
       __pyx_t_16 = __pyx_v_k;
       __pyx_t_17 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_21 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_17 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_16 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":388
+      /* "cssm.pyx":382
  *             # the choice corresponding the lower barrier is +1, higher barrier is -1
  *             rts_view[n, k, 0] = t_particle + t_view[k] # store rt
  *             choices_view[n, k, 0] = sign(y) # store choice             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  */
       __pyx_t_16 = __pyx_v_n;
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_20 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_16 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = __pyx_f_4cssm_sign(__pyx_v_y);
     }
   }
 
-  /* "cssm.pyx":390
+  /* "cssm.pyx":384
  *             choices_view[n, k, 0] = sign(y) # store choice
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                           'a': a,
  *                                                           'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 390, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
 
-  /* "cssm.pyx":391
+  /* "cssm.pyx":385
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  *                                                           'a': a,             # <<<<<<<<<<<<<<
  *                                                           'z': z,
  *                                                           't': t,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
 
-  /* "cssm.pyx":392
+  /* "cssm.pyx":386
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  *                                                           'a': a,
  *                                                           'z': z,             # <<<<<<<<<<<<<<
  *                                                           't': t,
  *                                                           's': s,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
 
-  /* "cssm.pyx":393
+  /* "cssm.pyx":387
  *                                                           'a': a,
  *                                                           'z': z,
  *                                                           't': t,             # <<<<<<<<<<<<<<
  *                                                           's': s,
  *                                                           'delta_t': delta_t,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
 
-  /* "cssm.pyx":394
+  /* "cssm.pyx":388
  *                                                           'z': z,
  *                                                           't': t,
  *                                                           's': s,             # <<<<<<<<<<<<<<
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 394, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 388, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_s, __pyx_t_4) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_s, __pyx_t_4) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "cssm.pyx":395
+  /* "cssm.pyx":389
  *                                                           't': t,
  *                                                           's': s,
  *                                                           'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 395, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 389, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_delta_t, __pyx_t_4) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_delta_t, __pyx_t_4) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "cssm.pyx":396
+  /* "cssm.pyx":390
  *                                                           's': s,
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ddm',
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 396, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 390, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_max_t, __pyx_t_4) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_max_t, __pyx_t_4) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "cssm.pyx":397
+  /* "cssm.pyx":391
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                           'simulator': 'ddm',
  *                                                           'boundary_fun_type': 'constant',
  */
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 397, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 391, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_4) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_4) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_ddm) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_ddm) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
 
-  /* "cssm.pyx":400
+  /* "cssm.pyx":394
  *                                                           'simulator': 'ddm',
  *                                                           'boundary_fun_type': 'constant',
  *                                                           'possible_choices': [-1, 1],             # <<<<<<<<<<<<<<
  *                                                           'trajectory': traj}}
  * 
  */
-  __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 400, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 394, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_4, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_4) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_4) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "cssm.pyx":401
+  /* "cssm.pyx":395
  *                                                           'boundary_fun_type': 'constant',
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj}}             # <<<<<<<<<<<<<<
  * 
  * # Simulate (rt, choice) tuples from: SIMPLE DDM -----------------------------------------------
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_metadata, __pyx_t_1) < 0) __PYX_ERR(0, 390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_u_metadata, __pyx_t_1) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_7;
   __pyx_t_7 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":320
+  /* "cssm.pyx":314
  * #@cython.wraparound(False)
  * 
  * def ddm(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *         np.ndarray[float, ndim = 1] a, # boundary separation
  *         np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
 
@@ -7395,15 +7409,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":410
+/* "cssm.pyx":404
  * #@cython.wraparound(False)
  * 
  * def ddm_cov(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *             np.ndarray[float, ndim = 1] a, # boundary separation
  *             np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
 
@@ -7427,15 +7441,15 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ddm_cov (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_random_state,0};
     PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":419
+    /* "cssm.pyx":413
  *             int n_samples = 1000, # number of samples considered
  *             int n_trials = 1,
  *             random_state = None,             # <<<<<<<<<<<<<<
  *             ):
  * 
  */
     values[9] = ((PyObject *)Py_None);
@@ -7471,27 +7485,27 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_cov", 0, 4, 10, 1); __PYX_ERR(0, 410, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_cov", 0, 4, 10, 1); __PYX_ERR(0, 404, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_cov", 0, 4, 10, 2); __PYX_ERR(0, 410, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_cov", 0, 4, 10, 2); __PYX_ERR(0, 404, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_cov", 0, 4, 10, 3); __PYX_ERR(0, 410, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_cov", 0, 4, 10, 3); __PYX_ERR(0, 404, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[4] = value; kw_args--; }
         }
@@ -7523,15 +7537,15 @@
         case  9:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[9] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_cov") < 0)) __PYX_ERR(0, 410, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_cov") < 0)) __PYX_ERR(0, 404, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
         CYTHON_FALLTHROUGH;
         case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
         CYTHON_FALLTHROUGH;
@@ -7552,55 +7566,55 @@
       }
     }
     __pyx_v_v = ((PyArrayObject *)values[0]);
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_t = ((PyArrayObject *)values[3]);
     if (values[4]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 414, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 408, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[5]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 415, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 409, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[6]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 416, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 410, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[7]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 417, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 411, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x3E8);
     }
     if (values[8]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 418, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 412, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_random_state = values[9];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ddm_cov", 0, 4, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 410, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ddm_cov", 0, 4, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 404, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ddm_cov", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 410, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 411, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 412, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 413, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 404, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 405, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 406, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 407, __pyx_L1_error)
   __pyx_r = __pyx_pf_4cssm_6ddm_cov(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_random_state);
 
-  /* "cssm.pyx":410
+  /* "cssm.pyx":404
  * #@cython.wraparound(False)
  * 
  * def ddm_cov(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *             np.ndarray[float, ndim = 1] a, # boundary separation
  *             np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
 
@@ -7679,304 +7693,304 @@
   __pyx_pybuffernd_z.rcbuffer = &__pyx_pybuffer_z;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 410, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 404, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 410, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 404, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 410, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 404, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 410, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 404, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":422
+  /* "cssm.pyx":416
  *             ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     #cdef int n_trials = np.max([v.size, a.size, w.size, t.size]).astype(int)
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 416, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":424
+  /* "cssm.pyx":418
  *     set_seed(random_state)
  *     #cdef int n_trials = np.max([v.size, a.size, w.size, t.size]).astype(int)
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 424, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_rts = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "cssm.pyx":425
+  /* "cssm.pyx":419
  *     #cdef int n_trials = np.max([v.size, a.size, w.size, t.size]).astype(int)
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 425, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_choices = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":427
+  /* "cssm.pyx":421
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  *     cdef float[:] v_view = v
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 427, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 421, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":428
+  /* "cssm.pyx":422
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  *     cdef float[:] v_view = v
  *     cdef float[:] a_view = a
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 428, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 422, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "cssm.pyx":429
+  /* "cssm.pyx":423
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices
  *     cdef float[:] v_view = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 429, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 423, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":430
+  /* "cssm.pyx":424
  *     cdef int[:, :, :] choices_view = choices
  *     cdef float[:] v_view = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 430, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 424, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":431
+  /* "cssm.pyx":425
  *     cdef float[:] v_view = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 431, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 425, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":432
+  /* "cssm.pyx":426
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 432, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 426, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":434
+  /* "cssm.pyx":428
  *     cdef float[:] t_view = t
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":435
+  /* "cssm.pyx":429
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  *     cdef float sqrt_st = delta_t_sqrt * s             # <<<<<<<<<<<<<<
  * 
  *     cdef float y, t_particle
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":442
+  /* "cssm.pyx":436
  *     cdef Py_ssize_t n
  *     cdef Py_ssize_t k
  *     cdef int m = 0             # <<<<<<<<<<<<<<
  *     cdef int num_draws = int(max_t / delta_t + 1)
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":443
+  /* "cssm.pyx":437
  *     cdef Py_ssize_t k
  *     cdef int m = 0
  *     cdef int num_draws = int(max_t / delta_t + 1)             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":444
+  /* "cssm.pyx":438
  *     cdef int m = 0
  *     cdef int num_draws = int(max_t / delta_t + 1)
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     # Loop over samples
  */
-  __pyx_t_8 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_8 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 438, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":447
+  /* "cssm.pyx":441
  * 
  *     # Loop over samples
  *     for n in range(n_samples):             # <<<<<<<<<<<<<<
  *         for k in range(n_trials):
  *             y = z_view[k] * a_view[k] # reset starting point
  */
   __pyx_t_9 = __pyx_v_n_samples;
   __pyx_t_10 = __pyx_t_9;
   for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
     __pyx_v_n = __pyx_t_11;
 
-    /* "cssm.pyx":448
+    /* "cssm.pyx":442
  *     # Loop over samples
  *     for n in range(n_samples):
  *         for k in range(n_trials):             # <<<<<<<<<<<<<<
  *             y = z_view[k] * a_view[k] # reset starting point
  *             t_particle = 0.0 # reset time
  */
     __pyx_t_12 = __pyx_v_n_trials;
     __pyx_t_13 = __pyx_t_12;
     for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
       __pyx_v_k = __pyx_t_14;
 
-      /* "cssm.pyx":449
+      /* "cssm.pyx":443
  *     for n in range(n_samples):
  *         for k in range(n_trials):
  *             y = z_view[k] * a_view[k] # reset starting point             # <<<<<<<<<<<<<<
  *             t_particle = 0.0 # reset time
  * 
  */
       __pyx_t_15 = __pyx_v_k;
       __pyx_t_16 = __pyx_v_k;
       __pyx_v_y = ((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_15 * __pyx_v_z_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_16 * __pyx_v_a_view.strides[0]) ))));
 
-      /* "cssm.pyx":450
+      /* "cssm.pyx":444
  *         for k in range(n_trials):
  *             y = z_view[k] * a_view[k] # reset starting point
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":453
+      /* "cssm.pyx":447
  * 
  *             # Random walker
  *             while y <= a[k] and y >= 0 and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position
  *                 t_particle += delta_t
  */
       while (1) {
@@ -7994,229 +8008,229 @@
           goto __pyx_L9_bool_binop_done;
         }
         __pyx_t_18 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_17 = __pyx_t_18;
         __pyx_L9_bool_binop_done:;
         if (!__pyx_t_17) break;
 
-        /* "cssm.pyx":454
+        /* "cssm.pyx":448
  *             # Random walker
  *             while y <= a[k] and y >= 0 and t_particle <= max_t:
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 m += 1
  */
         __pyx_t_16 = __pyx_v_k;
         __pyx_t_15 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_16 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_15 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":455
+        /* "cssm.pyx":449
  *             while y <= a[k] and y >= 0 and t_particle <= max_t:
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 m += 1
  *                 if m == num_draws:
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":456
+        /* "cssm.pyx":450
  *                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position
  *                 t_particle += delta_t
  *                 m += 1             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":457
+        /* "cssm.pyx":451
  *                 t_particle += delta_t
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_17 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_17) {
 
-          /* "cssm.pyx":458
+          /* "cssm.pyx":452
  *                 m += 1
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_8 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 458, __pyx_L1_error)
+          __pyx_t_8 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 452, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_8;
           __pyx_t_8.memview = NULL;
           __pyx_t_8.data = NULL;
 
-          /* "cssm.pyx":459
+          /* "cssm.pyx":453
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             # Note that for purposes of consistency with Navarro and Fuss,
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":457
+          /* "cssm.pyx":451
  *                 t_particle += delta_t
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":463
+      /* "cssm.pyx":457
  *             # Note that for purposes of consistency with Navarro and Fuss,
  *             # the choice corresponding the lower barrier is +1, higher barrier is -1
  *             rts_view[n, k, 0] = t_particle + t_view[k] # store rt             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = sign(y) # store choice
  * 
  */
       __pyx_t_15 = __pyx_v_k;
       __pyx_t_16 = __pyx_v_n;
       __pyx_t_19 = __pyx_v_k;
       __pyx_t_20 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_16 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_15 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":464
+      /* "cssm.pyx":458
  *             # the choice corresponding the lower barrier is +1, higher barrier is -1
  *             rts_view[n, k, 0] = t_particle + t_view[k] # store rt
  *             choices_view[n, k, 0] = sign(y) # store choice             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  */
       __pyx_t_15 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_19 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_15 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) = __pyx_f_4cssm_sign(__pyx_v_y);
     }
   }
 
-  /* "cssm.pyx":466
+  /* "cssm.pyx":460
  *             choices_view[n, k, 0] = sign(y) # store choice
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                          'a': a,
  *                                                          'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 466, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 460, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 460, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
 
-  /* "cssm.pyx":467
+  /* "cssm.pyx":461
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                          'a': a,             # <<<<<<<<<<<<<<
  *                                                          'z': z,
  *                                                          't': t,
  */
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
 
-  /* "cssm.pyx":468
+  /* "cssm.pyx":462
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                          'a': a,
  *                                                          'z': z,             # <<<<<<<<<<<<<<
  *                                                          't': t,
  *                                                          's': s,
  */
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
 
-  /* "cssm.pyx":469
+  /* "cssm.pyx":463
  *                                                          'a': a,
  *                                                          'z': z,
  *                                                          't': t,             # <<<<<<<<<<<<<<
  *                                                          's': s,
  *                                                          'delta_t': delta_t,
  */
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
 
-  /* "cssm.pyx":470
+  /* "cssm.pyx":464
  *                                                          'z': z,
  *                                                          't': t,
  *                                                          's': s,             # <<<<<<<<<<<<<<
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 464, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_s, __pyx_t_3) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_s, __pyx_t_3) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":471
+  /* "cssm.pyx":465
  *                                                          't': t,
  *                                                          's': s,
  *                                                          'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 471, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 465, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":472
+  /* "cssm.pyx":466
  *                                                          's': s,
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                          'n_samples': n_samples,
  *                                                          'simulator': 'ddm',
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 466, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":473
+  /* "cssm.pyx":467
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                          'simulator': 'ddm',
  *                                                          'boundary_fun_type': 'constant',
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 467, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_simulator, __pyx_n_u_ddm) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_simulator, __pyx_n_u_ddm) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
 
-  /* "cssm.pyx":476
+  /* "cssm.pyx":470
  *                                                          'simulator': 'ddm',
  *                                                          'boundary_fun_type': 'constant',
  *                                                          'possible_choices': [-1, 1]}}             # <<<<<<<<<<<<<<
  * 
- * # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------
+ * # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES,
  */
-  __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 476, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_2) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_2) < 0) __PYX_ERR(0, 460, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":410
+  /* "cssm.pyx":404
  * #@cython.wraparound(False)
  * 
  * def ddm_cov(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *             np.ndarray[float, ndim = 1] a, # boundary separation
  *             np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
 
@@ -8258,26 +8272,1754 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_t_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":481
+/* "cssm.pyx":478
+ * # @cythonwraparound(False)
+ * 
+ * def ddm_flexbound_deadline(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
+ *                            np.ndarray[float, ndim = 1] a,
+ *                            np.ndarray[float, ndim = 1] z,
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_4cssm_9ddm_flexbound_deadline(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_9ddm_flexbound_deadline = {"ddm_flexbound_deadline", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_9ddm_flexbound_deadline, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_9ddm_flexbound_deadline(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  PyArrayObject *__pyx_v_v = 0;
+  PyArrayObject *__pyx_v_a = 0;
+  PyArrayObject *__pyx_v_z = 0;
+  PyArrayObject *__pyx_v_t = 0;
+  PyArrayObject *__pyx_v_deadline = 0;
+  float __pyx_v_s;
+  float __pyx_v_delta_t;
+  float __pyx_v_max_t;
+  int __pyx_v_n_samples;
+  int __pyx_v_n_trials;
+  PyObject *__pyx_v_boundary_fun = 0;
+  PyObject *__pyx_v_boundary_multiplicative = 0;
+  PyObject *__pyx_v_boundary_params = 0;
+  PyObject *__pyx_v_random_state = 0;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("ddm_flexbound_deadline (wrapper)", 0);
+  {
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_deadline,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
+    PyObject* values[14] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0};
+
+    /* "cssm.pyx":488
+ *                            int n_samples = 20000,
+ *                            int n_trials = 1,
+ *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
+ *                            boundary_multiplicative = True,
+ *                            boundary_params = {},
+ */
+    values[10] = ((PyObject *)Py_None);
+
+    /* "cssm.pyx":489
+ *                            int n_trials = 1,
+ *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
+ *                            boundary_multiplicative = True,             # <<<<<<<<<<<<<<
+ *                            boundary_params = {},
+ *                            random_state = None,
+ */
+    values[11] = ((PyObject *)Py_True);
+    values[12] = __pyx_k__3;
+
+    /* "cssm.pyx":491
+ *                            boundary_multiplicative = True,
+ *                            boundary_params = {},
+ *                            random_state = None,             # <<<<<<<<<<<<<<
+ *                            ):
+ * 
+ */
+    values[13] = ((PyObject *)Py_None);
+    if (unlikely(__pyx_kwds)) {
+      Py_ssize_t kw_args;
+      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
+      switch (pos_args) {
+        case 14: values[13] = PyTuple_GET_ITEM(__pyx_args, 13);
+        CYTHON_FALLTHROUGH;
+        case 13: values[12] = PyTuple_GET_ITEM(__pyx_args, 12);
+        CYTHON_FALLTHROUGH;
+        case 12: values[11] = PyTuple_GET_ITEM(__pyx_args, 11);
+        CYTHON_FALLTHROUGH;
+        case 11: values[10] = PyTuple_GET_ITEM(__pyx_args, 10);
+        CYTHON_FALLTHROUGH;
+        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
+        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+        CYTHON_FALLTHROUGH;
+        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+        CYTHON_FALLTHROUGH;
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
+        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        CYTHON_FALLTHROUGH;
+        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = PyDict_Size(__pyx_kwds);
+      switch (pos_args) {
+        case  0:
+        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
+        else goto __pyx_L5_argtuple_error;
+        CYTHON_FALLTHROUGH;
+        case  1:
+        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_deadline", 0, 5, 14, 1); __PYX_ERR(0, 478, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_deadline", 0, 5, 14, 2); __PYX_ERR(0, 478, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  3:
+        if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_deadline", 0, 5, 14, 3); __PYX_ERR(0, 478, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  4:
+        if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_deadline)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_deadline", 0, 5, 14, 4); __PYX_ERR(0, 478, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  5:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
+          if (value) { values[5] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  6:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_delta_t);
+          if (value) { values[6] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  7:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_max_t);
+          if (value) { values[7] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  8:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_n_samples);
+          if (value) { values[8] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case  9:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_n_trials);
+          if (value) { values[9] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case 10:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_boundary_fun);
+          if (value) { values[10] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case 11:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_boundary_multiplicative);
+          if (value) { values[11] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case 12:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_boundary_params);
+          if (value) { values[12] = value; kw_args--; }
+        }
+        CYTHON_FALLTHROUGH;
+        case 13:
+        if (kw_args > 0) {
+          PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
+          if (value) { values[13] = value; kw_args--; }
+        }
+      }
+      if (unlikely(kw_args > 0)) {
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_deadline") < 0)) __PYX_ERR(0, 478, __pyx_L3_error)
+      }
+    } else {
+      switch (PyTuple_GET_SIZE(__pyx_args)) {
+        case 14: values[13] = PyTuple_GET_ITEM(__pyx_args, 13);
+        CYTHON_FALLTHROUGH;
+        case 13: values[12] = PyTuple_GET_ITEM(__pyx_args, 12);
+        CYTHON_FALLTHROUGH;
+        case 12: values[11] = PyTuple_GET_ITEM(__pyx_args, 11);
+        CYTHON_FALLTHROUGH;
+        case 11: values[10] = PyTuple_GET_ITEM(__pyx_args, 10);
+        CYTHON_FALLTHROUGH;
+        case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
+        CYTHON_FALLTHROUGH;
+        case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
+        CYTHON_FALLTHROUGH;
+        case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
+        CYTHON_FALLTHROUGH;
+        case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
+        CYTHON_FALLTHROUGH;
+        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
+        CYTHON_FALLTHROUGH;
+        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
+        values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
+        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
+        break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+    }
+    __pyx_v_v = ((PyArrayObject *)values[0]);
+    __pyx_v_a = ((PyArrayObject *)values[1]);
+    __pyx_v_z = ((PyArrayObject *)values[2]);
+    __pyx_v_t = ((PyArrayObject *)values[3]);
+    __pyx_v_deadline = ((PyArrayObject *)values[4]);
+    if (values[5]) {
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 483, __pyx_L3_error)
+    } else {
+      __pyx_v_s = ((float)1.0);
+    }
+    if (values[6]) {
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 484, __pyx_L3_error)
+    } else {
+      __pyx_v_delta_t = ((float)0.001);
+    }
+    if (values[7]) {
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 485, __pyx_L3_error)
+    } else {
+      __pyx_v_max_t = ((float)20.0);
+    }
+    if (values[8]) {
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 486, __pyx_L3_error)
+    } else {
+      __pyx_v_n_samples = ((int)0x4E20);
+    }
+    if (values[9]) {
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 487, __pyx_L3_error)
+    } else {
+      __pyx_v_n_trials = ((int)1);
+    }
+    __pyx_v_boundary_fun = values[10];
+    __pyx_v_boundary_multiplicative = values[11];
+    __pyx_v_boundary_params = values[12];
+    __pyx_v_random_state = values[13];
+  }
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_deadline", 0, 5, 14, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 478, __pyx_L3_error)
+  __pyx_L3_error:;
+  __Pyx_AddTraceback("cssm.ddm_flexbound_deadline", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 478, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 479, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 480, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 481, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) __PYX_ERR(0, 482, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_8ddm_flexbound_deadline(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+
+  /* "cssm.pyx":478
+ * # @cythonwraparound(False)
+ * 
+ * def ddm_flexbound_deadline(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
+ *                            np.ndarray[float, ndim = 1] a,
+ *                            np.ndarray[float, ndim = 1] z,
+ */
+
+  /* function exit code */
+  goto __pyx_L0;
+  __pyx_L1_error:;
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_4cssm_8ddm_flexbound_deadline(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
+  PyObject *__pyx_v_traj = NULL;
+  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
+  PyObject *__pyx_v_rts = NULL;
+  PyObject *__pyx_v_choices = NULL;
+  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
+  float __pyx_v_delta_t_sqrt;
+  float __pyx_v_sqrt_st;
+  int __pyx_v_num_draws;
+  PyObject *__pyx_v_t_s = NULL;
+  PyObject *__pyx_v_boundary = NULL;
+  float __pyx_v_y;
+  float __pyx_v_t_particle;
+  float __pyx_v_deadline_adj;
+  Py_ssize_t __pyx_v_n;
+  Py_ssize_t __pyx_v_ix;
+  Py_ssize_t __pyx_v_m;
+  Py_ssize_t __pyx_v_k;
+  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
+  PyObject *__pyx_v_boundary_params_tmp = NULL;
+  PyObject *__pyx_7genexpr__pyx_v_key = NULL;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
+  __Pyx_Buffer __pyx_pybuffer_a;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
+  __Pyx_Buffer __pyx_pybuffer_deadline;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
+  __Pyx_Buffer __pyx_pybuffer_t;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
+  __Pyx_Buffer __pyx_pybuffer_v;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
+  __Pyx_Buffer __pyx_pybuffer_z;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  __Pyx_memviewslice __pyx_t_2 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  __Pyx_memviewslice __pyx_t_6 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  PyObject *__pyx_t_7 = NULL;
+  __Pyx_memviewslice __pyx_t_8 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  __Pyx_memviewslice __pyx_t_9 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  PyObject *__pyx_t_10 = NULL;
+  int __pyx_t_11;
+  PyObject *__pyx_t_12 = NULL;
+  int __pyx_t_13;
+  Py_ssize_t __pyx_t_14;
+  Py_ssize_t __pyx_t_15;
+  Py_ssize_t __pyx_t_16;
+  int __pyx_t_17;
+  int __pyx_t_18;
+  int __pyx_t_19;
+  Py_ssize_t __pyx_t_20;
+  Py_ssize_t __pyx_t_21;
+  Py_ssize_t __pyx_t_22;
+  int __pyx_t_23;
+  Py_ssize_t __pyx_t_24;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("ddm_flexbound_deadline", 0);
+  __pyx_pybuffer_v.pybuffer.buf = NULL;
+  __pyx_pybuffer_v.refcount = 0;
+  __pyx_pybuffernd_v.data = NULL;
+  __pyx_pybuffernd_v.rcbuffer = &__pyx_pybuffer_v;
+  __pyx_pybuffer_a.pybuffer.buf = NULL;
+  __pyx_pybuffer_a.refcount = 0;
+  __pyx_pybuffernd_a.data = NULL;
+  __pyx_pybuffernd_a.rcbuffer = &__pyx_pybuffer_a;
+  __pyx_pybuffer_z.pybuffer.buf = NULL;
+  __pyx_pybuffer_z.refcount = 0;
+  __pyx_pybuffernd_z.data = NULL;
+  __pyx_pybuffernd_z.rcbuffer = &__pyx_pybuffer_z;
+  __pyx_pybuffer_t.pybuffer.buf = NULL;
+  __pyx_pybuffer_t.refcount = 0;
+  __pyx_pybuffernd_t.data = NULL;
+  __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
+  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
+  __pyx_pybuffer_deadline.refcount = 0;
+  __pyx_pybuffernd_deadline.data = NULL;
+  __pyx_pybuffernd_deadline.rcbuffer = &__pyx_pybuffer_deadline;
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 478, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 478, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 478, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 478, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_deadline.rcbuffer->pybuffer, (PyObject*)__pyx_v_deadline, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 478, __pyx_L1_error)
+  }
+  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer->pybuffer.shape[0];
+
+  /* "cssm.pyx":494
+ *                            ):
+ * 
+ *     set_seed(random_state)             # <<<<<<<<<<<<<<
+ *     #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
+ *     # Param views:
+ */
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "cssm.pyx":497
+ *     #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
+ *     # Param views:
+ *     cdef float[:] v_view  = v             # <<<<<<<<<<<<<<
+ *     cdef float[:] a_view = a
+ *     cdef float[:] z_view = z
+ */
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 497, __pyx_L1_error)
+  __pyx_v_v_view = __pyx_t_2;
+  __pyx_t_2.memview = NULL;
+  __pyx_t_2.data = NULL;
+
+  /* "cssm.pyx":498
+ *     # Param views:
+ *     cdef float[:] v_view  = v
+ *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
+ *     cdef float[:] z_view = z
+ *     cdef float[:] t_view = t
+ */
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 498, __pyx_L1_error)
+  __pyx_v_a_view = __pyx_t_2;
+  __pyx_t_2.memview = NULL;
+  __pyx_t_2.data = NULL;
+
+  /* "cssm.pyx":499
+ *     cdef float[:] v_view  = v
+ *     cdef float[:] a_view = a
+ *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
+ *     cdef float[:] t_view = t
+ *     cdef float[:] deadline_view = deadline
+ */
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __pyx_v_z_view = __pyx_t_2;
+  __pyx_t_2.memview = NULL;
+  __pyx_t_2.data = NULL;
+
+  /* "cssm.pyx":500
+ *     cdef float[:] a_view = a
+ *     cdef float[:] z_view = z
+ *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
+ *     cdef float[:] deadline_view = deadline
+ * 
+ */
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __pyx_v_t_view = __pyx_t_2;
+  __pyx_t_2.memview = NULL;
+  __pyx_t_2.data = NULL;
+
+  /* "cssm.pyx":501
+ *     cdef float[:] z_view = z
+ *     cdef float[:] t_view = t
+ *     cdef float[:] deadline_view = deadline             # <<<<<<<<<<<<<<
+ * 
+ *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
+ */
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 501, __pyx_L1_error)
+  __pyx_v_deadline_view = __pyx_t_2;
+  __pyx_t_2.memview = NULL;
+  __pyx_t_2.data = NULL;
+
+  /* "cssm.pyx":503
+ *     cdef float[:] deadline_view = deadline
+ * 
+ *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
+ *     traj[:, :] = -999
+ *     cdef float[:,:] traj_view = traj
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
+  __Pyx_INCREF(__pyx_int_1);
+  __Pyx_GIVEREF(__pyx_int_1);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 503, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_traj = __pyx_t_5;
+  __pyx_t_5 = 0;
+
+  /* "cssm.pyx":504
+ * 
+ *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
+ *     traj[:, :] = -999             # <<<<<<<<<<<<<<
+ *     cdef float[:,:] traj_view = traj
+ * 
+ */
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 504, __pyx_L1_error)
+
+  /* "cssm.pyx":505
+ *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
+ *     traj[:, :] = -999
+ *     cdef float[:,:] traj_view = traj             # <<<<<<<<<<<<<<
+ * 
+ *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
+ */
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 505, __pyx_L1_error)
+  __pyx_v_traj_view = __pyx_t_6;
+  __pyx_t_6.memview = NULL;
+  __pyx_t_6.data = NULL;
+
+  /* "cssm.pyx":507
+ *     cdef float[:,:] traj_view = traj
+ * 
+ *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
+ *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
+ * 
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
+  __Pyx_INCREF(__pyx_int_1);
+  __Pyx_GIVEREF(__pyx_int_1);
+  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
+  __pyx_t_5 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 507, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_rts = __pyx_t_5;
+  __pyx_t_5 = 0;
+
+  /* "cssm.pyx":508
+ * 
+ *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
+ *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
+ * 
+ *     cdef float[:, :, :] rts_view = rts
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
+  __Pyx_INCREF(__pyx_int_1);
+  __Pyx_GIVEREF(__pyx_int_1);
+  PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
+  __pyx_t_5 = 0;
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_choices = __pyx_t_7;
+  __pyx_t_7 = 0;
+
+  /* "cssm.pyx":510
+ *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
+ * 
+ *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
+ *     cdef int[:, :, :] choices_view = choices
+ * 
+ */
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 510, __pyx_L1_error)
+  __pyx_v_rts_view = __pyx_t_8;
+  __pyx_t_8.memview = NULL;
+  __pyx_t_8.data = NULL;
+
+  /* "cssm.pyx":511
+ * 
+ *     cdef float[:, :, :] rts_view = rts
+ *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
+ * 
+ *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
+ */
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 511, __pyx_L1_error)
+  __pyx_v_choices_view = __pyx_t_9;
+  __pyx_t_9.memview = NULL;
+  __pyx_t_9.data = NULL;
+
+  /* "cssm.pyx":513
+ *     cdef int[:, :, :] choices_view = choices
+ * 
+ *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
+ *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
+ * 
+ */
+  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
+
+  /* "cssm.pyx":514
+ * 
+ *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
+ *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
+ * 
+ *     # Boundary storage for the upper bound
+ */
+  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
+
+  /* "cssm.pyx":517
+ * 
+ *     # Boundary storage for the upper bound
+ *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
+ *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
+ *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
+ */
+  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
+
+  /* "cssm.pyx":518
+ *     # Boundary storage for the upper bound
+ *     cdef int num_draws = int((max_t / delta_t) + 1)
+ *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
+ *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
+ * 
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 518, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 518, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 518, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 518, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_10 = NULL;
+  __pyx_t_11 = 0;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_10)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_10);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
+      __pyx_t_11 = 1;
+    }
+  }
+  #if CYTHON_FAST_PYCALL
+  if (PyFunction_Check(__pyx_t_3)) {
+    PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  } else
+  #endif
+  #if CYTHON_FAST_PYCCALL
+  if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+    PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
+    __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  } else
+  #endif
+  {
+    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 518, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_12);
+    if (__pyx_t_10) {
+      __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
+    }
+    __Pyx_INCREF(__pyx_int_0);
+    __Pyx_GIVEREF(__pyx_int_0);
+    PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_int_0);
+    __Pyx_GIVEREF(__pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_5);
+    PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
+    __pyx_t_4 = 0;
+    __pyx_t_5 = 0;
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+  }
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 518, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_12 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_12)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_12);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
+    }
+  }
+  __pyx_t_7 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 518, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_t_s = __pyx_t_7;
+  __pyx_t_7 = 0;
+
+  /* "cssm.pyx":519
+ *     cdef int num_draws = int((max_t / delta_t) + 1)
+ *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
+ *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
+ * 
+ *     cdef float y, t_particle, deadline_adj
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_7);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
+  __pyx_t_7 = 0;
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_12);
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 519, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_12);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_v_boundary = __pyx_t_12;
+  __pyx_t_12 = 0;
+
+  /* "cssm.pyx":524
+ *     cdef Py_ssize_t n
+ *     cdef Py_ssize_t ix
+ *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
+ *     cdef Py_ssize_t k
+ *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
+ */
+  __pyx_v_m = 0;
+
+  /* "cssm.pyx":526
+ *     cdef Py_ssize_t m = 0
+ *     cdef Py_ssize_t k
+ *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
+ *     cdef float[:] boundary_view = boundary
+ * 
+ */
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 526, __pyx_L1_error)
+  __pyx_v_gaussian_values = __pyx_t_2;
+  __pyx_t_2.memview = NULL;
+  __pyx_t_2.data = NULL;
+
+  /* "cssm.pyx":527
+ *     cdef Py_ssize_t k
+ *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
+ *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
+ * 
+ *     # Loop over samples
+ */
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 527, __pyx_L1_error)
+  __pyx_v_boundary_view = __pyx_t_2;
+  __pyx_t_2.memview = NULL;
+  __pyx_t_2.data = NULL;
+
+  /* "cssm.pyx":530
+ * 
+ *     # Loop over samples
+ *     for k in range(n_trials):             # <<<<<<<<<<<<<<
+ *         # Precompute boundary evaluations
+ *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
+ */
+  __pyx_t_11 = __pyx_v_n_trials;
+  __pyx_t_13 = __pyx_t_11;
+  for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
+    __pyx_v_k = __pyx_t_14;
+
+    /* "cssm.pyx":532
+ *     for k in range(n_trials):
+ *         # Precompute boundary evaluations
+ *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
+ * 
+ *         if boundary_multiplicative:
+ */
+    { /* enter inner scope */
+      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 532, __pyx_L7_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __pyx_t_15 = 0;
+      if (unlikely(__pyx_v_boundary_params == Py_None)) {
+        PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
+        __PYX_ERR(0, 532, __pyx_L7_error)
+      }
+      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 532, __pyx_L7_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_XDECREF(__pyx_t_7);
+      __pyx_t_7 = __pyx_t_1;
+      __pyx_t_1 = 0;
+      while (1) {
+        __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_16, &__pyx_t_15, &__pyx_t_1, NULL, NULL, __pyx_t_17);
+        if (unlikely(__pyx_t_18 == 0)) break;
+        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 532, __pyx_L7_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_XDECREF_SET(__pyx_7genexpr__pyx_v_key, __pyx_t_1);
+        __pyx_t_1 = 0;
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_7genexpr__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 532, __pyx_L7_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 532, __pyx_L7_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_7genexpr__pyx_v_key, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 532, __pyx_L7_error)
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_XDECREF(__pyx_7genexpr__pyx_v_key); __pyx_7genexpr__pyx_v_key = 0;
+      goto __pyx_L10_exit_scope;
+      __pyx_L7_error:;
+      __Pyx_XDECREF(__pyx_7genexpr__pyx_v_key); __pyx_7genexpr__pyx_v_key = 0;
+      goto __pyx_L1_error;
+      __pyx_L10_exit_scope:;
+    } /* exit inner scope */
+    __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_12));
+    __pyx_t_12 = 0;
+
+    /* "cssm.pyx":534
+ *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
+ * 
+ *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
+ *             # print('passed')
+ *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
+ */
+    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 534, __pyx_L1_error)
+    if (__pyx_t_19) {
+
+      /* "cssm.pyx":536
+ *         if boundary_multiplicative:
+ *             # print('passed')
+ *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
+ *         else:
+ *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
+ */
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 536, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_20 = __pyx_v_k;
+      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 536, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 536, __pyx_L1_error)
+      __pyx_t_5 = __pyx_t_4;
+      __pyx_t_4 = 0;
+      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 536, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_t_5 = NULL;
+      __pyx_t_17 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
+        if (likely(__pyx_t_5)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+          __Pyx_INCREF(__pyx_t_5);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_1, function);
+          __pyx_t_17 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_1)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
+        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 536, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_GOTREF(__pyx_t_7);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
+        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 536, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+        __Pyx_GOTREF(__pyx_t_7);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 536, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_10);
+        if (__pyx_t_5) {
+          __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5); __pyx_t_5 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_17, __pyx_t_3);
+        __Pyx_GIVEREF(__pyx_t_4);
+        PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_17, __pyx_t_4);
+        __pyx_t_3 = 0;
+        __pyx_t_4 = 0;
+        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 536, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
+        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 536, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_10 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
+        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
+        if (likely(__pyx_t_10)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+          __Pyx_INCREF(__pyx_t_10);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_1, function);
+        }
+      }
+      __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7);
+      __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 536, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 536, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+
+      /* "cssm.pyx":534
+ *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
+ * 
+ *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
+ *             # print('passed')
+ *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
+ */
+      goto __pyx_L11;
+    }
+
+    /* "cssm.pyx":538
+ *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
+ *         else:
+ *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
+ * 
+ *         # subtract current non-decision-time from current deadline
+ */
+    /*else*/ {
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __pyx_t_20 = __pyx_v_k;
+      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 538, __pyx_L1_error)
+      __pyx_t_4 = __pyx_t_3;
+      __pyx_t_3 = 0;
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 538, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = NULL;
+      __pyx_t_17 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
+        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_10);
+        if (likely(__pyx_t_4)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
+          __Pyx_INCREF(__pyx_t_4);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_10, function);
+          __pyx_t_17 = 1;
+        }
+      }
+      #if CYTHON_FAST_PYCALL
+      if (PyFunction_Check(__pyx_t_10)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_3};
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      } else
+      #endif
+      #if CYTHON_FAST_PYCCALL
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_3};
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      } else
+      #endif
+      {
+        __pyx_t_5 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 538, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_5);
+        if (__pyx_t_4) {
+          __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
+        }
+        __Pyx_GIVEREF(__pyx_t_7);
+        PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_17, __pyx_t_7);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_17, __pyx_t_3);
+        __pyx_t_7 = 0;
+        __pyx_t_3 = 0;
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      }
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_5 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
+        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
+        if (likely(__pyx_t_5)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
+          __Pyx_INCREF(__pyx_t_5);
+          __Pyx_INCREF(function);
+          __Pyx_DECREF_SET(__pyx_t_10, function);
+        }
+      }
+      __pyx_t_12 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1);
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 538, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_12);
+      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 538, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
+    }
+    __pyx_L11:;
+
+    /* "cssm.pyx":541
+ * 
+ *         # subtract current non-decision-time from current deadline
+ *         deadline_adj = deadline_view[k] - t_view[k]             # <<<<<<<<<<<<<<
+ *         for n in range(n_samples):
+ *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
+ */
+    __pyx_t_20 = __pyx_v_k;
+    __pyx_t_21 = __pyx_v_k;
+    __pyx_v_deadline_adj = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_20 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) ))));
+
+    /* "cssm.pyx":542
+ *         # subtract current non-decision-time from current deadline
+ *         deadline_adj = deadline_view[k] - t_view[k]
+ *         for n in range(n_samples):             # <<<<<<<<<<<<<<
+ *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
+ *             t_particle = 0.0 # reset time
+ */
+    __pyx_t_17 = __pyx_v_n_samples;
+    __pyx_t_18 = __pyx_t_17;
+    for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_18; __pyx_t_16+=1) {
+      __pyx_v_n = __pyx_t_16;
+
+      /* "cssm.pyx":543
+ *         deadline_adj = deadline_view[k] - t_view[k]
+ *         for n in range(n_samples):
+ *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position             # <<<<<<<<<<<<<<
+ *             t_particle = 0.0 # reset time
+ *             ix = 0 # reset boundary index
+ */
+      __pyx_t_21 = 0;
+      __pyx_t_20 = __pyx_v_k;
+      __pyx_t_22 = 0;
+      __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_20 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_22 * __pyx_v_boundary_view.strides[0]) )))));
+
+      /* "cssm.pyx":544
+ *         for n in range(n_samples):
+ *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
+ *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
+ *             ix = 0 # reset boundary index
+ * 
+ */
+      __pyx_v_t_particle = 0.0;
+
+      /* "cssm.pyx":545
+ *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
+ *             t_particle = 0.0 # reset time
+ *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
+ * 
+ *             # Can improve with less checks
+ */
+      __pyx_v_ix = 0;
+
+      /* "cssm.pyx":548
+ * 
+ *             # Can improve with less checks
+ *             if n == 0:             # <<<<<<<<<<<<<<
+ *                 if k == 0:
+ *                     traj_view[0, 0] = y
+ */
+      __pyx_t_19 = ((__pyx_v_n == 0) != 0);
+      if (__pyx_t_19) {
+
+        /* "cssm.pyx":549
+ *             # Can improve with less checks
+ *             if n == 0:
+ *                 if k == 0:             # <<<<<<<<<<<<<<
+ *                     traj_view[0, 0] = y
+ * 
+ */
+        __pyx_t_19 = ((__pyx_v_k == 0) != 0);
+        if (__pyx_t_19) {
+
+          /* "cssm.pyx":550
+ *             if n == 0:
+ *                 if k == 0:
+ *                     traj_view[0, 0] = y             # <<<<<<<<<<<<<<
+ * 
+ *             # Random walker
+ */
+          __pyx_t_22 = 0;
+          __pyx_t_20 = 0;
+          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
+
+          /* "cssm.pyx":549
+ *             # Can improve with less checks
+ *             if n == 0:
+ *                 if k == 0:             # <<<<<<<<<<<<<<
+ *                     traj_view[0, 0] = y
+ * 
+ */
+        }
+
+        /* "cssm.pyx":548
+ * 
+ *             # Can improve with less checks
+ *             if n == 0:             # <<<<<<<<<<<<<<
+ *                 if k == 0:
+ *                     traj_view[0, 0] = y
+ */
+      }
+
+      /* "cssm.pyx":553
+ * 
+ *             # Random walker
+ *             while (y >= (-1) * boundary_view[ix]) and (y <= boundary_view[ix]) and (t_particle <= max_t) and (t_particle <= deadline_adj):             # <<<<<<<<<<<<<<
+ *                 y += (v_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
+ *                 t_particle += delta_t
+ */
+      while (1) {
+        __pyx_t_20 = __pyx_v_ix;
+        __pyx_t_23 = ((__pyx_v_y >= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))))) != 0);
+        if (__pyx_t_23) {
+        } else {
+          __pyx_t_19 = __pyx_t_23;
+          goto __pyx_L18_bool_binop_done;
+        }
+        __pyx_t_20 = __pyx_v_ix;
+        __pyx_t_23 = ((__pyx_v_y <= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) != 0);
+        if (__pyx_t_23) {
+        } else {
+          __pyx_t_19 = __pyx_t_23;
+          goto __pyx_L18_bool_binop_done;
+        }
+        __pyx_t_23 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
+        if (__pyx_t_23) {
+        } else {
+          __pyx_t_19 = __pyx_t_23;
+          goto __pyx_L18_bool_binop_done;
+        }
+        __pyx_t_23 = ((__pyx_v_t_particle <= __pyx_v_deadline_adj) != 0);
+        __pyx_t_19 = __pyx_t_23;
+        __pyx_L18_bool_binop_done:;
+        if (!__pyx_t_19) break;
+
+        /* "cssm.pyx":554
+ *             # Random walker
+ *             while (y >= (-1) * boundary_view[ix]) and (y <= boundary_view[ix]) and (t_particle <= max_t) and (t_particle <= deadline_adj):
+ *                 y += (v_view[k] * delta_t) + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
+ *                 t_particle += delta_t
+ *                 ix += 1
+ */
+        __pyx_t_20 = __pyx_v_k;
+        __pyx_t_22 = __pyx_v_m;
+        __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_20 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_22 * __pyx_v_gaussian_values.strides[0]) ))))));
+
+        /* "cssm.pyx":555
+ *             while (y >= (-1) * boundary_view[ix]) and (y <= boundary_view[ix]) and (t_particle <= max_t) and (t_particle <= deadline_adj):
+ *                 y += (v_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
+ *                 t_particle += delta_t             # <<<<<<<<<<<<<<
+ *                 ix += 1
+ *                 m += 1
+ */
+        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
+
+        /* "cssm.pyx":556
+ *                 y += (v_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
+ *                 t_particle += delta_t
+ *                 ix += 1             # <<<<<<<<<<<<<<
+ *                 m += 1
+ * 
+ */
+        __pyx_v_ix = (__pyx_v_ix + 1);
+
+        /* "cssm.pyx":557
+ *                 t_particle += delta_t
+ *                 ix += 1
+ *                 m += 1             # <<<<<<<<<<<<<<
+ * 
+ *                 if n == 0:
+ */
+        __pyx_v_m = (__pyx_v_m + 1);
+
+        /* "cssm.pyx":559
+ *                 m += 1
+ * 
+ *                 if n == 0:             # <<<<<<<<<<<<<<
+ *                     if k == 0:
+ *                         traj_view[ix, 0] = y
+ */
+        __pyx_t_19 = ((__pyx_v_n == 0) != 0);
+        if (__pyx_t_19) {
+
+          /* "cssm.pyx":560
+ * 
+ *                 if n == 0:
+ *                     if k == 0:             # <<<<<<<<<<<<<<
+ *                         traj_view[ix, 0] = y
+ * 
+ */
+          __pyx_t_19 = ((__pyx_v_k == 0) != 0);
+          if (__pyx_t_19) {
+
+            /* "cssm.pyx":561
+ *                 if n == 0:
+ *                     if k == 0:
+ *                         traj_view[ix, 0] = y             # <<<<<<<<<<<<<<
+ * 
+ *                 # Can improve with less checks
+ */
+            __pyx_t_22 = __pyx_v_ix;
+            __pyx_t_20 = 0;
+            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
+
+            /* "cssm.pyx":560
+ * 
+ *                 if n == 0:
+ *                     if k == 0:             # <<<<<<<<<<<<<<
+ *                         traj_view[ix, 0] = y
+ * 
+ */
+          }
+
+          /* "cssm.pyx":559
+ *                 m += 1
+ * 
+ *                 if n == 0:             # <<<<<<<<<<<<<<
+ *                     if k == 0:
+ *                         traj_view[ix, 0] = y
+ */
+        }
+
+        /* "cssm.pyx":564
+ * 
+ *                 # Can improve with less checks
+ *                 if m == num_draws:             # <<<<<<<<<<<<<<
+ *                     gaussian_values = draw_gaussian(num_draws)
+ *                     m = 0
+ */
+        __pyx_t_19 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
+        if (__pyx_t_19) {
+
+          /* "cssm.pyx":565
+ *                 # Can improve with less checks
+ *                 if m == num_draws:
+ *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
+ *                     m = 0
+ * 
+ */
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 565, __pyx_L1_error)
+          __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
+          __pyx_v_gaussian_values = __pyx_t_2;
+          __pyx_t_2.memview = NULL;
+          __pyx_t_2.data = NULL;
+
+          /* "cssm.pyx":566
+ *                 if m == num_draws:
+ *                     gaussian_values = draw_gaussian(num_draws)
+ *                     m = 0             # <<<<<<<<<<<<<<
+ * 
+ *             if t_particle > deadline_adj:
+ */
+          __pyx_v_m = 0;
+
+          /* "cssm.pyx":564
+ * 
+ *                 # Can improve with less checks
+ *                 if m == num_draws:             # <<<<<<<<<<<<<<
+ *                     gaussian_values = draw_gaussian(num_draws)
+ *                     m = 0
+ */
+        }
+      }
+
+      /* "cssm.pyx":568
+ *                     m = 0
+ * 
+ *             if t_particle > deadline_adj:             # <<<<<<<<<<<<<<
+ *                 rts_view[n, k, 0] = -999
+ *                 choices_view[n, k, 0] = -1
+ */
+      __pyx_t_19 = ((__pyx_v_t_particle > __pyx_v_deadline_adj) != 0);
+      if (__pyx_t_19) {
+
+        /* "cssm.pyx":569
+ * 
+ *             if t_particle > deadline_adj:
+ *                 rts_view[n, k, 0] = -999             # <<<<<<<<<<<<<<
+ *                 choices_view[n, k, 0] = -1
+ *             elif t_particle == deadline_adj:
+ */
+        __pyx_t_20 = __pyx_v_n;
+        __pyx_t_22 = __pyx_v_k;
+        __pyx_t_21 = 0;
+        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_22 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[2]) )) = -999.0;
+
+        /* "cssm.pyx":570
+ *             if t_particle > deadline_adj:
+ *                 rts_view[n, k, 0] = -999
+ *                 choices_view[n, k, 0] = -1             # <<<<<<<<<<<<<<
+ *             elif t_particle == deadline_adj:
+ *                 rts_view[n, k, 0] = t_particle + t_view[k] - ((delta_t / 2) * random_uniform()) # Store rt
+ */
+        __pyx_t_21 = __pyx_v_n;
+        __pyx_t_22 = __pyx_v_k;
+        __pyx_t_20 = 0;
+        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_22 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = -1;
+
+        /* "cssm.pyx":568
+ *                     m = 0
+ * 
+ *             if t_particle > deadline_adj:             # <<<<<<<<<<<<<<
+ *                 rts_view[n, k, 0] = -999
+ *                 choices_view[n, k, 0] = -1
+ */
+        goto __pyx_L25;
+      }
+
+      /* "cssm.pyx":571
+ *                 rts_view[n, k, 0] = -999
+ *                 choices_view[n, k, 0] = -1
+ *             elif t_particle == deadline_adj:             # <<<<<<<<<<<<<<
+ *                 rts_view[n, k, 0] = t_particle + t_view[k] - ((delta_t / 2) * random_uniform()) # Store rt
+ *                 choices_view[n, k, 0] = sign(y) # Store choice
+ */
+      __pyx_t_19 = ((__pyx_v_t_particle == __pyx_v_deadline_adj) != 0);
+      if (__pyx_t_19) {
+
+        /* "cssm.pyx":572
+ *                 choices_view[n, k, 0] = -1
+ *             elif t_particle == deadline_adj:
+ *                 rts_view[n, k, 0] = t_particle + t_view[k] - ((delta_t / 2) * random_uniform()) # Store rt             # <<<<<<<<<<<<<<
+ *                 choices_view[n, k, 0] = sign(y) # Store choice
+ *             else:
+ */
+        __pyx_t_20 = __pyx_v_k;
+        __pyx_t_22 = __pyx_v_n;
+        __pyx_t_21 = __pyx_v_k;
+        __pyx_t_24 = 0;
+        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_22 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) )))) - ((__pyx_v_delta_t / 2.0) * __pyx_f_4cssm_random_uniform()));
+
+        /* "cssm.pyx":573
+ *             elif t_particle == deadline_adj:
+ *                 rts_view[n, k, 0] = t_particle + t_view[k] - ((delta_t / 2) * random_uniform()) # Store rt
+ *                 choices_view[n, k, 0] = sign(y) # Store choice             # <<<<<<<<<<<<<<
+ *             else:
+ *                 rts_view[n, k, 0] = t_particle + t_view[k] + ((delta_t * random_uniform()) - (delta_t / 2)) # Store rt
+ */
+        __pyx_t_20 = __pyx_v_n;
+        __pyx_t_24 = __pyx_v_k;
+        __pyx_t_21 = 0;
+        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) = __pyx_f_4cssm_sign(__pyx_v_y);
+
+        /* "cssm.pyx":571
+ *                 rts_view[n, k, 0] = -999
+ *                 choices_view[n, k, 0] = -1
+ *             elif t_particle == deadline_adj:             # <<<<<<<<<<<<<<
+ *                 rts_view[n, k, 0] = t_particle + t_view[k] - ((delta_t / 2) * random_uniform()) # Store rt
+ *                 choices_view[n, k, 0] = sign(y) # Store choice
+ */
+        goto __pyx_L25;
+      }
+
+      /* "cssm.pyx":575
+ *                 choices_view[n, k, 0] = sign(y) # Store choice
+ *             else:
+ *                 rts_view[n, k, 0] = t_particle + t_view[k] + ((delta_t * random_uniform()) - (delta_t / 2)) # Store rt             # <<<<<<<<<<<<<<
+ *                 choices_view[n, k, 0] = sign(y) # Store choice
+ * 
+ */
+      /*else*/ {
+        __pyx_t_21 = __pyx_v_k;
+        __pyx_t_24 = __pyx_v_n;
+        __pyx_t_20 = __pyx_v_k;
+        __pyx_t_22 = 0;
+        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_24 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_22 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) )))) + ((__pyx_v_delta_t * __pyx_f_4cssm_random_uniform()) - (__pyx_v_delta_t / 2.0)));
+
+        /* "cssm.pyx":576
+ *             else:
+ *                 rts_view[n, k, 0] = t_particle + t_view[k] + ((delta_t * random_uniform()) - (delta_t / 2)) # Store rt
+ *                 choices_view[n, k, 0] = sign(y) # Store choice             # <<<<<<<<<<<<<<
+ * 
+ *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
+ */
+        __pyx_t_21 = __pyx_v_n;
+        __pyx_t_22 = __pyx_v_k;
+        __pyx_t_20 = 0;
+        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_22 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = __pyx_f_4cssm_sign(__pyx_v_y);
+      }
+      __pyx_L25:;
+    }
+  }
+
+  /* "cssm.pyx":578
+ *                 choices_view[n, k, 0] = sign(y) # Store choice
+ * 
+ *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,             # <<<<<<<<<<<<<<
+ *                                                           'a': a,
+ *                                                           'z': z,
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_12);
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 578, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 578, __pyx_L1_error)
+
+  /* "cssm.pyx":579
+ * 
+ *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
+ *                                                           'a': a,             # <<<<<<<<<<<<<<
+ *                                                           'z': z,
+ *                                                           't': t,
+ */
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 578, __pyx_L1_error)
+
+  /* "cssm.pyx":580
+ *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
+ *                                                           'a': a,
+ *                                                           'z': z,             # <<<<<<<<<<<<<<
+ *                                                           't': t,
+ *                                                           'deadline': deadline,
+ */
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 578, __pyx_L1_error)
+
+  /* "cssm.pyx":581
+ *                                                           'a': a,
+ *                                                           'z': z,
+ *                                                           't': t,             # <<<<<<<<<<<<<<
+ *                                                           'deadline': deadline,
+ *                                                           's': s,
+ */
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 578, __pyx_L1_error)
+
+  /* "cssm.pyx":582
+ *                                                           'z': z,
+ *                                                           't': t,
+ *                                                           'deadline': deadline,             # <<<<<<<<<<<<<<
+ *                                                           's': s,
+ *                                                           **boundary_params,
+ */
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) < 0) __PYX_ERR(0, 578, __pyx_L1_error)
+
+  /* "cssm.pyx":583
+ *                                                           't': t,
+ *                                                           'deadline': deadline,
+ *                                                           's': s,             # <<<<<<<<<<<<<<
+ *                                                           **boundary_params,
+ *                                                           'delta_t': delta_t,
+ */
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 583, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_s, __pyx_t_5) < 0) __PYX_ERR(0, 578, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_10 = __pyx_t_1;
+  __pyx_t_1 = 0;
+
+  /* "cssm.pyx":584
+ *                                                           'deadline': deadline,
+ *                                                           's': s,
+ *                                                           **boundary_params,             # <<<<<<<<<<<<<<
+ *                                                           'delta_t': delta_t,
+ *                                                           'max_t': max_t,
+ */
+  if (unlikely(__pyx_v_boundary_params == Py_None)) {
+    PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
+    __PYX_ERR(0, 584, __pyx_L1_error)
+  }
+  if (unlikely(PyDict_Update(__pyx_t_10, __pyx_v_boundary_params) < 0)) {
+    if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
+    __PYX_ERR(0, 584, __pyx_L1_error)
+  }
+
+  /* "cssm.pyx":585
+ *                                                           's': s,
+ *                                                           **boundary_params,
+ *                                                           'delta_t': delta_t,             # <<<<<<<<<<<<<<
+ *                                                           'max_t': max_t,
+ *                                                           'n_samples': n_samples,
+ */
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 585, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "cssm.pyx":586
+ *                                                           **boundary_params,
+ *                                                           'delta_t': delta_t,
+ *                                                           'max_t': max_t,             # <<<<<<<<<<<<<<
+ *                                                           'n_samples': n_samples,
+ *                                                           'simulator': 'ddm_flexbound_deadline',
+ */
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 586, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "cssm.pyx":587
+ *                                                           'delta_t': delta_t,
+ *                                                           'max_t': max_t,
+ *                                                           'n_samples': n_samples,             # <<<<<<<<<<<<<<
+ *                                                           'simulator': 'ddm_flexbound_deadline',
+ *                                                           'boundary_fun_type': boundary_fun.__name__,
+ */
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 587, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 587, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_deadline) < 0) __PYX_ERR(0, 588, __pyx_L1_error)
+
+  /* "cssm.pyx":589
+ *                                                           'n_samples': n_samples,
+ *                                                           'simulator': 'ddm_flexbound_deadline',
+ *                                                           'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
+ *                                                           'possible_choices': [-1, 1],
+ *                                                           'trajectory': traj,
+ */
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 589, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) < 0) __PYX_ERR(0, 589, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "cssm.pyx":590
+ *                                                           'simulator': 'ddm_flexbound_deadline',
+ *                                                           'boundary_fun_type': boundary_fun.__name__,
+ *                                                           'possible_choices': [-1, 1],             # <<<<<<<<<<<<<<
+ *                                                           'trajectory': traj,
+ *                                                           'boundary': boundary,
+ */
+  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 590, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_INCREF(__pyx_int_neg_1);
+  __Pyx_GIVEREF(__pyx_int_neg_1);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_neg_1);
+  __Pyx_INCREF(__pyx_int_1);
+  __Pyx_GIVEREF(__pyx_int_1);
+  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) < 0) __PYX_ERR(0, 590, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "cssm.pyx":591
+ *                                                           'boundary_fun_type': boundary_fun.__name__,
+ *                                                           'possible_choices': [-1, 1],
+ *                                                           'trajectory': traj,             # <<<<<<<<<<<<<<
+ *                                                           'boundary': boundary,
+ *                                                           }}
+ */
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 591, __pyx_L1_error)
+
+  /* "cssm.pyx":592
+ *                                                           'possible_choices': [-1, 1],
+ *                                                           'trajectory': traj,
+ *                                                           'boundary': boundary,             # <<<<<<<<<<<<<<
+ *                                                           }}
+ * # ----------------------------------------------------------------------------------------------------
+ */
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 592, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_10) < 0) __PYX_ERR(0, 578, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
+  __pyx_r = __pyx_t_12;
+  __pyx_t_12 = 0;
+  goto __pyx_L0;
+
+  /* "cssm.pyx":478
+ * # @cythonwraparound(False)
+ * 
+ * def ddm_flexbound_deadline(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
+ *                            np.ndarray[float, ndim = 1] a,
+ *                            np.ndarray[float, ndim = 1] z,
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_2, 1);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
+  __Pyx_XDECREF(__pyx_t_7);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_8, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
+  __Pyx_XDECREF(__pyx_t_10);
+  __Pyx_XDECREF(__pyx_t_12);
+  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
+    __Pyx_PyThreadState_declare
+    __Pyx_PyThreadState_assign
+    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_a.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_deadline.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_t.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_v.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_z.rcbuffer->pybuffer);
+  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
+  __Pyx_AddTraceback("cssm.ddm_flexbound_deadline", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  goto __pyx_L2;
+  __pyx_L0:;
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_a.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_deadline.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_t.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_v.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_z.rcbuffer->pybuffer);
+  __pyx_L2:;
+  __PYX_XDEC_MEMVIEW(&__pyx_v_v_view, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_a_view, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_z_view, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_t_view, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_deadline_view, 1);
+  __Pyx_XDECREF(__pyx_v_traj);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_traj_view, 1);
+  __Pyx_XDECREF(__pyx_v_rts);
+  __Pyx_XDECREF(__pyx_v_choices);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_rts_view, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
+  __Pyx_XDECREF(__pyx_v_t_s);
+  __Pyx_XDECREF(__pyx_v_boundary);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
+  __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
+  __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
+  __Pyx_XDECREF(__pyx_7genexpr__pyx_v_key);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "cssm.pyx":601
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                   np.ndarray[float, ndim = 1] a,
  *                   np.ndarray[float, ndim = 1] z,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_9ddm_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_9ddm_flexbound = {"ddm_flexbound", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_9ddm_flexbound, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_9ddm_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_11ddm_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_11ddm_flexbound = {"ddm_flexbound", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_11ddm_flexbound, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_11ddm_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z = 0;
   PyArrayObject *__pyx_v_t = 0;
   float __pyx_v_s;
   float __pyx_v_delta_t;
   float __pyx_v_max_t;
@@ -8293,34 +10035,34 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ddm_flexbound (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[13] = {0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":490
+    /* "cssm.pyx":610
  *                   int n_samples = 20000,
  *                   int n_trials = 1,
  *                   boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *                   boundary_multiplicative = True,
  *                   boundary_params = {},
  */
     values[9] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":491
+    /* "cssm.pyx":611
  *                   int n_trials = 1,
  *                   boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                   boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *                   boundary_params = {},
  *                   random_state = None,
  */
     values[10] = ((PyObject *)Py_True);
-    values[11] = __pyx_k__3;
+    values[11] = __pyx_k__4;
 
-    /* "cssm.pyx":493
+    /* "cssm.pyx":613
  *                   boundary_multiplicative = True,
  *                   boundary_params = {},
  *                   random_state = None,             # <<<<<<<<<<<<<<
  *                   ):
  * 
  */
     values[12] = ((PyObject *)Py_None);
@@ -8362,27 +10104,27 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound", 0, 4, 13, 1); __PYX_ERR(0, 481, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound", 0, 4, 13, 1); __PYX_ERR(0, 601, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound", 0, 4, 13, 2); __PYX_ERR(0, 481, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound", 0, 4, 13, 2); __PYX_ERR(0, 601, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound", 0, 4, 13, 3); __PYX_ERR(0, 481, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound", 0, 4, 13, 3); __PYX_ERR(0, 601, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[4] = value; kw_args--; }
         }
@@ -8432,15 +10174,15 @@
         case 12:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[12] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound") < 0)) __PYX_ERR(0, 481, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound") < 0)) __PYX_ERR(0, 601, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 13: values[12] = PyTuple_GET_ITEM(__pyx_args, 12);
         CYTHON_FALLTHROUGH;
         case 12: values[11] = PyTuple_GET_ITEM(__pyx_args, 11);
         CYTHON_FALLTHROUGH;
@@ -8467,58 +10209,58 @@
       }
     }
     __pyx_v_v = ((PyArrayObject *)values[0]);
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_t = ((PyArrayObject *)values[3]);
     if (values[4]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 485, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 605, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[5]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 486, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 606, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[6]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 487, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 607, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[7]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 488, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 608, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[8]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 489, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 609, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_boundary_fun = values[9];
     __pyx_v_boundary_multiplicative = values[10];
     __pyx_v_boundary_params = values[11];
     __pyx_v_random_state = values[12];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ddm_flexbound", 0, 4, 13, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 481, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ddm_flexbound", 0, 4, 13, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 601, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ddm_flexbound", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 481, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 482, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 483, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 484, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_8ddm_flexbound(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 601, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 602, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 603, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 604, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_10ddm_flexbound(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":481
+  /* "cssm.pyx":601
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                   np.ndarray[float, ndim = 1] a,
  *                   np.ndarray[float, ndim = 1] z,
  */
 
@@ -8527,15 +10269,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_8ddm_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_10ddm_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_traj = NULL;
   __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_rts = NULL;
@@ -8552,15 +10294,15 @@
   Py_ssize_t __pyx_v_n;
   Py_ssize_t __pyx_v_ix;
   Py_ssize_t __pyx_v_m;
   Py_ssize_t __pyx_v_k;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
-  PyObject *__pyx_7genexpr__pyx_v_key = NULL;
+  PyObject *__pyx_8genexpr1__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
   __Pyx_Buffer __pyx_pybuffer_t;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
   __Pyx_Buffer __pyx_pybuffer_v;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
@@ -8609,318 +10351,318 @@
   __pyx_pybuffernd_z.rcbuffer = &__pyx_pybuffer_z;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 481, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 601, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 481, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 601, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 481, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 601, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 481, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 601, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":496
+  /* "cssm.pyx":616
  *                   ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
  *     # Param views:
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":499
+  /* "cssm.pyx":619
  *     #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
  *     # Param views:
  *     cdef float[:] v_view  = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 619, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":500
+  /* "cssm.pyx":620
  *     # Param views:
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 620, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":501
+  /* "cssm.pyx":621
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 501, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 621, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":502
+  /* "cssm.pyx":622
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 622, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":504
+  /* "cssm.pyx":624
  *     cdef float[:] t_view = t
  * 
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 504, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 504, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_traj = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":505
+  /* "cssm.pyx":625
  * 
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:,:] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 505, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 625, __pyx_L1_error)
 
-  /* "cssm.pyx":506
+  /* "cssm.pyx":626
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 506, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 626, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":508
+  /* "cssm.pyx":628
  *     cdef float[:,:] traj_view = traj
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 508, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rts = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":509
+  /* "cssm.pyx":629
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 509, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 509, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 629, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":511
+  /* "cssm.pyx":631
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 511, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 631, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":512
+  /* "cssm.pyx":632
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 512, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 632, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":514
+  /* "cssm.pyx":634
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":515
+  /* "cssm.pyx":635
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage for the upper bound
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":518
+  /* "cssm.pyx":638
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":519
+  /* "cssm.pyx":639
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_10 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -8929,231 +10671,231 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_10) {
       __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_12 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_12)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_12);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_7 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 519, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 639, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_t_s = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":520
+  /* "cssm.pyx":640
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  * 
  *     cdef float y, t_particle
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 520, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 640, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 520, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 640, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 520, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 640, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 520, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 520, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 640, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 520, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 640, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 520, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 640, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 520, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 640, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_boundary = __pyx_t_12;
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":525
+  /* "cssm.pyx":645
  *     cdef Py_ssize_t n
  *     cdef Py_ssize_t ix
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t k
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":527
+  /* "cssm.pyx":647
  *     cdef Py_ssize_t m = 0
  *     cdef Py_ssize_t k
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 527, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 647, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":528
+  /* "cssm.pyx":648
  *     cdef Py_ssize_t k
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     #print('boundary shape')
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 528, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 648, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":534
+  /* "cssm.pyx":654
  * 
  *     # Loop over samples
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_11 = __pyx_v_n_trials;
   __pyx_t_13 = __pyx_t_11;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_k = __pyx_t_14;
 
-    /* "cssm.pyx":536
+    /* "cssm.pyx":656
  *     for k in range(n_trials):
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  *         # print('before passed')
  *         if boundary_multiplicative:
  */
     { /* enter inner scope */
-      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 536, __pyx_L7_error)
+      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 656, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_12);
       __pyx_t_15 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 536, __pyx_L7_error)
+        __PYX_ERR(0, 656, __pyx_L7_error)
       }
-      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L7_error)
+      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 656, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF(__pyx_t_7);
       __pyx_t_7 = __pyx_t_1;
       __pyx_t_1 = 0;
       while (1) {
         __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_16, &__pyx_t_15, &__pyx_t_1, NULL, NULL, __pyx_t_17);
         if (unlikely(__pyx_t_18 == 0)) break;
-        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 536, __pyx_L7_error)
+        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 656, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_XDECREF_SET(__pyx_7genexpr__pyx_v_key, __pyx_t_1);
+        __Pyx_XDECREF_SET(__pyx_8genexpr1__pyx_v_key, __pyx_t_1);
         __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_7genexpr__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L7_error)
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr1__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 656, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 536, __pyx_L7_error)
+        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_7genexpr__pyx_v_key, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 536, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr1__pyx_v_key, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 656, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_XDECREF(__pyx_7genexpr__pyx_v_key); __pyx_7genexpr__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_key); __pyx_8genexpr1__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_7genexpr__pyx_v_key); __pyx_7genexpr__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_key); __pyx_8genexpr1__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_12));
     __pyx_t_12 = 0;
 
-    /* "cssm.pyx":538
+    /* "cssm.pyx":658
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  *         # print('before passed')
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print('passed')
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 538, __pyx_L1_error)
+    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 658, __pyx_L1_error)
     if (__pyx_t_19) {
 
-      /* "cssm.pyx":540
+      /* "cssm.pyx":660
  *         if boundary_multiplicative:
  *             # print('passed')
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_20 = __pyx_v_k;
-      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 540, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 660, __pyx_L1_error)
       __pyx_t_5 = __pyx_t_4;
       __pyx_t_4 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 540, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 540, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 660, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_5 = NULL;
       __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_5)) {
@@ -9163,105 +10905,105 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
-        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 540, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 660, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
-        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 540, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 660, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 540, __pyx_L1_error)
+        __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 660, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         if (__pyx_t_5) {
           __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5); __pyx_t_5 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_17, __pyx_t_3);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_17, __pyx_t_4);
         __pyx_t_3 = 0;
         __pyx_t_4 = 0;
-        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 540, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 660, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 540, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 540, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-      /* "cssm.pyx":538
+      /* "cssm.pyx":658
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  *         # print('before passed')
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print('passed')
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":542
+    /* "cssm.pyx":662
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         for n in range(n_samples):
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 542, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 662, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 542, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 662, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_20 = __pyx_v_k;
-      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 542, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 662, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 542, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 542, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 662, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_3;
       __pyx_t_3 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 542, __pyx_L1_error)
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 542, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_4)) {
@@ -9271,166 +11013,166 @@
           __Pyx_DECREF_SET(__pyx_t_10, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_3};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_3};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       {
-        __pyx_t_5 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 542, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 662, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_17, __pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_17, __pyx_t_3);
         __pyx_t_7 = 0;
         __pyx_t_3 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       }
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 542, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 662, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
       __pyx_t_12 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 542, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 662, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 542, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 662, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":544
+    /* "cssm.pyx":664
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  * 
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time
  */
     __pyx_t_17 = __pyx_v_n_samples;
     __pyx_t_18 = __pyx_t_17;
     for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_18; __pyx_t_16+=1) {
       __pyx_v_n = __pyx_t_16;
 
-      /* "cssm.pyx":545
+      /* "cssm.pyx":665
  * 
  *         for n in range(n_samples):
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position             # <<<<<<<<<<<<<<
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index
  */
       __pyx_t_20 = 0;
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_22 = 0;
       __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_21 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_22 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":546
+      /* "cssm.pyx":666
  *         for n in range(n_samples):
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":547
+      /* "cssm.pyx":667
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             # Can improve with less checks
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":550
+      /* "cssm.pyx":670
  * 
  *             # Can improve with less checks
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       __pyx_t_19 = ((__pyx_v_n == 0) != 0);
       if (__pyx_t_19) {
 
-        /* "cssm.pyx":551
+        /* "cssm.pyx":671
  *             # Can improve with less checks
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         __pyx_t_19 = ((__pyx_v_k == 0) != 0);
         if (__pyx_t_19) {
 
-          /* "cssm.pyx":552
+          /* "cssm.pyx":672
  *             if n == 0:
  *                 if k == 0:
  *                     traj_view[0, 0] = y             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
           __pyx_t_22 = 0;
           __pyx_t_21 = 0;
           *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-          /* "cssm.pyx":551
+          /* "cssm.pyx":671
  *             # Can improve with less checks
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         }
 
-        /* "cssm.pyx":550
+        /* "cssm.pyx":670
  * 
  *             # Can improve with less checks
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       }
 
-      /* "cssm.pyx":555
+      /* "cssm.pyx":675
  * 
  *             # Random walker
  *             while (y >= (-1) * boundary_view[ix]) and (y <= boundary_view[ix]) and (t_particle <= max_t):             # <<<<<<<<<<<<<<
  *                 # print('passed')
  *                 y += (v_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  */
       while (1) {
@@ -9449,334 +11191,334 @@
           goto __pyx_L18_bool_binop_done;
         }
         __pyx_t_23 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_19 = __pyx_t_23;
         __pyx_L18_bool_binop_done:;
         if (!__pyx_t_19) break;
 
-        /* "cssm.pyx":557
+        /* "cssm.pyx":677
  *             while (y >= (-1) * boundary_view[ix]) and (y <= boundary_view[ix]) and (t_particle <= max_t):
  *                 # print('passed')
  *                 y += (v_view[k] * delta_t) + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 ix += 1
  */
         __pyx_t_21 = __pyx_v_k;
         __pyx_t_22 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_21 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_22 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":558
+        /* "cssm.pyx":678
  *                 # print('passed')
  *                 y += (v_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":559
+        /* "cssm.pyx":679
  *                 y += (v_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  * 
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":560
+        /* "cssm.pyx":680
  *                 t_particle += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  * 
  *                 # Can improve with less checks
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":563
+        /* "cssm.pyx":683
  * 
  *                 # Can improve with less checks
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         __pyx_t_19 = ((__pyx_v_n == 0) != 0);
         if (__pyx_t_19) {
 
-          /* "cssm.pyx":564
+          /* "cssm.pyx":684
  *                 # Can improve with less checks
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  * 
  */
           __pyx_t_19 = ((__pyx_v_k == 0) != 0);
           if (__pyx_t_19) {
 
-            /* "cssm.pyx":565
+            /* "cssm.pyx":685
  *                 if n == 0:
  *                     if k == 0:
  *                         traj_view[ix, 0] = y             # <<<<<<<<<<<<<<
  * 
  *                 # Can improve with less checks
  */
             __pyx_t_22 = __pyx_v_ix;
             __pyx_t_21 = 0;
             *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-            /* "cssm.pyx":564
+            /* "cssm.pyx":684
  *                 # Can improve with less checks
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  * 
  */
           }
 
-          /* "cssm.pyx":563
+          /* "cssm.pyx":683
  * 
  *                 # Can improve with less checks
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         }
 
-        /* "cssm.pyx":568
+        /* "cssm.pyx":688
  * 
  *                 # Can improve with less checks
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_19 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_19) {
 
-          /* "cssm.pyx":569
+          /* "cssm.pyx":689
  *                 # Can improve with less checks
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 569, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 689, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":570
+          /* "cssm.pyx":690
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":568
+          /* "cssm.pyx":688
  * 
  *                 # Can improve with less checks
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":572
+      /* "cssm.pyx":692
  *                     m = 0
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = sign(y) # Store choice
  * 
  */
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_22 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_24 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_22 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":573
+      /* "cssm.pyx":693
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt
  *             choices_view[n, k, 0] = sign(y) # Store choice             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  */
       __pyx_t_21 = __pyx_v_n;
       __pyx_t_24 = __pyx_v_k;
       __pyx_t_20 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = __pyx_f_4cssm_sign(__pyx_v_y);
     }
   }
 
-  /* "cssm.pyx":575
+  /* "cssm.pyx":695
  *             choices_view[n, k, 0] = sign(y) # Store choice
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                           'a': a,
  *                                                           'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 575, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 695, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 575, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 575, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 695, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 695, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 575, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 695, __pyx_L1_error)
 
-  /* "cssm.pyx":576
+  /* "cssm.pyx":696
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  *                                                           'a': a,             # <<<<<<<<<<<<<<
  *                                                           'z': z,
  *                                                           't': t,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 575, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 695, __pyx_L1_error)
 
-  /* "cssm.pyx":577
+  /* "cssm.pyx":697
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  *                                                           'a': a,
  *                                                           'z': z,             # <<<<<<<<<<<<<<
  *                                                           't': t,
  *                                                           's': s,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 575, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 695, __pyx_L1_error)
 
-  /* "cssm.pyx":578
+  /* "cssm.pyx":698
  *                                                           'a': a,
  *                                                           'z': z,
  *                                                           't': t,             # <<<<<<<<<<<<<<
  *                                                           's': s,
  *                                                           **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 575, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 695, __pyx_L1_error)
 
-  /* "cssm.pyx":579
+  /* "cssm.pyx":699
  *                                                           'z': z,
  *                                                           't': t,
  *                                                           's': s,             # <<<<<<<<<<<<<<
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 579, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 699, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_s, __pyx_t_5) < 0) __PYX_ERR(0, 575, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_s, __pyx_t_5) < 0) __PYX_ERR(0, 695, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_10 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "cssm.pyx":580
+  /* "cssm.pyx":700
  *                                                           't': t,
  *                                                           's': s,
  *                                                           **boundary_params,             # <<<<<<<<<<<<<<
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 580, __pyx_L1_error)
+    __PYX_ERR(0, 700, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_10, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 580, __pyx_L1_error)
+    __PYX_ERR(0, 700, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":581
+  /* "cssm.pyx":701
  *                                                           's': s,
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 581, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 701, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 581, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 701, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":582
+  /* "cssm.pyx":702
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ddm_flexbound',
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 582, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 702, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 582, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 702, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":583
+  /* "cssm.pyx":703
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                           'simulator': 'ddm_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 583, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 583, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 703, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) < 0) __PYX_ERR(0, 584, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) < 0) __PYX_ERR(0, 704, __pyx_L1_error)
 
-  /* "cssm.pyx":585
+  /* "cssm.pyx":705
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ddm_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 705, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) < 0) __PYX_ERR(0, 585, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) < 0) __PYX_ERR(0, 705, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":586
+  /* "cssm.pyx":706
  *                                                           'simulator': 'ddm_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],             # <<<<<<<<<<<<<<
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary,
  */
-  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) < 0) __PYX_ERR(0, 586, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) < 0) __PYX_ERR(0, 706, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":587
+  /* "cssm.pyx":707
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,             # <<<<<<<<<<<<<<
  *                                                           'boundary': boundary,
  *                                                           }}
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 587, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 707, __pyx_L1_error)
 
-  /* "cssm.pyx":588
+  /* "cssm.pyx":708
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary,             # <<<<<<<<<<<<<<
  *                                                           }}
  * # ----------------------------------------------------------------------------------------------------
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 588, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_10) < 0) __PYX_ERR(0, 575, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 708, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_10) < 0) __PYX_ERR(0, 695, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   __pyx_r = __pyx_t_12;
   __pyx_t_12 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":481
+  /* "cssm.pyx":601
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                   np.ndarray[float, ndim = 1] a,
  *                   np.ndarray[float, ndim = 1] z,
  */
 
@@ -9822,32 +11564,32 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_rts_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
-  __Pyx_XDECREF(__pyx_7genexpr__pyx_v_key);
+  __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":595
+/* "cssm.pyx":715
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flex(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *              np.ndarray[float, ndim = 1] a,
  *              np.ndarray[float, ndim = 1] z,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_11ddm_flex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_11ddm_flex = {"ddm_flex", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_11ddm_flex, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_11ddm_flex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_13ddm_flex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_13ddm_flex = {"ddm_flex", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_13ddm_flex, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_13ddm_flex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z = 0;
   PyArrayObject *__pyx_v_t = 0;
   float __pyx_v_s;
   float __pyx_v_delta_t;
   float __pyx_v_max_t;
@@ -9865,44 +11607,44 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ddm_flex (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_boundary_fun,&__pyx_n_s_drift_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_drift_params,&__pyx_n_s_random_state,0};
     PyObject* values[15] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":604
+    /* "cssm.pyx":724
  *              int n_samples = 20000,
  *              int n_trials = 1,
  *              boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *              drift_fun = None,
  *              boundary_multiplicative = True,
  */
     values[9] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":605
+    /* "cssm.pyx":725
  *              int n_trials = 1,
  *              boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *              drift_fun = None,             # <<<<<<<<<<<<<<
  *              boundary_multiplicative = True,
  *              boundary_params = {},
  */
     values[10] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":606
+    /* "cssm.pyx":726
  *              boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *              drift_fun = None,
  *              boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *              boundary_params = {},
  *              drift_params = {},
  */
     values[11] = ((PyObject *)Py_True);
-    values[12] = __pyx_k__4;
-    values[13] = __pyx_k__5;
+    values[12] = __pyx_k__5;
+    values[13] = __pyx_k__6;
 
-    /* "cssm.pyx":609
+    /* "cssm.pyx":729
  *              boundary_params = {},
  *              drift_params = {},
  *              random_state = None,             # <<<<<<<<<<<<<<
  *              ):
  * 
  */
     values[14] = ((PyObject *)Py_None);
@@ -9948,27 +11690,27 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flex", 0, 4, 15, 1); __PYX_ERR(0, 595, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flex", 0, 4, 15, 1); __PYX_ERR(0, 715, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flex", 0, 4, 15, 2); __PYX_ERR(0, 595, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flex", 0, 4, 15, 2); __PYX_ERR(0, 715, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flex", 0, 4, 15, 3); __PYX_ERR(0, 595, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flex", 0, 4, 15, 3); __PYX_ERR(0, 715, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[4] = value; kw_args--; }
         }
@@ -10030,15 +11772,15 @@
         case 14:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[14] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flex") < 0)) __PYX_ERR(0, 595, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flex") < 0)) __PYX_ERR(0, 715, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 15: values[14] = PyTuple_GET_ITEM(__pyx_args, 14);
         CYTHON_FALLTHROUGH;
         case 14: values[13] = PyTuple_GET_ITEM(__pyx_args, 13);
         CYTHON_FALLTHROUGH;
@@ -10069,60 +11811,60 @@
       }
     }
     __pyx_v_v = ((PyArrayObject *)values[0]);
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_t = ((PyArrayObject *)values[3]);
     if (values[4]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 599, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 719, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[5]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 600, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 720, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[6]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 601, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 721, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[7]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 602, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 722, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[8]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 603, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 723, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_boundary_fun = values[9];
     __pyx_v_drift_fun = values[10];
     __pyx_v_boundary_multiplicative = values[11];
     __pyx_v_boundary_params = values[12];
     __pyx_v_drift_params = values[13];
     __pyx_v_random_state = values[14];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ddm_flex", 0, 4, 15, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 595, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ddm_flex", 0, 4, 15, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 715, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ddm_flex", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 595, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 596, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 597, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 598, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_10ddm_flex(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_drift_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_drift_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 715, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 716, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 717, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 718, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_12ddm_flex(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_drift_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_drift_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":595
+  /* "cssm.pyx":715
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flex(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *              np.ndarray[float, ndim = 1] a,
  *              np.ndarray[float, ndim = 1] z,
  */
 
@@ -10131,15 +11873,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_10ddm_flex(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_drift_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_drift_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_12ddm_flex(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_drift_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_drift_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_traj = NULL;
   __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_rts = NULL;
@@ -10159,16 +11901,16 @@
   Py_ssize_t __pyx_v_m;
   Py_ssize_t __pyx_v_k;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_drift_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_drift_params_tmp = NULL;
   PyObject *__pyx_v_boundary_params_tmp = NULL;
-  PyObject *__pyx_8genexpr1__pyx_v_key = NULL;
   PyObject *__pyx_8genexpr2__pyx_v_key = NULL;
+  PyObject *__pyx_8genexpr3__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
   __Pyx_Buffer __pyx_pybuffer_t;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
   __Pyx_Buffer __pyx_pybuffer_v;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
@@ -10217,318 +11959,318 @@
   __pyx_pybuffernd_z.rcbuffer = &__pyx_pybuffer_z;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 595, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 715, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 595, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 715, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 595, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 715, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 595, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 715, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":612
+  /* "cssm.pyx":732
  *              ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Param views:
  *     cdef float[:] v_view  = v
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":614
+  /* "cssm.pyx":734
  *     set_seed(random_state)
  *     # Param views:
  *     cdef float[:] v_view  = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 614, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 734, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":615
+  /* "cssm.pyx":735
  *     # Param views:
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 615, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 735, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":616
+  /* "cssm.pyx":736
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 736, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":617
+  /* "cssm.pyx":737
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 617, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 737, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":619
+  /* "cssm.pyx":739
  *     cdef float[:] t_view = t
  * 
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 619, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_traj = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":620
+  /* "cssm.pyx":740
  * 
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:,:] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 620, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 740, __pyx_L1_error)
 
-  /* "cssm.pyx":621
+  /* "cssm.pyx":741
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 621, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 741, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":623
+  /* "cssm.pyx":743
  *     cdef float[:,:] traj_view = traj
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 623, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rts = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":624
+  /* "cssm.pyx":744
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":626
+  /* "cssm.pyx":746
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 626, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 746, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":627
+  /* "cssm.pyx":747
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 627, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 747, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":629
+  /* "cssm.pyx":749
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":630
+  /* "cssm.pyx":750
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage for the upper bound
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":633
+  /* "cssm.pyx":753
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":634
+  /* "cssm.pyx":754
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     drift = np.zeros(t_s.shape, dtype = DTYPE)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 754, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 754, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 754, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 754, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_10 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -10537,266 +12279,266 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 754, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 754, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 754, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_10) {
       __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 754, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 754, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 754, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_12 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_12)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_12);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_7 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 634, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 754, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_t_s = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":635
+  /* "cssm.pyx":755
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     drift = np.zeros(t_s.shape, dtype = DTYPE)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 755, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 755, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 755, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 755, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 755, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 755, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 635, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 755, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 755, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_boundary = __pyx_t_12;
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":636
+  /* "cssm.pyx":756
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     drift = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  * 
  *     cdef float y, t_particle
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_12);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_12);
   __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 636, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, __pyx_t_12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, __pyx_t_12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   __pyx_v_drift = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":641
+  /* "cssm.pyx":761
  *     cdef Py_ssize_t n
  *     cdef Py_ssize_t ix
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t k
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":643
+  /* "cssm.pyx":763
  *     cdef Py_ssize_t m = 0
  *     cdef Py_ssize_t k
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  *     cdef float[:] drift_view = drift
  */
-  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 643, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 763, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":644
+  /* "cssm.pyx":764
  *     cdef Py_ssize_t k
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  *     cdef float[:] drift_view = drift
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 644, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 764, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":645
+  /* "cssm.pyx":765
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  *     cdef float[:] boundary_view = boundary
  *     cdef float[:] drift_view = drift             # <<<<<<<<<<<<<<
  * 
  *     # Loop over samples
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_drift, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 645, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_drift, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 765, __pyx_L1_error)
   __pyx_v_drift_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":648
+  /* "cssm.pyx":768
  * 
  *     # Loop over samples
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Precompute boundary evaluations and drift evaluations
  * 
  */
   __pyx_t_11 = __pyx_v_n_trials;
   __pyx_t_13 = __pyx_t_11;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_k = __pyx_t_14;
 
-    /* "cssm.pyx":652
+    /* "cssm.pyx":772
  * 
  *         # Drift
  *         drift_params_tmp = {key: drift_params[key][k] for key in drift_params.keys()}             # <<<<<<<<<<<<<<
  *         drift[:] = np.add(v_view[k], drift_fun(t = t_s, **drift_params_tmp)).astype(DTYPE)
  * 
  */
     { /* enter inner scope */
-      __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L7_error)
+      __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 772, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_15 = 0;
       if (unlikely(__pyx_v_drift_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 652, __pyx_L7_error)
+        __PYX_ERR(0, 772, __pyx_L7_error)
       }
-      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_drift_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 652, __pyx_L7_error)
+      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_drift_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF(__pyx_t_12);
       __pyx_t_12 = __pyx_t_1;
       __pyx_t_1 = 0;
       while (1) {
         __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_12, __pyx_t_16, &__pyx_t_15, &__pyx_t_1, NULL, NULL, __pyx_t_17);
         if (unlikely(__pyx_t_18 == 0)) break;
-        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 652, __pyx_L7_error)
+        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 772, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_XDECREF_SET(__pyx_8genexpr1__pyx_v_key, __pyx_t_1);
+        __Pyx_XDECREF_SET(__pyx_8genexpr2__pyx_v_key, __pyx_t_1);
         __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_drift_params, __pyx_8genexpr1__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 652, __pyx_L7_error)
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_drift_params, __pyx_8genexpr2__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 652, __pyx_L7_error)
+        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 772, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_3, (PyObject*)__pyx_8genexpr1__pyx_v_key, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 652, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_3, (PyObject*)__pyx_8genexpr2__pyx_v_key, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 772, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       }
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_key); __pyx_8genexpr1__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_key); __pyx_8genexpr2__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_key); __pyx_8genexpr1__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_key); __pyx_8genexpr2__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_drift_params_tmp, ((PyObject*)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "cssm.pyx":653
+    /* "cssm.pyx":773
  *         # Drift
  *         drift_params_tmp = {key: drift_params[key][k] for key in drift_params.keys()}
  *         drift[:] = np.add(v_view[k], drift_fun(t = t_s, **drift_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Boundary
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 773, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 773, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_19 = __pyx_v_k;
-    __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_19 * __pyx_v_v_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_19 * __pyx_v_v_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 773, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 773, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 653, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 773, __pyx_L1_error)
     __pyx_t_5 = __pyx_t_4;
     __pyx_t_4 = 0;
-    if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_drift_params_tmp) < 0) __PYX_ERR(0, 653, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_drift_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 653, __pyx_L1_error)
+    if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_drift_params_tmp) < 0) __PYX_ERR(0, 773, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_drift_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 773, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_5 = NULL;
     __pyx_t_17 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_5)) {
@@ -10806,150 +12548,150 @@
         __Pyx_DECREF_SET(__pyx_t_1, function);
         __pyx_t_17 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_7, __pyx_t_4};
-      __pyx_t_12 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 653, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_7, __pyx_t_4};
-      __pyx_t_12 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 653, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     {
-      __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 653, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       if (__pyx_t_5) {
         __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5); __pyx_t_5 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_17, __pyx_t_7);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_17, __pyx_t_4);
       __pyx_t_7 = 0;
       __pyx_t_4 = 0;
-      __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 653, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 773, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 773, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_t_12) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_12);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 653, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 773, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (__Pyx_PyObject_SetSlice(__pyx_v_drift, __pyx_t_3, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 653, __pyx_L1_error)
+    if (__Pyx_PyObject_SetSlice(__pyx_v_drift, __pyx_t_3, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 773, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "cssm.pyx":656
+    /* "cssm.pyx":776
  * 
  *         # Boundary
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  *         if boundary_multiplicative:
  *             # print('passed')
  */
     { /* enter inner scope */
-      __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L13_error)
+      __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 776, __pyx_L13_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_16 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 656, __pyx_L13_error)
+        __PYX_ERR(0, 776, __pyx_L13_error)
       }
-      __pyx_t_12 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_15), (&__pyx_t_17)); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 656, __pyx_L13_error)
+      __pyx_t_12 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_15), (&__pyx_t_17)); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 776, __pyx_L13_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_XDECREF(__pyx_t_1);
       __pyx_t_1 = __pyx_t_12;
       __pyx_t_12 = 0;
       while (1) {
         __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_15, &__pyx_t_16, &__pyx_t_12, NULL, NULL, __pyx_t_17);
         if (unlikely(__pyx_t_18 == 0)) break;
-        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 656, __pyx_L13_error)
+        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 776, __pyx_L13_error)
         __Pyx_GOTREF(__pyx_t_12);
-        __Pyx_XDECREF_SET(__pyx_8genexpr2__pyx_v_key, __pyx_t_12);
+        __Pyx_XDECREF_SET(__pyx_8genexpr3__pyx_v_key, __pyx_t_12);
         __pyx_t_12 = 0;
-        __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr2__pyx_v_key); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 656, __pyx_L13_error)
+        __pyx_t_12 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr3__pyx_v_key); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 776, __pyx_L13_error)
         __Pyx_GOTREF(__pyx_t_12);
-        __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_12, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 656, __pyx_L13_error)
+        __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_12, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 776, __pyx_L13_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_3, (PyObject*)__pyx_8genexpr2__pyx_v_key, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 656, __pyx_L13_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_3, (PyObject*)__pyx_8genexpr3__pyx_v_key, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 776, __pyx_L13_error)
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_key); __pyx_8genexpr2__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_key); __pyx_8genexpr3__pyx_v_key = 0;
       goto __pyx_L16_exit_scope;
       __pyx_L13_error:;
-      __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_key); __pyx_8genexpr2__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_key); __pyx_8genexpr3__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L16_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "cssm.pyx":657
+    /* "cssm.pyx":777
  *         # Boundary
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print('passed')
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-    __pyx_t_20 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_20 < 0)) __PYX_ERR(0, 657, __pyx_L1_error)
+    __pyx_t_20 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_20 < 0)) __PYX_ERR(0, 777, __pyx_L1_error)
     if (__pyx_t_20) {
 
-      /* "cssm.pyx":659
+      /* "cssm.pyx":779
  *         if boundary_multiplicative:
  *             # print('passed')
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 659, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 779, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_multiply); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 659, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_multiply); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 779, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_19 = __pyx_v_k;
-      __pyx_t_10 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 659, __pyx_L1_error)
+      __pyx_t_10 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 779, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 659, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 779, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 659, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 779, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_7;
       __pyx_t_7 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 659, __pyx_L1_error)
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 659, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 779, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 779, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_12))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_12);
         if (likely(__pyx_t_4)) {
@@ -10959,105 +12701,105 @@
           __Pyx_DECREF_SET(__pyx_t_12, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_12)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_10, __pyx_t_7};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_12)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_10, __pyx_t_7};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_12, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       } else
       #endif
       {
-        __pyx_t_5 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 659, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 779, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_10);
         PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_17, __pyx_t_10);
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_17, __pyx_t_7);
         __pyx_t_10 = 0;
         __pyx_t_7 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       }
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 659, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 779, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_12);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_12, function);
         }
       }
       __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 659, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 779, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_3, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 659, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_3, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 779, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "cssm.pyx":657
+      /* "cssm.pyx":777
  *         # Boundary
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print('passed')
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
       goto __pyx_L17;
     }
 
-    /* "cssm.pyx":661
+    /* "cssm.pyx":781
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         for n in range(n_samples):
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 661, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_add); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 661, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_add); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_19 = __pyx_v_k;
-      __pyx_t_1 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 661, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_10 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 661, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 661, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
       __pyx_t_7 = __pyx_t_10;
       __pyx_t_10 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_7, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 661, __pyx_L1_error)
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 661, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_7, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_7 = NULL;
       __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_7)) {
@@ -11067,166 +12809,166 @@
           __Pyx_DECREF_SET(__pyx_t_5, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_1, __pyx_t_10};
-        __pyx_t_12 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 661, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 781, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_GOTREF(__pyx_t_12);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_1, __pyx_t_10};
-        __pyx_t_12 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 661, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 781, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_GOTREF(__pyx_t_12);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       } else
       #endif
       {
-        __pyx_t_4 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 661, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         if (__pyx_t_7) {
           __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_1);
         PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_17, __pyx_t_1);
         __Pyx_GIVEREF(__pyx_t_10);
         PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_17, __pyx_t_10);
         __pyx_t_1 = 0;
         __pyx_t_10 = 0;
-        __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 661, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 781, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_12);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 661, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 661, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
           __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
       __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_t_12) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_12);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 661, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_3, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 661, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_3, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __pyx_L17:;
 
-    /* "cssm.pyx":663
+    /* "cssm.pyx":783
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  * 
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time
  */
     __pyx_t_17 = __pyx_v_n_samples;
     __pyx_t_18 = __pyx_t_17;
     for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_18; __pyx_t_15+=1) {
       __pyx_v_n = __pyx_t_15;
 
-      /* "cssm.pyx":664
+      /* "cssm.pyx":784
  * 
  *         for n in range(n_samples):
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position             # <<<<<<<<<<<<<<
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index
  */
       __pyx_t_19 = 0;
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_22 = 0;
       __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_21 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_22 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":665
+      /* "cssm.pyx":785
  *         for n in range(n_samples):
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":666
+      /* "cssm.pyx":786
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             # Can improve with less checks
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":669
+      /* "cssm.pyx":789
  * 
  *             # Can improve with less checks
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       __pyx_t_20 = ((__pyx_v_n == 0) != 0);
       if (__pyx_t_20) {
 
-        /* "cssm.pyx":670
+        /* "cssm.pyx":790
  *             # Can improve with less checks
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         __pyx_t_20 = ((__pyx_v_k == 0) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":671
+          /* "cssm.pyx":791
  *             if n == 0:
  *                 if k == 0:
  *                     traj_view[0, 0] = y             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
           __pyx_t_22 = 0;
           __pyx_t_21 = 0;
           *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-          /* "cssm.pyx":670
+          /* "cssm.pyx":790
  *             # Can improve with less checks
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         }
 
-        /* "cssm.pyx":669
+        /* "cssm.pyx":789
  * 
  *             # Can improve with less checks
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       }
 
-      /* "cssm.pyx":674
+      /* "cssm.pyx":794
  * 
  *             # Random walker
  *             while (y >= (-1) * boundary_view[ix]) and (y <= boundary_view[ix]) and (t_particle <= max_t):             # <<<<<<<<<<<<<<
  *                 y += (drift_view[ix] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  */
       while (1) {
@@ -11245,371 +12987,371 @@
           goto __pyx_L24_bool_binop_done;
         }
         __pyx_t_23 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_20 = __pyx_t_23;
         __pyx_L24_bool_binop_done:;
         if (!__pyx_t_20) break;
 
-        /* "cssm.pyx":675
+        /* "cssm.pyx":795
  *             # Random walker
  *             while (y >= (-1) * boundary_view[ix]) and (y <= boundary_view[ix]) and (t_particle <= max_t):
  *                 y += (drift_view[ix] * delta_t) + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 ix += 1
  */
         __pyx_t_21 = __pyx_v_ix;
         __pyx_t_22 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_drift_view.data + __pyx_t_21 * __pyx_v_drift_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_22 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":676
+        /* "cssm.pyx":796
  *             while (y >= (-1) * boundary_view[ix]) and (y <= boundary_view[ix]) and (t_particle <= max_t):
  *                 y += (drift_view[ix] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":677
+        /* "cssm.pyx":797
  *                 y += (drift_view[ix] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  * 
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":678
+        /* "cssm.pyx":798
  *                 t_particle += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  * 
  *                 # Can improve with less checks
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":681
+        /* "cssm.pyx":801
  * 
  *                 # Can improve with less checks
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         __pyx_t_20 = ((__pyx_v_n == 0) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":682
+          /* "cssm.pyx":802
  *                 # Can improve with less checks
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  * 
  */
           __pyx_t_20 = ((__pyx_v_k == 0) != 0);
           if (__pyx_t_20) {
 
-            /* "cssm.pyx":683
+            /* "cssm.pyx":803
  *                 if n == 0:
  *                     if k == 0:
  *                         traj_view[ix, 0] = y             # <<<<<<<<<<<<<<
  * 
  *                 # Can improve with less checks
  */
             __pyx_t_22 = __pyx_v_ix;
             __pyx_t_21 = 0;
             *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-            /* "cssm.pyx":682
+            /* "cssm.pyx":802
  *                 # Can improve with less checks
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  * 
  */
           }
 
-          /* "cssm.pyx":681
+          /* "cssm.pyx":801
  * 
  *                 # Can improve with less checks
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         }
 
-        /* "cssm.pyx":686
+        /* "cssm.pyx":806
  * 
  *                 # Can improve with less checks
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_20 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":687
+          /* "cssm.pyx":807
  *                 # Can improve with less checks
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 687, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 807, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":688
+          /* "cssm.pyx":808
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":686
+          /* "cssm.pyx":806
  * 
  *                 # Can improve with less checks
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":690
+      /* "cssm.pyx":810
  *                     m = 0
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = sign(y) # Store choice
  * 
  */
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_22 = __pyx_v_n;
       __pyx_t_19 = __pyx_v_k;
       __pyx_t_24 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_22 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":691
+      /* "cssm.pyx":811
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt
  *             choices_view[n, k, 0] = sign(y) # Store choice             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  */
       __pyx_t_21 = __pyx_v_n;
       __pyx_t_24 = __pyx_v_k;
       __pyx_t_19 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) = __pyx_f_4cssm_sign(__pyx_v_y);
     }
   }
 
-  /* "cssm.pyx":693
+  /* "cssm.pyx":813
  *             choices_view[n, k, 0] = sign(y) # Store choice
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                           'a': a,
  *                                                           'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
 
-  /* "cssm.pyx":694
+  /* "cssm.pyx":814
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  *                                                           'a': a,             # <<<<<<<<<<<<<<
  *                                                           'z': z,
  *                                                           't': t,
  */
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
 
-  /* "cssm.pyx":695
+  /* "cssm.pyx":815
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  *                                                           'a': a,
  *                                                           'z': z,             # <<<<<<<<<<<<<<
  *                                                           't': t,
  *                                                           's': s,
  */
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
 
-  /* "cssm.pyx":696
+  /* "cssm.pyx":816
  *                                                           'a': a,
  *                                                           'z': z,
  *                                                           't': t,             # <<<<<<<<<<<<<<
  *                                                           's': s,
  *                                                           **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
 
-  /* "cssm.pyx":697
+  /* "cssm.pyx":817
  *                                                           'z': z,
  *                                                           't': t,
  *                                                           's': s,             # <<<<<<<<<<<<<<
  *                                                           **boundary_params,
  *                                                           **drift_params,
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 817, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_s, __pyx_t_4) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_s, __pyx_t_4) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_5 = __pyx_t_12;
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":698
+  /* "cssm.pyx":818
  *                                                           't': t,
  *                                                           's': s,
  *                                                           **boundary_params,             # <<<<<<<<<<<<<<
  *                                                           **drift_params,
  *                                                           'delta_t': delta_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 698, __pyx_L1_error)
+    __PYX_ERR(0, 818, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_5, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 698, __pyx_L1_error)
+    __PYX_ERR(0, 818, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":699
+  /* "cssm.pyx":819
  *                                                           's': s,
  *                                                           **boundary_params,
  *                                                           **drift_params,             # <<<<<<<<<<<<<<
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  */
   if (unlikely(__pyx_v_drift_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 699, __pyx_L1_error)
+    __PYX_ERR(0, 819, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_5, __pyx_v_drift_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_drift_params);
-    __PYX_ERR(0, 699, __pyx_L1_error)
+    __PYX_ERR(0, 819, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":700
+  /* "cssm.pyx":820
  *                                                           **boundary_params,
  *                                                           **drift_params,
  *                                                           'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,
  */
-  __pyx_t_12 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 700, __pyx_L1_error)
+  __pyx_t_12 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_delta_t, __pyx_t_12) < 0) __PYX_ERR(0, 700, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_delta_t, __pyx_t_12) < 0) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-  /* "cssm.pyx":701
+  /* "cssm.pyx":821
  *                                                           **drift_params,
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ddm_flex',
  */
-  __pyx_t_12 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 701, __pyx_L1_error)
+  __pyx_t_12 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_max_t, __pyx_t_12) < 0) __PYX_ERR(0, 701, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_max_t, __pyx_t_12) < 0) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-  /* "cssm.pyx":702
+  /* "cssm.pyx":822
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                           'simulator': 'ddm_flex',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 702, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 822, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_n_samples, __pyx_t_12) < 0) __PYX_ERR(0, 702, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_n_samples, __pyx_t_12) < 0) __PYX_ERR(0, 822, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_simulator, __pyx_n_u_ddm_flex) < 0) __PYX_ERR(0, 703, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_simulator, __pyx_n_u_ddm_flex) < 0) __PYX_ERR(0, 823, __pyx_L1_error)
 
-  /* "cssm.pyx":704
+  /* "cssm.pyx":824
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ddm_flex',
  *                                                           'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                           'drift_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],
  */
-  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 704, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 824, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_boundary_fun_type, __pyx_t_12) < 0) __PYX_ERR(0, 704, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_boundary_fun_type, __pyx_t_12) < 0) __PYX_ERR(0, 824, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-  /* "cssm.pyx":705
+  /* "cssm.pyx":825
  *                                                           'simulator': 'ddm_flex',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'drift_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  */
-  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 705, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_drift_fun_type, __pyx_t_12) < 0) __PYX_ERR(0, 705, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_drift_fun_type, __pyx_t_12) < 0) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-  /* "cssm.pyx":706
+  /* "cssm.pyx":826
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'drift_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],             # <<<<<<<<<<<<<<
  *                                                           'trajectory': traj,
  *                                                           'drift': drift,
  */
-  __pyx_t_12 = PyList_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 706, __pyx_L1_error)
+  __pyx_t_12 = PyList_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 826, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_12, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_12, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_possible_choices, __pyx_t_12) < 0) __PYX_ERR(0, 706, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_possible_choices, __pyx_t_12) < 0) __PYX_ERR(0, 826, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-  /* "cssm.pyx":707
+  /* "cssm.pyx":827
  *                                                           'drift_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,             # <<<<<<<<<<<<<<
  *                                                           'drift': drift,
  *                                                           'boundary': boundary}}
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 707, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 827, __pyx_L1_error)
 
-  /* "cssm.pyx":708
+  /* "cssm.pyx":828
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  *                                                           'drift': drift,             # <<<<<<<<<<<<<<
  *                                                           'boundary': boundary}}
  * # ----------------------------------------------------------------------------------------------------
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_drift, __pyx_v_drift) < 0) __PYX_ERR(0, 708, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_drift, __pyx_v_drift) < 0) __PYX_ERR(0, 828, __pyx_L1_error)
 
-  /* "cssm.pyx":709
+  /* "cssm.pyx":829
  *                                                           'trajectory': traj,
  *                                                           'drift': drift,
  *                                                           'boundary': boundary}}             # <<<<<<<<<<<<<<
  * # ----------------------------------------------------------------------------------------------------
  * 
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 709, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_5) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 829, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_5) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":595
+  /* "cssm.pyx":715
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flex(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *              np.ndarray[float, ndim = 1] a,
  *              np.ndarray[float, ndim = 1] z,
  */
 
@@ -11658,33 +13400,33 @@
   __Pyx_XDECREF(__pyx_v_boundary);
   __Pyx_XDECREF(__pyx_v_drift);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_drift_view, 1);
   __Pyx_XDECREF(__pyx_v_drift_params_tmp);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
-  __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_key);
   __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_key);
+  __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":716
+/* "cssm.pyx":836
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_max(float v = 0.0,             # <<<<<<<<<<<<<<
  *                       float a = 1.0,
  *                       float z = 0.5,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_13ddm_flexbound_max(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_13ddm_flexbound_max = {"ddm_flexbound_max", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_13ddm_flexbound_max, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_13ddm_flexbound_max(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_15ddm_flexbound_max(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_15ddm_flexbound_max = {"ddm_flexbound_max", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_15ddm_flexbound_max, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_15ddm_flexbound_max(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   float __pyx_v_v;
   float __pyx_v_a;
   float __pyx_v_z;
   float __pyx_v_t;
   float __pyx_v_s;
   float __pyx_v_delta_t;
   float __pyx_v_max_t;
@@ -11699,34 +13441,34 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ddm_flexbound_max (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":724
+    /* "cssm.pyx":844
  *                       float max_t = 20,
  *                       int n_samples = 20000,
  *                       boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *                       boundary_multiplicative = True,
  *                       boundary_params = {},
  */
     values[8] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":725
+    /* "cssm.pyx":845
  *                       int n_samples = 20000,
  *                       boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                       boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *                       boundary_params = {},
  *                       random_state = None,
  */
     values[9] = ((PyObject *)Py_True);
-    values[10] = __pyx_k__6;
+    values[10] = __pyx_k__7;
 
-    /* "cssm.pyx":727
+    /* "cssm.pyx":847
  *                       boundary_multiplicative = True,
  *                       boundary_params = {},
  *                       random_state = None,             # <<<<<<<<<<<<<<
  *                       ):
  * 
  */
     values[11] = ((PyObject *)Py_None);
@@ -11832,15 +13574,15 @@
         case 11:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[11] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_max") < 0)) __PYX_ERR(0, 716, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_max") < 0)) __PYX_ERR(0, 836, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 12: values[11] = PyTuple_GET_ITEM(__pyx_args, 11);
         CYTHON_FALLTHROUGH;
         case 11: values[10] = PyTuple_GET_ITEM(__pyx_args, 10);
         CYTHON_FALLTHROUGH;
@@ -11865,82 +13607,82 @@
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     if (values[0]) {
-      __pyx_v_v = __pyx_PyFloat_AsFloat(values[0]); if (unlikely((__pyx_v_v == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 716, __pyx_L3_error)
+      __pyx_v_v = __pyx_PyFloat_AsFloat(values[0]); if (unlikely((__pyx_v_v == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 836, __pyx_L3_error)
     } else {
       __pyx_v_v = ((float)0.0);
     }
     if (values[1]) {
-      __pyx_v_a = __pyx_PyFloat_AsFloat(values[1]); if (unlikely((__pyx_v_a == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 717, __pyx_L3_error)
+      __pyx_v_a = __pyx_PyFloat_AsFloat(values[1]); if (unlikely((__pyx_v_a == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 837, __pyx_L3_error)
     } else {
       __pyx_v_a = ((float)1.0);
     }
     if (values[2]) {
-      __pyx_v_z = __pyx_PyFloat_AsFloat(values[2]); if (unlikely((__pyx_v_z == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 718, __pyx_L3_error)
+      __pyx_v_z = __pyx_PyFloat_AsFloat(values[2]); if (unlikely((__pyx_v_z == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 838, __pyx_L3_error)
     } else {
       __pyx_v_z = ((float)0.5);
     }
     if (values[3]) {
-      __pyx_v_t = __pyx_PyFloat_AsFloat(values[3]); if (unlikely((__pyx_v_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 719, __pyx_L3_error)
+      __pyx_v_t = __pyx_PyFloat_AsFloat(values[3]); if (unlikely((__pyx_v_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 839, __pyx_L3_error)
     } else {
       __pyx_v_t = ((float)0.5);
     }
     if (values[4]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 720, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[4]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 840, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[5]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 721, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 841, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[6]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 722, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 842, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[7]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 723, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 843, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     __pyx_v_boundary_fun = values[8];
     __pyx_v_boundary_multiplicative = values[9];
     __pyx_v_boundary_params = values[10];
     __pyx_v_random_state = values[11];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_max", 0, 0, 12, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 716, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_max", 0, 0, 12, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 836, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ddm_flexbound_max", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_4cssm_12ddm_flexbound_max(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  __pyx_r = __pyx_pf_4cssm_14ddm_flexbound_max(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":716
+  /* "cssm.pyx":836
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_max(float v = 0.0,             # <<<<<<<<<<<<<<
  *                       float a = 1.0,
  *                       float z = 0.5,
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_12ddm_flexbound_max(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_v, float __pyx_v_a, float __pyx_v_z, float __pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_14ddm_flexbound_max(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_v, float __pyx_v_a, float __pyx_v_z, float __pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   PyObject *__pyx_v_rts = NULL;
   PyObject *__pyx_v_choices = NULL;
   __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   float __pyx_v_delta_t_sqrt;
   float __pyx_v_sqrt_st;
   int __pyx_v_num_draws;
@@ -11973,176 +13715,176 @@
   Py_ssize_t __pyx_t_16;
   int __pyx_t_17;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("ddm_flexbound_max", 0);
 
-  /* "cssm.pyx":730
+  /* "cssm.pyx":850
  *                       ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     rts = np.zeros((n_samples, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, 1), dtype = np.intc)
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":731
+  /* "cssm.pyx":851
  * 
  *     set_seed(random_state)
  *     rts = np.zeros((n_samples, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 731, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rts = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "cssm.pyx":732
+  /* "cssm.pyx":852
  *     set_seed(random_state)
  *     rts = np.zeros((n_samples, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_intc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_intc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 732, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":734
+  /* "cssm.pyx":854
  *     choices = np.zeros((n_samples, 1), dtype = np.intc)
  * 
  *     cdef float[:, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :] choices_view = choices
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 854, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":735
+  /* "cssm.pyx":855
  * 
  *     cdef float[:, :] rts_view = rts
  *     cdef int[:, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 735, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 855, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "cssm.pyx":737
+  /* "cssm.pyx":857
  *     cdef int[:, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":738
+  /* "cssm.pyx":858
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage for the upper bound
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":741
+  /* "cssm.pyx":861
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":742
+  /* "cssm.pyx":862
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_8 = NULL;
   __pyx_t_9 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_8)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -12151,176 +13893,176 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_9 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_int_0, __pyx_t_4, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_int_0, __pyx_t_4, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   {
-    __pyx_t_10 = PyTuple_New(3+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_10 = PyTuple_New(3+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     if (__pyx_t_8) {
       __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_9, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_9, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_9, __pyx_t_2);
     __pyx_t_4 = 0;
     __pyx_t_2 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_10 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_10);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_5 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_10, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 742, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_t_s = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":743
+  /* "cssm.pyx":863
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_10) < 0) __PYX_ERR(0, 743, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_10) < 0) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_boundary = __pyx_t_10;
   __pyx_t_10 = 0;
 
-  /* "cssm.pyx":749
+  /* "cssm.pyx":869
  *     cdef Py_ssize_t n
  *     cdef Py_ssize_t ix
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t k
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":751
+  /* "cssm.pyx":871
  *     cdef Py_ssize_t m = 0
  *     cdef Py_ssize_t k
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __pyx_t_11 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 751, __pyx_L1_error)
+  __pyx_t_11 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 871, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_11;
   __pyx_t_11.memview = NULL;
   __pyx_t_11.data = NULL;
 
-  /* "cssm.pyx":752
+  /* "cssm.pyx":872
  *     cdef Py_ssize_t k
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     # Loop over samples
  */
-  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 752, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 872, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_11;
   __pyx_t_11.memview = NULL;
   __pyx_t_11.data = NULL;
 
-  /* "cssm.pyx":756
+  /* "cssm.pyx":876
  *     # Loop over samples
  *     # Precompute boundary evaluations
  *     if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *         boundary[:] = np.multiply(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)
  *     else:
  */
-  __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 756, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 876, __pyx_L1_error)
   if (__pyx_t_12) {
 
-    /* "cssm.pyx":757
+    /* "cssm.pyx":877
  *     # Precompute boundary evaluations
  *     if boundary_multiplicative:
  *         boundary[:] = np.multiply(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     else:
  *         boundary[:] = np.add(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 757, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_a); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_a); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 877, __pyx_L1_error)
     __pyx_t_2 = __pyx_t_4;
     __pyx_t_4 = 0;
     if (unlikely(__pyx_v_boundary_params == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-      __PYX_ERR(0, 757, __pyx_L1_error)
+      __PYX_ERR(0, 877, __pyx_L1_error)
     }
-    if (__Pyx_MergeKeywords(__pyx_t_2, __pyx_v_boundary_params) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)
+    if (__Pyx_MergeKeywords(__pyx_t_2, __pyx_v_boundary_params) < 0) __PYX_ERR(0, 877, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     __pyx_t_9 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_2)) {
@@ -12330,108 +14072,108 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_9 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_1, __pyx_t_4};
-      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_1, __pyx_t_4};
-      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     {
-      __pyx_t_8 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 757, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       if (__pyx_t_2) {
         __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_2); __pyx_t_2 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_9, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_9, __pyx_t_4);
       __pyx_t_1 = 0;
       __pyx_t_4 = 0;
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 877, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 757, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_10 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_8, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 757, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_10, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
+    if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_10, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "cssm.pyx":756
+    /* "cssm.pyx":876
  *     # Loop over samples
  *     # Precompute boundary evaluations
  *     if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *         boundary[:] = np.multiply(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)
  *     else:
  */
     goto __pyx_L3;
   }
 
-  /* "cssm.pyx":759
+  /* "cssm.pyx":879
  *         boundary[:] = np.multiply(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)
  *     else:
  *         boundary[:] = np.add(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *     for n in range(n_samples):
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 759, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_add); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 759, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_add); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyFloat_FromDouble(__pyx_v_a); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 759, __pyx_L1_error)
+    __pyx_t_5 = PyFloat_FromDouble(__pyx_v_a); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 759, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 879, __pyx_L1_error)
     __pyx_t_4 = __pyx_t_1;
     __pyx_t_1 = 0;
     if (unlikely(__pyx_v_boundary_params == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-      __PYX_ERR(0, 759, __pyx_L1_error)
+      __PYX_ERR(0, 879, __pyx_L1_error)
     }
-    if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params) < 0) __PYX_ERR(0, 759, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)
+    if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params) < 0) __PYX_ERR(0, 879, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     __pyx_t_9 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_4)) {
@@ -12441,116 +14183,116 @@
         __Pyx_DECREF_SET(__pyx_t_8, function);
         __pyx_t_9 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_8)) {
       PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_5, __pyx_t_1};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 759, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 879, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_8)) {
       PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_5, __pyx_t_1};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 759, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 879, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     {
-      __pyx_t_2 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 759, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 879, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       if (__pyx_t_4) {
         __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_9, __pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_9, __pyx_t_1);
       __pyx_t_5 = 0;
       __pyx_t_1 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 759, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 879, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 759, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 759, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_8, function);
       }
     }
     __pyx_t_10 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 759, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_10, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 759, __pyx_L1_error)
+    if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_10, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   }
   __pyx_L3:;
 
-  /* "cssm.pyx":761
+  /* "cssm.pyx":881
  *         boundary[:] = np.add(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)
  * 
  *     for n in range(n_samples):             # <<<<<<<<<<<<<<
  *         y = (-1) * boundary_view[0] + (z * 2 * (boundary_view[0]))  # reset starting position
  *         t_particle = 0.0 # reset time
  */
   __pyx_t_9 = __pyx_v_n_samples;
   __pyx_t_13 = __pyx_t_9;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_n = __pyx_t_14;
 
-    /* "cssm.pyx":762
+    /* "cssm.pyx":882
  * 
  *     for n in range(n_samples):
  *         y = (-1) * boundary_view[0] + (z * 2 * (boundary_view[0]))  # reset starting position             # <<<<<<<<<<<<<<
  *         t_particle = 0.0 # reset time
  *         ix = 0 # reset boundary index
  */
     __pyx_t_15 = 0;
     __pyx_t_16 = 0;
     __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_15 * __pyx_v_boundary_view.strides[0]) )))) + ((__pyx_v_z * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_16 * __pyx_v_boundary_view.strides[0]) )))));
 
-    /* "cssm.pyx":763
+    /* "cssm.pyx":883
  *     for n in range(n_samples):
  *         y = (-1) * boundary_view[0] + (z * 2 * (boundary_view[0]))  # reset starting position
  *         t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *         ix = 0 # reset boundary index
  * 
  */
     __pyx_v_t_particle = 0.0;
 
-    /* "cssm.pyx":764
+    /* "cssm.pyx":884
  *         y = (-1) * boundary_view[0] + (z * 2 * (boundary_view[0]))  # reset starting position
  *         t_particle = 0.0 # reset time
  *         ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *         # Random walker
  */
     __pyx_v_ix = 0;
 
-    /* "cssm.pyx":767
+    /* "cssm.pyx":887
  * 
  *         # Random walker
  *         while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *             y += (v * delta_t) + (sqrt_st * gaussian_values[m])
  *             t_particle += delta_t
  */
     while (1) {
@@ -12569,283 +14311,283 @@
         goto __pyx_L8_bool_binop_done;
       }
       __pyx_t_17 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
       __pyx_t_12 = __pyx_t_17;
       __pyx_L8_bool_binop_done:;
       if (!__pyx_t_12) break;
 
-      /* "cssm.pyx":768
+      /* "cssm.pyx":888
  *         # Random walker
  *         while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *             y += (v * delta_t) + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *             t_particle += delta_t
  *             ix += 1
  */
       __pyx_t_16 = __pyx_v_m;
       __pyx_v_y = (__pyx_v_y + ((__pyx_v_v * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_16 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-      /* "cssm.pyx":769
+      /* "cssm.pyx":889
  *         while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *             y += (v * delta_t) + (sqrt_st * gaussian_values[m])
  *             t_particle += delta_t             # <<<<<<<<<<<<<<
  *             ix += 1
  *             m += 1
  */
       __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-      /* "cssm.pyx":770
+      /* "cssm.pyx":890
  *             y += (v * delta_t) + (sqrt_st * gaussian_values[m])
  *             t_particle += delta_t
  *             ix += 1             # <<<<<<<<<<<<<<
  *             m += 1
  * 
  */
       __pyx_v_ix = (__pyx_v_ix + 1);
 
-      /* "cssm.pyx":771
+      /* "cssm.pyx":891
  *             t_particle += delta_t
  *             ix += 1
  *             m += 1             # <<<<<<<<<<<<<<
  * 
  *             # Can improve with less checks
  */
       __pyx_v_m = (__pyx_v_m + 1);
 
-      /* "cssm.pyx":774
+      /* "cssm.pyx":894
  * 
  *             # Can improve with less checks
  *             if m == num_draws:             # <<<<<<<<<<<<<<
  *                 gaussian_values = draw_gaussian(num_draws)
  *                 m = 0
  */
       __pyx_t_12 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
       if (__pyx_t_12) {
 
-        /* "cssm.pyx":775
+        /* "cssm.pyx":895
  *             # Can improve with less checks
  *             if m == num_draws:
  *                 gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                 m = 0
  * 
  */
-        __pyx_t_11 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 775, __pyx_L1_error)
+        __pyx_t_11 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 895, __pyx_L1_error)
         __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
         __pyx_v_gaussian_values = __pyx_t_11;
         __pyx_t_11.memview = NULL;
         __pyx_t_11.data = NULL;
 
-        /* "cssm.pyx":776
+        /* "cssm.pyx":896
  *             if m == num_draws:
  *                 gaussian_values = draw_gaussian(num_draws)
  *                 m = 0             # <<<<<<<<<<<<<<
  * 
  *         rts_view[n, 0] = t_particle + t # Store rt
  */
         __pyx_v_m = 0;
 
-        /* "cssm.pyx":774
+        /* "cssm.pyx":894
  * 
  *             # Can improve with less checks
  *             if m == num_draws:             # <<<<<<<<<<<<<<
  *                 gaussian_values = draw_gaussian(num_draws)
  *                 m = 0
  */
       }
     }
 
-    /* "cssm.pyx":778
+    /* "cssm.pyx":898
  *                 m = 0
  * 
  *         rts_view[n, 0] = t_particle + t # Store rt             # <<<<<<<<<<<<<<
  *         choices_view[n, 0] = sign(y) # Store choice
  * 
  */
     __pyx_t_16 = __pyx_v_n;
     __pyx_t_15 = 0;
     *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_16 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_15 * __pyx_v_rts_view.strides[1]) )) = (__pyx_v_t_particle + __pyx_v_t);
 
-    /* "cssm.pyx":779
+    /* "cssm.pyx":899
  * 
  *         rts_view[n, 0] = t_particle + t # Store rt
  *         choices_view[n, 0] = sign(y) # Store choice             # <<<<<<<<<<<<<<
  * 
  * 
  */
     __pyx_t_15 = __pyx_v_n;
     __pyx_t_16 = 0;
     *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_15 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_16 * __pyx_v_choices_view.strides[1]) )) = __pyx_f_4cssm_sign(__pyx_v_y);
   }
 
-  /* "cssm.pyx":782
+  /* "cssm.pyx":902
  * 
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                           'a': a,
  *                                                           'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_10 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 902, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 782, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 782, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 782, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 902, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 902, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 902, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_v); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_v); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 902, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_v, __pyx_t_2) < 0) __PYX_ERR(0, 782, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_v, __pyx_t_2) < 0) __PYX_ERR(0, 902, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":783
+  /* "cssm.pyx":903
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  *                                                           'a': a,             # <<<<<<<<<<<<<<
  *                                                           'z': z,
  *                                                           't': t,
  */
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_a); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 783, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_a); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, __pyx_t_2) < 0) __PYX_ERR(0, 782, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, __pyx_t_2) < 0) __PYX_ERR(0, 902, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":784
+  /* "cssm.pyx":904
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  *                                                           'a': a,
  *                                                           'z': z,             # <<<<<<<<<<<<<<
  *                                                           't': t,
  *                                                           's': s,
  */
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_z); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 784, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_z); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 904, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_z, __pyx_t_2) < 0) __PYX_ERR(0, 782, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_z, __pyx_t_2) < 0) __PYX_ERR(0, 902, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":785
+  /* "cssm.pyx":905
  *                                                           'a': a,
  *                                                           'z': z,
  *                                                           't': t,             # <<<<<<<<<<<<<<
  *                                                           's': s,
  *                                                           **boundary_params,
  */
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_t); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_t); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, __pyx_t_2) < 0) __PYX_ERR(0, 782, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, __pyx_t_2) < 0) __PYX_ERR(0, 902, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":786
+  /* "cssm.pyx":906
  *                                                           'z': z,
  *                                                           't': t,
  *                                                           's': s,             # <<<<<<<<<<<<<<
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  */
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 906, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_2) < 0) __PYX_ERR(0, 782, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_2) < 0) __PYX_ERR(0, 902, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_8 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":787
+  /* "cssm.pyx":907
  *                                                           't': t,
  *                                                           's': s,
  *                                                           **boundary_params,             # <<<<<<<<<<<<<<
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 787, __pyx_L1_error)
+    __PYX_ERR(0, 907, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_8, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 787, __pyx_L1_error)
+    __PYX_ERR(0, 907, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":788
+  /* "cssm.pyx":908
  *                                                           's': s,
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 788, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 908, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":789
+  /* "cssm.pyx":909
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ddm_flexbound',
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 789, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 789, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 909, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":790
+  /* "cssm.pyx":910
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                           'simulator': 'ddm_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 790, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 790, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) < 0) __PYX_ERR(0, 791, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) < 0) __PYX_ERR(0, 911, __pyx_L1_error)
 
-  /* "cssm.pyx":792
+  /* "cssm.pyx":912
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ddm_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                           'possible_choices': [-1, 1],
  *                                                           'boundary': boundary}}
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 792, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 912, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_boundary_fun_type, __pyx_t_3) < 0) __PYX_ERR(0, 792, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_boundary_fun_type, __pyx_t_3) < 0) __PYX_ERR(0, 912, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":793
+  /* "cssm.pyx":913
  *                                                           'simulator': 'ddm_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],             # <<<<<<<<<<<<<<
  *                                                           'boundary': boundary}}
  * # ----------------------------------------------------------------------------------------------------
  */
-  __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 793, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 913, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 793, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 913, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":794
+  /* "cssm.pyx":914
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],
  *                                                           'boundary': boundary}}             # <<<<<<<<<<<<<<
  * # ----------------------------------------------------------------------------------------------------
  * 
  */
-  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 794, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_metadata, __pyx_t_8) < 0) __PYX_ERR(0, 782, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_8, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 914, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_metadata, __pyx_t_8) < 0) __PYX_ERR(0, 902, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __pyx_r = __pyx_t_10;
   __pyx_t_10 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":716
+  /* "cssm.pyx":836
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_max(float v = 0.0,             # <<<<<<<<<<<<<<
  *                       float a = 1.0,
  *                       float z = 0.5,
  */
 
@@ -12873,26 +14615,26 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":803
+/* "cssm.pyx":923
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def glob_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                    np.ndarray[float, ndim = 1] a,
  *                    np.ndarray[float, ndim = 1] z,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_15glob_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_15glob_flexbound = {"glob_flexbound", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_15glob_flexbound, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_15glob_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_17glob_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_17glob_flexbound = {"glob_flexbound", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_17glob_flexbound, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_17glob_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z = 0;
   PyArrayObject *__pyx_v_alphar = 0;
   PyArrayObject *__pyx_v_g = 0;
   PyArrayObject *__pyx_v_t = 0;
   float __pyx_v_s;
@@ -12910,34 +14652,34 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("glob_flexbound (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_alphar,&__pyx_n_s_g,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[15] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":814
+    /* "cssm.pyx":934
  *                    int n_samples = 20000,
  *                    int n_trials = 1,
  *                    boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *                    boundary_multiplicative = True,
  *                    boundary_params = {},
  */
     values[11] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":815
+    /* "cssm.pyx":935
  *                    int n_trials = 1,
  *                    boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                    boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *                    boundary_params = {},
  *                    random_state = None,
  */
     values[12] = ((PyObject *)Py_True);
-    values[13] = __pyx_k__7;
+    values[13] = __pyx_k__8;
 
-    /* "cssm.pyx":817
+    /* "cssm.pyx":937
  *                    boundary_multiplicative = True,
  *                    boundary_params = {},
  *                    random_state = None,             # <<<<<<<<<<<<<<
  *                    ):
  * 
  */
     values[14] = ((PyObject *)Py_None);
@@ -12983,39 +14725,39 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, 1); __PYX_ERR(0, 803, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, 1); __PYX_ERR(0, 923, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, 2); __PYX_ERR(0, 803, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, 2); __PYX_ERR(0, 923, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_alphar)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, 3); __PYX_ERR(0, 803, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, 3); __PYX_ERR(0, 923, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, 4); __PYX_ERR(0, 803, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, 4); __PYX_ERR(0, 923, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, 5); __PYX_ERR(0, 803, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, 5); __PYX_ERR(0, 923, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[6] = value; kw_args--; }
         }
@@ -13065,15 +14807,15 @@
         case 14:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[14] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "glob_flexbound") < 0)) __PYX_ERR(0, 803, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "glob_flexbound") < 0)) __PYX_ERR(0, 923, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 15: values[14] = PyTuple_GET_ITEM(__pyx_args, 14);
         CYTHON_FALLTHROUGH;
         case 14: values[13] = PyTuple_GET_ITEM(__pyx_args, 13);
         CYTHON_FALLTHROUGH;
@@ -13104,60 +14846,60 @@
     __pyx_v_v = ((PyArrayObject *)values[0]);
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_alphar = ((PyArrayObject *)values[3]);
     __pyx_v_g = ((PyArrayObject *)values[4]);
     __pyx_v_t = ((PyArrayObject *)values[5]);
     if (values[6]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 809, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 929, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[7]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 810, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 930, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[8]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 811, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 931, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[9]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 812, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 932, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[10]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[10]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 813, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[10]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 933, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_boundary_fun = values[11];
     __pyx_v_boundary_multiplicative = values[12];
     __pyx_v_boundary_params = values[13];
     __pyx_v_random_state = values[14];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 803, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("glob_flexbound", 0, 6, 15, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 923, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.glob_flexbound", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 803, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 804, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 805, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_alphar), __pyx_ptype_5numpy_ndarray, 1, "alphar", 0))) __PYX_ERR(0, 806, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) __PYX_ERR(0, 807, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 808, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_14glob_flexbound(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_alphar, __pyx_v_g, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 923, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 924, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 925, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_alphar), __pyx_ptype_5numpy_ndarray, 1, "alphar", 0))) __PYX_ERR(0, 926, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) __PYX_ERR(0, 927, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 928, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_16glob_flexbound(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_alphar, __pyx_v_g, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":803
+  /* "cssm.pyx":923
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def glob_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                    np.ndarray[float, ndim = 1] a,
  *                    np.ndarray[float, ndim = 1] z,
  */
 
@@ -13166,15 +14908,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_14glob_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_alphar, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_16glob_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_alphar, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_alphar_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_g_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_traj = NULL;
@@ -13192,15 +14934,15 @@
   float __pyx_v_t_particle;
   Py_ssize_t __pyx_v_n;
   Py_ssize_t __pyx_v_ix;
   Py_ssize_t __pyx_v_k;
   Py_ssize_t __pyx_v_m;
   __Pyx_memviewslice __pyx_v_alpha_stable_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
-  PyObject *__pyx_8genexpr3__pyx_v_key = NULL;
+  PyObject *__pyx_8genexpr4__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_alphar;
   __Pyx_Buffer __pyx_pybuffer_alphar;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
   __Pyx_Buffer __pyx_pybuffer_g;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
@@ -13261,334 +15003,334 @@
   __pyx_pybuffernd_g.rcbuffer = &__pyx_pybuffer_g;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 803, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 923, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 803, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 923, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 803, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 923, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_alphar.rcbuffer->pybuffer, (PyObject*)__pyx_v_alphar, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 803, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_alphar.rcbuffer->pybuffer, (PyObject*)__pyx_v_alphar, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 923, __pyx_L1_error)
   }
   __pyx_pybuffernd_alphar.diminfo[0].strides = __pyx_pybuffernd_alphar.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_alphar.diminfo[0].shape = __pyx_pybuffernd_alphar.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g.rcbuffer->pybuffer, (PyObject*)__pyx_v_g, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 803, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g.rcbuffer->pybuffer, (PyObject*)__pyx_v_g, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 923, __pyx_L1_error)
   }
   __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 803, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 923, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":820
+  /* "cssm.pyx":940
  *                    ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
  *     # Param views:
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 820, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 940, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":823
+  /* "cssm.pyx":943
  *     #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
  *     # Param views:
  *     cdef float[:] v_view  = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 823, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 943, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":824
+  /* "cssm.pyx":944
  *     # Param views:
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] alphar_view = alphar
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 824, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 944, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":825
+  /* "cssm.pyx":945
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] alphar_view = alphar
  *     cdef float[:] g_view = g
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 825, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 945, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":826
+  /* "cssm.pyx":946
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] alphar_view = alphar             # <<<<<<<<<<<<<<
  *     cdef float[:] g_view = g
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_alphar), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 826, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_alphar), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 946, __pyx_L1_error)
   __pyx_v_alphar_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":827
+  /* "cssm.pyx":947
  *     cdef float[:] z_view = z
  *     cdef float[:] alphar_view = alphar
  *     cdef float[:] g_view = g             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_g), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 827, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_g), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_v_g_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":828
+  /* "cssm.pyx":948
  *     cdef float[:] alphar_view = alphar
  *     cdef float[:] g_view = g
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     # Data-struct for trajectory storage
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 828, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":831
+  /* "cssm.pyx":951
  * 
  *     # Data-struct for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 951, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_traj = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":832
+  /* "cssm.pyx":952
  *     # Data-struct for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:,:] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 832, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 952, __pyx_L1_error)
 
-  /* "cssm.pyx":833
+  /* "cssm.pyx":953
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 833, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 953, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":835
+  /* "cssm.pyx":955
  *     cdef float[:,:] traj_view = traj
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 835, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rts = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":836
+  /* "cssm.pyx":956
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:,:, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 836, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 956, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":838
+  /* "cssm.pyx":958
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:,:, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:,:, :] choices_view = choices
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 958, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":839
+  /* "cssm.pyx":959
  * 
  *     cdef float[:,:, :] rts_view = rts
  *     cdef int[:,:, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_alpha # = pow(delta_t, 1.0 / alpha_diff) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 839, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 959, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":844
+  /* "cssm.pyx":964
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":845
+  /* "cssm.pyx":965
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 965, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 965, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 965, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 965, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_10 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -13597,242 +15339,242 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 965, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 965, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 965, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_10) {
       __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 965, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 965, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 965, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_12 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_12)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_12);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_7 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 845, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 965, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_t_s = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":846
+  /* "cssm.pyx":966
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 846, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 846, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 846, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 846, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 846, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 846, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 846, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 846, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_boundary = __pyx_t_12;
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":847
+  /* "cssm.pyx":967
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     cdef float y, t_particle
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 847, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 967, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":853
+  /* "cssm.pyx":973
  *     cdef Py_ssize_t ix
  *     cdef Py_ssize_t k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     #cdef int n, ix
  *     #cdef int m = 0
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":856
+  /* "cssm.pyx":976
  *     #cdef int n, ix
  *     #cdef int m = 0
  *     cdef float[:] alpha_stable_values = draw_random_stable(num_draws, alphar_view[0])             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
   __pyx_t_13 = 0;
-  __pyx_t_2 = __pyx_f_4cssm_draw_random_stable(__pyx_v_num_draws, (*((float *) ( /* dim=0 */ (__pyx_v_alphar_view.data + __pyx_t_13 * __pyx_v_alphar_view.strides[0]) )))); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 856, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_random_stable(__pyx_v_num_draws, (*((float *) ( /* dim=0 */ (__pyx_v_alphar_view.data + __pyx_t_13 * __pyx_v_alphar_view.strides[0]) )))); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 976, __pyx_L1_error)
   __pyx_v_alpha_stable_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":858
+  /* "cssm.pyx":978
  *     cdef float[:] alpha_stable_values = draw_random_stable(num_draws, alphar_view[0])
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         delta_t_alpha = s * pow(delta_t, 1.0 / alphar_view[k])
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_11 = __pyx_v_n_trials;
   __pyx_t_14 = __pyx_t_11;
   for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
     __pyx_v_k = __pyx_t_15;
 
-    /* "cssm.pyx":859
+    /* "cssm.pyx":979
  * 
  *     for k in range(n_trials):
  *         delta_t_alpha = s * pow(delta_t, 1.0 / alphar_view[k])             # <<<<<<<<<<<<<<
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  * 
  */
     __pyx_t_13 = __pyx_v_k;
     __pyx_v_delta_t_alpha = (__pyx_v_s * pow(__pyx_v_delta_t, (1.0 / ((double)(*((float *) ( /* dim=0 */ (__pyx_v_alphar_view.data + __pyx_t_13 * __pyx_v_alphar_view.strides[0]) )))))));
 
-    /* "cssm.pyx":860
+    /* "cssm.pyx":980
  *     for k in range(n_trials):
  *         delta_t_alpha = s * pow(delta_t, 1.0 / alphar_view[k])
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         # Precompute boundary evaluations
  */
     { /* enter inner scope */
-      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 860, __pyx_L7_error)
+      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 980, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_12);
       __pyx_t_16 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 860, __pyx_L7_error)
+        __PYX_ERR(0, 980, __pyx_L7_error)
       }
-      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_17), (&__pyx_t_18)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 860, __pyx_L7_error)
+      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_17), (&__pyx_t_18)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF(__pyx_t_7);
       __pyx_t_7 = __pyx_t_1;
       __pyx_t_1 = 0;
       while (1) {
         __pyx_t_19 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_17, &__pyx_t_16, &__pyx_t_1, NULL, NULL, __pyx_t_18);
         if (unlikely(__pyx_t_19 == 0)) break;
-        if (unlikely(__pyx_t_19 == -1)) __PYX_ERR(0, 860, __pyx_L7_error)
+        if (unlikely(__pyx_t_19 == -1)) __PYX_ERR(0, 980, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_XDECREF_SET(__pyx_8genexpr3__pyx_v_key, __pyx_t_1);
+        __Pyx_XDECREF_SET(__pyx_8genexpr4__pyx_v_key, __pyx_t_1);
         __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr3__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 860, __pyx_L7_error)
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr4__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L7_error)
+        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 980, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr3__pyx_v_key, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 860, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr4__pyx_v_key, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 980, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_key); __pyx_8genexpr3__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_key); __pyx_8genexpr4__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_key); __pyx_8genexpr3__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_key); __pyx_8genexpr4__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_12));
     __pyx_t_12 = 0;
 
-    /* "cssm.pyx":863
+    /* "cssm.pyx":983
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-    __pyx_t_20 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_20 < 0)) __PYX_ERR(0, 863, __pyx_L1_error)
+    __pyx_t_20 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_20 < 0)) __PYX_ERR(0, 983, __pyx_L1_error)
     if (__pyx_t_20) {
 
-      /* "cssm.pyx":865
+      /* "cssm.pyx":985
  *         if boundary_multiplicative:
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             # print(a)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 865, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 985, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 865, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_13 = __pyx_v_k;
-      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_13 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 865, __pyx_L1_error)
+      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_13 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 985, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 865, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 865, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 985, __pyx_L1_error)
       __pyx_t_5 = __pyx_t_4;
       __pyx_t_4 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 865, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 865, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 985, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_5 = NULL;
       __pyx_t_18 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_5)) {
@@ -13842,105 +15584,105 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_18 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
-        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 865, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
-        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 865, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_10 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 865, __pyx_L1_error)
+        __pyx_t_10 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         if (__pyx_t_5) {
           __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5); __pyx_t_5 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_18, __pyx_t_3);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_18, __pyx_t_4);
         __pyx_t_3 = 0;
         __pyx_t_4 = 0;
-        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 865, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 865, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 865, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 985, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 865, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 985, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 865, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 985, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-      /* "cssm.pyx":863
+      /* "cssm.pyx":983
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":868
+    /* "cssm.pyx":988
  *         else:
  *             # print(a)
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Loop over samples
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 868, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 988, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 868, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 988, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_13 = __pyx_v_k;
-      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_13 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 868, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_13 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 988, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 988, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 868, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 988, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_3;
       __pyx_t_3 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 868, __pyx_L1_error)
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 988, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 988, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_18 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_4)) {
@@ -13950,166 +15692,166 @@
           __Pyx_DECREF_SET(__pyx_t_10, function);
           __pyx_t_18 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_3};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 868, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 988, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_3};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 868, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 988, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       {
-        __pyx_t_5 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 868, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 988, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_18, __pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_18, __pyx_t_3);
         __pyx_t_7 = 0;
         __pyx_t_3 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 868, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 988, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       }
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 868, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 988, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 868, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 988, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
       __pyx_t_12 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 868, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 988, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 868, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 988, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":871
+    /* "cssm.pyx":991
  * 
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time
  */
     __pyx_t_18 = __pyx_v_n_samples;
     __pyx_t_19 = __pyx_t_18;
     for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_19; __pyx_t_17+=1) {
       __pyx_v_n = __pyx_t_17;
 
-      /* "cssm.pyx":872
+      /* "cssm.pyx":992
  *         # Loop over samples
  *         for n in range(n_samples):
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position             # <<<<<<<<<<<<<<
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index
  */
       __pyx_t_13 = 0;
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_22 = 0;
       __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_13 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_21 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_22 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":873
+      /* "cssm.pyx":993
  *         for n in range(n_samples):
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  *             if n == 0:
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":874
+      /* "cssm.pyx":994
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  *             if n == 0:
  *                 if k == 0:
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":875
+      /* "cssm.pyx":995
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       __pyx_t_20 = ((__pyx_v_n == 0) != 0);
       if (__pyx_t_20) {
 
-        /* "cssm.pyx":876
+        /* "cssm.pyx":996
  *             ix = 0 # reset boundary index
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         __pyx_t_20 = ((__pyx_v_k == 0) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":877
+          /* "cssm.pyx":997
  *             if n == 0:
  *                 if k == 0:
  *                     traj_view[0, 0] = y             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
           __pyx_t_22 = 0;
           __pyx_t_21 = 0;
           *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-          /* "cssm.pyx":876
+          /* "cssm.pyx":996
  *             ix = 0 # reset boundary index
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         }
 
-        /* "cssm.pyx":875
+        /* "cssm.pyx":995
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       }
 
-      /* "cssm.pyx":880
+      /* "cssm.pyx":1000
  * 
  *             # Random walker
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 y += ((v_view[k] - (g_view[k] * y)) * delta_t) + (delta_t_alpha * alpha_stable_values[m])
  *                 t_particle += delta_t
  */
       while (1) {
@@ -14128,354 +15870,354 @@
           goto __pyx_L18_bool_binop_done;
         }
         __pyx_t_23 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_20 = __pyx_t_23;
         __pyx_L18_bool_binop_done:;
         if (!__pyx_t_20) break;
 
-        /* "cssm.pyx":881
+        /* "cssm.pyx":1001
  *             # Random walker
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *                 y += ((v_view[k] - (g_view[k] * y)) * delta_t) + (delta_t_alpha * alpha_stable_values[m])             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 ix += 1
  */
         __pyx_t_21 = __pyx_v_k;
         __pyx_t_22 = __pyx_v_k;
         __pyx_t_13 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + ((((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_21 * __pyx_v_v_view.strides[0]) ))) - ((*((float *) ( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_22 * __pyx_v_g_view.strides[0]) ))) * __pyx_v_y)) * __pyx_v_delta_t) + (__pyx_v_delta_t_alpha * (*((float *) ( /* dim=0 */ (__pyx_v_alpha_stable_values.data + __pyx_t_13 * __pyx_v_alpha_stable_values.strides[0]) ))))));
 
-        /* "cssm.pyx":882
+        /* "cssm.pyx":1002
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *                 y += ((v_view[k] - (g_view[k] * y)) * delta_t) + (delta_t_alpha * alpha_stable_values[m])
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":883
+        /* "cssm.pyx":1003
  *                 y += ((v_view[k] - (g_view[k] * y)) * delta_t) + (delta_t_alpha * alpha_stable_values[m])
  *                 t_particle += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  *                 if n == 0:
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":884
+        /* "cssm.pyx":1004
  *                 t_particle += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  *                 if n == 0:
  *                     if k == 0:
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":885
+        /* "cssm.pyx":1005
  *                 ix += 1
  *                 m += 1
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         __pyx_t_20 = ((__pyx_v_n == 0) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":886
+          /* "cssm.pyx":1006
  *                 m += 1
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  */
           __pyx_t_20 = ((__pyx_v_k == 0) != 0);
           if (__pyx_t_20) {
 
-            /* "cssm.pyx":887
+            /* "cssm.pyx":1007
  *                 if n == 0:
  *                     if k == 0:
  *                         traj_view[ix, 0] = y             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     alpha_stable_values = draw_random_stable(num_draws, alphar_view[k])
  */
             __pyx_t_13 = __pyx_v_ix;
             __pyx_t_22 = 0;
             *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_13 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_22 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-            /* "cssm.pyx":886
+            /* "cssm.pyx":1006
  *                 m += 1
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  */
           }
 
-          /* "cssm.pyx":885
+          /* "cssm.pyx":1005
  *                 ix += 1
  *                 m += 1
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         }
 
-        /* "cssm.pyx":888
+        /* "cssm.pyx":1008
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     alpha_stable_values = draw_random_stable(num_draws, alphar_view[k])
  *                     m = 0
  */
         __pyx_t_20 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":889
+          /* "cssm.pyx":1009
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  *                     alpha_stable_values = draw_random_stable(num_draws, alphar_view[k])             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
           __pyx_t_22 = __pyx_v_k;
-          __pyx_t_2 = __pyx_f_4cssm_draw_random_stable(__pyx_v_num_draws, (*((float *) ( /* dim=0 */ (__pyx_v_alphar_view.data + __pyx_t_22 * __pyx_v_alphar_view.strides[0]) )))); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 889, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_random_stable(__pyx_v_num_draws, (*((float *) ( /* dim=0 */ (__pyx_v_alphar_view.data + __pyx_t_22 * __pyx_v_alphar_view.strides[0]) )))); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1009, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_alpha_stable_values, 1);
           __pyx_v_alpha_stable_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":890
+          /* "cssm.pyx":1010
  *                 if m == num_draws:
  *                     alpha_stable_values = draw_random_stable(num_draws, alphar_view[k])
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":888
+          /* "cssm.pyx":1008
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     alpha_stable_values = draw_random_stable(num_draws, alphar_view[k])
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":892
+      /* "cssm.pyx":1012
  *                     m = 0
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = sign(y) # Store choice
  * 
  */
       __pyx_t_22 = __pyx_v_k;
       __pyx_t_13 = __pyx_v_n;
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_24 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_13 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_22 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":893
+      /* "cssm.pyx":1013
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt
  *             choices_view[n, k, 0] = sign(y) # Store choice             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  */
       __pyx_t_22 = __pyx_v_n;
       __pyx_t_24 = __pyx_v_k;
       __pyx_t_21 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_22 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) = __pyx_f_4cssm_sign(__pyx_v_y);
     }
   }
 
-  /* "cssm.pyx":895
+  /* "cssm.pyx":1015
  *             choices_view[n, k, 0] = sign(y) # Store choice
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                           'a': a,
  *                                                           'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 895, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
 
-  /* "cssm.pyx":896
+  /* "cssm.pyx":1016
  * 
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  *                                                           'a': a,             # <<<<<<<<<<<<<<
  *                                                           'z': z,
  *                                                           't': t,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
 
-  /* "cssm.pyx":897
+  /* "cssm.pyx":1017
  *     return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
  *                                                           'a': a,
  *                                                           'z': z,             # <<<<<<<<<<<<<<
  *                                                           't': t,
  *                                                           'alphar': alphar,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
 
-  /* "cssm.pyx":898
+  /* "cssm.pyx":1018
  *                                                           'a': a,
  *                                                           'z': z,
  *                                                           't': t,             # <<<<<<<<<<<<<<
  *                                                           'alphar': alphar,
  *                                                           'g': g,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
 
-  /* "cssm.pyx":899
+  /* "cssm.pyx":1019
  *                                                           'z': z,
  *                                                           't': t,
  *                                                           'alphar': alphar,             # <<<<<<<<<<<<<<
  *                                                           'g': g,
  *                                                           's': s,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_alphar, ((PyObject *)__pyx_v_alphar)) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_alphar, ((PyObject *)__pyx_v_alphar)) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
 
-  /* "cssm.pyx":900
+  /* "cssm.pyx":1020
  *                                                           't': t,
  *                                                           'alphar': alphar,
  *                                                           'g': g,             # <<<<<<<<<<<<<<
  *                                                           's': s,
  *                                                           **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_g, ((PyObject *)__pyx_v_g)) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_g, ((PyObject *)__pyx_v_g)) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
 
-  /* "cssm.pyx":901
+  /* "cssm.pyx":1021
  *                                                           'alphar': alphar,
  *                                                           'g': g,
  *                                                           's': s,             # <<<<<<<<<<<<<<
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 901, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1021, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_s, __pyx_t_5) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_s, __pyx_t_5) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_10 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "cssm.pyx":902
+  /* "cssm.pyx":1022
  *                                                           'g': g,
  *                                                           's': s,
  *                                                           **boundary_params,             # <<<<<<<<<<<<<<
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 902, __pyx_L1_error)
+    __PYX_ERR(0, 1022, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_10, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 902, __pyx_L1_error)
+    __PYX_ERR(0, 1022, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":903
+  /* "cssm.pyx":1023
  *                                                           's': s,
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":904
+  /* "cssm.pyx":1024
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'glob_flexbound',
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 904, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1024, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 904, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 1024, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":905
+  /* "cssm.pyx":1025
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                           'simulator': 'glob_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 905, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1025, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 905, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 1025, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_glob_flexbound) < 0) __PYX_ERR(0, 906, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_glob_flexbound) < 0) __PYX_ERR(0, 1026, __pyx_L1_error)
 
-  /* "cssm.pyx":907
+  /* "cssm.pyx":1027
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'glob_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 907, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1027, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) < 0) __PYX_ERR(0, 907, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) < 0) __PYX_ERR(0, 1027, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":908
+  /* "cssm.pyx":1028
  *                                                           'simulator': 'glob_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],             # <<<<<<<<<<<<<<
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary}}
  */
-  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1028, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) < 0) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) < 0) __PYX_ERR(0, 1028, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":909
+  /* "cssm.pyx":1029
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,             # <<<<<<<<<<<<<<
  *                                                           'boundary': boundary}}
  * # -------------------------------------------------------------------------------------------------
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 909, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1029, __pyx_L1_error)
 
-  /* "cssm.pyx":910
+  /* "cssm.pyx":1030
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary}}             # <<<<<<<<<<<<<<
  * # -------------------------------------------------------------------------------------------------
  * 
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 910, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_10) < 0) __PYX_ERR(0, 895, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1030, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_10) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   __pyx_r = __pyx_t_12;
   __pyx_t_12 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":803
+  /* "cssm.pyx":923
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def glob_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                    np.ndarray[float, ndim = 1] a,
  *                    np.ndarray[float, ndim = 1] z,
  */
 
@@ -14527,32 +16269,32 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_rts_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_alpha_stable_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
-  __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_key);
+  __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":917
+/* "cssm.pyx":1037
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def levy_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                    np.ndarray[float, ndim = 1] a,
  *                    np.ndarray[float, ndim = 1] z,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_17levy_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_17levy_flexbound = {"levy_flexbound", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_17levy_flexbound, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_17levy_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_19levy_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_19levy_flexbound = {"levy_flexbound", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_19levy_flexbound, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_19levy_flexbound(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z = 0;
   PyArrayObject *__pyx_v_alpha_diff = 0;
   PyArrayObject *__pyx_v_t = 0;
   float __pyx_v_s;
   float __pyx_v_delta_t;
@@ -14569,34 +16311,34 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("levy_flexbound (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_alpha_diff,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[14] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":927
+    /* "cssm.pyx":1047
  *                    int n_samples = 20000,
  *                    int n_trials = 1,
  *                    boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *                    boundary_multiplicative = True,
  *                    boundary_params = {},
  */
     values[10] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":928
+    /* "cssm.pyx":1048
  *                    int n_trials = 1,
  *                    boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                    boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *                    boundary_params = {},
  *                    random_state = None,
  */
     values[11] = ((PyObject *)Py_True);
-    values[12] = __pyx_k__8;
+    values[12] = __pyx_k__9;
 
-    /* "cssm.pyx":930
+    /* "cssm.pyx":1050
  *                    boundary_multiplicative = True,
  *                    boundary_params = {},
  *                    random_state = None,             # <<<<<<<<<<<<<<
  *                    ):
  * 
  */
     values[13] = ((PyObject *)Py_None);
@@ -14640,33 +16382,33 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("levy_flexbound", 0, 5, 14, 1); __PYX_ERR(0, 917, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("levy_flexbound", 0, 5, 14, 1); __PYX_ERR(0, 1037, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("levy_flexbound", 0, 5, 14, 2); __PYX_ERR(0, 917, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("levy_flexbound", 0, 5, 14, 2); __PYX_ERR(0, 1037, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_alpha_diff)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("levy_flexbound", 0, 5, 14, 3); __PYX_ERR(0, 917, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("levy_flexbound", 0, 5, 14, 3); __PYX_ERR(0, 1037, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("levy_flexbound", 0, 5, 14, 4); __PYX_ERR(0, 917, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("levy_flexbound", 0, 5, 14, 4); __PYX_ERR(0, 1037, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[5] = value; kw_args--; }
         }
@@ -14716,15 +16458,15 @@
         case 13:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[13] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "levy_flexbound") < 0)) __PYX_ERR(0, 917, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "levy_flexbound") < 0)) __PYX_ERR(0, 1037, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 14: values[13] = PyTuple_GET_ITEM(__pyx_args, 13);
         CYTHON_FALLTHROUGH;
         case 13: values[12] = PyTuple_GET_ITEM(__pyx_args, 12);
         CYTHON_FALLTHROUGH;
@@ -14753,59 +16495,59 @@
     }
     __pyx_v_v = ((PyArrayObject *)values[0]);
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_alpha_diff = ((PyArrayObject *)values[3]);
     __pyx_v_t = ((PyArrayObject *)values[4]);
     if (values[5]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 922, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1042, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[6]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 923, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1043, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[7]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 924, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1044, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[8]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 925, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1045, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[9]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 926, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1046, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_boundary_fun = values[10];
     __pyx_v_boundary_multiplicative = values[11];
     __pyx_v_boundary_params = values[12];
     __pyx_v_random_state = values[13];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("levy_flexbound", 0, 5, 14, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 917, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("levy_flexbound", 0, 5, 14, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1037, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.levy_flexbound", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 917, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 918, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 919, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_alpha_diff), __pyx_ptype_5numpy_ndarray, 1, "alpha_diff", 0))) __PYX_ERR(0, 920, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 921, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_16levy_flexbound(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_alpha_diff, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1037, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1038, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1039, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_alpha_diff), __pyx_ptype_5numpy_ndarray, 1, "alpha_diff", 0))) __PYX_ERR(0, 1040, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_18levy_flexbound(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_alpha_diff, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":917
+  /* "cssm.pyx":1037
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def levy_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                    np.ndarray[float, ndim = 1] a,
  *                    np.ndarray[float, ndim = 1] z,
  */
 
@@ -14814,15 +16556,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_16levy_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_alpha_diff, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_18levy_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_alpha_diff, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_alpha_diff_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_traj = NULL;
   __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -14839,15 +16581,15 @@
   float __pyx_v_t_particle;
   Py_ssize_t __pyx_v_n;
   Py_ssize_t __pyx_v_ix;
   Py_ssize_t __pyx_v_k;
   Py_ssize_t __pyx_v_m;
   __Pyx_memviewslice __pyx_v_alpha_stable_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
-  PyObject *__pyx_8genexpr4__pyx_v_key = NULL;
+  PyObject *__pyx_8genexpr5__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_alpha_diff;
   __Pyx_Buffer __pyx_pybuffer_alpha_diff;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
   __Pyx_Buffer __pyx_pybuffer_t;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
@@ -14902,317 +16644,317 @@
   __pyx_pybuffernd_alpha_diff.rcbuffer = &__pyx_pybuffer_alpha_diff;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 917, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1037, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 917, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1037, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 917, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1037, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_alpha_diff.rcbuffer->pybuffer, (PyObject*)__pyx_v_alpha_diff, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 917, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_alpha_diff.rcbuffer->pybuffer, (PyObject*)__pyx_v_alpha_diff, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1037, __pyx_L1_error)
   }
   __pyx_pybuffernd_alpha_diff.diminfo[0].strides = __pyx_pybuffernd_alpha_diff.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_alpha_diff.diminfo[0].shape = __pyx_pybuffernd_alpha_diff.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 917, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1037, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":933
+  /* "cssm.pyx":1053
  *                    ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
  *     # Param views:
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 933, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":936
+  /* "cssm.pyx":1056
  *     #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
  *     # Param views:
  *     cdef float[:] v_view  = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1056, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":937
+  /* "cssm.pyx":1057
  *     # Param views:
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] alpha_diff_view = alpha_diff
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1057, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":938
+  /* "cssm.pyx":1058
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] alpha_diff_view = alpha_diff
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 938, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1058, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":939
+  /* "cssm.pyx":1059
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] alpha_diff_view = alpha_diff             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_alpha_diff), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 939, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_alpha_diff), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1059, __pyx_L1_error)
   __pyx_v_alpha_diff_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":940
+  /* "cssm.pyx":1060
  *     cdef float[:] z_view = z
  *     cdef float[:] alpha_diff_view = alpha_diff
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     # Data-struct for trajectory storage
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 940, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":943
+  /* "cssm.pyx":1063
  * 
  *     # Data-struct for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 943, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_traj = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":944
+  /* "cssm.pyx":1064
  *     # Data-struct for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:,:] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1064, __pyx_L1_error)
 
-  /* "cssm.pyx":945
+  /* "cssm.pyx":1065
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1065, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":947
+  /* "cssm.pyx":1067
  *     cdef float[:,:] traj_view = traj
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1067, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rts = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":948
+  /* "cssm.pyx":1068
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:,:, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 948, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 948, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1068, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":950
+  /* "cssm.pyx":1070
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:,:, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:,:, :] choices_view = choices
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 950, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1070, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":951
+  /* "cssm.pyx":1071
  * 
  *     cdef float[:,:, :] rts_view = rts
  *     cdef int[:,:, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_alpha # = pow(delta_t, 1.0 / alpha_diff) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 951, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1071, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":956
+  /* "cssm.pyx":1076
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":957
+  /* "cssm.pyx":1077
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 957, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 957, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 957, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 957, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_10 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -15221,242 +16963,242 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 957, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1077, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_10) {
       __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 957, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_12 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_12)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_12);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_7 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 957, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_t_s = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":958
+  /* "cssm.pyx":1078
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 958, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 958, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 958, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 958, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 958, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 958, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 958, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 958, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_boundary = __pyx_t_12;
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":959
+  /* "cssm.pyx":1079
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     cdef float y, t_particle
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 959, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1079, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":965
+  /* "cssm.pyx":1085
  *     cdef Py_ssize_t ix
  *     cdef Py_ssize_t k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     #cdef int n, ix
  *     #cdef int m = 0
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":968
+  /* "cssm.pyx":1088
  *     #cdef int n, ix
  *     #cdef int m = 0
  *     cdef float[:] alpha_stable_values = draw_random_stable(num_draws, alpha_diff_view[0])             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
   __pyx_t_13 = 0;
-  __pyx_t_2 = __pyx_f_4cssm_draw_random_stable(__pyx_v_num_draws, (*((float *) ( /* dim=0 */ (__pyx_v_alpha_diff_view.data + __pyx_t_13 * __pyx_v_alpha_diff_view.strides[0]) )))); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 968, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_random_stable(__pyx_v_num_draws, (*((float *) ( /* dim=0 */ (__pyx_v_alpha_diff_view.data + __pyx_t_13 * __pyx_v_alpha_diff_view.strides[0]) )))); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1088, __pyx_L1_error)
   __pyx_v_alpha_stable_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":970
+  /* "cssm.pyx":1090
  *     cdef float[:] alpha_stable_values = draw_random_stable(num_draws, alpha_diff_view[0])
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         delta_t_alpha = s * pow(delta_t, 1.0 / alpha_diff_view[k])
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_11 = __pyx_v_n_trials;
   __pyx_t_14 = __pyx_t_11;
   for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
     __pyx_v_k = __pyx_t_15;
 
-    /* "cssm.pyx":971
+    /* "cssm.pyx":1091
  * 
  *     for k in range(n_trials):
  *         delta_t_alpha = s * pow(delta_t, 1.0 / alpha_diff_view[k])             # <<<<<<<<<<<<<<
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  * 
  */
     __pyx_t_13 = __pyx_v_k;
     __pyx_v_delta_t_alpha = (__pyx_v_s * pow(__pyx_v_delta_t, (1.0 / ((double)(*((float *) ( /* dim=0 */ (__pyx_v_alpha_diff_view.data + __pyx_t_13 * __pyx_v_alpha_diff_view.strides[0]) )))))));
 
-    /* "cssm.pyx":972
+    /* "cssm.pyx":1092
  *     for k in range(n_trials):
  *         delta_t_alpha = s * pow(delta_t, 1.0 / alpha_diff_view[k])
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         # Precompute boundary evaluations
  */
     { /* enter inner scope */
-      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 972, __pyx_L7_error)
+      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1092, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_12);
       __pyx_t_16 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 972, __pyx_L7_error)
+        __PYX_ERR(0, 1092, __pyx_L7_error)
       }
-      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_17), (&__pyx_t_18)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 972, __pyx_L7_error)
+      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_17), (&__pyx_t_18)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF(__pyx_t_7);
       __pyx_t_7 = __pyx_t_1;
       __pyx_t_1 = 0;
       while (1) {
         __pyx_t_19 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_17, &__pyx_t_16, &__pyx_t_1, NULL, NULL, __pyx_t_18);
         if (unlikely(__pyx_t_19 == 0)) break;
-        if (unlikely(__pyx_t_19 == -1)) __PYX_ERR(0, 972, __pyx_L7_error)
+        if (unlikely(__pyx_t_19 == -1)) __PYX_ERR(0, 1092, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_XDECREF_SET(__pyx_8genexpr4__pyx_v_key, __pyx_t_1);
+        __Pyx_XDECREF_SET(__pyx_8genexpr5__pyx_v_key, __pyx_t_1);
         __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr4__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 972, __pyx_L7_error)
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr5__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 972, __pyx_L7_error)
+        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1092, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr4__pyx_v_key, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 972, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr5__pyx_v_key, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1092, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_key); __pyx_8genexpr4__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_key); __pyx_8genexpr5__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_key); __pyx_8genexpr4__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_key); __pyx_8genexpr5__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_12));
     __pyx_t_12 = 0;
 
-    /* "cssm.pyx":975
+    /* "cssm.pyx":1095
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-    __pyx_t_20 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_20 < 0)) __PYX_ERR(0, 975, __pyx_L1_error)
+    __pyx_t_20 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_20 < 0)) __PYX_ERR(0, 1095, __pyx_L1_error)
     if (__pyx_t_20) {
 
-      /* "cssm.pyx":977
+      /* "cssm.pyx":1097
  *         if boundary_multiplicative:
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             # print(a)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 977, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1097, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 977, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1097, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_13 = __pyx_v_k;
-      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_13 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 977, __pyx_L1_error)
+      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_13 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1097, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 977, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1097, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 977, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1097, __pyx_L1_error)
       __pyx_t_5 = __pyx_t_4;
       __pyx_t_4 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 977, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 977, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1097, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1097, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_5 = NULL;
       __pyx_t_18 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_5)) {
@@ -15466,105 +17208,105 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_18 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
-        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 977, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1097, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
-        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 977, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1097, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_10 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 977, __pyx_L1_error)
+        __pyx_t_10 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1097, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         if (__pyx_t_5) {
           __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5); __pyx_t_5 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_18, __pyx_t_3);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_18, __pyx_t_4);
         __pyx_t_3 = 0;
         __pyx_t_4 = 0;
-        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 977, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1097, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 977, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1097, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 977, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1097, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 977, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1097, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 977, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1097, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-      /* "cssm.pyx":975
+      /* "cssm.pyx":1095
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":980
+    /* "cssm.pyx":1100
  *         else:
  *             # print(a)
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Loop over samples
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 980, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1100, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 980, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1100, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_13 = __pyx_v_k;
-      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_13 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 980, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_13 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1100, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 980, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1100, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 980, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1100, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_3;
       __pyx_t_3 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 980, __pyx_L1_error)
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 980, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1100, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1100, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_18 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_4)) {
@@ -15574,166 +17316,166 @@
           __Pyx_DECREF_SET(__pyx_t_10, function);
           __pyx_t_18 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_3};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_3};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       {
-        __pyx_t_5 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1100, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_18, __pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_18, __pyx_t_3);
         __pyx_t_7 = 0;
         __pyx_t_3 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       }
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 980, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1100, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
       __pyx_t_12 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 980, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1100, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 980, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1100, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":983
+    /* "cssm.pyx":1103
  * 
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time
  */
     __pyx_t_18 = __pyx_v_n_samples;
     __pyx_t_19 = __pyx_t_18;
     for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_19; __pyx_t_17+=1) {
       __pyx_v_n = __pyx_t_17;
 
-      /* "cssm.pyx":984
+      /* "cssm.pyx":1104
  *         # Loop over samples
  *         for n in range(n_samples):
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position             # <<<<<<<<<<<<<<
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index
  */
       __pyx_t_13 = 0;
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_22 = 0;
       __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_13 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_21 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_22 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":985
+      /* "cssm.pyx":1105
  *         for n in range(n_samples):
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  *             if n == 0:
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":986
+      /* "cssm.pyx":1106
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  *             if n == 0:
  *                 if k == 0:
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":987
+      /* "cssm.pyx":1107
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       __pyx_t_20 = ((__pyx_v_n == 0) != 0);
       if (__pyx_t_20) {
 
-        /* "cssm.pyx":988
+        /* "cssm.pyx":1108
  *             ix = 0 # reset boundary index
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         __pyx_t_20 = ((__pyx_v_k == 0) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":989
+          /* "cssm.pyx":1109
  *             if n == 0:
  *                 if k == 0:
  *                     traj_view[0, 0] = y             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
           __pyx_t_22 = 0;
           __pyx_t_21 = 0;
           *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-          /* "cssm.pyx":988
+          /* "cssm.pyx":1108
  *             ix = 0 # reset boundary index
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         }
 
-        /* "cssm.pyx":987
+        /* "cssm.pyx":1107
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       }
 
-      /* "cssm.pyx":992
+      /* "cssm.pyx":1112
  * 
  *             # Random walker
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 y += (v_view[k] * delta_t) + (delta_t_alpha * alpha_stable_values[m])
  *                 t_particle += delta_t
  */
       while (1) {
@@ -15752,344 +17494,344 @@
           goto __pyx_L18_bool_binop_done;
         }
         __pyx_t_23 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_20 = __pyx_t_23;
         __pyx_L18_bool_binop_done:;
         if (!__pyx_t_20) break;
 
-        /* "cssm.pyx":993
+        /* "cssm.pyx":1113
  *             # Random walker
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *                 y += (v_view[k] * delta_t) + (delta_t_alpha * alpha_stable_values[m])             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 ix += 1
  */
         __pyx_t_21 = __pyx_v_k;
         __pyx_t_22 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_21 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_delta_t_alpha * (*((float *) ( /* dim=0 */ (__pyx_v_alpha_stable_values.data + __pyx_t_22 * __pyx_v_alpha_stable_values.strides[0]) ))))));
 
-        /* "cssm.pyx":994
+        /* "cssm.pyx":1114
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *                 y += (v_view[k] * delta_t) + (delta_t_alpha * alpha_stable_values[m])
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":995
+        /* "cssm.pyx":1115
  *                 y += (v_view[k] * delta_t) + (delta_t_alpha * alpha_stable_values[m])
  *                 t_particle += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  *                 if n == 0:
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":996
+        /* "cssm.pyx":1116
  *                 t_particle += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  *                 if n == 0:
  *                     if k == 0:
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":997
+        /* "cssm.pyx":1117
  *                 ix += 1
  *                 m += 1
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         __pyx_t_20 = ((__pyx_v_n == 0) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":998
+          /* "cssm.pyx":1118
  *                 m += 1
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  */
           __pyx_t_20 = ((__pyx_v_k == 0) != 0);
           if (__pyx_t_20) {
 
-            /* "cssm.pyx":999
+            /* "cssm.pyx":1119
  *                 if n == 0:
  *                     if k == 0:
  *                         traj_view[ix, 0] = y             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     alpha_stable_values = draw_random_stable(num_draws, alpha_diff_view[k])
  */
             __pyx_t_22 = __pyx_v_ix;
             __pyx_t_21 = 0;
             *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-            /* "cssm.pyx":998
+            /* "cssm.pyx":1118
  *                 m += 1
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  */
           }
 
-          /* "cssm.pyx":997
+          /* "cssm.pyx":1117
  *                 ix += 1
  *                 m += 1
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         }
 
-        /* "cssm.pyx":1000
+        /* "cssm.pyx":1120
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     alpha_stable_values = draw_random_stable(num_draws, alpha_diff_view[k])
  *                     m = 0
  */
         __pyx_t_20 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":1001
+          /* "cssm.pyx":1121
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  *                     alpha_stable_values = draw_random_stable(num_draws, alpha_diff_view[k])             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
           __pyx_t_21 = __pyx_v_k;
-          __pyx_t_2 = __pyx_f_4cssm_draw_random_stable(__pyx_v_num_draws, (*((float *) ( /* dim=0 */ (__pyx_v_alpha_diff_view.data + __pyx_t_21 * __pyx_v_alpha_diff_view.strides[0]) )))); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1001, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_random_stable(__pyx_v_num_draws, (*((float *) ( /* dim=0 */ (__pyx_v_alpha_diff_view.data + __pyx_t_21 * __pyx_v_alpha_diff_view.strides[0]) )))); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1121, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_alpha_stable_values, 1);
           __pyx_v_alpha_stable_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":1002
+          /* "cssm.pyx":1122
  *                 if m == num_draws:
  *                     alpha_stable_values = draw_random_stable(num_draws, alpha_diff_view[k])
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":1000
+          /* "cssm.pyx":1120
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     alpha_stable_values = draw_random_stable(num_draws, alpha_diff_view[k])
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":1004
+      /* "cssm.pyx":1124
  *                     m = 0
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = sign(y) # Store choice
  * 
  */
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_22 = __pyx_v_n;
       __pyx_t_13 = __pyx_v_k;
       __pyx_t_24 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_22 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_13 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":1005
+      /* "cssm.pyx":1125
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt
  *             choices_view[n, k, 0] = sign(y) # Store choice             # <<<<<<<<<<<<<<
  * 
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,
  */
       __pyx_t_21 = __pyx_v_n;
       __pyx_t_24 = __pyx_v_k;
       __pyx_t_13 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_13 * __pyx_v_choices_view.strides[2]) )) = __pyx_f_4cssm_sign(__pyx_v_y);
     }
   }
 
-  /* "cssm.pyx":1007
+  /* "cssm.pyx":1127
  *             choices_view[n, k, 0] = sign(y) # Store choice
  * 
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                           'a': a,
  *                                                           'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1007, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1127, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1007, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1007, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1007, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 1007, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
 
-  /* "cssm.pyx":1008
+  /* "cssm.pyx":1128
  * 
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                           'a': a,             # <<<<<<<<<<<<<<
  *                                                           'z': z,
  *                                                           't': t,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1007, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
 
-  /* "cssm.pyx":1009
+  /* "cssm.pyx":1129
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                           'a': a,
  *                                                           'z': z,             # <<<<<<<<<<<<<<
  *                                                           't': t,
  *                                                           'alpha_diff': alpha_diff,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 1007, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
 
-  /* "cssm.pyx":1010
+  /* "cssm.pyx":1130
  *                                                           'a': a,
  *                                                           'z': z,
  *                                                           't': t,             # <<<<<<<<<<<<<<
  *                                                           'alpha_diff': alpha_diff,
  *                                                           's': s,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1007, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
 
-  /* "cssm.pyx":1011
+  /* "cssm.pyx":1131
  *                                                           'z': z,
  *                                                           't': t,
  *                                                           'alpha_diff': alpha_diff,             # <<<<<<<<<<<<<<
  *                                                           's': s,
  *                                                           **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_alpha_diff, ((PyObject *)__pyx_v_alpha_diff)) < 0) __PYX_ERR(0, 1007, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_alpha_diff, ((PyObject *)__pyx_v_alpha_diff)) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
 
-  /* "cssm.pyx":1012
+  /* "cssm.pyx":1132
  *                                                           't': t,
  *                                                           'alpha_diff': alpha_diff,
  *                                                           's': s,             # <<<<<<<<<<<<<<
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1012, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1132, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_s, __pyx_t_5) < 0) __PYX_ERR(0, 1007, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_s, __pyx_t_5) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_10 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1013
+  /* "cssm.pyx":1133
  *                                                           'alpha_diff': alpha_diff,
  *                                                           's': s,
  *                                                           **boundary_params,             # <<<<<<<<<<<<<<
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 1013, __pyx_L1_error)
+    __PYX_ERR(0, 1133, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_10, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 1013, __pyx_L1_error)
+    __PYX_ERR(0, 1133, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":1014
+  /* "cssm.pyx":1134
  *                                                           's': s,
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1014, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 1014, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1015
+  /* "cssm.pyx":1135
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'levy_flexbound',
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1015, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 1135, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1016
+  /* "cssm.pyx":1136
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                           'simulator': 'levy_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1016, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1136, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 1016, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_levy_flexbound) < 0) __PYX_ERR(0, 1017, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_levy_flexbound) < 0) __PYX_ERR(0, 1137, __pyx_L1_error)
 
-  /* "cssm.pyx":1018
+  /* "cssm.pyx":1138
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'levy_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1018, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) < 0) __PYX_ERR(0, 1018, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) < 0) __PYX_ERR(0, 1138, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1019
+  /* "cssm.pyx":1139
  *                                                           'simulator': 'levy_flexbound',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],             # <<<<<<<<<<<<<<
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary}}
  */
-  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1019, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) < 0) __PYX_ERR(0, 1019, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) < 0) __PYX_ERR(0, 1139, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1020
+  /* "cssm.pyx":1140
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,             # <<<<<<<<<<<<<<
  *                                                           'boundary': boundary}}
  * # -------------------------------------------------------------------------------------------------
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1020, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1140, __pyx_L1_error)
 
-  /* "cssm.pyx":1021
+  /* "cssm.pyx":1141
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary}}             # <<<<<<<<<<<<<<
  * # -------------------------------------------------------------------------------------------------
  * 
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1021, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_10) < 0) __PYX_ERR(0, 1007, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1141, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_10) < 0) __PYX_ERR(0, 1127, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   __pyx_r = __pyx_t_12;
   __pyx_t_12 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":917
+  /* "cssm.pyx":1037
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def levy_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                    np.ndarray[float, ndim = 1] a,
  *                    np.ndarray[float, ndim = 1] z,
  */
 
@@ -16138,32 +17880,32 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_rts_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_alpha_stable_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
-  __Pyx_XDECREF(__pyx_8genexpr4__pyx_v_key);
+  __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":1027
+/* "cssm.pyx":1147
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def full_ddm(np.ndarray[float, ndim = 1] v, # = 0,             # <<<<<<<<<<<<<<
  *              np.ndarray[float, ndim = 1] a, # = 1,
  *              np.ndarray[float, ndim = 1] z, # = 0.5,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_19full_ddm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_19full_ddm = {"full_ddm", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_19full_ddm, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_19full_ddm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_21full_ddm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_21full_ddm = {"full_ddm", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_21full_ddm, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_21full_ddm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z = 0;
   PyArrayObject *__pyx_v_t = 0;
   PyArrayObject *__pyx_v_sz = 0;
   PyArrayObject *__pyx_v_sv = 0;
   PyArrayObject *__pyx_v_st = 0;
@@ -16182,34 +17924,34 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("full_ddm (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_sz,&__pyx_n_s_sv,&__pyx_n_s_st,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":1039
+    /* "cssm.pyx":1159
  *              int n_samples = 20000,
  *              int n_trials = 1,
  *              boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *              boundary_multiplicative = True,
  *              boundary_params = {},
  */
     values[12] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":1040
+    /* "cssm.pyx":1160
  *              int n_trials = 1,
  *              boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *              boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *              boundary_params = {},
  *              random_state = None,):
  */
     values[13] = ((PyObject *)Py_True);
-    values[14] = __pyx_k__9;
+    values[14] = __pyx_k__10;
 
-    /* "cssm.pyx":1042
+    /* "cssm.pyx":1162
  *              boundary_multiplicative = True,
  *              boundary_params = {},
  *              random_state = None,):             # <<<<<<<<<<<<<<
  * 
  *     set_seed(random_state)
  */
     values[15] = ((PyObject *)Py_None);
@@ -16257,45 +17999,45 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 1); __PYX_ERR(0, 1027, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 1); __PYX_ERR(0, 1147, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 2); __PYX_ERR(0, 1027, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 2); __PYX_ERR(0, 1147, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 3); __PYX_ERR(0, 1027, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 3); __PYX_ERR(0, 1147, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sz)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 4); __PYX_ERR(0, 1027, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 4); __PYX_ERR(0, 1147, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sv)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 5); __PYX_ERR(0, 1027, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 5); __PYX_ERR(0, 1147, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_st)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 6); __PYX_ERR(0, 1027, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, 6); __PYX_ERR(0, 1147, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[7] = value; kw_args--; }
         }
@@ -16345,15 +18087,15 @@
         case 15:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[15] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "full_ddm") < 0)) __PYX_ERR(0, 1027, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "full_ddm") < 0)) __PYX_ERR(0, 1147, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 16: values[15] = PyTuple_GET_ITEM(__pyx_args, 15);
         CYTHON_FALLTHROUGH;
         case 15: values[14] = PyTuple_GET_ITEM(__pyx_args, 14);
         CYTHON_FALLTHROUGH;
@@ -16386,61 +18128,61 @@
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_t = ((PyArrayObject *)values[3]);
     __pyx_v_sz = ((PyArrayObject *)values[4]);
     __pyx_v_sv = ((PyArrayObject *)values[5]);
     __pyx_v_st = ((PyArrayObject *)values[6]);
     if (values[7]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1034, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1154, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[8]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1035, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1155, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[9]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1036, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1156, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[10]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[10]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1037, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[10]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1157, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[11]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[11]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1038, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[11]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1158, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_boundary_fun = values[12];
     __pyx_v_boundary_multiplicative = values[13];
     __pyx_v_boundary_params = values[14];
     __pyx_v_random_state = values[15];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1027, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("full_ddm", 0, 7, 16, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1147, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.full_ddm", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1027, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1028, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1029, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1030, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sz), __pyx_ptype_5numpy_ndarray, 1, "sz", 0))) __PYX_ERR(0, 1031, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sv), __pyx_ptype_5numpy_ndarray, 1, "sv", 0))) __PYX_ERR(0, 1032, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_st), __pyx_ptype_5numpy_ndarray, 1, "st", 0))) __PYX_ERR(0, 1033, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_18full_ddm(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_sz, __pyx_v_sv, __pyx_v_st, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1147, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1148, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1149, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1150, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sz), __pyx_ptype_5numpy_ndarray, 1, "sz", 0))) __PYX_ERR(0, 1151, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sv), __pyx_ptype_5numpy_ndarray, 1, "sv", 0))) __PYX_ERR(0, 1152, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_st), __pyx_ptype_5numpy_ndarray, 1, "st", 0))) __PYX_ERR(0, 1153, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_20full_ddm(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_sz, __pyx_v_sv, __pyx_v_st, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":1027
+  /* "cssm.pyx":1147
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def full_ddm(np.ndarray[float, ndim = 1] v, # = 0,             # <<<<<<<<<<<<<<
  *              np.ndarray[float, ndim = 1] a, # = 1,
  *              np.ndarray[float, ndim = 1] z, # = 0.5,
  */
 
@@ -16449,15 +18191,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_18full_ddm(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sz, PyArrayObject *__pyx_v_sv, PyArrayObject *__pyx_v_st, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_20full_ddm(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sz, PyArrayObject *__pyx_v_sv, PyArrayObject *__pyx_v_st, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_sz_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_sv_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_st_view = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -16479,15 +18221,15 @@
   Py_ssize_t __pyx_v_n;
   Py_ssize_t __pyx_v_ix;
   Py_ssize_t __pyx_v_k;
   Py_ssize_t __pyx_v_m;
   float __pyx_v_drift_increment;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
-  PyObject *__pyx_8genexpr5__pyx_v_key = NULL;
+  PyObject *__pyx_8genexpr6__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_st;
   __Pyx_Buffer __pyx_pybuffer_st;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_sv;
   __Pyx_Buffer __pyx_pybuffer_sv;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_sz;
@@ -16555,369 +18297,369 @@
   __pyx_pybuffernd_sv.rcbuffer = &__pyx_pybuffer_sv;
   __pyx_pybuffer_st.pybuffer.buf = NULL;
   __pyx_pybuffer_st.refcount = 0;
   __pyx_pybuffernd_st.data = NULL;
   __pyx_pybuffernd_st.rcbuffer = &__pyx_pybuffer_st;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1027, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1147, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1027, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1147, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1027, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1147, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1027, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1147, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sz.rcbuffer->pybuffer, (PyObject*)__pyx_v_sz, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1027, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sz.rcbuffer->pybuffer, (PyObject*)__pyx_v_sz, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1147, __pyx_L1_error)
   }
   __pyx_pybuffernd_sz.diminfo[0].strides = __pyx_pybuffernd_sz.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_sz.diminfo[0].shape = __pyx_pybuffernd_sz.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sv.rcbuffer->pybuffer, (PyObject*)__pyx_v_sv, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1027, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sv.rcbuffer->pybuffer, (PyObject*)__pyx_v_sv, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1147, __pyx_L1_error)
   }
   __pyx_pybuffernd_sv.diminfo[0].strides = __pyx_pybuffernd_sv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_sv.diminfo[0].shape = __pyx_pybuffernd_sv.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_st.rcbuffer->pybuffer, (PyObject*)__pyx_v_st, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1027, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_st.rcbuffer->pybuffer, (PyObject*)__pyx_v_st, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1147, __pyx_L1_error)
   }
   __pyx_pybuffernd_st.diminfo[0].strides = __pyx_pybuffernd_st.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_st.diminfo[0].shape = __pyx_pybuffernd_st.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":1044
+  /* "cssm.pyx":1164
  *              random_state = None,):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
  *     # Param views
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1164, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1048
+  /* "cssm.pyx":1168
  *     # Param views
  *     #set_random_state(random_state)
  *     cdef float[:] v_view  = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1048, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1168, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1049
+  /* "cssm.pyx":1169
  *     #set_random_state(random_state)
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1169, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1050
+  /* "cssm.pyx":1170
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  *     cdef float[:] sz_view = sz
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1050, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1170, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1051
+  /* "cssm.pyx":1171
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  *     cdef float[:] sz_view = sz
  *     cdef float[:] sv_view = sv
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1051, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1171, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1052
+  /* "cssm.pyx":1172
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  *     cdef float[:] sz_view = sz             # <<<<<<<<<<<<<<
  *     cdef float[:] sv_view = sv
  *     cdef float[:] st_view = st
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_sz), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1052, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_sz), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1172, __pyx_L1_error)
   __pyx_v_sz_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1053
+  /* "cssm.pyx":1173
  *     cdef float[:] t_view = t
  *     cdef float[:] sz_view = sz
  *     cdef float[:] sv_view = sv             # <<<<<<<<<<<<<<
  *     cdef float[:] st_view = st
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_sv), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1053, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_sv), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1173, __pyx_L1_error)
   __pyx_v_sv_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1054
+  /* "cssm.pyx":1174
  *     cdef float[:] sz_view = sz
  *     cdef float[:] sv_view = sv
  *     cdef float[:] st_view = st             # <<<<<<<<<<<<<<
  * 
  *     # Data-structs for trajectory storage
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_st), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1054, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_st), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1174, __pyx_L1_error)
   __pyx_v_st_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1057
+  /* "cssm.pyx":1177
  * 
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:, :] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1057, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1057, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1177, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_traj = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":1058
+  /* "cssm.pyx":1178
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:, :] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1058, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1178, __pyx_L1_error)
 
-  /* "cssm.pyx":1059
+  /* "cssm.pyx":1179
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:, :] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1059, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1179, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1061
+  /* "cssm.pyx":1181
  *     cdef float[:, :] traj_view = traj
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1181, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1181, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1181, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1181, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1181, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1181, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1181, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1181, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1061, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1181, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1181, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rts = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":1062
+  /* "cssm.pyx":1182
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1062, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":1064
+  /* "cssm.pyx":1184
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1184, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":1065
+  /* "cssm.pyx":1185
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1065, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1185, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":1067
+  /* "cssm.pyx":1187
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":1068
+  /* "cssm.pyx":1188
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage for the upper bound
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":1071
+  /* "cssm.pyx":1191
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":1072
+  /* "cssm.pyx":1192
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1072, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1072, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1072, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1072, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_10 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -16926,240 +18668,240 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1072, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1192, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_10) {
       __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_5);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1072, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_12 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_12)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_12);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_7 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1072, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_t_s = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":1073
+  /* "cssm.pyx":1193
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1073, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1073, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1073, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1073, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1073, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1073, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 1073, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1073, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_boundary = __pyx_t_12;
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":1074
+  /* "cssm.pyx":1194
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     cdef float y, t_particle, t_tmp
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1074, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1194, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1078
+  /* "cssm.pyx":1198
  *     cdef float y, t_particle, t_tmp
  *     cdef Py_ssize_t n, ix, k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     cdef float drift_increment = 0.0
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":1079
+  /* "cssm.pyx":1199
  *     cdef Py_ssize_t n, ix, k
  *     cdef Py_ssize_t m = 0
  *     cdef float drift_increment = 0.0             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_drift_increment = 0.0;
 
-  /* "cssm.pyx":1080
+  /* "cssm.pyx":1200
  *     cdef Py_ssize_t m = 0
  *     cdef float drift_increment = 0.0
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     # Loop over trials
  */
-  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1080, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1200, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1083
+  /* "cssm.pyx":1203
  * 
  *     # Loop over trials
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  * 
  */
   __pyx_t_11 = __pyx_v_n_trials;
   __pyx_t_13 = __pyx_t_11;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_k = __pyx_t_14;
 
-    /* "cssm.pyx":1084
+    /* "cssm.pyx":1204
  *     # Loop over trials
  *     for k in range(n_trials):
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         # Precompute boundary evaluations
  */
     { /* enter inner scope */
-      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1084, __pyx_L7_error)
+      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1204, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_12);
       __pyx_t_15 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 1084, __pyx_L7_error)
+        __PYX_ERR(0, 1204, __pyx_L7_error)
       }
-      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1084, __pyx_L7_error)
+      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF(__pyx_t_7);
       __pyx_t_7 = __pyx_t_1;
       __pyx_t_1 = 0;
       while (1) {
         __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_16, &__pyx_t_15, &__pyx_t_1, NULL, NULL, __pyx_t_17);
         if (unlikely(__pyx_t_18 == 0)) break;
-        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 1084, __pyx_L7_error)
+        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 1204, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_XDECREF_SET(__pyx_8genexpr5__pyx_v_key, __pyx_t_1);
+        __Pyx_XDECREF_SET(__pyx_8genexpr6__pyx_v_key, __pyx_t_1);
         __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr5__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1084, __pyx_L7_error)
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr6__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1084, __pyx_L7_error)
+        __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1204, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr5__pyx_v_key, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1084, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr6__pyx_v_key, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1204, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_key); __pyx_8genexpr5__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_key); __pyx_8genexpr6__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_key); __pyx_8genexpr5__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_key); __pyx_8genexpr6__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_12));
     __pyx_t_12 = 0;
 
-    /* "cssm.pyx":1087
+    /* "cssm.pyx":1207
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary_view[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 1207, __pyx_L1_error)
     if (__pyx_t_19) {
 
-      /* "cssm.pyx":1089
+      /* "cssm.pyx":1209
  *         if boundary_multiplicative:
  *             # print(a)
  *             boundary_view[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             # print(a)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1089, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_20 = __pyx_v_k;
-      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1089, __pyx_L1_error)
+      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1089, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1089, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1209, __pyx_L1_error)
       __pyx_t_5 = __pyx_t_4;
       __pyx_t_4 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1089, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1089, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1209, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_5 = NULL;
       __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_5)) {
@@ -17169,70 +18911,70 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
-        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1089, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_4};
-        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1089, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1089, __pyx_L1_error)
+        __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         if (__pyx_t_5) {
           __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5); __pyx_t_5 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_17, __pyx_t_3);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_17, __pyx_t_4);
         __pyx_t_3 = 0;
         __pyx_t_4 = 0;
-        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1089, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1209, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1089, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1089, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_21 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_21 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1089, __pyx_L1_error)
+      __pyx_t_21 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_21 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1209, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       {
           float __pyx_temp_scalar = __pyx_t_21;
           {
               Py_ssize_t __pyx_temp_extent_0 = __pyx_v_boundary_view.shape[0];
               Py_ssize_t __pyx_temp_stride_0 = __pyx_v_boundary_view.strides[0];
               char *__pyx_temp_pointer_0;
@@ -17241,47 +18983,47 @@
               for (__pyx_temp_idx_0 = 0; __pyx_temp_idx_0 < __pyx_temp_extent_0; __pyx_temp_idx_0++) {
                 *((float *) __pyx_temp_pointer_0) = __pyx_temp_scalar;
                 __pyx_temp_pointer_0 += __pyx_temp_stride_0;
               }
           }
       }
 
-      /* "cssm.pyx":1087
+      /* "cssm.pyx":1207
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary_view[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":1092
+    /* "cssm.pyx":1212
  *         else:
  *             # print(a)
  *             boundary_view[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Loop over samples
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_20 = __pyx_v_k;
-      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1092, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1212, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_3;
       __pyx_t_3 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1092, __pyx_L1_error)
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1212, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_4)) {
@@ -17291,70 +19033,70 @@
           __Pyx_DECREF_SET(__pyx_t_10, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_3};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_3};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       {
-        __pyx_t_5 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1092, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1212, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_17, __pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_17, __pyx_t_3);
         __pyx_t_7 = 0;
         __pyx_t_3 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       }
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
       __pyx_t_12 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1092, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_21 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_21 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1092, __pyx_L1_error)
+      __pyx_t_21 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_21 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1212, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       {
           float __pyx_temp_scalar = __pyx_t_21;
           {
               Py_ssize_t __pyx_temp_extent_0 = __pyx_v_boundary_view.shape[0];
               Py_ssize_t __pyx_temp_stride_0 = __pyx_v_boundary_view.strides[0];
               char *__pyx_temp_pointer_0;
@@ -17365,189 +19107,189 @@
                 __pyx_temp_pointer_0 += __pyx_temp_stride_0;
               }
           }
       }
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":1095
+    /* "cssm.pyx":1215
  * 
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             # initialize starting point
  *             y = ((-1) * boundary_view[0]) + (z_view[k] * 2.0 * (boundary_view[0]))  # reset starting position
  */
     __pyx_t_17 = __pyx_v_n_samples;
     __pyx_t_18 = __pyx_t_17;
     for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_18; __pyx_t_16+=1) {
       __pyx_v_n = __pyx_t_16;
 
-      /* "cssm.pyx":1097
+      /* "cssm.pyx":1217
  *         for n in range(n_samples):
  *             # initialize starting point
  *             y = ((-1) * boundary_view[0]) + (z_view[k] * 2.0 * (boundary_view[0]))  # reset starting position             # <<<<<<<<<<<<<<
  * 
  *             # get drift by random displacement of v
  */
       __pyx_t_20 = 0;
       __pyx_t_22 = __pyx_v_k;
       __pyx_t_23 = 0;
       __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_22 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_23 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":1100
+      /* "cssm.pyx":1220
  * 
  *             # get drift by random displacement of v
  *             drift_increment = (v_view[k] + sv_view[k] * gaussian_values[m]) * delta_t             # <<<<<<<<<<<<<<
  *             t_tmp = t_view[k] + (2 * (random_uniform() - 0.5) * st_view[k])
  * 
  */
       __pyx_t_23 = __pyx_v_k;
       __pyx_t_22 = __pyx_v_k;
       __pyx_t_20 = __pyx_v_m;
       __pyx_v_drift_increment = (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_23 * __pyx_v_v_view.strides[0]) ))) + ((*((float *) ( /* dim=0 */ (__pyx_v_sv_view.data + __pyx_t_22 * __pyx_v_sv_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))) * __pyx_v_delta_t);
 
-      /* "cssm.pyx":1101
+      /* "cssm.pyx":1221
  *             # get drift by random displacement of v
  *             drift_increment = (v_view[k] + sv_view[k] * gaussian_values[m]) * delta_t
  *             t_tmp = t_view[k] + (2 * (random_uniform() - 0.5) * st_view[k])             # <<<<<<<<<<<<<<
  * 
  *             # apply uniform displacement on y
  */
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_22 = __pyx_v_k;
       __pyx_v_t_tmp = ((*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))) + ((2.0 * (__pyx_f_4cssm_random_uniform() - 0.5)) * (*((float *) ( /* dim=0 */ (__pyx_v_st_view.data + __pyx_t_22 * __pyx_v_st_view.strides[0]) )))));
 
-      /* "cssm.pyx":1104
+      /* "cssm.pyx":1224
  * 
  *             # apply uniform displacement on y
  *             y += 2 * (random_uniform() - 0.5) * sz_view[k]             # <<<<<<<<<<<<<<
  * 
  *             # increment m appropriately
  */
       __pyx_t_22 = __pyx_v_k;
       __pyx_v_y = (__pyx_v_y + ((2.0 * (__pyx_f_4cssm_random_uniform() - 0.5)) * (*((float *) ( /* dim=0 */ (__pyx_v_sz_view.data + __pyx_t_22 * __pyx_v_sz_view.strides[0]) )))));
 
-      /* "cssm.pyx":1107
+      /* "cssm.pyx":1227
  * 
  *             # increment m appropriately
  *             m += 1             # <<<<<<<<<<<<<<
  *             if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
       __pyx_v_m = (__pyx_v_m + 1);
 
-      /* "cssm.pyx":1108
+      /* "cssm.pyx":1228
  *             # increment m appropriately
  *             m += 1
  *             if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
       __pyx_t_19 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
       if (__pyx_t_19) {
 
-        /* "cssm.pyx":1109
+        /* "cssm.pyx":1229
  *             m += 1
  *             if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-        __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1109, __pyx_L1_error)
+        __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1229, __pyx_L1_error)
         __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
         __pyx_v_gaussian_values = __pyx_t_2;
         __pyx_t_2.memview = NULL;
         __pyx_t_2.data = NULL;
 
-        /* "cssm.pyx":1110
+        /* "cssm.pyx":1230
  *             if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             t_particle = 0.0 # reset time
  */
         __pyx_v_m = 0;
 
-        /* "cssm.pyx":1108
+        /* "cssm.pyx":1228
  *             # increment m appropriately
  *             m += 1
  *             if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
       }
 
-      /* "cssm.pyx":1112
+      /* "cssm.pyx":1232
  *                     m = 0
  * 
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":1113
+      /* "cssm.pyx":1233
  * 
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             if n == 0:
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":1115
+      /* "cssm.pyx":1235
  *             ix = 0 # reset boundary index
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       __pyx_t_19 = ((__pyx_v_n == 0) != 0);
       if (__pyx_t_19) {
 
-        /* "cssm.pyx":1116
+        /* "cssm.pyx":1236
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         __pyx_t_19 = ((__pyx_v_k == 0) != 0);
         if (__pyx_t_19) {
 
-          /* "cssm.pyx":1117
+          /* "cssm.pyx":1237
  *             if n == 0:
  *                 if k == 0:
  *                     traj_view[0, 0] = y             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
           __pyx_t_22 = 0;
           __pyx_t_20 = 0;
           *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-          /* "cssm.pyx":1116
+          /* "cssm.pyx":1236
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         }
 
-        /* "cssm.pyx":1115
+        /* "cssm.pyx":1235
  *             ix = 0 # reset boundary index
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       }
 
-      /* "cssm.pyx":1120
+      /* "cssm.pyx":1240
  * 
  *             # Random walker
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  */
       while (1) {
@@ -17566,384 +19308,384 @@
           goto __pyx_L19_bool_binop_done;
         }
         __pyx_t_24 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_19 = __pyx_t_24;
         __pyx_L19_bool_binop_done:;
         if (!__pyx_t_19) break;
 
-        /* "cssm.pyx":1121
+        /* "cssm.pyx":1241
  *             # Random walker
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 ix += 1
  */
         __pyx_t_20 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + (__pyx_v_drift_increment + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":1122
+        /* "cssm.pyx":1242
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":1123
+        /* "cssm.pyx":1243
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  * 
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":1124
+        /* "cssm.pyx":1244
  *                 t_particle += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  * 
  *                 if n == 0:
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":1126
+        /* "cssm.pyx":1246
  *                 m += 1
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         __pyx_t_19 = ((__pyx_v_n == 0) != 0);
         if (__pyx_t_19) {
 
-          /* "cssm.pyx":1127
+          /* "cssm.pyx":1247
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  */
           __pyx_t_19 = ((__pyx_v_k == 0) != 0);
           if (__pyx_t_19) {
 
-            /* "cssm.pyx":1128
+            /* "cssm.pyx":1248
  *                 if n == 0:
  *                     if k == 0:
  *                         traj_view[ix, 0] = y             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
             __pyx_t_20 = __pyx_v_ix;
             __pyx_t_22 = 0;
             *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_22 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-            /* "cssm.pyx":1127
+            /* "cssm.pyx":1247
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  */
           }
 
-          /* "cssm.pyx":1126
+          /* "cssm.pyx":1246
  *                 m += 1
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         }
 
-        /* "cssm.pyx":1129
+        /* "cssm.pyx":1249
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_19 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_19) {
 
-          /* "cssm.pyx":1130
+          /* "cssm.pyx":1250
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1130, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1250, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":1131
+          /* "cssm.pyx":1251
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             rts_view[n, k, 0] = t_particle + t_tmp # Store rt
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":1129
+          /* "cssm.pyx":1249
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":1133
+      /* "cssm.pyx":1253
  *                     m = 0
  * 
  *             rts_view[n, k, 0] = t_particle + t_tmp # Store rt             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = np.sign(y) # Store choice
  * 
  */
       __pyx_t_22 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_23 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_22 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_23 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + __pyx_v_t_tmp);
 
-      /* "cssm.pyx":1134
+      /* "cssm.pyx":1254
  * 
  *             rts_view[n, k, 0] = t_particle + t_tmp # Store rt
  *             choices_view[n, k, 0] = np.sign(y) # Store choice             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1134, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1254, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_sign); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1134, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_sign); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1254, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyFloat_FromDouble(__pyx_v_y); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1134, __pyx_L1_error)
+      __pyx_t_10 = PyFloat_FromDouble(__pyx_v_y); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1254, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_12 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_10);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1134, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1254, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_t_12); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1134, __pyx_L1_error)
+      __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_t_12); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1254, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __pyx_t_23 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_22 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_23 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_22 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_25;
     }
   }
 
-  /* "cssm.pyx":1136
+  /* "cssm.pyx":1256
  *             choices_view[n, k, 0] = np.sign(y) # Store choice
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                          'a': a,
  *                                                          'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1136, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
-  __pyx_t_10 = __Pyx_PyDict_NewPresized(8); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyDict_NewPresized(8); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
 
-  /* "cssm.pyx":1137
+  /* "cssm.pyx":1257
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                          'a': a,             # <<<<<<<<<<<<<<
  *                                                          'z': z,
  *                                                          't': t,
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
 
-  /* "cssm.pyx":1138
+  /* "cssm.pyx":1258
  *     return {'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                          'a': a,
  *                                                          'z': z,             # <<<<<<<<<<<<<<
  *                                                          't': t,
  *                                                          'sz': sz,
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
 
-  /* "cssm.pyx":1139
+  /* "cssm.pyx":1259
  *                                                          'a': a,
  *                                                          'z': z,
  *                                                          't': t,             # <<<<<<<<<<<<<<
  *                                                          'sz': sz,
  *                                                          'sv': sv,
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
 
-  /* "cssm.pyx":1140
+  /* "cssm.pyx":1260
  *                                                          'z': z,
  *                                                          't': t,
  *                                                          'sz': sz,             # <<<<<<<<<<<<<<
  *                                                          'sv': sv,
  *                                                          'st': st,
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_sz, ((PyObject *)__pyx_v_sz)) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_sz, ((PyObject *)__pyx_v_sz)) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
 
-  /* "cssm.pyx":1141
+  /* "cssm.pyx":1261
  *                                                          't': t,
  *                                                          'sz': sz,
  *                                                          'sv': sv,             # <<<<<<<<<<<<<<
  *                                                          'st': st,
  *                                                          's': s,
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_sv, ((PyObject *)__pyx_v_sv)) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_sv, ((PyObject *)__pyx_v_sv)) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
 
-  /* "cssm.pyx":1142
+  /* "cssm.pyx":1262
  *                                                          'sz': sz,
  *                                                          'sv': sv,
  *                                                          'st': st,             # <<<<<<<<<<<<<<
  *                                                          's': s,
  *                                                          **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_st, ((PyObject *)__pyx_v_st)) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_st, ((PyObject *)__pyx_v_st)) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
 
-  /* "cssm.pyx":1143
+  /* "cssm.pyx":1263
  *                                                          'sv': sv,
  *                                                          'st': st,
  *                                                          's': s,             # <<<<<<<<<<<<<<
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1143, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1263, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_s, __pyx_t_5) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_s, __pyx_t_5) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_1 = __pyx_t_10;
   __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1144
+  /* "cssm.pyx":1264
  *                                                          'st': st,
  *                                                          's': s,
  *                                                          **boundary_params,             # <<<<<<<<<<<<<<
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 1144, __pyx_L1_error)
+    __PYX_ERR(0, 1264, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_1, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 1144, __pyx_L1_error)
+    __PYX_ERR(0, 1264, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":1145
+  /* "cssm.pyx":1265
  *                                                          's': s,
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,
  */
-  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1145, __pyx_L1_error)
+  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1265, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_delta_t, __pyx_t_10) < 0) __PYX_ERR(0, 1145, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_delta_t, __pyx_t_10) < 0) __PYX_ERR(0, 1265, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1146
+  /* "cssm.pyx":1266
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                          'n_samples': n_samples,
  *                                                          'simulator': 'full_ddm',
  */
-  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1146, __pyx_L1_error)
+  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1266, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_max_t, __pyx_t_10) < 0) __PYX_ERR(0, 1146, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_max_t, __pyx_t_10) < 0) __PYX_ERR(0, 1266, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1147
+  /* "cssm.pyx":1267
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                          'simulator': 'full_ddm',
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1267, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_10) < 0) __PYX_ERR(0, 1147, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_10) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_full_ddm) < 0) __PYX_ERR(0, 1148, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_full_ddm) < 0) __PYX_ERR(0, 1268, __pyx_L1_error)
 
-  /* "cssm.pyx":1149
+  /* "cssm.pyx":1269
  *                                                          'n_samples': n_samples,
  *                                                          'simulator': 'full_ddm',
  *                                                          'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                          'possible_choices': [-1, 1],
  *                                                          'trajectory': traj,
  */
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1149, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1269, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_t_10) < 0) __PYX_ERR(0, 1149, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_t_10) < 0) __PYX_ERR(0, 1269, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1150
+  /* "cssm.pyx":1270
  *                                                          'simulator': 'full_ddm',
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  *                                                          'possible_choices': [-1, 1],             # <<<<<<<<<<<<<<
  *                                                          'trajectory': traj,
  *                                                          'boundary': boundary}}
  */
-  __pyx_t_10 = PyList_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1150, __pyx_L1_error)
+  __pyx_t_10 = PyList_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1270, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_10, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_10, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_10) < 0) __PYX_ERR(0, 1150, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_10) < 0) __PYX_ERR(0, 1270, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1151
+  /* "cssm.pyx":1271
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  *                                                          'possible_choices': [-1, 1],
  *                                                          'trajectory': traj,             # <<<<<<<<<<<<<<
  *                                                          'boundary': boundary}}
  * 
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1151, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1271, __pyx_L1_error)
 
-  /* "cssm.pyx":1152
+  /* "cssm.pyx":1272
  *                                                          'possible_choices': [-1, 1],
  *                                                          'trajectory': traj,
  *                                                          'boundary': boundary}}             # <<<<<<<<<<<<<<
  * 
  * # -------------------------------------------------------------------------------------------------
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1152, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_1) < 0) __PYX_ERR(0, 1136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1272, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_1) < 0) __PYX_ERR(0, 1256, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_12;
   __pyx_t_12 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":1027
+  /* "cssm.pyx":1147
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def full_ddm(np.ndarray[float, ndim = 1] v, # = 0,             # <<<<<<<<<<<<<<
  *              np.ndarray[float, ndim = 1] a, # = 1,
  *              np.ndarray[float, ndim = 1] z, # = 0.5,
  */
 
@@ -17998,32 +19740,32 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_rts_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
-  __Pyx_XDECREF(__pyx_8genexpr5__pyx_v_key);
+  __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":1159
+/* "cssm.pyx":1279
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_sdv(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *             np.ndarray[float, ndim = 1] a,
  *             np.ndarray[float, ndim = 1] z,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_21ddm_sdv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_21ddm_sdv = {"ddm_sdv", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_21ddm_sdv, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_21ddm_sdv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_23ddm_sdv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_23ddm_sdv = {"ddm_sdv", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_23ddm_sdv, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_23ddm_sdv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z = 0;
   PyArrayObject *__pyx_v_t = 0;
   PyArrayObject *__pyx_v_sv = 0;
   float __pyx_v_s;
   float __pyx_v_delta_t;
@@ -18040,34 +19782,34 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ddm_sdv (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_sv,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[14] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":1169
+    /* "cssm.pyx":1289
  *             int n_samples = 20000,
  *             int n_trials = 1,
  *             boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *             boundary_multiplicative = True,
  *             boundary_params = {},
  */
     values[10] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":1170
+    /* "cssm.pyx":1290
  *             int n_trials = 1,
  *             boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *             boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *             boundary_params = {},
  *             random_state = None,
  */
     values[11] = ((PyObject *)Py_True);
-    values[12] = __pyx_k__10;
+    values[12] = __pyx_k__11;
 
-    /* "cssm.pyx":1172
+    /* "cssm.pyx":1292
  *             boundary_multiplicative = True,
  *             boundary_params = {},
  *             random_state = None,             # <<<<<<<<<<<<<<
  *             ):
  * 
  */
     values[13] = ((PyObject *)Py_None);
@@ -18111,33 +19853,33 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_sdv", 0, 5, 14, 1); __PYX_ERR(0, 1159, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_sdv", 0, 5, 14, 1); __PYX_ERR(0, 1279, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_sdv", 0, 5, 14, 2); __PYX_ERR(0, 1159, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_sdv", 0, 5, 14, 2); __PYX_ERR(0, 1279, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_sdv", 0, 5, 14, 3); __PYX_ERR(0, 1159, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_sdv", 0, 5, 14, 3); __PYX_ERR(0, 1279, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sv)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_sdv", 0, 5, 14, 4); __PYX_ERR(0, 1159, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_sdv", 0, 5, 14, 4); __PYX_ERR(0, 1279, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[5] = value; kw_args--; }
         }
@@ -18187,15 +19929,15 @@
         case 13:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[13] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_sdv") < 0)) __PYX_ERR(0, 1159, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_sdv") < 0)) __PYX_ERR(0, 1279, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 14: values[13] = PyTuple_GET_ITEM(__pyx_args, 13);
         CYTHON_FALLTHROUGH;
         case 13: values[12] = PyTuple_GET_ITEM(__pyx_args, 12);
         CYTHON_FALLTHROUGH;
@@ -18224,59 +19966,59 @@
     }
     __pyx_v_v = ((PyArrayObject *)values[0]);
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_t = ((PyArrayObject *)values[3]);
     __pyx_v_sv = ((PyArrayObject *)values[4]);
     if (values[5]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1164, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1284, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[6]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1165, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1285, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[7]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1166, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1286, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[8]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1167, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1287, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[9]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1168, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1288, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_boundary_fun = values[10];
     __pyx_v_boundary_multiplicative = values[11];
     __pyx_v_boundary_params = values[12];
     __pyx_v_random_state = values[13];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ddm_sdv", 0, 5, 14, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1159, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ddm_sdv", 0, 5, 14, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1279, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ddm_sdv", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1159, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1160, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1161, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1162, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sv), __pyx_ptype_5numpy_ndarray, 1, "sv", 0))) __PYX_ERR(0, 1163, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_20ddm_sdv(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_sv, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1279, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1280, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1281, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1282, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_sv), __pyx_ptype_5numpy_ndarray, 1, "sv", 0))) __PYX_ERR(0, 1283, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_22ddm_sdv(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_sv, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":1159
+  /* "cssm.pyx":1279
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_sdv(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *             np.ndarray[float, ndim = 1] a,
  *             np.ndarray[float, ndim = 1] z,
  */
 
@@ -18285,15 +20027,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_20ddm_sdv(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sv, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_22ddm_sdv(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sv, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   PyObject *__pyx_v_traj = NULL;
   __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_sv_view = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -18312,15 +20054,15 @@
   Py_ssize_t __pyx_v_n;
   Py_ssize_t __pyx_v_ix;
   Py_ssize_t __pyx_v_k;
   Py_ssize_t __pyx_v_m;
   float __pyx_v_drift_increment;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
-  PyObject *__pyx_8genexpr6__pyx_v_key = NULL;
+  PyObject *__pyx_8genexpr7__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_sv;
   __Pyx_Buffer __pyx_pybuffer_sv;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
   __Pyx_Buffer __pyx_pybuffer_t;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
@@ -18338,22 +20080,22 @@
   PyObject *__pyx_t_7 = NULL;
   __Pyx_memviewslice __pyx_t_8 = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_t_9 = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_t_10 = NULL;
   int __pyx_t_11;
   PyObject *__pyx_t_12 = NULL;
   int __pyx_t_13;
-  float __pyx_t_14;
-  int __pyx_t_15;
+  Py_ssize_t __pyx_t_14;
+  Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
-  Py_ssize_t __pyx_t_17;
-  Py_ssize_t __pyx_t_18;
+  int __pyx_t_17;
+  int __pyx_t_18;
   int __pyx_t_19;
-  int __pyx_t_20;
-  Py_ssize_t __pyx_t_21;
+  Py_ssize_t __pyx_t_20;
+  float __pyx_t_21;
   Py_ssize_t __pyx_t_22;
   Py_ssize_t __pyx_t_23;
   int __pyx_t_24;
   Py_ssize_t __pyx_t_25;
   int __pyx_t_26;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -18377,335 +20119,335 @@
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   __pyx_pybuffer_sv.pybuffer.buf = NULL;
   __pyx_pybuffer_sv.refcount = 0;
   __pyx_pybuffernd_sv.data = NULL;
   __pyx_pybuffernd_sv.rcbuffer = &__pyx_pybuffer_sv;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1159, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1279, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1159, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1279, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1159, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1279, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1159, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1279, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sv.rcbuffer->pybuffer, (PyObject*)__pyx_v_sv, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1159, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_sv.rcbuffer->pybuffer, (PyObject*)__pyx_v_sv, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1279, __pyx_L1_error)
   }
   __pyx_pybuffernd_sv.diminfo[0].strides = __pyx_pybuffernd_sv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_sv.diminfo[0].shape = __pyx_pybuffernd_sv.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":1175
+  /* "cssm.pyx":1295
  *             ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1175, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1177
+  /* "cssm.pyx":1297
  *     set_seed(random_state)
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1177, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_traj = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "cssm.pyx":1178
+  /* "cssm.pyx":1298
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:,:] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1178, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1298, __pyx_L1_error)
 
-  /* "cssm.pyx":1179
+  /* "cssm.pyx":1299
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     # Param views
  */
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1179, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1299, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "cssm.pyx":1182
+  /* "cssm.pyx":1302
  * 
  *     # Param views
  *     cdef float[:] v_view  = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1182, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1302, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1183
+  /* "cssm.pyx":1303
  *     # Param views
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1183, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1303, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1184
+  /* "cssm.pyx":1304
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  *     cdef float[:] sv_view = sv
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1184, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1304, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1185
+  /* "cssm.pyx":1305
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  *     cdef float[:] sv_view = sv
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1185, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1305, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1186
+  /* "cssm.pyx":1306
  *     cdef float[:] z_view = z
  *     cdef float[:] t_view = t
  *     cdef float[:] sv_view = sv             # <<<<<<<<<<<<<<
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_sv), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1186, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_sv), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1306, __pyx_L1_error)
   __pyx_v_sv_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1188
+  /* "cssm.pyx":1308
  *     cdef float[:] sv_view = sv
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_int_1);
   __pyx_t_4 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1188, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1308, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1188, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_rts = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "cssm.pyx":1189
+  /* "cssm.pyx":1309
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
   __pyx_t_4 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1189, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":1191
+  /* "cssm.pyx":1311
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1191, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1311, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":1192
+  /* "cssm.pyx":1312
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1192, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1312, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":1194
+  /* "cssm.pyx":1314
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":1195
+  /* "cssm.pyx":1315
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage for the upper bound
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":1198
+  /* "cssm.pyx":1318
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":1199
+  /* "cssm.pyx":1319
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_10 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -18714,1229 +20456,986 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_3, __pyx_t_4};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1319, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_3, __pyx_t_4};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1319, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1199, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_10) {
       __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_4);
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1319, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_12 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_12)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_12);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_7 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_12, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_t_s = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":1200
+  /* "cssm.pyx":1320
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 1200, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_boundary = __pyx_t_12;
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":1201
+  /* "cssm.pyx":1321
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
- *     # Precompute boundary evaluations
+ *     cdef float y, t_particle
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1201, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1321, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1204
- * 
- *     # Precompute boundary evaluations
- *     if boundary_multiplicative:             # <<<<<<<<<<<<<<
- *         # print(a)
- *         boundary_view[:] = np.multiply(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)
- */
-  __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1204, __pyx_L1_error)
-  if (__pyx_t_13) {
-
-    /* "cssm.pyx":1206
- *     if boundary_multiplicative:
- *         # print(a)
- *         boundary_view[:] = np.multiply(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)             # <<<<<<<<<<<<<<
- *     else:
- *         # print(a)
- */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1206, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_multiply); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1206, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1206, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1206, __pyx_L1_error)
-    __pyx_t_1 = __pyx_t_4;
-    __pyx_t_4 = 0;
-    if (unlikely(__pyx_v_boundary_params == Py_None)) {
-      PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-      __PYX_ERR(0, 1206, __pyx_L1_error)
-    }
-    if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params) < 0) __PYX_ERR(0, 1206, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1206, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = NULL;
-    __pyx_t_11 = 0;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
-      if (likely(__pyx_t_1)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-        __Pyx_INCREF(__pyx_t_1);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_2, function);
-        __pyx_t_11 = 1;
-      }
-    }
-    #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(__pyx_t_2)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_1, ((PyObject *)__pyx_v_a), __pyx_t_4};
-      __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1206, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    } else
-    #endif
-    #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_1, ((PyObject *)__pyx_v_a), __pyx_t_4};
-      __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1206, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    } else
-    #endif
-    {
-      __pyx_t_3 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1206, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      if (__pyx_t_1) {
-        __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
-      }
-      __Pyx_INCREF(((PyObject *)__pyx_v_a));
-      __Pyx_GIVEREF(((PyObject *)__pyx_v_a));
-      PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_11, ((PyObject *)__pyx_v_a));
-      __Pyx_GIVEREF(__pyx_t_4);
-      PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_11, __pyx_t_4);
-      __pyx_t_4 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1206, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    }
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1206, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1206, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
-      if (likely(__pyx_t_3)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-        __Pyx_INCREF(__pyx_t_3);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_2, function);
-      }
-    }
-    __pyx_t_12 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_7);
-    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1206, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_12);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_14 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_14 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1206, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    {
-        float __pyx_temp_scalar = __pyx_t_14;
-        {
-            Py_ssize_t __pyx_temp_extent_0 = __pyx_v_boundary_view.shape[0];
-            Py_ssize_t __pyx_temp_stride_0 = __pyx_v_boundary_view.strides[0];
-            char *__pyx_temp_pointer_0;
-            Py_ssize_t __pyx_temp_idx_0;
-            __pyx_temp_pointer_0 = __pyx_v_boundary_view.data;
-            for (__pyx_temp_idx_0 = 0; __pyx_temp_idx_0 < __pyx_temp_extent_0; __pyx_temp_idx_0++) {
-              *((float *) __pyx_temp_pointer_0) = __pyx_temp_scalar;
-              __pyx_temp_pointer_0 += __pyx_temp_stride_0;
-            }
-        }
-    }
-
-    /* "cssm.pyx":1204
- * 
- *     # Precompute boundary evaluations
- *     if boundary_multiplicative:             # <<<<<<<<<<<<<<
- *         # print(a)
- *         boundary_view[:] = np.multiply(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)
- */
-    goto __pyx_L3;
-  }
-
-  /* "cssm.pyx":1209
- *     else:
- *         # print(a)
- *         boundary_view[:] = np.add(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)             # <<<<<<<<<<<<<<
- * 
- *     cdef float y, t_particle
- */
-  /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1209, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1209, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1209, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1209, __pyx_L1_error)
-    __pyx_t_7 = __pyx_t_4;
-    __pyx_t_4 = 0;
-    if (unlikely(__pyx_v_boundary_params == Py_None)) {
-      PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-      __PYX_ERR(0, 1209, __pyx_L1_error)
-    }
-    if (__Pyx_MergeKeywords(__pyx_t_7, __pyx_v_boundary_params) < 0) __PYX_ERR(0, 1209, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1209, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = NULL;
-    __pyx_t_11 = 0;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
-      if (likely(__pyx_t_7)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-        __Pyx_INCREF(__pyx_t_7);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_3, function);
-        __pyx_t_11 = 1;
-      }
-    }
-    #if CYTHON_FAST_PYCALL
-    if (PyFunction_Check(__pyx_t_3)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_7, ((PyObject *)__pyx_v_a), __pyx_t_4};
-      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    } else
-    #endif
-    #if CYTHON_FAST_PYCCALL
-    if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_7, ((PyObject *)__pyx_v_a), __pyx_t_4};
-      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    } else
-    #endif
-    {
-      __pyx_t_1 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (__pyx_t_7) {
-        __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7); __pyx_t_7 = NULL;
-      }
-      __Pyx_INCREF(((PyObject *)__pyx_v_a));
-      __Pyx_GIVEREF(((PyObject *)__pyx_v_a));
-      PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_11, ((PyObject *)__pyx_v_a));
-      __Pyx_GIVEREF(__pyx_t_4);
-      PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_11, __pyx_t_4);
-      __pyx_t_4 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    }
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1209, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
-      if (likely(__pyx_t_1)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-        __Pyx_INCREF(__pyx_t_1);
-        __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_3, function);
-      }
-    }
-    __pyx_t_12 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
-    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1209, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_12);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_14 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_14 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1209, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    {
-        float __pyx_temp_scalar = __pyx_t_14;
-        {
-            Py_ssize_t __pyx_temp_extent_0 = __pyx_v_boundary_view.shape[0];
-            Py_ssize_t __pyx_temp_stride_0 = __pyx_v_boundary_view.strides[0];
-            char *__pyx_temp_pointer_0;
-            Py_ssize_t __pyx_temp_idx_0;
-            __pyx_temp_pointer_0 = __pyx_v_boundary_view.data;
-            for (__pyx_temp_idx_0 = 0; __pyx_temp_idx_0 < __pyx_temp_extent_0; __pyx_temp_idx_0++) {
-              *((float *) __pyx_temp_pointer_0) = __pyx_temp_scalar;
-              __pyx_temp_pointer_0 += __pyx_temp_stride_0;
-            }
-        }
-    }
-  }
-  __pyx_L3:;
-
-  /* "cssm.pyx":1213
+  /* "cssm.pyx":1325
  *     cdef float y, t_particle
  *     cdef Py_ssize_t n, ix, k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     cdef float drift_increment = 0.0
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":1214
+  /* "cssm.pyx":1326
  *     cdef Py_ssize_t n, ix, k
  *     cdef Py_ssize_t m = 0
  *     cdef float drift_increment = 0.0             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_drift_increment = 0.0;
 
-  /* "cssm.pyx":1215
+  /* "cssm.pyx":1327
  *     cdef Py_ssize_t m = 0
  *     cdef float drift_increment = 0.0
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
-  __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1215, __pyx_L1_error)
+  __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1327, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1217
+  /* "cssm.pyx":1329
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_11 = __pyx_v_n_trials;
-  __pyx_t_15 = __pyx_t_11;
-  for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
-    __pyx_v_k = __pyx_t_16;
+  __pyx_t_13 = __pyx_t_11;
+  for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
+    __pyx_v_k = __pyx_t_14;
 
-    /* "cssm.pyx":1219
+    /* "cssm.pyx":1331
  *     for k in range(n_trials):
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         if boundary_multiplicative:
  */
     { /* enter inner scope */
-      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1219, __pyx_L8_error)
+      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1331, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_12);
-      __pyx_t_17 = 0;
+      __pyx_t_15 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 1219, __pyx_L8_error)
+        __PYX_ERR(0, 1331, __pyx_L7_error)
       }
-      __pyx_t_2 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_18), (&__pyx_t_19)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1219, __pyx_L8_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_XDECREF(__pyx_t_3);
-      __pyx_t_3 = __pyx_t_2;
-      __pyx_t_2 = 0;
+      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1331, __pyx_L7_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_XDECREF(__pyx_t_7);
+      __pyx_t_7 = __pyx_t_1;
+      __pyx_t_1 = 0;
       while (1) {
-        __pyx_t_20 = __Pyx_dict_iter_next(__pyx_t_3, __pyx_t_18, &__pyx_t_17, &__pyx_t_2, NULL, NULL, __pyx_t_19);
-        if (unlikely(__pyx_t_20 == 0)) break;
-        if (unlikely(__pyx_t_20 == -1)) __PYX_ERR(0, 1219, __pyx_L8_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_XDECREF_SET(__pyx_8genexpr6__pyx_v_key, __pyx_t_2);
-        __pyx_t_2 = 0;
-        __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr6__pyx_v_key); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1219, __pyx_L8_error)
-        __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1219, __pyx_L8_error)
+        __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_16, &__pyx_t_15, &__pyx_t_1, NULL, NULL, __pyx_t_17);
+        if (unlikely(__pyx_t_18 == 0)) break;
+        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 1331, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr6__pyx_v_key, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 1219, __pyx_L8_error)
+        __Pyx_XDECREF_SET(__pyx_8genexpr7__pyx_v_key, __pyx_t_1);
+        __pyx_t_1 = 0;
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr7__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1331, __pyx_L7_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1331, __pyx_L7_error)
+        __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr7__pyx_v_key, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 1331, __pyx_L7_error)
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_key); __pyx_8genexpr6__pyx_v_key = 0;
-      goto __pyx_L11_exit_scope;
-      __pyx_L8_error:;
-      __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_key); __pyx_8genexpr6__pyx_v_key = 0;
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_key); __pyx_8genexpr7__pyx_v_key = 0;
+      goto __pyx_L10_exit_scope;
+      __pyx_L7_error:;
+      __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_key); __pyx_8genexpr7__pyx_v_key = 0;
       goto __pyx_L1_error;
-      __pyx_L11_exit_scope:;
+      __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_12));
     __pyx_t_12 = 0;
 
-    /* "cssm.pyx":1221
+    /* "cssm.pyx":1333
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  * 
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             boundary_view[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  */
-    __pyx_t_13 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1221, __pyx_L1_error)
-    if (__pyx_t_13) {
+    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 1333, __pyx_L1_error)
+    if (__pyx_t_19) {
 
-      /* "cssm.pyx":1222
+      /* "cssm.pyx":1334
  * 
  *         if boundary_multiplicative:
  *             boundary_view[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             boundary_view[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1222, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_multiply); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1222, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1334, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_21 = __pyx_v_k;
-      __pyx_t_1 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1222, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1334, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1222, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
-      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1222, __pyx_L1_error)
-      __pyx_t_4 = __pyx_t_7;
-      __pyx_t_7 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1222, __pyx_L1_error)
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1222, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_7);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_20 = __pyx_v_k;
+      __pyx_t_2 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1334, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1334, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1334, __pyx_L1_error)
+      __pyx_t_4 = __pyx_t_3;
+      __pyx_t_3 = 0;
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1334, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1334, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
-      __pyx_t_19 = 0;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
+      __pyx_t_17 = 0;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_4)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
-          __pyx_t_19 = 1;
+          __Pyx_DECREF_SET(__pyx_t_1, function);
+          __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
-      if (PyFunction_Check(__pyx_t_2)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_1, __pyx_t_7};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_19, 2+__pyx_t_19); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1222, __pyx_L1_error)
+      if (PyFunction_Check(__pyx_t_1)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_2, __pyx_t_3};
+        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1334, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_GOTREF(__pyx_t_7);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
-      if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_1, __pyx_t_7};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_19, 2+__pyx_t_19); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1222, __pyx_L1_error)
+      if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
+        PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_2, __pyx_t_3};
+        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1334, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_GOTREF(__pyx_t_7);
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       {
-        __pyx_t_10 = PyTuple_New(2+__pyx_t_19); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1222, __pyx_L1_error)
+        __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1334, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
-        __Pyx_GIVEREF(__pyx_t_1);
-        PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_19, __pyx_t_1);
-        __Pyx_GIVEREF(__pyx_t_7);
-        PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_19, __pyx_t_7);
-        __pyx_t_1 = 0;
-        __pyx_t_7 = 0;
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1222, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_GIVEREF(__pyx_t_2);
+        PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_17, __pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_17, __pyx_t_3);
+        __pyx_t_2 = 0;
+        __pyx_t_3 = 0;
+        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1334, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       }
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1222, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1222, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1334, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1334, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
       __pyx_t_10 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
+        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_10)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
+          __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
-      __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_10, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
+      __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1222, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1334, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_14 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_14 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1222, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_21 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_21 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1334, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       {
-          float __pyx_temp_scalar = __pyx_t_14;
+          float __pyx_temp_scalar = __pyx_t_21;
           {
               Py_ssize_t __pyx_temp_extent_0 = __pyx_v_boundary_view.shape[0];
               Py_ssize_t __pyx_temp_stride_0 = __pyx_v_boundary_view.strides[0];
               char *__pyx_temp_pointer_0;
               Py_ssize_t __pyx_temp_idx_0;
               __pyx_temp_pointer_0 = __pyx_v_boundary_view.data;
               for (__pyx_temp_idx_0 = 0; __pyx_temp_idx_0 < __pyx_temp_extent_0; __pyx_temp_idx_0++) {
                 *((float *) __pyx_temp_pointer_0) = __pyx_temp_scalar;
                 __pyx_temp_pointer_0 += __pyx_temp_stride_0;
               }
           }
       }
 
-      /* "cssm.pyx":1221
+      /* "cssm.pyx":1333
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  * 
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             boundary_view[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  */
-      goto __pyx_L12;
+      goto __pyx_L11;
     }
 
-    /* "cssm.pyx":1224
+    /* "cssm.pyx":1336
  *             boundary_view[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  *             boundary_view[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Loop over samples
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1224, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1224, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1336, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_21 = __pyx_v_k;
-      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1224, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1224, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1224, __pyx_L1_error)
-      __pyx_t_7 = __pyx_t_1;
-      __pyx_t_1 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_7, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1224, __pyx_L1_error)
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1224, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = NULL;
-      __pyx_t_19 = 0;
+      __pyx_t_20 = __pyx_v_k;
+      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_7);
+      __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __pyx_t_3 = __pyx_t_2;
+      __pyx_t_2 = 0;
+      if (__Pyx_MergeKeywords(__pyx_t_3, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = NULL;
+      __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
-        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_10);
-        if (likely(__pyx_t_7)) {
+        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_10);
+        if (likely(__pyx_t_3)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
-          __Pyx_INCREF(__pyx_t_7);
+          __Pyx_INCREF(__pyx_t_3);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
-          __pyx_t_19 = 1;
+          __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_10)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_3, __pyx_t_1};
-        __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_19, 2+__pyx_t_19); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1224, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_7, __pyx_t_2};
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1336, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_3, __pyx_t_1};
-        __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_19, 2+__pyx_t_19); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1224, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __Pyx_GOTREF(__pyx_t_2);
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_7, __pyx_t_2};
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1336, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       } else
       #endif
       {
-        __pyx_t_4 = PyTuple_New(2+__pyx_t_19); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1224, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1336, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        if (__pyx_t_7) {
-          __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
+        if (__pyx_t_3) {
+          __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
         }
-        __Pyx_GIVEREF(__pyx_t_3);
-        PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_19, __pyx_t_3);
-        __Pyx_GIVEREF(__pyx_t_1);
-        PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_19, __pyx_t_1);
-        __pyx_t_3 = 0;
-        __pyx_t_1 = 0;
-        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1224, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_7);
+        PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_17, __pyx_t_7);
+        __Pyx_GIVEREF(__pyx_t_2);
+        PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_17, __pyx_t_2);
+        __pyx_t_7 = 0;
+        __pyx_t_2 = 0;
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1336, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1224, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1336, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1224, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1336, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
-      __pyx_t_12 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_2);
+      __pyx_t_12 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_4, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1224, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1336, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_14 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_14 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1224, __pyx_L1_error)
+      __pyx_t_21 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_21 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1336, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       {
-          float __pyx_temp_scalar = __pyx_t_14;
+          float __pyx_temp_scalar = __pyx_t_21;
           {
               Py_ssize_t __pyx_temp_extent_0 = __pyx_v_boundary_view.shape[0];
               Py_ssize_t __pyx_temp_stride_0 = __pyx_v_boundary_view.strides[0];
               char *__pyx_temp_pointer_0;
               Py_ssize_t __pyx_temp_idx_0;
               __pyx_temp_pointer_0 = __pyx_v_boundary_view.data;
               for (__pyx_temp_idx_0 = 0; __pyx_temp_idx_0 < __pyx_temp_extent_0; __pyx_temp_idx_0++) {
                 *((float *) __pyx_temp_pointer_0) = __pyx_temp_scalar;
                 __pyx_temp_pointer_0 += __pyx_temp_stride_0;
               }
           }
       }
     }
-    __pyx_L12:;
+    __pyx_L11:;
 
-    /* "cssm.pyx":1227
+    /* "cssm.pyx":1339
  * 
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             # initialize starting point
  *             y = ((-1) * boundary_view[0]) + (z_view[k] * 2.0 * (boundary_view[0]))  # reset starting position
  */
-    __pyx_t_19 = __pyx_v_n_samples;
-    __pyx_t_20 = __pyx_t_19;
-    for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_20; __pyx_t_18+=1) {
-      __pyx_v_n = __pyx_t_18;
+    __pyx_t_17 = __pyx_v_n_samples;
+    __pyx_t_18 = __pyx_t_17;
+    for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_18; __pyx_t_16+=1) {
+      __pyx_v_n = __pyx_t_16;
 
-      /* "cssm.pyx":1229
+      /* "cssm.pyx":1341
  *         for n in range(n_samples):
  *             # initialize starting point
  *             y = ((-1) * boundary_view[0]) + (z_view[k] * 2.0 * (boundary_view[0]))  # reset starting position             # <<<<<<<<<<<<<<
  * 
  *             # get drift by random displacement of v
  */
-      __pyx_t_21 = 0;
+      __pyx_t_20 = 0;
       __pyx_t_22 = __pyx_v_k;
       __pyx_t_23 = 0;
-      __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_22 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_23 * __pyx_v_boundary_view.strides[0]) )))));
+      __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_22 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_23 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":1232
+      /* "cssm.pyx":1344
  * 
  *             # get drift by random displacement of v
  *             drift_increment = (v_view[k] + sv_view[k] * gaussian_values[m]) * delta_t             # <<<<<<<<<<<<<<
  * 
  *             # increment m appropriately
  */
       __pyx_t_23 = __pyx_v_k;
       __pyx_t_22 = __pyx_v_k;
-      __pyx_t_21 = __pyx_v_m;
-      __pyx_v_drift_increment = (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_23 * __pyx_v_v_view.strides[0]) ))) + ((*((float *) ( /* dim=0 */ (__pyx_v_sv_view.data + __pyx_t_22 * __pyx_v_sv_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_21 * __pyx_v_gaussian_values.strides[0]) ))))) * __pyx_v_delta_t);
+      __pyx_t_20 = __pyx_v_m;
+      __pyx_v_drift_increment = (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_23 * __pyx_v_v_view.strides[0]) ))) + ((*((float *) ( /* dim=0 */ (__pyx_v_sv_view.data + __pyx_t_22 * __pyx_v_sv_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))) * __pyx_v_delta_t);
 
-      /* "cssm.pyx":1235
+      /* "cssm.pyx":1347
  * 
  *             # increment m appropriately
  *             m += 1             # <<<<<<<<<<<<<<
  *             if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
       __pyx_v_m = (__pyx_v_m + 1);
 
-      /* "cssm.pyx":1236
+      /* "cssm.pyx":1348
  *             # increment m appropriately
  *             m += 1
  *             if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
-      __pyx_t_13 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
-      if (__pyx_t_13) {
+      __pyx_t_19 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
+      if (__pyx_t_19) {
 
-        /* "cssm.pyx":1237
+        /* "cssm.pyx":1349
  *             m += 1
  *             if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-        __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1237, __pyx_L1_error)
+        __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1349, __pyx_L1_error)
         __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
         __pyx_v_gaussian_values = __pyx_t_6;
         __pyx_t_6.memview = NULL;
         __pyx_t_6.data = NULL;
 
-        /* "cssm.pyx":1238
+        /* "cssm.pyx":1350
  *             if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             t_particle = 0.0 # reset time
  */
         __pyx_v_m = 0;
 
-        /* "cssm.pyx":1236
+        /* "cssm.pyx":1348
  *             # increment m appropriately
  *             m += 1
  *             if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
       }
 
-      /* "cssm.pyx":1240
+      /* "cssm.pyx":1352
  *                     m = 0
  * 
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":1241
+      /* "cssm.pyx":1353
  * 
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             if n == 0:
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":1243
+      /* "cssm.pyx":1355
  *             ix = 0 # reset boundary index
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
-      __pyx_t_13 = ((__pyx_v_n == 0) != 0);
-      if (__pyx_t_13) {
+      __pyx_t_19 = ((__pyx_v_n == 0) != 0);
+      if (__pyx_t_19) {
 
-        /* "cssm.pyx":1244
+        /* "cssm.pyx":1356
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
-        __pyx_t_13 = ((__pyx_v_k == 0) != 0);
-        if (__pyx_t_13) {
+        __pyx_t_19 = ((__pyx_v_k == 0) != 0);
+        if (__pyx_t_19) {
 
-          /* "cssm.pyx":1245
+          /* "cssm.pyx":1357
  *             if n == 0:
  *                 if k == 0:
  *                     traj_view[0, 0] = y             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
-          __pyx_t_21 = 0;
+          __pyx_t_20 = 0;
           __pyx_t_22 = 0;
-          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_21 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_22 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
+          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_22 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-          /* "cssm.pyx":1244
+          /* "cssm.pyx":1356
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         }
 
-        /* "cssm.pyx":1243
+        /* "cssm.pyx":1355
  *             ix = 0 # reset boundary index
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       }
 
-      /* "cssm.pyx":1248
+      /* "cssm.pyx":1360
  * 
  *             # Random walker
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  */
       while (1) {
         __pyx_t_22 = __pyx_v_ix;
         __pyx_t_24 = ((__pyx_v_y >= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_22 * __pyx_v_boundary_view.strides[0]) ))))) != 0);
         if (__pyx_t_24) {
         } else {
-          __pyx_t_13 = __pyx_t_24;
-          goto __pyx_L20_bool_binop_done;
+          __pyx_t_19 = __pyx_t_24;
+          goto __pyx_L19_bool_binop_done;
         }
         __pyx_t_22 = __pyx_v_ix;
         __pyx_t_24 = ((__pyx_v_y <= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_22 * __pyx_v_boundary_view.strides[0]) )))) != 0);
         if (__pyx_t_24) {
         } else {
-          __pyx_t_13 = __pyx_t_24;
-          goto __pyx_L20_bool_binop_done;
+          __pyx_t_19 = __pyx_t_24;
+          goto __pyx_L19_bool_binop_done;
         }
         __pyx_t_24 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
-        __pyx_t_13 = __pyx_t_24;
-        __pyx_L20_bool_binop_done:;
-        if (!__pyx_t_13) break;
+        __pyx_t_19 = __pyx_t_24;
+        __pyx_L19_bool_binop_done:;
+        if (!__pyx_t_19) break;
 
-        /* "cssm.pyx":1249
+        /* "cssm.pyx":1361
  *             # Random walker
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 ix += 1
  */
         __pyx_t_22 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + (__pyx_v_drift_increment + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_22 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":1250
+        /* "cssm.pyx":1362
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":1251
+        /* "cssm.pyx":1363
  *                 y += drift_increment + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  * 
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":1252
+        /* "cssm.pyx":1364
  *                 t_particle += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  * 
  *                 if n == 0:
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":1254
+        /* "cssm.pyx":1366
  *                 m += 1
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
-        __pyx_t_13 = ((__pyx_v_n == 0) != 0);
-        if (__pyx_t_13) {
+        __pyx_t_19 = ((__pyx_v_n == 0) != 0);
+        if (__pyx_t_19) {
 
-          /* "cssm.pyx":1255
+          /* "cssm.pyx":1367
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  * 
  */
-          __pyx_t_13 = ((__pyx_v_k == 0) != 0);
-          if (__pyx_t_13) {
+          __pyx_t_19 = ((__pyx_v_k == 0) != 0);
+          if (__pyx_t_19) {
 
-            /* "cssm.pyx":1256
+            /* "cssm.pyx":1368
  *                 if n == 0:
  *                     if k == 0:
  *                         traj_view[ix, 0] = y             # <<<<<<<<<<<<<<
  * 
  *                 if m == num_draws:
  */
             __pyx_t_22 = __pyx_v_ix;
-            __pyx_t_21 = 0;
-            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
+            __pyx_t_20 = 0;
+            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_22 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-            /* "cssm.pyx":1255
+            /* "cssm.pyx":1367
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  * 
  */
           }
 
-          /* "cssm.pyx":1254
+          /* "cssm.pyx":1366
  *                 m += 1
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         }
 
-        /* "cssm.pyx":1258
+        /* "cssm.pyx":1370
  *                         traj_view[ix, 0] = y
  * 
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
-        __pyx_t_13 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
-        if (__pyx_t_13) {
+        __pyx_t_19 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
+        if (__pyx_t_19) {
 
-          /* "cssm.pyx":1259
+          /* "cssm.pyx":1371
  * 
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1259, __pyx_L1_error)
+          __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1371, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_6;
           __pyx_t_6.memview = NULL;
           __pyx_t_6.data = NULL;
 
-          /* "cssm.pyx":1260
+          /* "cssm.pyx":1372
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":1258
+          /* "cssm.pyx":1370
  *                         traj_view[ix, 0] = y
  * 
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":1263
+      /* "cssm.pyx":1375
  * 
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = np.sign(y) # Store choice
  * 
  */
-      __pyx_t_21 = __pyx_v_k;
+      __pyx_t_20 = __pyx_v_k;
       __pyx_t_22 = __pyx_v_n;
       __pyx_t_23 = __pyx_v_k;
       __pyx_t_25 = 0;
-      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_22 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_23 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_25 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) ))));
+      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_22 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_23 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_25 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":1264
+      /* "cssm.pyx":1376
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k] # Store rt
  *             choices_view[n, k, 0] = np.sign(y) # Store choice             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1264, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1376, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_sign); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1264, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_sign); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1376, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyFloat_FromDouble(__pyx_v_y); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1264, __pyx_L1_error)
+      __pyx_t_10 = PyFloat_FromDouble(__pyx_v_y); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1376, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __pyx_t_4 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_4)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
+          __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
-      __pyx_t_12 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_10);
+      __pyx_t_12 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_10);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1264, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1376, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_26 = __Pyx_PyInt_As_int(__pyx_t_12); if (unlikely((__pyx_t_26 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1264, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_26 = __Pyx_PyInt_As_int(__pyx_t_12); if (unlikely((__pyx_t_26 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1376, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __pyx_t_21 = __pyx_v_n;
+      __pyx_t_20 = __pyx_v_n;
       __pyx_t_25 = __pyx_v_k;
       __pyx_t_23 = 0;
-      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_25 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_23 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_26;
+      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_25 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_23 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_26;
     }
   }
 
-  /* "cssm.pyx":1267
+  /* "cssm.pyx":1379
  * 
  * 
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                           'a': a,
  *                                                           'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1267, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1379, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
-  __pyx_t_10 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1267, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1379, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
 
-  /* "cssm.pyx":1268
+  /* "cssm.pyx":1380
  * 
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                           'a': a,             # <<<<<<<<<<<<<<
  *                                                           'z': z,
  *                                                           't': t,
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
 
-  /* "cssm.pyx":1269
+  /* "cssm.pyx":1381
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                           'a': a,
  *                                                           'z': z,             # <<<<<<<<<<<<<<
  *                                                           't': t,
  *                                                           'sv': sv,
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
 
-  /* "cssm.pyx":1270
+  /* "cssm.pyx":1382
  *                                                           'a': a,
  *                                                           'z': z,
  *                                                           't': t,             # <<<<<<<<<<<<<<
  *                                                           'sv': sv,
  *                                                           's': s,
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
 
-  /* "cssm.pyx":1271
+  /* "cssm.pyx":1383
  *                                                           'z': z,
  *                                                           't': t,
  *                                                           'sv': sv,             # <<<<<<<<<<<<<<
  *                                                           's': s,
  *                                                           **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_sv, ((PyObject *)__pyx_v_sv)) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_sv, ((PyObject *)__pyx_v_sv)) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
 
-  /* "cssm.pyx":1272
+  /* "cssm.pyx":1384
  *                                                           't': t,
  *                                                           'sv': sv,
  *                                                           's': s,             # <<<<<<<<<<<<<<
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1272, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1384, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_s, __pyx_t_4) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_10, __pyx_n_u_s, __pyx_t_4) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_2 = __pyx_t_10;
+  __pyx_t_1 = __pyx_t_10;
   __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1273
+  /* "cssm.pyx":1385
  *                                                           'sv': sv,
  *                                                           's': s,
  *                                                           **boundary_params,             # <<<<<<<<<<<<<<
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 1273, __pyx_L1_error)
+    __PYX_ERR(0, 1385, __pyx_L1_error)
   }
-  if (unlikely(PyDict_Update(__pyx_t_2, __pyx_v_boundary_params) < 0)) {
+  if (unlikely(PyDict_Update(__pyx_t_1, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 1273, __pyx_L1_error)
+    __PYX_ERR(0, 1385, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":1274
+  /* "cssm.pyx":1386
  *                                                           's': s,
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,
  */
-  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1274, __pyx_L1_error)
+  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_delta_t, __pyx_t_10) < 0) __PYX_ERR(0, 1274, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_delta_t, __pyx_t_10) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1275
+  /* "cssm.pyx":1387
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ddm_sdv',
  */
-  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1275, __pyx_L1_error)
+  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1387, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_max_t, __pyx_t_10) < 0) __PYX_ERR(0, 1275, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_max_t, __pyx_t_10) < 0) __PYX_ERR(0, 1387, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1276
+  /* "cssm.pyx":1388
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                           'simulator': 'ddm_sdv',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1276, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1388, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_n_samples, __pyx_t_10) < 0) __PYX_ERR(0, 1276, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_10) < 0) __PYX_ERR(0, 1388, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_simulator, __pyx_n_u_ddm_sdv) < 0) __PYX_ERR(0, 1277, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_ddm_sdv) < 0) __PYX_ERR(0, 1389, __pyx_L1_error)
 
-  /* "cssm.pyx":1278
+  /* "cssm.pyx":1390
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ddm_sdv',
  *                                                           'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  */
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1278, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1390, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_boundary_fun_type, __pyx_t_10) < 0) __PYX_ERR(0, 1278, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_t_10) < 0) __PYX_ERR(0, 1390, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1279
+  /* "cssm.pyx":1391
  *                                                           'simulator': 'ddm_sdv',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],             # <<<<<<<<<<<<<<
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary}}
  */
-  __pyx_t_10 = PyList_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1279, __pyx_L1_error)
+  __pyx_t_10 = PyList_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1391, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_10, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_10, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_possible_choices, __pyx_t_10) < 0) __PYX_ERR(0, 1279, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_10) < 0) __PYX_ERR(0, 1391, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1280
+  /* "cssm.pyx":1392
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,             # <<<<<<<<<<<<<<
  *                                                           'boundary': boundary}}
  * 
  */
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1280, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1392, __pyx_L1_error)
 
-  /* "cssm.pyx":1281
+  /* "cssm.pyx":1393
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary}}             # <<<<<<<<<<<<<<
  * 
  * # -------------------------------------------------------------------------------------------------
  */
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1281, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_2) < 0) __PYX_ERR(0, 1267, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1393, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_1) < 0) __PYX_ERR(0, 1379, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_12;
   __pyx_t_12 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":1159
+  /* "cssm.pyx":1279
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_sdv(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *             np.ndarray[float, ndim = 1] a,
  *             np.ndarray[float, ndim = 1] z,
  */
 
@@ -19985,32 +21484,32 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_rts_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
-  __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_key);
+  __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":1288
+/* "cssm.pyx":1400
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ornstein_uhlenbeck(np.ndarray[float, ndim = 1] v, # drift parameter             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] a, # initial boundary separation
  *                        np.ndarray[float, ndim = 1] z, # starting point bias
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_23ornstein_uhlenbeck(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_23ornstein_uhlenbeck = {"ornstein_uhlenbeck", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_23ornstein_uhlenbeck, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_23ornstein_uhlenbeck(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_25ornstein_uhlenbeck(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_25ornstein_uhlenbeck = {"ornstein_uhlenbeck", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_25ornstein_uhlenbeck, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_25ornstein_uhlenbeck(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z = 0;
   PyArrayObject *__pyx_v_g = 0;
   PyArrayObject *__pyx_v_t = 0;
   float __pyx_v_s;
   float __pyx_v_delta_t;
@@ -20027,34 +21526,34 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ornstein_uhlenbeck (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_g,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[14] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":1298
+    /* "cssm.pyx":1410
  *                        int n_samples = 20000, # number of samples from process
  *                        int n_trials = 1,
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *                        boundary_multiplicative = True,
  *                        boundary_params = {},
  */
     values[10] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":1299
+    /* "cssm.pyx":1411
  *                        int n_trials = 1,
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                        boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *                        boundary_params = {},
  *                        random_state = None,
  */
     values[11] = ((PyObject *)Py_True);
-    values[12] = __pyx_k__11;
+    values[12] = __pyx_k__12;
 
-    /* "cssm.pyx":1301
+    /* "cssm.pyx":1413
  *                        boundary_multiplicative = True,
  *                        boundary_params = {},
  *                        random_state = None,             # <<<<<<<<<<<<<<
  *                       ):
  * 
  */
     values[13] = ((PyObject *)Py_None);
@@ -20098,33 +21597,33 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ornstein_uhlenbeck", 0, 5, 14, 1); __PYX_ERR(0, 1288, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ornstein_uhlenbeck", 0, 5, 14, 1); __PYX_ERR(0, 1400, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ornstein_uhlenbeck", 0, 5, 14, 2); __PYX_ERR(0, 1288, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ornstein_uhlenbeck", 0, 5, 14, 2); __PYX_ERR(0, 1400, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ornstein_uhlenbeck", 0, 5, 14, 3); __PYX_ERR(0, 1288, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ornstein_uhlenbeck", 0, 5, 14, 3); __PYX_ERR(0, 1400, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ornstein_uhlenbeck", 0, 5, 14, 4); __PYX_ERR(0, 1288, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ornstein_uhlenbeck", 0, 5, 14, 4); __PYX_ERR(0, 1400, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[5] = value; kw_args--; }
         }
@@ -20174,15 +21673,15 @@
         case 13:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[13] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ornstein_uhlenbeck") < 0)) __PYX_ERR(0, 1288, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ornstein_uhlenbeck") < 0)) __PYX_ERR(0, 1400, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 14: values[13] = PyTuple_GET_ITEM(__pyx_args, 13);
         CYTHON_FALLTHROUGH;
         case 13: values[12] = PyTuple_GET_ITEM(__pyx_args, 12);
         CYTHON_FALLTHROUGH;
@@ -20211,59 +21710,59 @@
     }
     __pyx_v_v = ((PyArrayObject *)values[0]);
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_g = ((PyArrayObject *)values[3]);
     __pyx_v_t = ((PyArrayObject *)values[4]);
     if (values[5]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1293, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1405, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[6]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1294, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1406, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[7]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1295, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1407, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[8]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1296, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1408, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[9]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1297, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1409, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_boundary_fun = values[10];
     __pyx_v_boundary_multiplicative = values[11];
     __pyx_v_boundary_params = values[12];
     __pyx_v_random_state = values[13];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ornstein_uhlenbeck", 0, 5, 14, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1288, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ornstein_uhlenbeck", 0, 5, 14, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1400, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ornstein_uhlenbeck", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1288, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1289, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1290, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) __PYX_ERR(0, 1291, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1292, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_22ornstein_uhlenbeck(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_g, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1400, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1401, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1402, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) __PYX_ERR(0, 1403, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1404, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_24ornstein_uhlenbeck(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_g, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":1288
+  /* "cssm.pyx":1400
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ornstein_uhlenbeck(np.ndarray[float, ndim = 1] v, # drift parameter             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] a, # initial boundary separation
  *                        np.ndarray[float, ndim = 1] z, # starting point bias
  */
 
@@ -20272,15 +21771,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_22ornstein_uhlenbeck(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_24ornstein_uhlenbeck(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   PyObject *__pyx_v_traj = NULL;
   __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_g_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -20298,15 +21797,15 @@
   float __pyx_v_t_particle;
   Py_ssize_t __pyx_v_n;
   Py_ssize_t __pyx_v_ix;
   Py_ssize_t __pyx_v_k;
   Py_ssize_t __pyx_v_m;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
-  PyObject *__pyx_8genexpr7__pyx_v_key = NULL;
+  PyObject *__pyx_8genexpr8__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
   __Pyx_Buffer __pyx_pybuffer_g;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
   __Pyx_Buffer __pyx_pybuffer_t;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
@@ -20362,360 +21861,360 @@
   __pyx_pybuffernd_g.rcbuffer = &__pyx_pybuffer_g;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1288, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1400, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1288, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1400, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1288, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1400, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g.rcbuffer->pybuffer, (PyObject*)__pyx_v_g, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1288, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g.rcbuffer->pybuffer, (PyObject*)__pyx_v_g, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1400, __pyx_L1_error)
   }
   __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1288, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1400, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":1304
+  /* "cssm.pyx":1416
  *                       ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1304, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1416, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1306
+  /* "cssm.pyx":1418
  *     set_seed(random_state)
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1306, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1306, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1306, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1306, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1306, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_1);
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1306, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1306, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1306, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1306, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1418, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1306, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_traj = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "cssm.pyx":1307
+  /* "cssm.pyx":1419
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:,:] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1307, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1419, __pyx_L1_error)
 
-  /* "cssm.pyx":1308
+  /* "cssm.pyx":1420
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:,:] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     # Param views
  */
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1308, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1420, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "cssm.pyx":1311
+  /* "cssm.pyx":1423
  * 
  *     # Param views
  *     cdef float[:] v_view  = v             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1311, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1423, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1312
+  /* "cssm.pyx":1424
  *     # Param views
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_view = z
  *     cdef float[:] g_view = g
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1312, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1424, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1313
+  /* "cssm.pyx":1425
  *     cdef float[:] v_view  = v
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:] g_view = g
  *     cdef float[:] t_view = t
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1313, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1425, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1314
+  /* "cssm.pyx":1426
  *     cdef float[:] a_view = a
  *     cdef float[:] z_view = z
  *     cdef float[:] g_view = g             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_g), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1314, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_g), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1426, __pyx_L1_error)
   __pyx_v_g_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1315
+  /* "cssm.pyx":1427
  *     cdef float[:] z_view = z
  *     cdef float[:] g_view = g
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     # Initializations
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1315, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1427, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1318
+  /* "cssm.pyx":1430
  * 
  *     # Initializations
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE) # rt storage             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc) # choice storage
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1318, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1318, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1318, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1318, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_int_1);
   __pyx_t_4 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1318, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1318, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1318, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1318, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1430, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1318, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_rts = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "cssm.pyx":1319
+  /* "cssm.pyx":1431
  *     # Initializations
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE) # rt storage
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc) # choice storage             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1319, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1319, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1319, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1319, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1319, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
   __pyx_t_4 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1319, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1319, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1319, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1319, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1319, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1319, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":1321
+  /* "cssm.pyx":1433
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc) # choice storage
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1321, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1433, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":1322
+  /* "cssm.pyx":1434
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = np.sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1322, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1434, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":1324
+  /* "cssm.pyx":1436
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = np.sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = s * delta_t_sqrt
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1324, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1324, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1324, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1324, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_10 = __pyx_PyFloat_AsFloat(__pyx_t_7); if (unlikely((__pyx_t_10 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1324, __pyx_L1_error)
+  __pyx_t_10 = __pyx_PyFloat_AsFloat(__pyx_t_7); if (unlikely((__pyx_t_10 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1436, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_delta_t_sqrt = __pyx_t_10;
 
-  /* "cssm.pyx":1325
+  /* "cssm.pyx":1437
  * 
  *     cdef float delta_t_sqrt = np.sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = s * delta_t_sqrt             # <<<<<<<<<<<<<<
  * 
  *     # Boundary Storage
  */
   __pyx_v_sqrt_st = (__pyx_v_s * __pyx_v_delta_t_sqrt);
 
-  /* "cssm.pyx":1328
+  /* "cssm.pyx":1440
  * 
  *     # Boundary Storage
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":1329
+  /* "cssm.pyx":1441
  *     # Boundary Storage
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1441, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1441, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1441, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1441, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_11 = NULL;
   __pyx_t_12 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_11)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -20724,231 +22223,231 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_12 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_int_0, __pyx_t_1, __pyx_t_4};
-    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1329, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1441, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_int_0, __pyx_t_1, __pyx_t_4};
-    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1329, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_12, 3+__pyx_t_12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1441, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   {
-    __pyx_t_13 = PyTuple_New(3+__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1329, __pyx_L1_error)
+    __pyx_t_13 = PyTuple_New(3+__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     if (__pyx_t_11) {
       __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_11); __pyx_t_11 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_12, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_13, 1+__pyx_t_12, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_13, 2+__pyx_t_12, __pyx_t_4);
     __pyx_t_1 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_13, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1329, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_13, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1441, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1441, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_13 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_13)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_13);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_7 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_13, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1441, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_t_s = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":1330
+  /* "cssm.pyx":1442
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1330, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1442, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1330, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1442, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1330, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1442, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1330, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1442, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1330, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1442, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1330, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1442, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_13) < 0) __PYX_ERR(0, 1330, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_13) < 0) __PYX_ERR(0, 1442, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-  __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1330, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1442, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_boundary = __pyx_t_13;
   __pyx_t_13 = 0;
 
-  /* "cssm.pyx":1331
+  /* "cssm.pyx":1443
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     cdef float y, t_particle
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1331, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1443, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1335
+  /* "cssm.pyx":1447
  *     cdef float y, t_particle
  *     cdef Py_ssize_t n, ix, k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":1336
+  /* "cssm.pyx":1448
  *     cdef Py_ssize_t n, ix, k
  *     cdef Py_ssize_t m = 0
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
-  __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1336, __pyx_L1_error)
+  __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1448, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1338
+  /* "cssm.pyx":1450
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_12 = __pyx_v_n_trials;
   __pyx_t_14 = __pyx_t_12;
   for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
     __pyx_v_k = __pyx_t_15;
 
-    /* "cssm.pyx":1340
+    /* "cssm.pyx":1452
  *     for k in range(n_trials):
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         # Precompute boundary evaluations
  */
     { /* enter inner scope */
-      __pyx_t_13 = PyDict_New(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1340, __pyx_L7_error)
+      __pyx_t_13 = PyDict_New(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1452, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_13);
       __pyx_t_16 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 1340, __pyx_L7_error)
+        __PYX_ERR(0, 1452, __pyx_L7_error)
       }
-      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_17), (&__pyx_t_18)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1340, __pyx_L7_error)
+      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_17), (&__pyx_t_18)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1452, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_XDECREF(__pyx_t_7);
       __pyx_t_7 = __pyx_t_3;
       __pyx_t_3 = 0;
       while (1) {
         __pyx_t_19 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_17, &__pyx_t_16, &__pyx_t_3, NULL, NULL, __pyx_t_18);
         if (unlikely(__pyx_t_19 == 0)) break;
-        if (unlikely(__pyx_t_19 == -1)) __PYX_ERR(0, 1340, __pyx_L7_error)
+        if (unlikely(__pyx_t_19 == -1)) __PYX_ERR(0, 1452, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_XDECREF_SET(__pyx_8genexpr7__pyx_v_key, __pyx_t_3);
+        __Pyx_XDECREF_SET(__pyx_8genexpr8__pyx_v_key, __pyx_t_3);
         __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr7__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1340, __pyx_L7_error)
+        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr8__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1452, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1340, __pyx_L7_error)
+        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1452, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_13, (PyObject*)__pyx_8genexpr7__pyx_v_key, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 1340, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_13, (PyObject*)__pyx_8genexpr8__pyx_v_key, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 1452, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_key); __pyx_8genexpr7__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr8__pyx_v_key); __pyx_8genexpr8__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_key); __pyx_8genexpr7__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr8__pyx_v_key); __pyx_8genexpr8__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_13));
     __pyx_t_13 = 0;
 
-    /* "cssm.pyx":1343
+    /* "cssm.pyx":1455
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-    __pyx_t_20 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_20 < 0)) __PYX_ERR(0, 1343, __pyx_L1_error)
+    __pyx_t_20 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_20 < 0)) __PYX_ERR(0, 1455, __pyx_L1_error)
     if (__pyx_t_20) {
 
-      /* "cssm.pyx":1345
+      /* "cssm.pyx":1457
  *         if boundary_multiplicative:
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             # print(a)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1345, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1457, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1345, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1457, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_21 = __pyx_v_k;
-      __pyx_t_2 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1345, __pyx_L1_error)
+      __pyx_t_2 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1457, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1345, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1457, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1345, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1457, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_1;
       __pyx_t_1 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1345, __pyx_L1_error)
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1345, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1457, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1457, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_18 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_4)) {
@@ -20958,105 +22457,105 @@
           __Pyx_DECREF_SET(__pyx_t_3, function);
           __pyx_t_18 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_2, __pyx_t_1};
-        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1345, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_2, __pyx_t_1};
-        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1345, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       } else
       #endif
       {
-        __pyx_t_11 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1345, __pyx_L1_error)
+        __pyx_t_11 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_2);
         PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_18, __pyx_t_2);
         __Pyx_GIVEREF(__pyx_t_1);
         PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_18, __pyx_t_1);
         __pyx_t_2 = 0;
         __pyx_t_1 = 0;
-        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_11, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1345, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_11, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1345, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1457, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1345, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __pyx_t_11 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_11)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_11);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_13 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_11, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_7);
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1345, __pyx_L1_error)
+      if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1457, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_13, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1345, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_13, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1457, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-      /* "cssm.pyx":1343
+      /* "cssm.pyx":1455
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":1348
+    /* "cssm.pyx":1460
  *         else:
  *             # print(a)
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Loop over samples
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1348, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1460, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1348, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_add); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1460, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_21 = __pyx_v_k;
-      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1348, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1460, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1348, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1460, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1348, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1460, __pyx_L1_error)
       __pyx_t_1 = __pyx_t_2;
       __pyx_t_2 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1348, __pyx_L1_error)
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1348, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1460, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1460, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       __pyx_t_18 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_11);
         if (likely(__pyx_t_1)) {
@@ -21066,166 +22565,166 @@
           __Pyx_DECREF_SET(__pyx_t_11, function);
           __pyx_t_18 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_11)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_7, __pyx_t_2};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1348, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1460, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_7, __pyx_t_2};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1348, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_18, 2+__pyx_t_18); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1460, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       } else
       #endif
       {
-        __pyx_t_4 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1348, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_New(2+__pyx_t_18); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1460, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         if (__pyx_t_1) {
           __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_18, __pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_2);
         PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_18, __pyx_t_2);
         __pyx_t_7 = 0;
         __pyx_t_2 = 0;
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1348, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1460, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1348, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1460, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1348, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1460, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_11);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
           __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_11, function);
         }
       }
       __pyx_t_13 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1348, __pyx_L1_error)
+      if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1460, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_13, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1348, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_13, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1460, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":1351
+    /* "cssm.pyx":1463
  * 
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * boundary_view[0])
  *             t_particle = 0.0
  */
     __pyx_t_18 = __pyx_v_n_samples;
     __pyx_t_19 = __pyx_t_18;
     for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_19; __pyx_t_17+=1) {
       __pyx_v_n = __pyx_t_17;
 
-      /* "cssm.pyx":1352
+      /* "cssm.pyx":1464
  *         # Loop over samples
  *         for n in range(n_samples):
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * boundary_view[0])             # <<<<<<<<<<<<<<
  *             t_particle = 0.0
  *             ix = 0
  */
       __pyx_t_21 = 0;
       __pyx_t_22 = __pyx_v_k;
       __pyx_t_23 = 0;
       __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_22 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_23 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":1353
+      /* "cssm.pyx":1465
  *         for n in range(n_samples):
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * boundary_view[0])
  *             t_particle = 0.0             # <<<<<<<<<<<<<<
  *             ix = 0
  * 
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":1354
+      /* "cssm.pyx":1466
  *             y = (-1) * boundary_view[0] + (z_view[k] * 2 * boundary_view[0])
  *             t_particle = 0.0
  *             ix = 0             # <<<<<<<<<<<<<<
  * 
  *             if n == 0:
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":1356
+      /* "cssm.pyx":1468
  *             ix = 0
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       __pyx_t_20 = ((__pyx_v_n == 0) != 0);
       if (__pyx_t_20) {
 
-        /* "cssm.pyx":1357
+        /* "cssm.pyx":1469
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         __pyx_t_20 = ((__pyx_v_k == 0) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":1358
+          /* "cssm.pyx":1470
  *             if n == 0:
  *                 if k == 0:
  *                     traj_view[0, 0] = y             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
           __pyx_t_23 = 0;
           __pyx_t_22 = 0;
           *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_23 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_22 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-          /* "cssm.pyx":1357
+          /* "cssm.pyx":1469
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     traj_view[0, 0] = y
  * 
  */
         }
 
-        /* "cssm.pyx":1356
+        /* "cssm.pyx":1468
  *             ix = 0
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     traj_view[0, 0] = y
  */
       }
 
-      /* "cssm.pyx":1361
+      /* "cssm.pyx":1473
  * 
  *             # Random walker
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 y += ((v_view[k] - (g_view[k] * y)) * delta_t) + sqrt_st * gaussian_values[m]
  *                 t_particle += delta_t
  */
       while (1) {
@@ -21244,344 +22743,344 @@
           goto __pyx_L18_bool_binop_done;
         }
         __pyx_t_24 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_20 = __pyx_t_24;
         __pyx_L18_bool_binop_done:;
         if (!__pyx_t_20) break;
 
-        /* "cssm.pyx":1362
+        /* "cssm.pyx":1474
  *             # Random walker
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *                 y += ((v_view[k] - (g_view[k] * y)) * delta_t) + sqrt_st * gaussian_values[m]             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 ix += 1
  */
         __pyx_t_22 = __pyx_v_k;
         __pyx_t_23 = __pyx_v_k;
         __pyx_t_21 = __pyx_v_m;
         __pyx_v_y = (__pyx_v_y + ((((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_22 * __pyx_v_v_view.strides[0]) ))) - ((*((float *) ( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_23 * __pyx_v_g_view.strides[0]) ))) * __pyx_v_y)) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_21 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":1363
+        /* "cssm.pyx":1475
  *             while y >= (-1) * boundary_view[ix] and y <= boundary_view[ix] and t_particle <= max_t:
  *                 y += ((v_view[k] - (g_view[k] * y)) * delta_t) + sqrt_st * gaussian_values[m]
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":1364
+        /* "cssm.pyx":1476
  *                 y += ((v_view[k] - (g_view[k] * y)) * delta_t) + sqrt_st * gaussian_values[m]
  *                 t_particle += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  * 
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":1365
+        /* "cssm.pyx":1477
  *                 t_particle += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  * 
  *                 if n == 0:
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":1367
+        /* "cssm.pyx":1479
  *                 m += 1
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         __pyx_t_20 = ((__pyx_v_n == 0) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":1368
+          /* "cssm.pyx":1480
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  * 
  */
           __pyx_t_20 = ((__pyx_v_k == 0) != 0);
           if (__pyx_t_20) {
 
-            /* "cssm.pyx":1369
+            /* "cssm.pyx":1481
  *                 if n == 0:
  *                     if k == 0:
  *                         traj_view[ix, 0] = y             # <<<<<<<<<<<<<<
  * 
  *                 if m == num_draws:
  */
             __pyx_t_21 = __pyx_v_ix;
             __pyx_t_23 = 0;
             *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_21 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_23 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
 
-            /* "cssm.pyx":1368
+            /* "cssm.pyx":1480
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         traj_view[ix, 0] = y
  * 
  */
           }
 
-          /* "cssm.pyx":1367
+          /* "cssm.pyx":1479
  *                 m += 1
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         traj_view[ix, 0] = y
  */
         }
 
-        /* "cssm.pyx":1371
+        /* "cssm.pyx":1483
  *                         traj_view[ix, 0] = y
  * 
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_20 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_20) {
 
-          /* "cssm.pyx":1372
+          /* "cssm.pyx":1484
  * 
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1372, __pyx_L1_error)
+          __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1484, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_6;
           __pyx_t_6.memview = NULL;
           __pyx_t_6.data = NULL;
 
-          /* "cssm.pyx":1373
+          /* "cssm.pyx":1485
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k]
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":1371
+          /* "cssm.pyx":1483
  *                         traj_view[ix, 0] = y
  * 
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":1375
+      /* "cssm.pyx":1487
  *                     m = 0
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k]             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = sign(y)
  * 
  */
       __pyx_t_23 = __pyx_v_k;
       __pyx_t_21 = __pyx_v_n;
       __pyx_t_22 = __pyx_v_k;
       __pyx_t_25 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_21 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_22 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_25 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_23 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":1376
+      /* "cssm.pyx":1488
  * 
  *             rts_view[n, k, 0] = t_particle + t_view[k]
  *             choices_view[n, k, 0] = sign(y)             # <<<<<<<<<<<<<<
  * 
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,
  */
       __pyx_t_23 = __pyx_v_n;
       __pyx_t_25 = __pyx_v_k;
       __pyx_t_22 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_23 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_25 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_22 * __pyx_v_choices_view.strides[2]) )) = __pyx_f_4cssm_sign(__pyx_v_y);
     }
   }
 
-  /* "cssm.pyx":1378
+  /* "cssm.pyx":1490
  *             choices_view[n, k, 0] = sign(y)
  * 
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,             # <<<<<<<<<<<<<<
  *                                                           'a': a,
  *                                                           'z': z,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_13 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1378, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1490, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_13);
-  if (PyDict_SetItem(__pyx_t_13, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1378, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_13, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1378, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1378, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_13, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_13, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1490, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 1378, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
 
-  /* "cssm.pyx":1379
+  /* "cssm.pyx":1491
  * 
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                           'a': a,             # <<<<<<<<<<<<<<
  *                                                           'z': z,
  *                                                           'g': g,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1378, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
 
-  /* "cssm.pyx":1380
+  /* "cssm.pyx":1492
  *     return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,
  *                                                           'a': a,
  *                                                           'z': z,             # <<<<<<<<<<<<<<
  *                                                           'g': g,
  *                                                           't': t,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 1378, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
 
-  /* "cssm.pyx":1381
+  /* "cssm.pyx":1493
  *                                                           'a': a,
  *                                                           'z': z,
  *                                                           'g': g,             # <<<<<<<<<<<<<<
  *                                                           't': t,
  *                                                           's': s,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_g, ((PyObject *)__pyx_v_g)) < 0) __PYX_ERR(0, 1378, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_g, ((PyObject *)__pyx_v_g)) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
 
-  /* "cssm.pyx":1382
+  /* "cssm.pyx":1494
  *                                                           'z': z,
  *                                                           'g': g,
  *                                                           't': t,             # <<<<<<<<<<<<<<
  *                                                           's': s,
  *                                                           **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1378, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
 
-  /* "cssm.pyx":1383
+  /* "cssm.pyx":1495
  *                                                           'g': g,
  *                                                           't': t,
  *                                                           's': s,             # <<<<<<<<<<<<<<
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1383, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1495, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_4) < 0) __PYX_ERR(0, 1378, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_4) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_11 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1384
+  /* "cssm.pyx":1496
  *                                                           't': t,
  *                                                           's': s,
  *                                                           **boundary_params,             # <<<<<<<<<<<<<<
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 1384, __pyx_L1_error)
+    __PYX_ERR(0, 1496, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_11, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 1384, __pyx_L1_error)
+    __PYX_ERR(0, 1496, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":1385
+  /* "cssm.pyx":1497
  *                                                           's': s,
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1385, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1497, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 1385, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 1497, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1386
+  /* "cssm.pyx":1498
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ornstein_uhlenbeck',
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1498, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 1498, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1387
+  /* "cssm.pyx":1499
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                           'simulator': 'ornstein_uhlenbeck',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1387, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1499, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 1387, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 1499, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_simulator, __pyx_n_u_ornstein_uhlenbeck) < 0) __PYX_ERR(0, 1388, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_simulator, __pyx_n_u_ornstein_uhlenbeck) < 0) __PYX_ERR(0, 1500, __pyx_L1_error)
 
-  /* "cssm.pyx":1389
+  /* "cssm.pyx":1501
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'ornstein_uhlenbeck',
  *                                                           'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1389, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_boundary_fun_type, __pyx_t_3) < 0) __PYX_ERR(0, 1389, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_boundary_fun_type, __pyx_t_3) < 0) __PYX_ERR(0, 1501, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1390
+  /* "cssm.pyx":1502
  *                                                           'simulator': 'ornstein_uhlenbeck',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],             # <<<<<<<<<<<<<<
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary}}
  */
-  __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1390, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1502, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
   PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_neg_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 1390, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 1502, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1391
+  /* "cssm.pyx":1503
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,             # <<<<<<<<<<<<<<
  *                                                           'boundary': boundary}}
  * # --------------------------------------------------------------------------------------------------
  */
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1391, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1503, __pyx_L1_error)
 
-  /* "cssm.pyx":1392
+  /* "cssm.pyx":1504
  *                                                           'possible_choices': [-1, 1],
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary}}             # <<<<<<<<<<<<<<
  * # --------------------------------------------------------------------------------------------------
  * 
  */
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1392, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_13, __pyx_n_u_metadata, __pyx_t_11) < 0) __PYX_ERR(0, 1378, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1504, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_13, __pyx_n_u_metadata, __pyx_t_11) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_r = __pyx_t_13;
   __pyx_t_13 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":1288
+  /* "cssm.pyx":1400
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ornstein_uhlenbeck(np.ndarray[float, ndim = 1] v, # drift parameter             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] a, # initial boundary separation
  *                        np.ndarray[float, ndim = 1] z, # starting point bias
  */
 
@@ -21630,21 +23129,21 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_rts_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
-  __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_key);
+  __Pyx_XDECREF(__pyx_8genexpr8__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":1402
+/* "cssm.pyx":1514
  * 
  * # Function that checks boundary crossing of particles
  * cdef bint check_finished(float[:] particles, float boundary, int n):             # <<<<<<<<<<<<<<
  *     cdef int i # ,n
  *     #n = particles.shape[0]
  */
 
@@ -21655,93 +23154,93 @@
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   Py_ssize_t __pyx_t_4;
   int __pyx_t_5;
   __Pyx_RefNannySetupContext("check_finished", 0);
 
-  /* "cssm.pyx":1405
+  /* "cssm.pyx":1517
  *     cdef int i # ,n
  *     #n = particles.shape[0]
  *     for i in range(n):             # <<<<<<<<<<<<<<
  *         if particles[i] > boundary:
  *             return True
  */
   __pyx_t_1 = __pyx_v_n;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "cssm.pyx":1406
+    /* "cssm.pyx":1518
  *     #n = particles.shape[0]
  *     for i in range(n):
  *         if particles[i] > boundary:             # <<<<<<<<<<<<<<
  *             return True
  *     return False
  */
     __pyx_t_4 = __pyx_v_i;
     __pyx_t_5 = (((*((float *) ( /* dim=0 */ (__pyx_v_particles.data + __pyx_t_4 * __pyx_v_particles.strides[0]) ))) > __pyx_v_boundary) != 0);
     if (__pyx_t_5) {
 
-      /* "cssm.pyx":1407
+      /* "cssm.pyx":1519
  *     for i in range(n):
  *         if particles[i] > boundary:
  *             return True             # <<<<<<<<<<<<<<
  *     return False
  * 
  */
       __pyx_r = 1;
       goto __pyx_L0;
 
-      /* "cssm.pyx":1406
+      /* "cssm.pyx":1518
  *     #n = particles.shape[0]
  *     for i in range(n):
  *         if particles[i] > boundary:             # <<<<<<<<<<<<<<
  *             return True
  *     return False
  */
     }
   }
 
-  /* "cssm.pyx":1408
+  /* "cssm.pyx":1520
  *         if particles[i] > boundary:
  *             return True
  *     return False             # <<<<<<<<<<<<<<
  * 
  * #def test_check():
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":1402
+  /* "cssm.pyx":1514
  * 
  * # Function that checks boundary crossing of particles
  * cdef bint check_finished(float[:] particles, float boundary, int n):             # <<<<<<<<<<<<<<
  *     cdef int i # ,n
  *     #n = particles.shape[0]
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":1426
+/* "cssm.pyx":1538
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def race_model(np.ndarray[float, ndim = 2] v,  # np.array expected, one column of floats             # <<<<<<<<<<<<<<
  *                np.ndarray[float, ndim = 2] a, # initial boundary separation
  *                np.ndarray[float, ndim = 2] z, # np.array expected, one column of floats
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_25race_model(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_25race_model = {"race_model", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_25race_model, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_25race_model(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_27race_model(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_27race_model = {"race_model", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_27race_model, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_27race_model(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z = 0;
   PyArrayObject *__pyx_v_t = 0;
   PyArrayObject *__pyx_v_s = 0;
   float __pyx_v_delta_t;
   float __pyx_v_max_t;
@@ -21757,34 +23256,34 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("race_model (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[13] = {0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":1435
+    /* "cssm.pyx":1547
  *                int n_samples = 2000,
  *                int n_trials = 1,
  *                boundary_fun = None,             # <<<<<<<<<<<<<<
  *                boundary_multiplicative = True,
  *                boundary_params = {},
  */
     values[9] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":1436
+    /* "cssm.pyx":1548
  *                int n_trials = 1,
  *                boundary_fun = None,
  *                boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *                boundary_params = {},
  *                random_state = None,):
  */
     values[10] = ((PyObject *)Py_True);
-    values[11] = __pyx_k__12;
+    values[11] = __pyx_k__13;
 
-    /* "cssm.pyx":1438
+    /* "cssm.pyx":1550
  *                boundary_multiplicative = True,
  *                boundary_params = {},
  *                random_state = None,):             # <<<<<<<<<<<<<<
  * 
  *     set_seed(random_state)
  */
     values[12] = ((PyObject *)Py_None);
@@ -21826,33 +23325,33 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("race_model", 0, 5, 13, 1); __PYX_ERR(0, 1426, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("race_model", 0, 5, 13, 1); __PYX_ERR(0, 1538, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("race_model", 0, 5, 13, 2); __PYX_ERR(0, 1426, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("race_model", 0, 5, 13, 2); __PYX_ERR(0, 1538, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("race_model", 0, 5, 13, 3); __PYX_ERR(0, 1426, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("race_model", 0, 5, 13, 3); __PYX_ERR(0, 1538, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("race_model", 0, 5, 13, 4); __PYX_ERR(0, 1426, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("race_model", 0, 5, 13, 4); __PYX_ERR(0, 1538, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_delta_t);
           if (value) { values[5] = value; kw_args--; }
         }
@@ -21896,15 +23395,15 @@
         case 12:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[12] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "race_model") < 0)) __PYX_ERR(0, 1426, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "race_model") < 0)) __PYX_ERR(0, 1538, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 13: values[12] = PyTuple_GET_ITEM(__pyx_args, 12);
         CYTHON_FALLTHROUGH;
         case 12: values[11] = PyTuple_GET_ITEM(__pyx_args, 11);
         CYTHON_FALLTHROUGH;
@@ -21931,54 +23430,54 @@
     }
     __pyx_v_v = ((PyArrayObject *)values[0]);
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_t = ((PyArrayObject *)values[3]);
     __pyx_v_s = ((PyArrayObject *)values[4]);
     if (values[5]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1431, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1543, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[6]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1432, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1544, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[7]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1433, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1545, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x7D0);
     }
     if (values[8]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1434, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1546, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_boundary_fun = values[9];
     __pyx_v_boundary_multiplicative = values[10];
     __pyx_v_boundary_params = values[11];
     __pyx_v_random_state = values[12];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("race_model", 0, 5, 13, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1426, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("race_model", 0, 5, 13, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1538, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.race_model", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1426, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1427, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1428, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1429, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_5numpy_ndarray, 1, "s", 0))) __PYX_ERR(0, 1430, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_24race_model(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1538, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1539, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1540, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1541, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_5numpy_ndarray, 1, "s", 0))) __PYX_ERR(0, 1542, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_26race_model(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":1426
+  /* "cssm.pyx":1538
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def race_model(np.ndarray[float, ndim = 2] v,  # np.array expected, one column of floats             # <<<<<<<<<<<<<<
  *                np.ndarray[float, ndim = 2] a, # initial boundary separation
  *                np.ndarray[float, ndim = 2] z, # np.array expected, one column of floats
  */
 
@@ -21987,15 +23486,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_24race_model(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_26race_model(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   CYTHON_UNUSED __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   CYTHON_UNUSED __Pyx_memviewslice __pyx_v_s_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   float __pyx_v_delta_t_sqrt;
   PyObject *__pyx_v_sqrt_st = NULL;
@@ -22021,15 +23520,15 @@
   Py_ssize_t __pyx_v_m;
   int __pyx_v_num_draws;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
   PyObject *__pyx_v_v_dict = NULL;
   PyObject *__pyx_v_z_dict = NULL;
   PyObject *__pyx_v_i = NULL;
-  PyObject *__pyx_8genexpr8__pyx_v_key = NULL;
+  PyObject *__pyx_8genexpr9__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_s;
   __Pyx_Buffer __pyx_pybuffer_s;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
   __Pyx_Buffer __pyx_pybuffer_t;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
@@ -22090,409 +23589,409 @@
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   __pyx_pybuffer_s.pybuffer.buf = NULL;
   __pyx_pybuffer_s.refcount = 0;
   __pyx_pybuffernd_s.data = NULL;
   __pyx_pybuffernd_s.rcbuffer = &__pyx_pybuffer_s;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1426, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1538, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_v.diminfo[1].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_v.diminfo[1].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1426, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1538, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_a.diminfo[1].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_a.diminfo[1].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1426, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1538, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_z.diminfo[1].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_z.diminfo[1].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1426, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1538, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_t.diminfo[1].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_t.diminfo[1].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_s.rcbuffer->pybuffer, (PyObject*)__pyx_v_s, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1426, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_s.rcbuffer->pybuffer, (PyObject*)__pyx_v_s, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1538, __pyx_L1_error)
   }
   __pyx_pybuffernd_s.diminfo[0].strides = __pyx_pybuffernd_s.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_s.diminfo[0].shape = __pyx_pybuffernd_s.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_s.diminfo[1].strides = __pyx_pybuffernd_s.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_s.diminfo[1].shape = __pyx_pybuffernd_s.rcbuffer->pybuffer.shape[1];
 
-  /* "cssm.pyx":1440
+  /* "cssm.pyx":1552
  *                random_state = None,):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Param views
  *     cdef float[:, :] v_view = v
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1440, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1552, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1442
+  /* "cssm.pyx":1554
  *     set_seed(random_state)
  *     # Param views
  *     cdef float[:, :] v_view = v             # <<<<<<<<<<<<<<
  *     cdef float[:, :] z_view = z
  *     cdef float[:, :] a_view = a
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1442, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1554, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1443
+  /* "cssm.pyx":1555
  *     # Param views
  *     cdef float[:, :] v_view = v
  *     cdef float[:, :] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:, :] a_view = a
  *     cdef float[:, :] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1443, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1555, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1444
+  /* "cssm.pyx":1556
  *     cdef float[:, :] v_view = v
  *     cdef float[:, :] z_view = z
  *     cdef float[:, :] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:, :] t_view = t
  *     cdef float[:, :] s_view = s
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1444, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1556, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1445
+  /* "cssm.pyx":1557
  *     cdef float[:, :] z_view = z
  *     cdef float[:, :] a_view = a
  *     cdef float[:, :] t_view = t             # <<<<<<<<<<<<<<
  *     cdef float[:, :] s_view = s
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1445, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1557, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1446
+  /* "cssm.pyx":1558
  *     cdef float[:, :] a_view = a
  *     cdef float[:, :] t_view = t
  *     cdef float[:, :] s_view = s             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_s), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1446, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_s), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1558, __pyx_L1_error)
   __pyx_v_s_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1448
+  /* "cssm.pyx":1560
  *     cdef float[:, :] s_view = s
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)             # <<<<<<<<<<<<<<
  *     sqrt_st = delta_t_sqrt * s
  *     cdef float[:, :] sqrt_st_view = sqrt_st
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":1449
+  /* "cssm.pyx":1561
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  *     sqrt_st = delta_t_sqrt * s             # <<<<<<<<<<<<<<
  *     cdef float[:, :] sqrt_st_view = sqrt_st
  * 
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t_sqrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1449, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t_sqrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1561, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, ((PyObject *)__pyx_v_s)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1449, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, ((PyObject *)__pyx_v_s)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1561, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_sqrt_st = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1450
+  /* "cssm.pyx":1562
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  *     sqrt_st = delta_t_sqrt * s
  *     cdef float[:, :] sqrt_st_view = sqrt_st             # <<<<<<<<<<<<<<
  * 
  *     cdef int n_particles = v.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_sqrt_st, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1450, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_sqrt_st, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1562, __pyx_L1_error)
   __pyx_v_sqrt_st_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1452
+  /* "cssm.pyx":1564
  *     cdef float[:, :] sqrt_st_view = sqrt_st
  * 
  *     cdef int n_particles = v.shape[1]             # <<<<<<<<<<<<<<
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     cdef float[:, :, :] rts_view = rts
  */
   __pyx_v_n_particles = (__pyx_v_v->dimensions[1]);
 
-  /* "cssm.pyx":1453
+  /* "cssm.pyx":1565
  * 
  *     cdef int n_particles = v.shape[1]
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:, :, :] rts_view = rts
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1565, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1565, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1565, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1565, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1565, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_int_1);
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1565, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1565, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1565, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 1453, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 1565, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1565, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_rts = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1454
+  /* "cssm.pyx":1566
  *     cdef int n_particles = v.shape[1]
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  *     cdef int[:, :, :] choices_view = choices
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1454, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1566, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1455
+  /* "cssm.pyx":1567
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     cdef float[:, :, :] rts_view = rts
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1455, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1455, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":1456
+  /* "cssm.pyx":1568
  *     cdef float[:, :, :] rts_view = rts
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     particles = np.zeros((n_particles), dtype = DTYPE)
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1456, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1568, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":1458
+  /* "cssm.pyx":1570
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     particles = np.zeros((n_particles), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float [:] particles_view = particles
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1458, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1458, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1458, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1458, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1458, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1458, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1458, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1570, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1458, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_particles = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":1459
+  /* "cssm.pyx":1571
  * 
  *     particles = np.zeros((n_particles), dtype = DTYPE)
  *     cdef float [:] particles_view = particles             # <<<<<<<<<<<<<<
  * 
  *     # TD: Add Trajectory
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_particles, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1459, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_particles, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1571, __pyx_L1_error)
   __pyx_v_particles_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":1462
+  /* "cssm.pyx":1574
  * 
  *     # TD: Add Trajectory
  *     traj = np.zeros((int(max_t / delta_t) + 1, n_particles), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:, :] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1462, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1462, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1462, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_5, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1462, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_5, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1462, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1462, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_5);
   __pyx_t_4 = 0;
   __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1462, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1462, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1462, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1462, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1462, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_traj = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "cssm.pyx":1463
+  /* "cssm.pyx":1575
  *     # TD: Add Trajectory
  *     traj = np.zeros((int(max_t / delta_t) + 1, n_particles), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:, :] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1463, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1575, __pyx_L1_error)
 
-  /* "cssm.pyx":1464
+  /* "cssm.pyx":1576
  *     traj = np.zeros((int(max_t / delta_t) + 1, n_particles), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:, :] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1464, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1576, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1467
+  /* "cssm.pyx":1579
  * 
  *     # Boundary storage
  *     cdef int num_steps = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  * 
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  */
   __pyx_v_num_steps = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":1469
+  /* "cssm.pyx":1581
  *     cdef int num_steps = int((max_t / delta_t) + 1)
  * 
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1469, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_arange); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1469, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_arange); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1469, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1469, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_10 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_7);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
@@ -22501,241 +24000,241 @@
       __Pyx_DECREF_SET(__pyx_t_7, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_5, __pyx_t_3};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1469, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_5, __pyx_t_3};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1469, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1469, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1581, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_10) {
       __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_3);
     __pyx_t_5 = 0;
     __pyx_t_3 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1469, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1469, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1469, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_12 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_7);
     if (likely(__pyx_t_12)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
       __Pyx_INCREF(__pyx_t_12);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_7, function);
     }
   }
   __pyx_t_4 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_12, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1469, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1581, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_t_s = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "cssm.pyx":1470
+  /* "cssm.pyx":1582
  * 
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1470, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1582, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1470, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1582, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1470, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1582, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1470, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1582, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1470, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1582, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1470, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1582, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 1470, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 1582, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1470, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1582, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_boundary = __pyx_t_12;
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":1471
+  /* "cssm.pyx":1583
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     # Initialize variables needed for for loop
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1471, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1583, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":1476
+  /* "cssm.pyx":1588
  *     cdef float t_particle
  *     cdef Py_ssize_t n, ix, j, k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  * 
  *     cdef int num_draws = num_steps * n_particles
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":1478
+  /* "cssm.pyx":1590
  *     cdef Py_ssize_t m = 0
  * 
  *     cdef int num_draws = num_steps * n_particles             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_num_draws = (__pyx_v_num_steps * __pyx_v_n_particles);
 
-  /* "cssm.pyx":1479
+  /* "cssm.pyx":1591
  * 
  *     cdef int num_draws = num_steps * n_particles
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
-  __pyx_t_9 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1479, __pyx_L1_error)
+  __pyx_t_9 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1591, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":1481
+  /* "cssm.pyx":1593
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_11 = __pyx_v_n_trials;
   __pyx_t_13 = __pyx_t_11;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_k = __pyx_t_14;
 
-    /* "cssm.pyx":1483
+    /* "cssm.pyx":1595
  *     for k in range(n_trials):
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         # Precompute boundary evaluations
  */
     { /* enter inner scope */
-      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1483, __pyx_L7_error)
+      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1595, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_12);
       __pyx_t_15 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 1483, __pyx_L7_error)
+        __PYX_ERR(0, 1595, __pyx_L7_error)
       }
-      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1483, __pyx_L7_error)
+      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1595, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF(__pyx_t_4);
       __pyx_t_4 = __pyx_t_1;
       __pyx_t_1 = 0;
       while (1) {
         __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_4, __pyx_t_16, &__pyx_t_15, &__pyx_t_1, NULL, NULL, __pyx_t_17);
         if (unlikely(__pyx_t_18 == 0)) break;
-        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 1483, __pyx_L7_error)
+        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 1595, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __Pyx_XDECREF_SET(__pyx_8genexpr8__pyx_v_key, __pyx_t_1);
+        __Pyx_XDECREF_SET(__pyx_8genexpr9__pyx_v_key, __pyx_t_1);
         __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr8__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1483, __pyx_L7_error)
+        __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr9__pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1595, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1483, __pyx_L7_error)
+        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1595, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr8__pyx_v_key, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1483, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr9__pyx_v_key, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1595, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       }
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_XDECREF(__pyx_8genexpr8__pyx_v_key); __pyx_8genexpr8__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_key); __pyx_8genexpr9__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_8genexpr8__pyx_v_key); __pyx_8genexpr8__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_key); __pyx_8genexpr9__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_12));
     __pyx_t_12 = 0;
 
-    /* "cssm.pyx":1486
+    /* "cssm.pyx":1598
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             boundary[:] = np.multiply(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  */
-    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 1486, __pyx_L1_error)
+    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 1598, __pyx_L1_error)
     if (__pyx_t_19) {
 
-      /* "cssm.pyx":1487
+      /* "cssm.pyx":1599
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:
  *             boundary[:] = np.multiply(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             boundary[:] = np.add(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1487, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1599, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1487, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_multiply); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1599, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_21 = 0;
-      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) ) + __pyx_t_21 * __pyx_v_a_view.strides[1]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1487, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) ) + __pyx_t_21 * __pyx_v_a_view.strides[1]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1599, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1487, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1599, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1487, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1599, __pyx_L1_error)
       __pyx_t_3 = __pyx_t_5;
       __pyx_t_5 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_3, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1487, __pyx_L1_error)
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1487, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_3, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1599, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1599, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_3 = NULL;
       __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_3)) {
@@ -22745,106 +24244,106 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_7, __pyx_t_5};
-        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1487, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1599, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_7, __pyx_t_5};
-        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1487, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1599, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       } else
       #endif
       {
-        __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1487, __pyx_L1_error)
+        __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1599, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         if (__pyx_t_3) {
           __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_3); __pyx_t_3 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_17, __pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_5);
         PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_17, __pyx_t_5);
         __pyx_t_7 = 0;
         __pyx_t_5 = 0;
-        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1487, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1599, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1487, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1599, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1487, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1599, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1487, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1599, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1487, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1599, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-      /* "cssm.pyx":1486
+      /* "cssm.pyx":1598
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             boundary[:] = np.multiply(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":1489
+    /* "cssm.pyx":1601
  *             boundary[:] = np.multiply(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  *             boundary[:] = np.add(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Loop over samples
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1489, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1489, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_20 = 0;
-      __pyx_t_4 = PyFloat_FromDouble((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) ) + __pyx_t_20 * __pyx_v_a_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1489, __pyx_L1_error)
+      __pyx_t_4 = PyFloat_FromDouble((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) ) + __pyx_t_20 * __pyx_v_a_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1489, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1489, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1601, __pyx_L1_error)
       __pyx_t_5 = __pyx_t_7;
       __pyx_t_7 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1489, __pyx_L1_error)
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1489, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_5, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1601, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_5 = NULL;
       __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_5)) {
@@ -22854,197 +24353,197 @@
           __Pyx_DECREF_SET(__pyx_t_10, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_4, __pyx_t_7};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1489, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1601, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_4, __pyx_t_7};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1489, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1601, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       } else
       #endif
       {
-        __pyx_t_3 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1489, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1601, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (__pyx_t_5) {
           __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_17, __pyx_t_4);
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_17, __pyx_t_7);
         __pyx_t_4 = 0;
         __pyx_t_7 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1489, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1601, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1489, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1489, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_3 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_3)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_3);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
       __pyx_t_12 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1489, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1489, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1601, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":1492
+    /* "cssm.pyx":1604
  * 
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             for j in range(n_particles):
  *                 particles_view[j] = z_view[k, j] * boundary_view[0] # Reset particle starting points
  */
     __pyx_t_17 = __pyx_v_n_samples;
     __pyx_t_18 = __pyx_t_17;
     for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_18; __pyx_t_16+=1) {
       __pyx_v_n = __pyx_t_16;
 
-      /* "cssm.pyx":1493
+      /* "cssm.pyx":1605
  *         # Loop over samples
  *         for n in range(n_samples):
  *             for j in range(n_particles):             # <<<<<<<<<<<<<<
  *                 particles_view[j] = z_view[k, j] * boundary_view[0] # Reset particle starting points
  * 
  */
       __pyx_t_22 = __pyx_v_n_particles;
       __pyx_t_23 = __pyx_t_22;
       for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_23; __pyx_t_15+=1) {
         __pyx_v_j = __pyx_t_15;
 
-        /* "cssm.pyx":1494
+        /* "cssm.pyx":1606
  *         for n in range(n_samples):
  *             for j in range(n_particles):
  *                 particles_view[j] = z_view[k, j] * boundary_view[0] # Reset particle starting points             # <<<<<<<<<<<<<<
  * 
  *             t_particle = 0.0 # reset time
  */
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_21 = __pyx_v_j;
         __pyx_t_24 = 0;
         __pyx_t_25 = __pyx_v_j;
         *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_25 * __pyx_v_particles_view.strides[0]) )) = ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_20 * __pyx_v_z_view.strides[0]) ) + __pyx_t_21 * __pyx_v_z_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))));
       }
 
-      /* "cssm.pyx":1496
+      /* "cssm.pyx":1608
  *                 particles_view[j] = z_view[k, j] * boundary_view[0] # Reset particle starting points
  * 
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0
  * 
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":1497
+      /* "cssm.pyx":1609
  * 
  *             t_particle = 0.0 # reset time
  *             ix = 0             # <<<<<<<<<<<<<<
  * 
  *             if n == 0:
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":1499
+      /* "cssm.pyx":1611
  *             ix = 0
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     for j in range(n_particles):
  */
       __pyx_t_19 = ((__pyx_v_n == 0) != 0);
       if (__pyx_t_19) {
 
-        /* "cssm.pyx":1500
+        /* "cssm.pyx":1612
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     for j in range(n_particles):
  *                         traj_view[0, j] = particles[j]
  */
         __pyx_t_19 = ((__pyx_v_k == 0) != 0);
         if (__pyx_t_19) {
 
-          /* "cssm.pyx":1501
+          /* "cssm.pyx":1613
  *             if n == 0:
  *                 if k == 0:
  *                     for j in range(n_particles):             # <<<<<<<<<<<<<<
  *                         traj_view[0, j] = particles[j]
  * 
  */
           __pyx_t_22 = __pyx_v_n_particles;
           __pyx_t_23 = __pyx_t_22;
           for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_23; __pyx_t_15+=1) {
             __pyx_v_j = __pyx_t_15;
 
-            /* "cssm.pyx":1502
+            /* "cssm.pyx":1614
  *                 if k == 0:
  *                     for j in range(n_particles):
  *                         traj_view[0, j] = particles[j]             # <<<<<<<<<<<<<<
  * 
  *             # Random walker
  */
-            __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_particles, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1502, __pyx_L1_error)
+            __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_particles, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1614, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
-            __pyx_t_26 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_26 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1502, __pyx_L1_error)
+            __pyx_t_26 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_26 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1614, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
             __pyx_t_24 = 0;
             __pyx_t_21 = __pyx_v_j;
             *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_t_26;
           }
 
-          /* "cssm.pyx":1500
+          /* "cssm.pyx":1612
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     for j in range(n_particles):
  *                         traj_view[0, j] = particles[j]
  */
         }
 
-        /* "cssm.pyx":1499
+        /* "cssm.pyx":1611
  *             ix = 0
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     for j in range(n_particles):
  */
       }
 
-      /* "cssm.pyx":1505
+      /* "cssm.pyx":1617
  * 
  *             # Random walker
  *             while not check_finished(particles_view, boundary_view[ix], n_particles) and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 for j in range(n_particles):
  *                     particles_view[j] += (v_view[k, j] * delta_t) + sqrt_st_view[k, j] * gaussian_values[m]
  */
       while (1) {
@@ -23056,515 +24555,515 @@
           goto __pyx_L22_bool_binop_done;
         }
         __pyx_t_27 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_19 = __pyx_t_27;
         __pyx_L22_bool_binop_done:;
         if (!__pyx_t_19) break;
 
-        /* "cssm.pyx":1506
+        /* "cssm.pyx":1618
  *             # Random walker
  *             while not check_finished(particles_view, boundary_view[ix], n_particles) and t_particle <= max_t:
  *                 for j in range(n_particles):             # <<<<<<<<<<<<<<
  *                     particles_view[j] += (v_view[k, j] * delta_t) + sqrt_st_view[k, j] * gaussian_values[m]
  *                     particles_view[j] = fmax(0.0, particles_view[j]) # Cut off particles at 0
  */
         __pyx_t_22 = __pyx_v_n_particles;
         __pyx_t_23 = __pyx_t_22;
         for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_23; __pyx_t_15+=1) {
           __pyx_v_j = __pyx_t_15;
 
-          /* "cssm.pyx":1507
+          /* "cssm.pyx":1619
  *             while not check_finished(particles_view, boundary_view[ix], n_particles) and t_particle <= max_t:
  *                 for j in range(n_particles):
  *                     particles_view[j] += (v_view[k, j] * delta_t) + sqrt_st_view[k, j] * gaussian_values[m]             # <<<<<<<<<<<<<<
  *                     particles_view[j] = fmax(0.0, particles_view[j]) # Cut off particles at 0
  *                     m += 1
  */
           __pyx_t_21 = __pyx_v_k;
           __pyx_t_24 = __pyx_v_j;
           __pyx_t_20 = __pyx_v_k;
           __pyx_t_25 = __pyx_v_j;
           __pyx_t_28 = __pyx_v_m;
           __pyx_t_29 = __pyx_v_j;
           *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_29 * __pyx_v_particles_view.strides[0]) )) += (((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_21 * __pyx_v_v_view.strides[0]) ) + __pyx_t_24 * __pyx_v_v_view.strides[1]) ))) * __pyx_v_delta_t) + ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sqrt_st_view.data + __pyx_t_20 * __pyx_v_sqrt_st_view.strides[0]) ) + __pyx_t_25 * __pyx_v_sqrt_st_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_28 * __pyx_v_gaussian_values.strides[0]) )))));
 
-          /* "cssm.pyx":1508
+          /* "cssm.pyx":1620
  *                 for j in range(n_particles):
  *                     particles_view[j] += (v_view[k, j] * delta_t) + sqrt_st_view[k, j] * gaussian_values[m]
  *                     particles_view[j] = fmax(0.0, particles_view[j]) # Cut off particles at 0             # <<<<<<<<<<<<<<
  *                     m += 1
  *                     if m == num_draws:
  */
           __pyx_t_28 = __pyx_v_j;
           __pyx_t_25 = __pyx_v_j;
           *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_25 * __pyx_v_particles_view.strides[0]) )) = fmax(0.0, (*((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_28 * __pyx_v_particles_view.strides[0]) ))));
 
-          /* "cssm.pyx":1509
+          /* "cssm.pyx":1621
  *                     particles_view[j] += (v_view[k, j] * delta_t) + sqrt_st_view[k, j] * gaussian_values[m]
  *                     particles_view[j] = fmax(0.0, particles_view[j]) # Cut off particles at 0
  *                     m += 1             # <<<<<<<<<<<<<<
  *                     if m == num_draws:
  *                         m = 0
  */
           __pyx_v_m = (__pyx_v_m + 1);
 
-          /* "cssm.pyx":1510
+          /* "cssm.pyx":1622
  *                     particles_view[j] = fmax(0.0, particles_view[j]) # Cut off particles at 0
  *                     m += 1
  *                     if m == num_draws:             # <<<<<<<<<<<<<<
  *                         m = 0
  *                         gaussian_values = draw_gaussian(num_draws)
  */
           __pyx_t_19 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
           if (__pyx_t_19) {
 
-            /* "cssm.pyx":1511
+            /* "cssm.pyx":1623
  *                     m += 1
  *                     if m == num_draws:
  *                         m = 0             # <<<<<<<<<<<<<<
  *                         gaussian_values = draw_gaussian(num_draws)
  *                 t_particle += delta_t
  */
             __pyx_v_m = 0;
 
-            /* "cssm.pyx":1512
+            /* "cssm.pyx":1624
  *                     if m == num_draws:
  *                         m = 0
  *                         gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 ix += 1
  */
-            __pyx_t_9 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1512, __pyx_L1_error)
+            __pyx_t_9 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1624, __pyx_L1_error)
             __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
             __pyx_v_gaussian_values = __pyx_t_9;
             __pyx_t_9.memview = NULL;
             __pyx_t_9.data = NULL;
 
-            /* "cssm.pyx":1510
+            /* "cssm.pyx":1622
  *                     particles_view[j] = fmax(0.0, particles_view[j]) # Cut off particles at 0
  *                     m += 1
  *                     if m == num_draws:             # <<<<<<<<<<<<<<
  *                         m = 0
  *                         gaussian_values = draw_gaussian(num_draws)
  */
           }
         }
 
-        /* "cssm.pyx":1513
+        /* "cssm.pyx":1625
  *                         m = 0
  *                         gaussian_values = draw_gaussian(num_draws)
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 if n == 0:
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":1514
+        /* "cssm.pyx":1626
  *                         gaussian_values = draw_gaussian(num_draws)
  *                 t_particle += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 if n == 0:
  *                     if k == 0:
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":1515
+        /* "cssm.pyx":1627
  *                 t_particle += delta_t
  *                 ix += 1
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         for j in range(n_particles):
  */
         __pyx_t_19 = ((__pyx_v_n == 0) != 0);
         if (__pyx_t_19) {
 
-          /* "cssm.pyx":1516
+          /* "cssm.pyx":1628
  *                 ix += 1
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         for j in range(n_particles):
  *                             traj_view[ix, j] = particles[j]
  */
           __pyx_t_19 = ((__pyx_v_k == 0) != 0);
           if (__pyx_t_19) {
 
-            /* "cssm.pyx":1517
+            /* "cssm.pyx":1629
  *                 if n == 0:
  *                     if k == 0:
  *                         for j in range(n_particles):             # <<<<<<<<<<<<<<
  *                             traj_view[ix, j] = particles[j]
  * 
  */
             __pyx_t_22 = __pyx_v_n_particles;
             __pyx_t_23 = __pyx_t_22;
             for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_23; __pyx_t_15+=1) {
               __pyx_v_j = __pyx_t_15;
 
-              /* "cssm.pyx":1518
+              /* "cssm.pyx":1630
  *                     if k == 0:
  *                         for j in range(n_particles):
  *                             traj_view[ix, j] = particles[j]             # <<<<<<<<<<<<<<
  * 
  *             choices_view[n, k, 0] = np.argmax(particles)
  */
-              __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_particles, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1518, __pyx_L1_error)
+              __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_particles, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1630, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_12);
-              __pyx_t_26 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_26 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1518, __pyx_L1_error)
+              __pyx_t_26 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_26 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1630, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
               __pyx_t_28 = __pyx_v_ix;
               __pyx_t_25 = __pyx_v_j;
               *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_28 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_25 * __pyx_v_traj_view.strides[1]) )) = __pyx_t_26;
             }
 
-            /* "cssm.pyx":1516
+            /* "cssm.pyx":1628
  *                 ix += 1
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         for j in range(n_particles):
  *                             traj_view[ix, j] = particles[j]
  */
           }
 
-          /* "cssm.pyx":1515
+          /* "cssm.pyx":1627
  *                 t_particle += delta_t
  *                 ix += 1
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         for j in range(n_particles):
  */
         }
       }
 
-      /* "cssm.pyx":1520
+      /* "cssm.pyx":1632
  *                             traj_view[ix, j] = particles[j]
  * 
  *             choices_view[n, k, 0] = np.argmax(particles)             # <<<<<<<<<<<<<<
  *             #rts_view[n, 0] = t + t[choices_view[n, 0]]
  *             rts_view[n , k, 0] = t_particle + t[k, 0] # for now no t per choice option
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1520, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_argmax); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1520, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_argmax); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_v_particles) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_particles);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1520, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1632, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_22 = __Pyx_PyInt_As_int(__pyx_t_12); if (unlikely((__pyx_t_22 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1520, __pyx_L1_error)
+      __pyx_t_22 = __Pyx_PyInt_As_int(__pyx_t_12); if (unlikely((__pyx_t_22 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1632, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __pyx_t_25 = __pyx_v_n;
       __pyx_t_28 = __pyx_v_k;
       __pyx_t_20 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_25 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_28 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_22;
 
-      /* "cssm.pyx":1522
+      /* "cssm.pyx":1634
  *             choices_view[n, k, 0] = np.argmax(particles)
  *             #rts_view[n, 0] = t + t[choices_view[n, 0]]
  *             rts_view[n , k, 0] = t_particle + t[k, 0] # for now no t per choice option             # <<<<<<<<<<<<<<
  * 
  *         # Create some dics
  */
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_28 = 0;
       __pyx_t_25 = __pyx_v_n;
       __pyx_t_24 = __pyx_v_k;
       __pyx_t_21 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_25 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*__Pyx_BufPtrStrided2d(float *, __pyx_pybuffernd_t.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_t.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_t.diminfo[1].strides)));
     }
 
-    /* "cssm.pyx":1525
+    /* "cssm.pyx":1637
  * 
  *         # Create some dics
  *         v_dict = {}             # <<<<<<<<<<<<<<
  *         z_dict = {}
  *         #t_dict = {}
  */
-    __pyx_t_12 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1525, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1637, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_XDECREF_SET(__pyx_v_v_dict, ((PyObject*)__pyx_t_12));
     __pyx_t_12 = 0;
 
-    /* "cssm.pyx":1526
+    /* "cssm.pyx":1638
  *         # Create some dics
  *         v_dict = {}
  *         z_dict = {}             # <<<<<<<<<<<<<<
  *         #t_dict = {}
  *         for i in range(n_particles):
  */
-    __pyx_t_12 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1526, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1638, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_XDECREF_SET(__pyx_v_z_dict, ((PyObject*)__pyx_t_12));
     __pyx_t_12 = 0;
 
-    /* "cssm.pyx":1528
+    /* "cssm.pyx":1640
  *         z_dict = {}
  *         #t_dict = {}
  *         for i in range(n_particles):             # <<<<<<<<<<<<<<
  *             v_dict['v_' + str(i)] = v[:, i]
  *             z_dict['z_' + str(i)] = z[:, i]
  */
-    __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1528, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1640, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1528, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1640, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
       __pyx_t_12 = __pyx_t_1; __Pyx_INCREF(__pyx_t_12); __pyx_t_16 = 0;
       __pyx_t_30 = NULL;
     } else {
-      __pyx_t_16 = -1; __pyx_t_12 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1528, __pyx_L1_error)
+      __pyx_t_16 = -1; __pyx_t_12 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1640, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
-      __pyx_t_30 = Py_TYPE(__pyx_t_12)->tp_iternext; if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 1528, __pyx_L1_error)
+      __pyx_t_30 = Py_TYPE(__pyx_t_12)->tp_iternext; if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 1640, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     for (;;) {
       if (likely(!__pyx_t_30)) {
         if (likely(PyList_CheckExact(__pyx_t_12))) {
           if (__pyx_t_16 >= PyList_GET_SIZE(__pyx_t_12)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_12, __pyx_t_16); __Pyx_INCREF(__pyx_t_1); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1528, __pyx_L1_error)
+          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_12, __pyx_t_16); __Pyx_INCREF(__pyx_t_1); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1640, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_12, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1528, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_12, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1640, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         } else {
           if (__pyx_t_16 >= PyTuple_GET_SIZE(__pyx_t_12)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_12, __pyx_t_16); __Pyx_INCREF(__pyx_t_1); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1528, __pyx_L1_error)
+          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_12, __pyx_t_16); __Pyx_INCREF(__pyx_t_1); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1640, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_12, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1528, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_12, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1640, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         }
       } else {
         __pyx_t_1 = __pyx_t_30(__pyx_t_12);
         if (unlikely(!__pyx_t_1)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 1528, __pyx_L1_error)
+            else __PYX_ERR(0, 1640, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_1);
       }
       __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "cssm.pyx":1529
+      /* "cssm.pyx":1641
  *         #t_dict = {}
  *         for i in range(n_particles):
  *             v_dict['v_' + str(i)] = v[:, i]             # <<<<<<<<<<<<<<
  *             z_dict['z_' + str(i)] = z[:, i]
  *             #t_dict['t_' + str(i)] = t[i] # for now no t by choice
  */
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1529, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_slice_);
       __Pyx_GIVEREF(__pyx_slice_);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice_);
       __Pyx_INCREF(__pyx_v_i);
       __Pyx_GIVEREF(__pyx_v_i);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_i);
-      __pyx_t_10 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_v), __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1529, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_v), __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1641, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1529, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_n_u_v_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1529, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_n_u_v_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1641, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(PyDict_SetItem(__pyx_v_v_dict, __pyx_t_3, __pyx_t_10) < 0)) __PYX_ERR(0, 1529, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_v_v_dict, __pyx_t_3, __pyx_t_10) < 0)) __PYX_ERR(0, 1641, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-      /* "cssm.pyx":1530
+      /* "cssm.pyx":1642
  *         for i in range(n_particles):
  *             v_dict['v_' + str(i)] = v[:, i]
  *             z_dict['z_' + str(i)] = z[:, i]             # <<<<<<<<<<<<<<
  *             #t_dict['t_' + str(i)] = t[i] # for now no t by choice
  * 
  */
-      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1530, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1642, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_INCREF(__pyx_slice_);
       __Pyx_GIVEREF(__pyx_slice_);
       PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_slice_);
       __Pyx_INCREF(__pyx_v_i);
       __Pyx_GIVEREF(__pyx_v_i);
       PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_v_i);
-      __pyx_t_3 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_z), __pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1530, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_z), __pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1642, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_v_i); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1530, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_v_i); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1642, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_n_u_z_2, __pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1530, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_n_u_z_2, __pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1642, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(PyDict_SetItem(__pyx_v_z_dict, __pyx_t_1, __pyx_t_3) < 0)) __PYX_ERR(0, 1530, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_v_z_dict, __pyx_t_1, __pyx_t_3) < 0)) __PYX_ERR(0, 1642, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "cssm.pyx":1528
+      /* "cssm.pyx":1640
  *         z_dict = {}
  *         #t_dict = {}
  *         for i in range(n_particles):             # <<<<<<<<<<<<<<
  *             v_dict['v_' + str(i)] = v[:, i]
  *             z_dict['z_' + str(i)] = z[:, i]
  */
     }
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
 
-  /* "cssm.pyx":1533
+  /* "cssm.pyx":1645
  *             #t_dict['t_' + str(i)] = t[i] # for now no t by choice
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,             # <<<<<<<<<<<<<<
  *                                                           'a': a,
  *                                                           **z_dict,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1533, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1645, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1533, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1533, __pyx_L1_error)
-  if (unlikely(!__pyx_v_v_dict)) { __Pyx_RaiseUnboundLocalError("v_dict"); __PYX_ERR(0, 1533, __pyx_L1_error) }
-  __pyx_t_3 = PyDict_Copy(__pyx_v_v_dict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1533, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1645, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1645, __pyx_L1_error)
+  if (unlikely(!__pyx_v_v_dict)) { __Pyx_RaiseUnboundLocalError("v_dict"); __PYX_ERR(0, 1645, __pyx_L1_error) }
+  __pyx_t_3 = PyDict_Copy(__pyx_v_v_dict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1645, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
-  /* "cssm.pyx":1534
+  /* "cssm.pyx":1646
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,
  *                                                           'a': a,             # <<<<<<<<<<<<<<
  *                                                           **z_dict,
  *                                                           't': t,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1534, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1646, __pyx_L1_error)
 
-  /* "cssm.pyx":1535
+  /* "cssm.pyx":1647
  *     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,
  *                                                           'a': a,
  *                                                           **z_dict,             # <<<<<<<<<<<<<<
  *                                                           't': t,
  *                                                           # **t_dict, # for now no t by choice
  */
-  if (unlikely(!__pyx_v_z_dict)) { __Pyx_RaiseUnboundLocalError("z_dict"); __PYX_ERR(0, 1535, __pyx_L1_error) }
+  if (unlikely(!__pyx_v_z_dict)) { __Pyx_RaiseUnboundLocalError("z_dict"); __PYX_ERR(0, 1647, __pyx_L1_error) }
   if (unlikely(PyDict_Update(__pyx_t_3, __pyx_v_z_dict) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_z_dict);
-    __PYX_ERR(0, 1535, __pyx_L1_error)
+    __PYX_ERR(0, 1647, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":1536
+  /* "cssm.pyx":1648
  *                                                           'a': a,
  *                                                           **z_dict,
  *                                                           't': t,             # <<<<<<<<<<<<<<
  *                                                           # **t_dict, # for now no t by choice
  *                                                           's': s,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1536, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1648, __pyx_L1_error)
 
-  /* "cssm.pyx":1538
+  /* "cssm.pyx":1650
  *                                                           't': t,
  *                                                           # **t_dict, # for now no t by choice
  *                                                           's': s,             # <<<<<<<<<<<<<<
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, ((PyObject *)__pyx_v_s)) < 0) __PYX_ERR(0, 1538, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, ((PyObject *)__pyx_v_s)) < 0) __PYX_ERR(0, 1650, __pyx_L1_error)
 
-  /* "cssm.pyx":1539
+  /* "cssm.pyx":1651
  *                                                           # **t_dict, # for now no t by choice
  *                                                           's': s,
  *                                                           **boundary_params,             # <<<<<<<<<<<<<<
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 1539, __pyx_L1_error)
+    __PYX_ERR(0, 1651, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_3, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 1539, __pyx_L1_error)
+    __PYX_ERR(0, 1651, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":1540
+  /* "cssm.pyx":1652
  *                                                           's': s,
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1540, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1652, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 1540, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_delta_t, __pyx_t_1) < 0) __PYX_ERR(0, 1652, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1541
+  /* "cssm.pyx":1653
  *                                                           **boundary_params,
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'race_model',
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1541, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1653, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 1541, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_max_t, __pyx_t_1) < 0) __PYX_ERR(0, 1653, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1542
+  /* "cssm.pyx":1654
  *                                                           'delta_t': delta_t,
  *                                                           'max_t': max_t,
  *                                                           'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                           'simulator': 'race_model',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1542, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1654, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 1542, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_n_samples, __pyx_t_1) < 0) __PYX_ERR(0, 1654, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_simulator, __pyx_n_u_race_model) < 0) __PYX_ERR(0, 1543, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_simulator, __pyx_n_u_race_model) < 0) __PYX_ERR(0, 1655, __pyx_L1_error)
 
-  /* "cssm.pyx":1544
+  /* "cssm.pyx":1656
  *                                                           'n_samples': n_samples,
  *                                                           'simulator': 'race_model',
  *                                                           'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                           'possible_choices': list(np.arange(0, n_particles, 1)),
  *                                                           'trajectory': traj,
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1544, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1656, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_boundary_fun_type, __pyx_t_1) < 0) __PYX_ERR(0, 1544, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_boundary_fun_type, __pyx_t_1) < 0) __PYX_ERR(0, 1656, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1545
+  /* "cssm.pyx":1657
  *                                                           'simulator': 'race_model',
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': list(np.arange(0, n_particles, 1)),             # <<<<<<<<<<<<<<
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary}}
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1545, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1657, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_arange); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1545, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_arange); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1657, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1545, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1657, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __pyx_t_4 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
@@ -23573,79 +25072,79 @@
       __Pyx_DECREF_SET(__pyx_t_7, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_int_0, __pyx_t_10, __pyx_int_1};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1545, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1657, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_int_0, __pyx_t_10, __pyx_int_1};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1545, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1657, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1545, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1657, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_4) {
       __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_10);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_11, __pyx_t_10);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_11, __pyx_int_1);
     __pyx_t_10 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1545, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1657, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1545, __pyx_L1_error)
+  __pyx_t_7 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1657, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_possible_choices, __pyx_t_7) < 0) __PYX_ERR(0, 1545, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_possible_choices, __pyx_t_7) < 0) __PYX_ERR(0, 1657, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "cssm.pyx":1546
+  /* "cssm.pyx":1658
  *                                                           'boundary_fun_type': boundary_fun.__name__,
  *                                                           'possible_choices': list(np.arange(0, n_particles, 1)),
  *                                                           'trajectory': traj,             # <<<<<<<<<<<<<<
  *                                                           'boundary': boundary}}
  *     # -------------------------------------------------------------------------------------------------
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1546, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1658, __pyx_L1_error)
 
-  /* "cssm.pyx":1547
+  /* "cssm.pyx":1659
  *                                                           'possible_choices': list(np.arange(0, n_particles, 1)),
  *                                                           'trajectory': traj,
  *                                                           'boundary': boundary}}             # <<<<<<<<<<<<<<
  *     # -------------------------------------------------------------------------------------------------
  * # @cythonboundscheck(False)
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1547, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_3) < 0) __PYX_ERR(0, 1533, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1659, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_3) < 0) __PYX_ERR(0, 1645, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_12;
   __pyx_t_12 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":1426
+  /* "cssm.pyx":1538
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def race_model(np.ndarray[float, ndim = 2] v,  # np.array expected, one column of floats             # <<<<<<<<<<<<<<
  *                np.ndarray[float, ndim = 2] a, # initial boundary separation
  *                np.ndarray[float, ndim = 2] z, # np.array expected, one column of floats
  */
 
@@ -23701,32 +25200,32 @@
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
   __Pyx_XDECREF(__pyx_v_v_dict);
   __Pyx_XDECREF(__pyx_v_z_dict);
   __Pyx_XDECREF(__pyx_v_i);
-  __Pyx_XDECREF(__pyx_8genexpr8__pyx_v_key);
+  __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":1553
+/* "cssm.pyx":1665
  * 
  * # Simulate (rt, choice) tuples from: Leaky Competing Accumulator Model -----------------------------
  * def lca(np.ndarray[float, ndim = 2] v, # drift parameters (np.array expect: one column of floats)             # <<<<<<<<<<<<<<
  *         np.ndarray[float, ndim = 2] a, # criterion height
  *         np.ndarray[float, ndim = 2] z, # initial bias parameters (np.array expect: one column of floats)
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_27lca(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_27lca = {"lca", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_27lca, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_27lca(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_29lca(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_29lca = {"lca", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_29lca, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_29lca(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z = 0;
   PyArrayObject *__pyx_v_g = 0;
   PyArrayObject *__pyx_v_b = 0;
   PyArrayObject *__pyx_v_t = 0;
   PyArrayObject *__pyx_v_s = 0;
@@ -23744,34 +25243,34 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("lca (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_a,&__pyx_n_s_z,&__pyx_n_s_g,&__pyx_n_s_b,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[15] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":1564
+    /* "cssm.pyx":1676
  *         int n_samples = 2000, # number of samples to produce
  *         int n_trials = 1,
  *         boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *         boundary_multiplicative = True,
  *         boundary_params = {},
  */
     values[11] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":1565
+    /* "cssm.pyx":1677
  *         int n_trials = 1,
  *         boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *         boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *         boundary_params = {},
  *         random_state = None,):
  */
     values[12] = ((PyObject *)Py_True);
-    values[13] = __pyx_k__13;
+    values[13] = __pyx_k__14;
 
-    /* "cssm.pyx":1567
+    /* "cssm.pyx":1679
  *         boundary_multiplicative = True,
  *         boundary_params = {},
  *         random_state = None,):             # <<<<<<<<<<<<<<
  * 
  *     set_seed(random_state)
  */
     values[14] = ((PyObject *)Py_None);
@@ -23817,45 +25316,45 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 1); __PYX_ERR(0, 1553, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 1); __PYX_ERR(0, 1665, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 2); __PYX_ERR(0, 1553, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 2); __PYX_ERR(0, 1665, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 3); __PYX_ERR(0, 1553, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 3); __PYX_ERR(0, 1665, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_b)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 4); __PYX_ERR(0, 1553, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 4); __PYX_ERR(0, 1665, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 5); __PYX_ERR(0, 1553, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 5); __PYX_ERR(0, 1665, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 6); __PYX_ERR(0, 1553, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, 6); __PYX_ERR(0, 1665, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_delta_t);
           if (value) { values[7] = value; kw_args--; }
         }
@@ -23899,15 +25398,15 @@
         case 14:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[14] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lca") < 0)) __PYX_ERR(0, 1553, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lca") < 0)) __PYX_ERR(0, 1665, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 15: values[14] = PyTuple_GET_ITEM(__pyx_args, 14);
         CYTHON_FALLTHROUGH;
         case 14: values[13] = PyTuple_GET_ITEM(__pyx_args, 13);
         CYTHON_FALLTHROUGH;
@@ -23938,56 +25437,56 @@
     __pyx_v_a = ((PyArrayObject *)values[1]);
     __pyx_v_z = ((PyArrayObject *)values[2]);
     __pyx_v_g = ((PyArrayObject *)values[3]);
     __pyx_v_b = ((PyArrayObject *)values[4]);
     __pyx_v_t = ((PyArrayObject *)values[5]);
     __pyx_v_s = ((PyArrayObject *)values[6]);
     if (values[7]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1560, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[7]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1672, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[8]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1561, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1673, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[9]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1562, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[9]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1674, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x7D0);
     }
     if (values[10]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[10]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1563, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[10]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1675, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_boundary_fun = values[11];
     __pyx_v_boundary_multiplicative = values[12];
     __pyx_v_boundary_params = values[13];
     __pyx_v_random_state = values[14];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1553, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("lca", 0, 7, 15, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1665, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.lca", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1553, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1554, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1555, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) __PYX_ERR(0, 1556, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_b), __pyx_ptype_5numpy_ndarray, 1, "b", 0))) __PYX_ERR(0, 1557, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1558, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_5numpy_ndarray, 1, "s", 0))) __PYX_ERR(0, 1559, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_26lca(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_g, __pyx_v_b, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) __PYX_ERR(0, 1665, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1666, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) __PYX_ERR(0, 1667, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) __PYX_ERR(0, 1668, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_b), __pyx_ptype_5numpy_ndarray, 1, "b", 0))) __PYX_ERR(0, 1669, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1670, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_s), __pyx_ptype_5numpy_ndarray, 1, "s", 0))) __PYX_ERR(0, 1671, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_28lca(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_g, __pyx_v_b, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":1553
+  /* "cssm.pyx":1665
  * 
  * # Simulate (rt, choice) tuples from: Leaky Competing Accumulator Model -----------------------------
  * def lca(np.ndarray[float, ndim = 2] v, # drift parameters (np.array expect: one column of floats)             # <<<<<<<<<<<<<<
  *         np.ndarray[float, ndim = 2] a, # criterion height
  *         np.ndarray[float, ndim = 2] z, # initial bias parameters (np.array expect: one column of floats)
  */
 
@@ -23996,15 +25495,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_26lca(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_b, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_28lca(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_b, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_g_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_b_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   CYTHON_UNUSED __Pyx_memviewslice __pyx_v_s_view = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -24034,15 +25533,15 @@
   __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_v_num_draws;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
   double __pyx_v_t_particle;
   PyObject *__pyx_v_v_dict = NULL;
   PyObject *__pyx_v_z_dict = NULL;
-  PyObject *__pyx_8genexpr9__pyx_v_key = NULL;
+  PyObject *__pyx_9genexpr10__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_b;
   __Pyx_Buffer __pyx_pybuffer_b;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
   __Pyx_Buffer __pyx_pybuffer_g;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_s;
@@ -24120,497 +25619,497 @@
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   __pyx_pybuffer_s.pybuffer.buf = NULL;
   __pyx_pybuffer_s.refcount = 0;
   __pyx_pybuffernd_s.data = NULL;
   __pyx_pybuffernd_s.rcbuffer = &__pyx_pybuffer_s;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1553, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v.rcbuffer->pybuffer, (PyObject*)__pyx_v_v, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1665, __pyx_L1_error)
   }
   __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_v.diminfo[1].strides = __pyx_pybuffernd_v.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_v.diminfo[1].shape = __pyx_pybuffernd_v.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1553, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1665, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_a.diminfo[1].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_a.diminfo[1].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1553, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z.rcbuffer->pybuffer, (PyObject*)__pyx_v_z, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1665, __pyx_L1_error)
   }
   __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_z.diminfo[1].strides = __pyx_pybuffernd_z.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_z.diminfo[1].shape = __pyx_pybuffernd_z.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g.rcbuffer->pybuffer, (PyObject*)__pyx_v_g, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1553, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g.rcbuffer->pybuffer, (PyObject*)__pyx_v_g, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1665, __pyx_L1_error)
   }
   __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_g.diminfo[1].strides = __pyx_pybuffernd_g.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_g.diminfo[1].shape = __pyx_pybuffernd_g.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_b.rcbuffer->pybuffer, (PyObject*)__pyx_v_b, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1553, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_b.rcbuffer->pybuffer, (PyObject*)__pyx_v_b, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1665, __pyx_L1_error)
   }
   __pyx_pybuffernd_b.diminfo[0].strides = __pyx_pybuffernd_b.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_b.diminfo[0].shape = __pyx_pybuffernd_b.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_b.diminfo[1].strides = __pyx_pybuffernd_b.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_b.diminfo[1].shape = __pyx_pybuffernd_b.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1553, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1665, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_t.diminfo[1].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_t.diminfo[1].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_s.rcbuffer->pybuffer, (PyObject*)__pyx_v_s, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1553, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_s.rcbuffer->pybuffer, (PyObject*)__pyx_v_s, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1665, __pyx_L1_error)
   }
   __pyx_pybuffernd_s.diminfo[0].strides = __pyx_pybuffernd_s.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_s.diminfo[0].shape = __pyx_pybuffernd_s.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_s.diminfo[1].strides = __pyx_pybuffernd_s.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_s.diminfo[1].shape = __pyx_pybuffernd_s.rcbuffer->pybuffer.shape[1];
 
-  /* "cssm.pyx":1569
+  /* "cssm.pyx":1681
  *         random_state = None,):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Param views
  *     cdef float[:, :] v_view = v
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1569, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1681, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1571
+  /* "cssm.pyx":1683
  *     set_seed(random_state)
  *     # Param views
  *     cdef float[:, :] v_view = v             # <<<<<<<<<<<<<<
  *     cdef float[:, :] a_view = a
  *     cdef float[:, :] z_view = z
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1571, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_v), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1683, __pyx_L1_error)
   __pyx_v_v_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1572
+  /* "cssm.pyx":1684
  *     # Param views
  *     cdef float[:, :] v_view = v
  *     cdef float[:, :] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:, :] z_view = z
  *     cdef float[:, :] g_view = g
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1572, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1684, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1573
+  /* "cssm.pyx":1685
  *     cdef float[:, :] v_view = v
  *     cdef float[:, :] a_view = a
  *     cdef float[:, :] z_view = z             # <<<<<<<<<<<<<<
  *     cdef float[:, :] g_view = g
  *     cdef float[:, :] b_view = b
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1573, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_z), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1685, __pyx_L1_error)
   __pyx_v_z_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1574
+  /* "cssm.pyx":1686
  *     cdef float[:, :] a_view = a
  *     cdef float[:, :] z_view = z
  *     cdef float[:, :] g_view = g             # <<<<<<<<<<<<<<
  *     cdef float[:, :] b_view = b
  *     cdef float[:, :] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_g), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1574, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_g), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1686, __pyx_L1_error)
   __pyx_v_g_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1575
+  /* "cssm.pyx":1687
  *     cdef float[:, :] z_view = z
  *     cdef float[:, :] g_view = g
  *     cdef float[:, :] b_view = b             # <<<<<<<<<<<<<<
  *     cdef float[:, :] t_view = t
  *     cdef float[:, :] s_view = s
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_b), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1575, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_b), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1687, __pyx_L1_error)
   __pyx_v_b_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1576
+  /* "cssm.pyx":1688
  *     cdef float[:, :] g_view = g
  *     cdef float[:, :] b_view = b
  *     cdef float[:, :] t_view = t             # <<<<<<<<<<<<<<
  *     cdef float[:, :] s_view = s
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1688, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1577
+  /* "cssm.pyx":1689
  *     cdef float[:, :] b_view = b
  *     cdef float[:, :] t_view = t
  *     cdef float[:, :] s_view = s             # <<<<<<<<<<<<<<
  * 
  *     # Trajectory
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_s), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1577, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_s), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1689, __pyx_L1_error)
   __pyx_v_s_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1580
+  /* "cssm.pyx":1692
  * 
  *     # Trajectory
  *     cdef int n_particles = v.shape[1]             # <<<<<<<<<<<<<<
  *     traj = np.zeros((int(max_t / delta_t) + 1, n_particles), dtype = DTYPE)
  *     traj[:, :] = -999
  */
   __pyx_v_n_particles = (__pyx_v_v->dimensions[1]);
 
-  /* "cssm.pyx":1581
+  /* "cssm.pyx":1693
  *     # Trajectory
  *     cdef int n_particles = v.shape[1]
  *     traj = np.zeros((int(max_t / delta_t) + 1, n_particles), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     traj[:, :] = -999
  *     cdef float[:, :] traj_view = traj
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1581, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble((__pyx_v_max_t / __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1581, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1581, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_1);
   __pyx_t_4 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1581, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1581, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1581, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1581, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1693, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_traj = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "cssm.pyx":1582
+  /* "cssm.pyx":1694
  *     cdef int n_particles = v.shape[1]
  *     traj = np.zeros((int(max_t / delta_t) + 1, n_particles), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:, :] traj_view = traj
  * 
  */
-  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1582, __pyx_L1_error)
+  if (unlikely(PyObject_SetItem(__pyx_v_traj, __pyx_tuple__2, __pyx_int_neg_999) < 0)) __PYX_ERR(0, 1694, __pyx_L1_error)
 
-  /* "cssm.pyx":1583
+  /* "cssm.pyx":1695
  *     traj = np.zeros((int(max_t / delta_t) + 1, n_particles), dtype = DTYPE)
  *     traj[:, :] = -999
  *     cdef float[:, :] traj_view = traj             # <<<<<<<<<<<<<<
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1583, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_traj, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1695, __pyx_L1_error)
   __pyx_v_traj_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1585
+  /* "cssm.pyx":1697
  *     cdef float[:, :] traj_view = traj
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:, :, :] rts_view = rts
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1585, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1585, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1585, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1585, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1585, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_4 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1585, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1585, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1585, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1585, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1697, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1585, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1697, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rts = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "cssm.pyx":1586
+  /* "cssm.pyx":1698
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  * 
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1586, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1698, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "cssm.pyx":1588
+  /* "cssm.pyx":1700
  *     cdef float[:, :, :] rts_view = rts
  * 
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1588, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1588, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1588, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1588, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1588, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_1);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_int_1);
   __pyx_t_4 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1588, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1588, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1588, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1588, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_intc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1588, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1588, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_choices = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "cssm.pyx":1589
+  /* "cssm.pyx":1701
  * 
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     particles = np.zeros(n_particles, dtype = DTYPE)
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1589, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1701, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":1591
+  /* "cssm.pyx":1703
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     particles = np.zeros(n_particles, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] particles_view = particles
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1591, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1591, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1591, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1591, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1591, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1591, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 1591, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1591, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_particles = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1592
+  /* "cssm.pyx":1704
  * 
  *     particles = np.zeros(n_particles, dtype = DTYPE)
  *     cdef float[:] particles_view = particles             # <<<<<<<<<<<<<<
  * 
  *     particles_reduced_sum = np.zeros(n_particles, dtype = DTYPE)
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_particles, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1592, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_particles, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1704, __pyx_L1_error)
   __pyx_v_particles_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":1594
+  /* "cssm.pyx":1706
  *     cdef float[:] particles_view = particles
  * 
  *     particles_reduced_sum = np.zeros(n_particles, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] particles_reduced_sum_view = particles_reduced_sum
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1594, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1594, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1594, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1594, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1594, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1594, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1594, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1594, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_particles_reduced_sum = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":1595
+  /* "cssm.pyx":1707
  * 
  *     particles_reduced_sum = np.zeros(n_particles, dtype = DTYPE)
  *     cdef float[:] particles_reduced_sum_view = particles_reduced_sum             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_particles_reduced_sum, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1595, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_particles_reduced_sum, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1707, __pyx_L1_error)
   __pyx_v_particles_reduced_sum_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":1597
+  /* "cssm.pyx":1709
  *     cdef float[:] particles_reduced_sum_view = particles_reduced_sum
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)             # <<<<<<<<<<<<<<
  *     sqrt_st = s * delta_t_sqrt
  *     cdef float[:, :] sqrt_st_view = sqrt_st
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":1598
+  /* "cssm.pyx":1710
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  *     sqrt_st = s * delta_t_sqrt             # <<<<<<<<<<<<<<
  *     cdef float[:, :] sqrt_st_view = sqrt_st
  * 
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t_sqrt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1598, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_delta_t_sqrt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1710, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = PyNumber_Multiply(((PyObject *)__pyx_v_s), __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1598, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(((PyObject *)__pyx_v_s), __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1710, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_sqrt_st = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1599
+  /* "cssm.pyx":1711
  *     cdef float delta_t_sqrt = sqrt(delta_t)
  *     sqrt_st = s * delta_t_sqrt
  *     cdef float[:, :] sqrt_st_view = sqrt_st             # <<<<<<<<<<<<<<
  * 
  *     cdef Py_ssize_t n, i, ix, k
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_sqrt_st, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1599, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_sqrt_st, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1711, __pyx_L1_error)
   __pyx_v_sqrt_st_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1602
+  /* "cssm.pyx":1714
  * 
  *     cdef Py_ssize_t n, i, ix, k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     cdef float t_par, particles_sum
  * 
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":1606
+  /* "cssm.pyx":1718
  * 
  *     # Boundary storage
  *     cdef int num_steps = int((max_t / delta_t) + 2)             # <<<<<<<<<<<<<<
  * 
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  */
   __pyx_v_num_steps = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 2.0));
 
-  /* "cssm.pyx":1608
+  /* "cssm.pyx":1720
  *     cdef int num_steps = int((max_t / delta_t) + 2)
  * 
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1608, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_arange); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1608, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_arange); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1608, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1608, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_10 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_7);
     if (likely(__pyx_t_10)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
@@ -24619,232 +26118,232 @@
       __Pyx_DECREF_SET(__pyx_t_7, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_1, __pyx_t_4};
-    __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1608, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1720, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_1, __pyx_t_4};
-    __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1608, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1720, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1608, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1720, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_10) {
       __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_4);
     __pyx_t_1 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_12, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1608, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_12, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1720, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1608, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1608, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_12 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_7);
     if (likely(__pyx_t_12)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
       __Pyx_INCREF(__pyx_t_12);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_7, function);
     }
   }
   __pyx_t_3 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_12, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1608, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_t_s = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1609
+  /* "cssm.pyx":1721
  * 
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1609, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1609, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1609, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1609, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1609, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1609, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 1609, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1609, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_boundary = __pyx_t_12;
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":1610
+  /* "cssm.pyx":1722
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     cdef int num_draws = num_steps * n_particles
  */
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1610, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":1612
+  /* "cssm.pyx":1724
  *     cdef float[:] boundary_view = boundary
  * 
  *     cdef int num_draws = num_steps * n_particles             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_num_draws = (__pyx_v_num_steps * __pyx_v_n_particles);
 
-  /* "cssm.pyx":1613
+  /* "cssm.pyx":1725
  * 
  *     cdef int num_draws = num_steps * n_particles
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
-  __pyx_t_9 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1613, __pyx_L1_error)
+  __pyx_t_9 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1725, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "cssm.pyx":1615
+  /* "cssm.pyx":1727
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_11 = __pyx_v_n_trials;
   __pyx_t_13 = __pyx_t_11;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_k = __pyx_t_14;
 
-    /* "cssm.pyx":1617
+    /* "cssm.pyx":1729
  *     for k in range(n_trials):
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         # Precompute boundary evaluations
  */
     { /* enter inner scope */
-      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1617, __pyx_L7_error)
+      __pyx_t_12 = PyDict_New(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1729, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_12);
       __pyx_t_15 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 1617, __pyx_L7_error)
+        __PYX_ERR(0, 1729, __pyx_L7_error)
       }
-      __pyx_t_5 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1617, __pyx_L7_error)
+      __pyx_t_5 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_16), (&__pyx_t_17)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1729, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_XDECREF(__pyx_t_3);
       __pyx_t_3 = __pyx_t_5;
       __pyx_t_5 = 0;
       while (1) {
         __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_3, __pyx_t_16, &__pyx_t_15, &__pyx_t_5, NULL, NULL, __pyx_t_17);
         if (unlikely(__pyx_t_18 == 0)) break;
-        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 1617, __pyx_L7_error)
+        if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 1729, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __Pyx_XDECREF_SET(__pyx_8genexpr9__pyx_v_key, __pyx_t_5);
+        __Pyx_XDECREF_SET(__pyx_9genexpr10__pyx_v_key, __pyx_t_5);
         __pyx_t_5 = 0;
-        __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_8genexpr9__pyx_v_key); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1617, __pyx_L7_error)
+        __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_9genexpr10__pyx_v_key); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1729, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_5, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1617, __pyx_L7_error)
+        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_5, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1729, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_8genexpr9__pyx_v_key, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1617, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_12, (PyObject*)__pyx_9genexpr10__pyx_v_key, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1729, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_key); __pyx_8genexpr9__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_key); __pyx_9genexpr10__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_key); __pyx_8genexpr9__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_key); __pyx_9genexpr10__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_12));
     __pyx_t_12 = 0;
 
-    /* "cssm.pyx":1620
+    /* "cssm.pyx":1732
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 1620, __pyx_L1_error)
+    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_19 < 0)) __PYX_ERR(0, 1732, __pyx_L1_error)
     if (__pyx_t_19) {
 
-      /* "cssm.pyx":1622
+      /* "cssm.pyx":1734
  *         if boundary_multiplicative:
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             # print(a)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1622, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1734, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_multiply); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_multiply); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1734, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_21 = 0;
-      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) ) + __pyx_t_21 * __pyx_v_a_view.strides[1]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1622, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) ) + __pyx_t_21 * __pyx_v_a_view.strides[1]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1734, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1622, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1734, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1622, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1734, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_1;
       __pyx_t_1 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1622, __pyx_L1_error)
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1622, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1734, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1734, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_4)) {
@@ -24854,106 +26353,106 @@
           __Pyx_DECREF_SET(__pyx_t_5, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_1};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1622, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1734, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_1};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1622, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1734, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       } else
       #endif
       {
-        __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1622, __pyx_L1_error)
+        __pyx_t_10 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1734, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_17, __pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_1);
         PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_17, __pyx_t_1);
         __pyx_t_7 = 0;
         __pyx_t_1 = 0;
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1622, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1734, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       }
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1734, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1622, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1734, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
       __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_10, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1622, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1734, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1622, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1734, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-      /* "cssm.pyx":1620
+      /* "cssm.pyx":1732
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":1625
+    /* "cssm.pyx":1737
  *         else:
  *             # print(a)
  *             boundary[:] = np.add(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         for n in range(n_samples):
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1625, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1737, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1625, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_add); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1737, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_20 = 0;
-      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) ) + __pyx_t_20 * __pyx_v_a_view.strides[1]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1625, __pyx_L1_error)
+      __pyx_t_3 = PyFloat_FromDouble((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) ) + __pyx_t_20 * __pyx_v_a_view.strides[1]) )))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1737, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1625, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1737, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1625, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1737, __pyx_L1_error)
       __pyx_t_1 = __pyx_t_7;
       __pyx_t_7 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1625, __pyx_L1_error)
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1625, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1737, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1737, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       __pyx_t_17 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_1)) {
@@ -24963,197 +26462,197 @@
           __Pyx_DECREF_SET(__pyx_t_10, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_3, __pyx_t_7};
-        __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1625, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1737, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_3, __pyx_t_7};
-        __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1625, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_17, 2+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1737, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       } else
       #endif
       {
-        __pyx_t_4 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1625, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_New(2+__pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1737, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         if (__pyx_t_1) {
           __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_17, __pyx_t_3);
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_17, __pyx_t_7);
         __pyx_t_3 = 0;
         __pyx_t_7 = 0;
-        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1625, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1737, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1625, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1737, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1625, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1737, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
       __pyx_t_12 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_5);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1625, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1737, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1625, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_12, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1737, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":1627
+    /* "cssm.pyx":1739
  *             boundary[:] = np.add(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  * 
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             # Reset particle starting points
  *             for i in range(n_particles):
  */
     __pyx_t_17 = __pyx_v_n_samples;
     __pyx_t_18 = __pyx_t_17;
     for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_18; __pyx_t_16+=1) {
       __pyx_v_n = __pyx_t_16;
 
-      /* "cssm.pyx":1629
+      /* "cssm.pyx":1741
  *         for n in range(n_samples):
  *             # Reset particle starting points
  *             for i in range(n_particles):             # <<<<<<<<<<<<<<
  *                 particles_view[i] = z_view[k, i] * boundary_view[0]
  * 
  */
       __pyx_t_22 = __pyx_v_n_particles;
       __pyx_t_23 = __pyx_t_22;
       for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_23; __pyx_t_15+=1) {
         __pyx_v_i = __pyx_t_15;
 
-        /* "cssm.pyx":1630
+        /* "cssm.pyx":1742
  *             # Reset particle starting points
  *             for i in range(n_particles):
  *                 particles_view[i] = z_view[k, i] * boundary_view[0]             # <<<<<<<<<<<<<<
  * 
  *             t_particle = 0.0 # reset time
  */
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_21 = __pyx_v_i;
         __pyx_t_24 = 0;
         __pyx_t_25 = __pyx_v_i;
         *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_25 * __pyx_v_particles_view.strides[0]) )) = ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_20 * __pyx_v_z_view.strides[0]) ) + __pyx_t_21 * __pyx_v_z_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))));
       }
 
-      /* "cssm.pyx":1632
+      /* "cssm.pyx":1744
  *                 particles_view[i] = z_view[k, i] * boundary_view[0]
  * 
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":1633
+      /* "cssm.pyx":1745
  * 
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             if n == 0:
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":1635
+      /* "cssm.pyx":1747
  *             ix = 0 # reset boundary index
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     for i in range(n_particles):
  */
       __pyx_t_19 = ((__pyx_v_n == 0) != 0);
       if (__pyx_t_19) {
 
-        /* "cssm.pyx":1636
+        /* "cssm.pyx":1748
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     for i in range(n_particles):
  *                         traj_view[0, i] = particles[i]
  */
         __pyx_t_19 = ((__pyx_v_k == 0) != 0);
         if (__pyx_t_19) {
 
-          /* "cssm.pyx":1637
+          /* "cssm.pyx":1749
  *             if n == 0:
  *                 if k == 0:
  *                     for i in range(n_particles):             # <<<<<<<<<<<<<<
  *                         traj_view[0, i] = particles[i]
  * 
  */
           __pyx_t_22 = __pyx_v_n_particles;
           __pyx_t_23 = __pyx_t_22;
           for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_23; __pyx_t_15+=1) {
             __pyx_v_i = __pyx_t_15;
 
-            /* "cssm.pyx":1638
+            /* "cssm.pyx":1750
  *                 if k == 0:
  *                     for i in range(n_particles):
  *                         traj_view[0, i] = particles[i]             # <<<<<<<<<<<<<<
  * 
  *             while not check_finished(particles_view, boundary_view[ix], n_particles) and t_particle <= max_t:
  */
-            __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_particles, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1638, __pyx_L1_error)
+            __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_particles, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1750, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
-            __pyx_t_26 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_26 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1638, __pyx_L1_error)
+            __pyx_t_26 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_26 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1750, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
             __pyx_t_24 = 0;
             __pyx_t_21 = __pyx_v_i;
             *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_t_26;
           }
 
-          /* "cssm.pyx":1636
+          /* "cssm.pyx":1748
  * 
  *             if n == 0:
  *                 if k == 0:             # <<<<<<<<<<<<<<
  *                     for i in range(n_particles):
  *                         traj_view[0, i] = particles[i]
  */
         }
 
-        /* "cssm.pyx":1635
+        /* "cssm.pyx":1747
  *             ix = 0 # reset boundary index
  * 
  *             if n == 0:             # <<<<<<<<<<<<<<
  *                 if k == 0:
  *                     for i in range(n_particles):
  */
       }
 
-      /* "cssm.pyx":1640
+      /* "cssm.pyx":1752
  *                         traj_view[0, i] = particles[i]
  * 
  *             while not check_finished(particles_view, boundary_view[ix], n_particles) and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 # calculate current sum over particle positions
  *                 particles_sum = csum(particles_view)
  */
       while (1) {
@@ -25165,281 +26664,281 @@
           goto __pyx_L22_bool_binop_done;
         }
         __pyx_t_27 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_19 = __pyx_t_27;
         __pyx_L22_bool_binop_done:;
         if (!__pyx_t_19) break;
 
-        /* "cssm.pyx":1642
+        /* "cssm.pyx":1754
  *             while not check_finished(particles_view, boundary_view[ix], n_particles) and t_particle <= max_t:
  *                 # calculate current sum over particle positions
  *                 particles_sum = csum(particles_view)             # <<<<<<<<<<<<<<
  * 
  *                 # update particle positions
  */
         __pyx_v_particles_sum = __pyx_f_4cssm_csum(__pyx_v_particles_view);
 
-        /* "cssm.pyx":1645
+        /* "cssm.pyx":1757
  * 
  *                 # update particle positions
  *                 for i in range(n_particles):             # <<<<<<<<<<<<<<
  *                     particles_reduced_sum_view[i] = (- 1) * particles_view[i] + particles_sum
  *                     particles_view[i] += ((v_view[k, i] - (g_view[k, 0] * particles_view[i]) - \
  */
         __pyx_t_22 = __pyx_v_n_particles;
         __pyx_t_23 = __pyx_t_22;
         for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_23; __pyx_t_15+=1) {
           __pyx_v_i = __pyx_t_15;
 
-          /* "cssm.pyx":1646
+          /* "cssm.pyx":1758
  *                 # update particle positions
  *                 for i in range(n_particles):
  *                     particles_reduced_sum_view[i] = (- 1) * particles_view[i] + particles_sum             # <<<<<<<<<<<<<<
  *                     particles_view[i] += ((v_view[k, i] - (g_view[k, 0] * particles_view[i]) - \
  *                             (b_view[k, 0] * particles_reduced_sum_view[i])) * delta_t) + (sqrt_st_view[k, i] * gaussian_values[m])
  */
           __pyx_t_21 = __pyx_v_i;
           __pyx_t_24 = __pyx_v_i;
           *((float *) ( /* dim=0 */ (__pyx_v_particles_reduced_sum_view.data + __pyx_t_24 * __pyx_v_particles_reduced_sum_view.strides[0]) )) = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_21 * __pyx_v_particles_view.strides[0]) )))) + __pyx_v_particles_sum);
 
-          /* "cssm.pyx":1647
+          /* "cssm.pyx":1759
  *                 for i in range(n_particles):
  *                     particles_reduced_sum_view[i] = (- 1) * particles_view[i] + particles_sum
  *                     particles_view[i] += ((v_view[k, i] - (g_view[k, 0] * particles_view[i]) - \             # <<<<<<<<<<<<<<
  *                             (b_view[k, 0] * particles_reduced_sum_view[i])) * delta_t) + (sqrt_st_view[k, i] * gaussian_values[m])
  *                     particles_view[i] = fmax(0.0, particles_view[i])
  */
           __pyx_t_21 = __pyx_v_k;
           __pyx_t_24 = __pyx_v_i;
           __pyx_t_20 = __pyx_v_k;
           __pyx_t_25 = 0;
           __pyx_t_28 = __pyx_v_i;
 
-          /* "cssm.pyx":1648
+          /* "cssm.pyx":1760
  *                     particles_reduced_sum_view[i] = (- 1) * particles_view[i] + particles_sum
  *                     particles_view[i] += ((v_view[k, i] - (g_view[k, 0] * particles_view[i]) - \
  *                             (b_view[k, 0] * particles_reduced_sum_view[i])) * delta_t) + (sqrt_st_view[k, i] * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                     particles_view[i] = fmax(0.0, particles_view[i])
  *                     m += 1
  */
           __pyx_t_29 = __pyx_v_k;
           __pyx_t_30 = 0;
           __pyx_t_31 = __pyx_v_i;
 
-          /* "cssm.pyx":1647
+          /* "cssm.pyx":1759
  *                 for i in range(n_particles):
  *                     particles_reduced_sum_view[i] = (- 1) * particles_view[i] + particles_sum
  *                     particles_view[i] += ((v_view[k, i] - (g_view[k, 0] * particles_view[i]) - \             # <<<<<<<<<<<<<<
  *                             (b_view[k, 0] * particles_reduced_sum_view[i])) * delta_t) + (sqrt_st_view[k, i] * gaussian_values[m])
  *                     particles_view[i] = fmax(0.0, particles_view[i])
  */
           __pyx_t_32 = __pyx_v_k;
           __pyx_t_33 = __pyx_v_i;
 
-          /* "cssm.pyx":1648
+          /* "cssm.pyx":1760
  *                     particles_reduced_sum_view[i] = (- 1) * particles_view[i] + particles_sum
  *                     particles_view[i] += ((v_view[k, i] - (g_view[k, 0] * particles_view[i]) - \
  *                             (b_view[k, 0] * particles_reduced_sum_view[i])) * delta_t) + (sqrt_st_view[k, i] * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                     particles_view[i] = fmax(0.0, particles_view[i])
  *                     m += 1
  */
           __pyx_t_34 = __pyx_v_m;
 
-          /* "cssm.pyx":1647
+          /* "cssm.pyx":1759
  *                 for i in range(n_particles):
  *                     particles_reduced_sum_view[i] = (- 1) * particles_view[i] + particles_sum
  *                     particles_view[i] += ((v_view[k, i] - (g_view[k, 0] * particles_view[i]) - \             # <<<<<<<<<<<<<<
  *                             (b_view[k, 0] * particles_reduced_sum_view[i])) * delta_t) + (sqrt_st_view[k, i] * gaussian_values[m])
  *                     particles_view[i] = fmax(0.0, particles_view[i])
  */
           __pyx_t_35 = __pyx_v_i;
           *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_35 * __pyx_v_particles_view.strides[0]) )) += (((((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_21 * __pyx_v_v_view.strides[0]) ) + __pyx_t_24 * __pyx_v_v_view.strides[1]) ))) - ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_20 * __pyx_v_g_view.strides[0]) ) + __pyx_t_25 * __pyx_v_g_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_28 * __pyx_v_particles_view.strides[0]) ))))) - ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_b_view.data + __pyx_t_29 * __pyx_v_b_view.strides[0]) ) + __pyx_t_30 * __pyx_v_b_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_particles_reduced_sum_view.data + __pyx_t_31 * __pyx_v_particles_reduced_sum_view.strides[0]) ))))) * __pyx_v_delta_t) + ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sqrt_st_view.data + __pyx_t_32 * __pyx_v_sqrt_st_view.strides[0]) ) + __pyx_t_33 * __pyx_v_sqrt_st_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_34 * __pyx_v_gaussian_values.strides[0]) )))));
 
-          /* "cssm.pyx":1649
+          /* "cssm.pyx":1761
  *                     particles_view[i] += ((v_view[k, i] - (g_view[k, 0] * particles_view[i]) - \
  *                             (b_view[k, 0] * particles_reduced_sum_view[i])) * delta_t) + (sqrt_st_view[k, i] * gaussian_values[m])
  *                     particles_view[i] = fmax(0.0, particles_view[i])             # <<<<<<<<<<<<<<
  *                     m += 1
  * 
  */
           __pyx_t_34 = __pyx_v_i;
           __pyx_t_33 = __pyx_v_i;
           *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_33 * __pyx_v_particles_view.strides[0]) )) = fmax(0.0, (*((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_34 * __pyx_v_particles_view.strides[0]) ))));
 
-          /* "cssm.pyx":1650
+          /* "cssm.pyx":1762
  *                             (b_view[k, 0] * particles_reduced_sum_view[i])) * delta_t) + (sqrt_st_view[k, i] * gaussian_values[m])
  *                     particles_view[i] = fmax(0.0, particles_view[i])
  *                     m += 1             # <<<<<<<<<<<<<<
  * 
  *                     if m == num_draws:
  */
           __pyx_v_m = (__pyx_v_m + 1);
 
-          /* "cssm.pyx":1652
+          /* "cssm.pyx":1764
  *                     m += 1
  * 
  *                     if m == num_draws:             # <<<<<<<<<<<<<<
  *                         gaussian_values = draw_gaussian(num_draws)
  *                         m = 0
  */
           __pyx_t_19 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
           if (__pyx_t_19) {
 
-            /* "cssm.pyx":1653
+            /* "cssm.pyx":1765
  * 
  *                     if m == num_draws:
  *                         gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                         m = 0
  * 
  */
-            __pyx_t_9 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1653, __pyx_L1_error)
+            __pyx_t_9 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1765, __pyx_L1_error)
             __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
             __pyx_v_gaussian_values = __pyx_t_9;
             __pyx_t_9.memview = NULL;
             __pyx_t_9.data = NULL;
 
-            /* "cssm.pyx":1654
+            /* "cssm.pyx":1766
  *                     if m == num_draws:
  *                         gaussian_values = draw_gaussian(num_draws)
  *                         m = 0             # <<<<<<<<<<<<<<
  * 
  *                 t_particle += delta_t # increment time
  */
             __pyx_v_m = 0;
 
-            /* "cssm.pyx":1652
+            /* "cssm.pyx":1764
  *                     m += 1
  * 
  *                     if m == num_draws:             # <<<<<<<<<<<<<<
  *                         gaussian_values = draw_gaussian(num_draws)
  *                         m = 0
  */
           }
         }
 
-        /* "cssm.pyx":1656
+        /* "cssm.pyx":1768
  *                         m = 0
  * 
  *                 t_particle += delta_t # increment time             # <<<<<<<<<<<<<<
  *                 ix += 1 # increment boundary index
  * 
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":1657
+        /* "cssm.pyx":1769
  * 
  *                 t_particle += delta_t # increment time
  *                 ix += 1 # increment boundary index             # <<<<<<<<<<<<<<
  * 
  *                 if n == 0:
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":1659
+        /* "cssm.pyx":1771
  *                 ix += 1 # increment boundary index
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         for i in range(n_particles):
  */
         __pyx_t_19 = ((__pyx_v_n == 0) != 0);
         if (__pyx_t_19) {
 
-          /* "cssm.pyx":1660
+          /* "cssm.pyx":1772
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         for i in range(n_particles):
  *                             traj_view[ix, i] = particles[i]
  */
           __pyx_t_19 = ((__pyx_v_k == 0) != 0);
           if (__pyx_t_19) {
 
-            /* "cssm.pyx":1661
+            /* "cssm.pyx":1773
  *                 if n == 0:
  *                     if k == 0:
  *                         for i in range(n_particles):             # <<<<<<<<<<<<<<
  *                             traj_view[ix, i] = particles[i]
  * 
  */
             __pyx_t_22 = __pyx_v_n_particles;
             __pyx_t_23 = __pyx_t_22;
             for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_23; __pyx_t_15+=1) {
               __pyx_v_i = __pyx_t_15;
 
-              /* "cssm.pyx":1662
+              /* "cssm.pyx":1774
  *                     if k == 0:
  *                         for i in range(n_particles):
  *                             traj_view[ix, i] = particles[i]             # <<<<<<<<<<<<<<
  * 
  *             choices_view[n, k, 0] = np.argmax(particles) # store choices for sample n
  */
-              __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_particles, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1662, __pyx_L1_error)
+              __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_particles, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1774, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_12);
-              __pyx_t_26 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_26 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1662, __pyx_L1_error)
+              __pyx_t_26 = __pyx_PyFloat_AsFloat(__pyx_t_12); if (unlikely((__pyx_t_26 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1774, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
               __pyx_t_34 = __pyx_v_ix;
               __pyx_t_33 = __pyx_v_i;
               *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_34 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_33 * __pyx_v_traj_view.strides[1]) )) = __pyx_t_26;
             }
 
-            /* "cssm.pyx":1660
+            /* "cssm.pyx":1772
  * 
  *                 if n == 0:
  *                     if k == 0:             # <<<<<<<<<<<<<<
  *                         for i in range(n_particles):
  *                             traj_view[ix, i] = particles[i]
  */
           }
 
-          /* "cssm.pyx":1659
+          /* "cssm.pyx":1771
  *                 ix += 1 # increment boundary index
  * 
  *                 if n == 0:             # <<<<<<<<<<<<<<
  *                     if k == 0:
  *                         for i in range(n_particles):
  */
         }
       }
 
-      /* "cssm.pyx":1664
+      /* "cssm.pyx":1776
  *                             traj_view[ix, i] = particles[i]
  * 
  *             choices_view[n, k, 0] = np.argmax(particles) # store choices for sample n             # <<<<<<<<<<<<<<
  *             rts_view[n, k, 0] = t_particle + t_view[k, 0] # t[choices_view[n, 0]] # store reaction time for sample n
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1664, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1776, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_argmax); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1664, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_argmax); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1776, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
       __pyx_t_12 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_10, __pyx_v_particles) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_particles);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1664, __pyx_L1_error)
+      if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1776, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_22 = __Pyx_PyInt_As_int(__pyx_t_12); if (unlikely((__pyx_t_22 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1664, __pyx_L1_error)
+      __pyx_t_22 = __Pyx_PyInt_As_int(__pyx_t_12); if (unlikely((__pyx_t_22 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1776, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __pyx_t_33 = __pyx_v_n;
       __pyx_t_34 = __pyx_v_k;
       __pyx_t_32 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_33 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_34 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_32 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_22;
 
-      /* "cssm.pyx":1665
+      /* "cssm.pyx":1777
  * 
  *             choices_view[n, k, 0] = np.argmax(particles) # store choices for sample n
  *             rts_view[n, k, 0] = t_particle + t_view[k, 0] # t[choices_view[n, 0]] # store reaction time for sample n             # <<<<<<<<<<<<<<
  * 
  *     # Create some dics
  */
       __pyx_t_32 = __pyx_v_k;
@@ -25447,265 +26946,265 @@
       __pyx_t_33 = __pyx_v_n;
       __pyx_t_31 = __pyx_v_k;
       __pyx_t_30 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_33 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_31 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_30 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_32 * __pyx_v_t_view.strides[0]) ) + __pyx_t_34 * __pyx_v_t_view.strides[1]) ))));
     }
   }
 
-  /* "cssm.pyx":1668
+  /* "cssm.pyx":1780
  * 
  *     # Create some dics
  *     v_dict = {}             # <<<<<<<<<<<<<<
  *     z_dict = {}
  *     #t_dict = {}
  */
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1668, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __pyx_v_v_dict = ((PyObject*)__pyx_t_12);
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":1669
+  /* "cssm.pyx":1781
  *     # Create some dics
  *     v_dict = {}
  *     z_dict = {}             # <<<<<<<<<<<<<<
  *     #t_dict = {}
  * 
  */
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1669, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1781, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __pyx_v_z_dict = ((PyObject*)__pyx_t_12);
   __pyx_t_12 = 0;
 
-  /* "cssm.pyx":1672
+  /* "cssm.pyx":1784
  *     #t_dict = {}
  * 
  *     for i in range(n_particles):             # <<<<<<<<<<<<<<
  *         v_dict['v_' + str(i)] = v[:, i]
  *         z_dict['z_' + str(i)] = z[:, i]
  */
   __pyx_t_11 = __pyx_v_n_particles;
   __pyx_t_13 = __pyx_t_11;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_i = __pyx_t_14;
 
-    /* "cssm.pyx":1673
+    /* "cssm.pyx":1785
  * 
  *     for i in range(n_particles):
  *         v_dict['v_' + str(i)] = v[:, i]             # <<<<<<<<<<<<<<
  *         z_dict['z_' + str(i)] = z[:, i]
  * 
  */
-    __pyx_t_12 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1673, __pyx_L1_error)
+    __pyx_t_12 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1785, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1673, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1785, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_slice_);
     __Pyx_GIVEREF(__pyx_slice_);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_slice_);
     __Pyx_GIVEREF(__pyx_t_12);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_12);
     __pyx_t_12 = 0;
-    __pyx_t_12 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_v), __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1673, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_v), __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1785, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1673, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1785, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_10 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1673, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1785, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_n_u_v_2, __pyx_t_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1673, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_n_u_v_2, __pyx_t_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1785, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(PyDict_SetItem(__pyx_v_v_dict, __pyx_t_5, __pyx_t_12) < 0)) __PYX_ERR(0, 1673, __pyx_L1_error)
+    if (unlikely(PyDict_SetItem(__pyx_v_v_dict, __pyx_t_5, __pyx_t_12) < 0)) __PYX_ERR(0, 1785, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-    /* "cssm.pyx":1674
+    /* "cssm.pyx":1786
  *     for i in range(n_particles):
  *         v_dict['v_' + str(i)] = v[:, i]
  *         z_dict['z_' + str(i)] = z[:, i]             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,
  */
-    __pyx_t_12 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1674, __pyx_L1_error)
+    __pyx_t_12 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1674, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_slice_);
     __Pyx_GIVEREF(__pyx_slice_);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_slice_);
     __Pyx_GIVEREF(__pyx_t_12);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_12);
     __pyx_t_12 = 0;
-    __pyx_t_12 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_z), __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1674, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_z), __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1674, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_10 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1674, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_n_u_z_2, __pyx_t_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1674, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_n_u_z_2, __pyx_t_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(PyDict_SetItem(__pyx_v_z_dict, __pyx_t_5, __pyx_t_12) < 0)) __PYX_ERR(0, 1674, __pyx_L1_error)
+    if (unlikely(PyDict_SetItem(__pyx_v_z_dict, __pyx_t_5, __pyx_t_12) < 0)) __PYX_ERR(0, 1786, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
 
-  /* "cssm.pyx":1676
+  /* "cssm.pyx":1788
  *         z_dict['z_' + str(i)] = z[:, i]
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,             # <<<<<<<<<<<<<<
  *                                                          'a': a,
  *                                                          **z_dict,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1676, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1676, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1676, __pyx_L1_error)
-  __pyx_t_5 = PyDict_Copy(__pyx_v_v_dict); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1676, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1788, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1788, __pyx_L1_error)
+  __pyx_t_5 = PyDict_Copy(__pyx_v_v_dict); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
 
-  /* "cssm.pyx":1677
+  /* "cssm.pyx":1789
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,
  *                                                          'a': a,             # <<<<<<<<<<<<<<
  *                                                          **z_dict,
  *                                                          'g': g,
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1677, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1789, __pyx_L1_error)
 
-  /* "cssm.pyx":1678
+  /* "cssm.pyx":1790
  *     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,
  *                                                          'a': a,
  *                                                          **z_dict,             # <<<<<<<<<<<<<<
  *                                                          'g': g,
  *                                                          'b': b,
  */
   if (unlikely(PyDict_Update(__pyx_t_5, __pyx_v_z_dict) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_z_dict);
-    __PYX_ERR(0, 1678, __pyx_L1_error)
+    __PYX_ERR(0, 1790, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":1679
+  /* "cssm.pyx":1791
  *                                                          'a': a,
  *                                                          **z_dict,
  *                                                          'g': g,             # <<<<<<<<<<<<<<
  *                                                          'b': b,
  *                                                          't': t,
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_g, ((PyObject *)__pyx_v_g)) < 0) __PYX_ERR(0, 1679, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_g, ((PyObject *)__pyx_v_g)) < 0) __PYX_ERR(0, 1791, __pyx_L1_error)
 
-  /* "cssm.pyx":1680
+  /* "cssm.pyx":1792
  *                                                          **z_dict,
  *                                                          'g': g,
  *                                                          'b': b,             # <<<<<<<<<<<<<<
  *                                                          't': t,
  *                                                          's': s,
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_b, ((PyObject *)__pyx_v_b)) < 0) __PYX_ERR(0, 1680, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_b, ((PyObject *)__pyx_v_b)) < 0) __PYX_ERR(0, 1792, __pyx_L1_error)
 
-  /* "cssm.pyx":1681
+  /* "cssm.pyx":1793
  *                                                          'g': g,
  *                                                          'b': b,
  *                                                          't': t,             # <<<<<<<<<<<<<<
  *                                                          's': s,
  *                                                          **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1681, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1793, __pyx_L1_error)
 
-  /* "cssm.pyx":1682
+  /* "cssm.pyx":1794
  *                                                          'b': b,
  *                                                          't': t,
  *                                                          's': s,             # <<<<<<<<<<<<<<
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_s, ((PyObject *)__pyx_v_s)) < 0) __PYX_ERR(0, 1682, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_s, ((PyObject *)__pyx_v_s)) < 0) __PYX_ERR(0, 1794, __pyx_L1_error)
 
-  /* "cssm.pyx":1683
+  /* "cssm.pyx":1795
  *                                                          't': t,
  *                                                          's': s,
  *                                                          **boundary_params,             # <<<<<<<<<<<<<<
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 1683, __pyx_L1_error)
+    __PYX_ERR(0, 1795, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_5, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 1683, __pyx_L1_error)
+    __PYX_ERR(0, 1795, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":1684
+  /* "cssm.pyx":1796
  *                                                          's': s,
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,
  */
-  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1684, __pyx_L1_error)
+  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1796, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_delta_t, __pyx_t_10) < 0) __PYX_ERR(0, 1684, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_delta_t, __pyx_t_10) < 0) __PYX_ERR(0, 1796, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1685
+  /* "cssm.pyx":1797
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                          'n_samples': n_samples,
  *                                                          'simulator' : 'lca',
  */
-  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1685, __pyx_L1_error)
+  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_max_t, __pyx_t_10) < 0) __PYX_ERR(0, 1685, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_max_t, __pyx_t_10) < 0) __PYX_ERR(0, 1797, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1686
+  /* "cssm.pyx":1798
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                          'simulator' : 'lca',
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1686, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1798, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_n_samples, __pyx_t_10) < 0) __PYX_ERR(0, 1686, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_n_samples, __pyx_t_10) < 0) __PYX_ERR(0, 1798, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_simulator, __pyx_n_u_lca) < 0) __PYX_ERR(0, 1687, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_simulator, __pyx_n_u_lca) < 0) __PYX_ERR(0, 1799, __pyx_L1_error)
 
-  /* "cssm.pyx":1688
+  /* "cssm.pyx":1800
  *                                                          'n_samples': n_samples,
  *                                                          'simulator' : 'lca',
  *                                                          'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                          'possible_choices': list(np.arange(0, n_particles, 1)),
  *                                                          'trajectory': traj,
  */
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1688, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1800, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_boundary_fun_type, __pyx_t_10) < 0) __PYX_ERR(0, 1688, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_boundary_fun_type, __pyx_t_10) < 0) __PYX_ERR(0, 1800, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "cssm.pyx":1689
+  /* "cssm.pyx":1801
  *                                                          'simulator' : 'lca',
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  *                                                          'possible_choices': list(np.arange(0, n_particles, 1)),             # <<<<<<<<<<<<<<
  *                                                          'trajectory': traj,
  *                                                          'boundary': boundary}}
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1689, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1801, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1689, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1801, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1689, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_particles); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1801, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = NULL;
   __pyx_t_11 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
@@ -25714,79 +27213,79 @@
       __Pyx_DECREF_SET(__pyx_t_7, function);
       __pyx_t_11 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_int_0, __pyx_t_4, __pyx_int_1};
-    __pyx_t_10 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1689, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1801, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_int_0, __pyx_t_4, __pyx_int_1};
-    __pyx_t_10 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1689, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1801, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   {
-    __pyx_t_1 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1689, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_11, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_11, __pyx_t_4);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_11, __pyx_int_1);
     __pyx_t_4 = 0;
-    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1689, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PySequence_List(__pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1689, __pyx_L1_error)
+  __pyx_t_7 = PySequence_List(__pyx_t_10); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1801, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_possible_choices, __pyx_t_7) < 0) __PYX_ERR(0, 1689, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_possible_choices, __pyx_t_7) < 0) __PYX_ERR(0, 1801, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "cssm.pyx":1690
+  /* "cssm.pyx":1802
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  *                                                          'possible_choices': list(np.arange(0, n_particles, 1)),
  *                                                          'trajectory': traj,             # <<<<<<<<<<<<<<
  *                                                          'boundary': boundary}}
  * 
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1690, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_trajectory, __pyx_v_traj) < 0) __PYX_ERR(0, 1802, __pyx_L1_error)
 
-  /* "cssm.pyx":1691
+  /* "cssm.pyx":1803
  *                                                          'possible_choices': list(np.arange(0, n_particles, 1)),
  *                                                          'trajectory': traj,
  *                                                          'boundary': boundary}}             # <<<<<<<<<<<<<<
  * 
  * # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_5) < 0) __PYX_ERR(0, 1676, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1803, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_12, __pyx_n_u_metadata, __pyx_t_5) < 0) __PYX_ERR(0, 1788, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_r = __pyx_t_12;
   __pyx_t_12 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":1553
+  /* "cssm.pyx":1665
  * 
  * # Simulate (rt, choice) tuples from: Leaky Competing Accumulator Model -----------------------------
  * def lca(np.ndarray[float, ndim = 2] v, # drift parameters (np.array expect: one column of floats)             # <<<<<<<<<<<<<<
  *         np.ndarray[float, ndim = 2] a, # criterion height
  *         np.ndarray[float, ndim = 2] z, # initial bias parameters (np.array expect: one column of floats)
  */
 
@@ -25849,32 +27348,32 @@
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
   __Pyx_XDECREF(__pyx_v_v_dict);
   __Pyx_XDECREF(__pyx_v_z_dict);
-  __Pyx_XDECREF(__pyx_8genexpr9__pyx_v_key);
+  __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":1696
+/* "cssm.pyx":1808
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_seq2(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] v_l_1,
  *                        np.ndarray[float, ndim = 1] v_l_2,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_29ddm_flexbound_seq2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_29ddm_flexbound_seq2 = {"ddm_flexbound_seq2", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_29ddm_flexbound_seq2, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_29ddm_flexbound_seq2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_31ddm_flexbound_seq2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_31ddm_flexbound_seq2 = {"ddm_flexbound_seq2", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_31ddm_flexbound_seq2, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_31ddm_flexbound_seq2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v_h = 0;
   PyArrayObject *__pyx_v_v_l_1 = 0;
   PyArrayObject *__pyx_v_v_l_2 = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z_h = 0;
   PyArrayObject *__pyx_v_z_l_1 = 0;
   PyArrayObject *__pyx_v_z_l_2 = 0;
@@ -25895,43 +27394,43 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ddm_flexbound_seq2 (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v_h,&__pyx_n_s_v_l_1,&__pyx_n_s_v_l_2,&__pyx_n_s_a,&__pyx_n_s_z_h,&__pyx_n_s_z_l_1,&__pyx_n_s_z_l_2,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_print_info,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[18] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":1709
+    /* "cssm.pyx":1821
  *                        int n_samples = 20000,
  *                        int n_trials = 1,
  *                        print_info = True,             # <<<<<<<<<<<<<<
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                        boundary_multiplicative = True,
  */
     values[13] = ((PyObject *)Py_True);
 
-    /* "cssm.pyx":1710
+    /* "cssm.pyx":1822
  *                        int n_trials = 1,
  *                        print_info = True,
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *                        boundary_multiplicative = True,
  *                        boundary_params = {},
  */
     values[14] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":1711
+    /* "cssm.pyx":1823
  *                        print_info = True,
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                        boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *                        boundary_params = {},
  *                        random_state = None,
  */
     values[15] = ((PyObject *)Py_True);
-    values[16] = __pyx_k__14;
+    values[16] = __pyx_k__15;
 
-    /* "cssm.pyx":1713
+    /* "cssm.pyx":1825
  *                        boundary_multiplicative = True,
  *                        boundary_params = {},
  *                        random_state = None,             # <<<<<<<<<<<<<<
  *                        ):
  * 
  */
     values[17] = ((PyObject *)Py_None);
@@ -25983,51 +27482,51 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_h)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_l_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 1); __PYX_ERR(0, 1696, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 1); __PYX_ERR(0, 1808, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_l_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 2); __PYX_ERR(0, 1696, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 2); __PYX_ERR(0, 1808, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 3); __PYX_ERR(0, 1696, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 3); __PYX_ERR(0, 1808, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_h)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 4); __PYX_ERR(0, 1696, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 4); __PYX_ERR(0, 1808, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_l_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 5); __PYX_ERR(0, 1696, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 5); __PYX_ERR(0, 1808, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_l_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 6); __PYX_ERR(0, 1696, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 6); __PYX_ERR(0, 1808, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 7); __PYX_ERR(0, 1696, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, 7); __PYX_ERR(0, 1808, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[8] = value; kw_args--; }
         }
@@ -26083,15 +27582,15 @@
         case 17:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[17] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_seq2") < 0)) __PYX_ERR(0, 1696, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_seq2") < 0)) __PYX_ERR(0, 1808, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 18: values[17] = PyTuple_GET_ITEM(__pyx_args, 17);
         CYTHON_FALLTHROUGH;
         case 17: values[16] = PyTuple_GET_ITEM(__pyx_args, 16);
         CYTHON_FALLTHROUGH;
@@ -26128,63 +27627,63 @@
     __pyx_v_v_l_2 = ((PyArrayObject *)values[2]);
     __pyx_v_a = ((PyArrayObject *)values[3]);
     __pyx_v_z_h = ((PyArrayObject *)values[4]);
     __pyx_v_z_l_1 = ((PyArrayObject *)values[5]);
     __pyx_v_z_l_2 = ((PyArrayObject *)values[6]);
     __pyx_v_t = ((PyArrayObject *)values[7]);
     if (values[8]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1704, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1816, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[9]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1705, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1817, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[10]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[10]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1706, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[10]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1818, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[11]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[11]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1707, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[11]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1819, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[12]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[12]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1708, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[12]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1820, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_print_info = values[13];
     __pyx_v_boundary_fun = values[14];
     __pyx_v_boundary_multiplicative = values[15];
     __pyx_v_boundary_params = values[16];
     __pyx_v_random_state = values[17];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1696, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_seq2", 0, 8, 18, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1808, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ddm_flexbound_seq2", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_h), __pyx_ptype_5numpy_ndarray, 1, "v_h", 0))) __PYX_ERR(0, 1696, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_1), __pyx_ptype_5numpy_ndarray, 1, "v_l_1", 0))) __PYX_ERR(0, 1697, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_2), __pyx_ptype_5numpy_ndarray, 1, "v_l_2", 0))) __PYX_ERR(0, 1698, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1699, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_h), __pyx_ptype_5numpy_ndarray, 1, "z_h", 0))) __PYX_ERR(0, 1700, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_1), __pyx_ptype_5numpy_ndarray, 1, "z_l_1", 0))) __PYX_ERR(0, 1701, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_2), __pyx_ptype_5numpy_ndarray, 1, "z_l_2", 0))) __PYX_ERR(0, 1702, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1703, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_28ddm_flexbound_seq2(__pyx_self, __pyx_v_v_h, __pyx_v_v_l_1, __pyx_v_v_l_2, __pyx_v_a, __pyx_v_z_h, __pyx_v_z_l_1, __pyx_v_z_l_2, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_h), __pyx_ptype_5numpy_ndarray, 1, "v_h", 0))) __PYX_ERR(0, 1808, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_1), __pyx_ptype_5numpy_ndarray, 1, "v_l_1", 0))) __PYX_ERR(0, 1809, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_2), __pyx_ptype_5numpy_ndarray, 1, "v_l_2", 0))) __PYX_ERR(0, 1810, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1811, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_h), __pyx_ptype_5numpy_ndarray, 1, "z_h", 0))) __PYX_ERR(0, 1812, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_1), __pyx_ptype_5numpy_ndarray, 1, "z_l_1", 0))) __PYX_ERR(0, 1813, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_2), __pyx_ptype_5numpy_ndarray, 1, "z_l_2", 0))) __PYX_ERR(0, 1814, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1815, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_30ddm_flexbound_seq2(__pyx_self, __pyx_v_v_h, __pyx_v_v_l_1, __pyx_v_v_l_2, __pyx_v_a, __pyx_v_z_h, __pyx_v_z_l_1, __pyx_v_z_l_2, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":1696
+  /* "cssm.pyx":1808
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_seq2(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] v_l_1,
  *                        np.ndarray[float, ndim = 1] v_l_2,
  */
 
@@ -26193,15 +27692,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_28ddm_flexbound_seq2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_30ddm_flexbound_seq2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_h_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_v_l_1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_v_l_2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_h_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_l_1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_l_2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -26222,15 +27721,15 @@
   Py_ssize_t __pyx_v_n;
   Py_ssize_t __pyx_v_ix;
   Py_ssize_t __pyx_v_k;
   Py_ssize_t __pyx_v_m;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
   PyObject *__pyx_v_v_l = NULL;
-  PyObject *__pyx_9genexpr10__pyx_v_key = NULL;
+  PyObject *__pyx_9genexpr11__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
   __Pyx_Buffer __pyx_pybuffer_t;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v_h;
   __Pyx_Buffer __pyx_pybuffer_v_h;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v_l_1;
@@ -26305,321 +27804,321 @@
   __pyx_pybuffernd_z_l_2.rcbuffer = &__pyx_pybuffer_z_l_2;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1696, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1808, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_h.diminfo[0].strides = __pyx_pybuffernd_v_h.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_h.diminfo[0].shape = __pyx_pybuffernd_v_h.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1696, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1808, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_l_1.diminfo[0].strides = __pyx_pybuffernd_v_l_1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_l_1.diminfo[0].shape = __pyx_pybuffernd_v_l_1.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1696, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1808, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_l_2.diminfo[0].strides = __pyx_pybuffernd_v_l_2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_l_2.diminfo[0].shape = __pyx_pybuffernd_v_l_2.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1696, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1808, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1696, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1808, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_h.diminfo[0].strides = __pyx_pybuffernd_z_h.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_h.diminfo[0].shape = __pyx_pybuffernd_z_h.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1696, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1808, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_l_1.diminfo[0].strides = __pyx_pybuffernd_z_l_1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_l_1.diminfo[0].shape = __pyx_pybuffernd_z_l_1.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1696, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1808, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_l_2.diminfo[0].strides = __pyx_pybuffernd_z_l_2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_l_2.diminfo[0].shape = __pyx_pybuffernd_z_l_2.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1696, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1808, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":1716
+  /* "cssm.pyx":1828
  *                        ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Param views
  *     cdef float[:] v_h_view = v_h
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1716, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1828, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1718
+  /* "cssm.pyx":1830
  *     set_seed(random_state)
  *     # Param views
  *     cdef float[:] v_h_view = v_h             # <<<<<<<<<<<<<<
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1718, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1830, __pyx_L1_error)
   __pyx_v_v_h_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1719
+  /* "cssm.pyx":1831
  *     # Param views
  *     cdef float[:] v_h_view = v_h
  *     cdef float[:] v_l_1_view = v_l_1             # <<<<<<<<<<<<<<
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1719, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1831, __pyx_L1_error)
   __pyx_v_v_l_1_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1720
+  /* "cssm.pyx":1832
  *     cdef float[:] v_h_view = v_h
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1720, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1832, __pyx_L1_error)
   __pyx_v_v_l_2_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1721
+  /* "cssm.pyx":1833
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1721, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1833, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1722
+  /* "cssm.pyx":1834
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h             # <<<<<<<<<<<<<<
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1834, __pyx_L1_error)
   __pyx_v_z_h_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1723
+  /* "cssm.pyx":1835
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1             # <<<<<<<<<<<<<<
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1723, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1835, __pyx_L1_error)
   __pyx_v_z_l_1_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1724
+  /* "cssm.pyx":1836
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1724, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1836, __pyx_L1_error)
   __pyx_v_z_l_2_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1725
+  /* "cssm.pyx":1837
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1725, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1837, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1726
+  /* "cssm.pyx":1838
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] t_view = t
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 1726, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 1838, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1726, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_rts = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1727
+  /* "cssm.pyx":1839
  *     cdef float[:] t_view = t
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1727, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1727, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1727, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1727, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1727, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1727, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1727, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1727, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1727, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 1727, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1727, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_choices = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "cssm.pyx":1729
+  /* "cssm.pyx":1841
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1729, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1841, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "cssm.pyx":1730
+  /* "cssm.pyx":1842
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1730, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1842, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":1732
+  /* "cssm.pyx":1844
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":1733
+  /* "cssm.pyx":1845
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage for the upper bound
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":1736
+  /* "cssm.pyx":1848
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":1737
+  /* "cssm.pyx":1849
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_9 = NULL;
   __pyx_t_10 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_9)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -26628,231 +28127,231 @@
       __Pyx_DECREF_SET(__pyx_t_5, function);
       __pyx_t_10 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_1};
-    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1737, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1849, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_1};
-    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1737, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1849, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else
   #endif
   {
-    __pyx_t_11 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1737, __pyx_L1_error)
+    __pyx_t_11 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     if (__pyx_t_9) {
       __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_10, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_10, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_10, __pyx_t_1);
     __pyx_t_4 = 0;
     __pyx_t_1 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1737, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1849, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_11 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_11)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_11);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_11, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_t_s = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "cssm.pyx":1738
+  /* "cssm.pyx":1850
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1738, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1738, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1738, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1738, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1738, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1738, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 1738, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 1850, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1738, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_boundary = __pyx_t_11;
   __pyx_t_11 = 0;
 
-  /* "cssm.pyx":1739
+  /* "cssm.pyx":1851
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     cdef float y_h, t_particle, y_l
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1739, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1851, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1743
+  /* "cssm.pyx":1855
  *     cdef float y_h, t_particle, y_l
  *     cdef Py_ssize_t n, ix, k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     #cdef Py_ssize_t traj_id
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":1745
+  /* "cssm.pyx":1857
  *     cdef Py_ssize_t m = 0
  *     #cdef Py_ssize_t traj_id
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
-  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1745, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1857, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1747
+  /* "cssm.pyx":1859
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_10 = __pyx_v_n_trials;
   __pyx_t_12 = __pyx_t_10;
   for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
     __pyx_v_k = __pyx_t_13;
 
-    /* "cssm.pyx":1749
+    /* "cssm.pyx":1861
  *     for k in range(n_trials):
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         # Precompute boundary evaluations
  */
     { /* enter inner scope */
-      __pyx_t_11 = PyDict_New(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1749, __pyx_L7_error)
+      __pyx_t_11 = PyDict_New(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1861, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_11);
       __pyx_t_14 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 1749, __pyx_L7_error)
+        __PYX_ERR(0, 1861, __pyx_L7_error)
       }
-      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_15), (&__pyx_t_16)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1749, __pyx_L7_error)
+      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_15), (&__pyx_t_16)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1861, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_XDECREF(__pyx_t_6);
       __pyx_t_6 = __pyx_t_3;
       __pyx_t_3 = 0;
       while (1) {
         __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_6, __pyx_t_15, &__pyx_t_14, &__pyx_t_3, NULL, NULL, __pyx_t_16);
         if (unlikely(__pyx_t_17 == 0)) break;
-        if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 1749, __pyx_L7_error)
+        if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 1861, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_XDECREF_SET(__pyx_9genexpr10__pyx_v_key, __pyx_t_3);
+        __Pyx_XDECREF_SET(__pyx_9genexpr11__pyx_v_key, __pyx_t_3);
         __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_9genexpr10__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1749, __pyx_L7_error)
+        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_9genexpr11__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1861, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1749, __pyx_L7_error)
+        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1861, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_11, (PyObject*)__pyx_9genexpr10__pyx_v_key, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 1749, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_11, (PyObject*)__pyx_9genexpr11__pyx_v_key, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 1861, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       }
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_key); __pyx_9genexpr10__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_key); __pyx_9genexpr11__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_key); __pyx_9genexpr10__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_key); __pyx_9genexpr11__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_11));
     __pyx_t_11 = 0;
 
-    /* "cssm.pyx":1752
+    /* "cssm.pyx":1864
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 1752, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 1864, __pyx_L1_error)
     if (__pyx_t_18) {
 
-      /* "cssm.pyx":1754
+      /* "cssm.pyx":1866
  *         if boundary_multiplicative:
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             # print(a)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1754, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1866, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1754, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1866, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_19 = __pyx_v_k;
-      __pyx_t_5 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1754, __pyx_L1_error)
+      __pyx_t_5 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1866, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1754, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1866, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1754, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1866, __pyx_L1_error)
       __pyx_t_1 = __pyx_t_4;
       __pyx_t_4 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1754, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1754, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1866, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1866, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       __pyx_t_16 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_1)) {
@@ -26862,105 +28361,105 @@
           __Pyx_DECREF_SET(__pyx_t_3, function);
           __pyx_t_16 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_5, __pyx_t_4};
-        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1754, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1866, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_5, __pyx_t_4};
-        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1754, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1866, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_9 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1754, __pyx_L1_error)
+        __pyx_t_9 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1866, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         if (__pyx_t_1) {
           __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_1); __pyx_t_1 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_5);
         PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_16, __pyx_t_5);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_16, __pyx_t_4);
         __pyx_t_5 = 0;
         __pyx_t_4 = 0;
-        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1754, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1866, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1754, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1866, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1754, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1866, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __pyx_t_9 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_9)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_11 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_9, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1754, __pyx_L1_error)
+      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1866, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_11, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1754, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_11, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1866, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-      /* "cssm.pyx":1752
+      /* "cssm.pyx":1864
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":1757
+    /* "cssm.pyx":1869
  *         else:
  *             # print(a)
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Loop over samples
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1757, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1869, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_add); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1757, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_add); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1869, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __pyx_t_19 = __pyx_v_k;
-      __pyx_t_6 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1757, __pyx_L1_error)
+      __pyx_t_6 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1869, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1757, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1869, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1757, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1869, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_5;
       __pyx_t_5 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1757, __pyx_L1_error)
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1757, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1869, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1869, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_16 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_9);
         if (likely(__pyx_t_4)) {
@@ -26970,117 +28469,117 @@
           __Pyx_DECREF_SET(__pyx_t_9, function);
           __pyx_t_16 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_9)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_6, __pyx_t_5};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1757, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1869, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_6, __pyx_t_5};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1757, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1869, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       } else
       #endif
       {
-        __pyx_t_1 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1757, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1869, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_16, __pyx_t_6);
         __Pyx_GIVEREF(__pyx_t_5);
         PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_16, __pyx_t_5);
         __pyx_t_6 = 0;
         __pyx_t_5 = 0;
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1757, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1869, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       }
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1757, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1869, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1757, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1869, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_9);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
           __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_9, function);
         }
       }
       __pyx_t_11 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1757, __pyx_L1_error)
+      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1869, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_11, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1757, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_11, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1869, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":1760
+    /* "cssm.pyx":1872
  * 
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index
  */
     __pyx_t_16 = __pyx_v_n_samples;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_17; __pyx_t_15+=1) {
       __pyx_v_n = __pyx_t_15;
 
-      /* "cssm.pyx":1761
+      /* "cssm.pyx":1873
  *         # Loop over samples
  *         for n in range(n_samples):
  *             t_particle = 0.0 # reset time             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_particle = 0.0;
 
-      /* "cssm.pyx":1762
+      /* "cssm.pyx":1874
  *         for n in range(n_samples):
  *             t_particle = 0.0 # reset time
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             # Random walker 1
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":1765
+      /* "cssm.pyx":1877
  * 
  *             # Random walker 1
  *             y_h = (-1) * boundary_view[0] + (z_h_view[k] * 2 * (boundary_view[0]))  # reset starting position             # <<<<<<<<<<<<<<
  * 
  *             while y_h >= (-1) * boundary_view[ix] and y_h <= boundary_view[ix] and t_particle <= max_t:
  */
       __pyx_t_19 = 0;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_21 = 0;
       __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_h_view.data + __pyx_t_20 * __pyx_v_z_h_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":1767
+      /* "cssm.pyx":1879
  *             y_h = (-1) * boundary_view[0] + (z_h_view[k] * 2 * (boundary_view[0]))  # reset starting position
  * 
  *             while y_h >= (-1) * boundary_view[ix] and y_h <= boundary_view[ix] and t_particle <= max_t:             # <<<<<<<<<<<<<<
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  */
       while (1) {
@@ -27099,243 +28598,243 @@
           goto __pyx_L16_bool_binop_done;
         }
         __pyx_t_22 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
         __pyx_t_18 = __pyx_t_22;
         __pyx_L16_bool_binop_done:;
         if (!__pyx_t_18) break;
 
-        /* "cssm.pyx":1768
+        /* "cssm.pyx":1880
  * 
  *             while y_h >= (-1) * boundary_view[ix] and y_h <= boundary_view[ix] and t_particle <= max_t:
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                 t_particle += delta_t
  *                 ix += 1
  */
         __pyx_t_21 = __pyx_v_k;
         __pyx_t_20 = __pyx_v_m;
         __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_v_h_view.data + __pyx_t_21 * __pyx_v_v_h_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":1769
+        /* "cssm.pyx":1881
  *             while y_h >= (-1) * boundary_view[ix] and y_h <= boundary_view[ix] and t_particle <= max_t:
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-        /* "cssm.pyx":1770
+        /* "cssm.pyx":1882
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_particle += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  * 
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":1771
+        /* "cssm.pyx":1883
  *                 t_particle += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  * 
  *                 if m == num_draws:
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":1773
+        /* "cssm.pyx":1885
  *                 m += 1
  * 
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_18 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":1774
+          /* "cssm.pyx":1886
  * 
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1774, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1886, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":1775
+          /* "cssm.pyx":1887
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             # If we are already at maximum t, to generate a choice we just sample from a bernoulli
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":1773
+          /* "cssm.pyx":1885
  *                 m += 1
  * 
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":1778
+      /* "cssm.pyx":1890
  * 
  *             # If we are already at maximum t, to generate a choice we just sample from a bernoulli
  *             if t_particle >= max_t:             # <<<<<<<<<<<<<<
  *                 if random_uniform() > 0.5:
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 2
  */
       __pyx_t_18 = ((__pyx_v_t_particle >= __pyx_v_max_t) != 0);
       if (__pyx_t_18) {
 
-        /* "cssm.pyx":1779
+        /* "cssm.pyx":1891
  *             # If we are already at maximum t, to generate a choice we just sample from a bernoulli
  *             if t_particle >= max_t:
  *                 if random_uniform() > 0.5:             # <<<<<<<<<<<<<<
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 2
  *                 if random_uniform() > 0.5:
  */
         __pyx_t_18 = ((__pyx_f_4cssm_random_uniform() > 0.5) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":1780
+          /* "cssm.pyx":1892
  *             if t_particle >= max_t:
  *                 if random_uniform() > 0.5:
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 2             # <<<<<<<<<<<<<<
  *                 if random_uniform() > 0.5:
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 1
  */
           __pyx_t_20 = __pyx_v_n;
           __pyx_t_21 = __pyx_v_k;
           __pyx_t_19 = 0;
           __pyx_t_23 = __pyx_v_n;
           __pyx_t_24 = __pyx_v_k;
           __pyx_t_25 = 0;
           *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_23 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_25 * __pyx_v_choices_view.strides[2]) )) = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) + 2);
 
-          /* "cssm.pyx":1779
+          /* "cssm.pyx":1891
  *             # If we are already at maximum t, to generate a choice we just sample from a bernoulli
  *             if t_particle >= max_t:
  *                 if random_uniform() > 0.5:             # <<<<<<<<<<<<<<
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 2
  *                 if random_uniform() > 0.5:
  */
         }
 
-        /* "cssm.pyx":1781
+        /* "cssm.pyx":1893
  *                 if random_uniform() > 0.5:
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 2
  *                 if random_uniform() > 0.5:             # <<<<<<<<<<<<<<
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 1
  *                 rts_view[n, k, 0] = t_particle
  */
         __pyx_t_18 = ((__pyx_f_4cssm_random_uniform() > 0.5) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":1782
+          /* "cssm.pyx":1894
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 2
  *                 if random_uniform() > 0.5:
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 1             # <<<<<<<<<<<<<<
  *                 rts_view[n, k, 0] = t_particle
  * 
  */
           __pyx_t_19 = __pyx_v_n;
           __pyx_t_21 = __pyx_v_k;
           __pyx_t_20 = 0;
           __pyx_t_25 = __pyx_v_n;
           __pyx_t_24 = __pyx_v_k;
           __pyx_t_23 = 0;
           *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_25 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_23 * __pyx_v_choices_view.strides[2]) )) = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) ))) + 1);
 
-          /* "cssm.pyx":1781
+          /* "cssm.pyx":1893
  *                 if random_uniform() > 0.5:
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 2
  *                 if random_uniform() > 0.5:             # <<<<<<<<<<<<<<
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 1
  *                 rts_view[n, k, 0] = t_particle
  */
         }
 
-        /* "cssm.pyx":1783
+        /* "cssm.pyx":1895
  *                 if random_uniform() > 0.5:
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 1
  *                 rts_view[n, k, 0] = t_particle             # <<<<<<<<<<<<<<
  * 
  *             else:
  */
         __pyx_t_20 = __pyx_v_n;
         __pyx_t_21 = __pyx_v_k;
         __pyx_t_19 = 0;
         *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[2]) )) = __pyx_v_t_particle;
 
-        /* "cssm.pyx":1778
+        /* "cssm.pyx":1890
  * 
  *             # If we are already at maximum t, to generate a choice we just sample from a bernoulli
  *             if t_particle >= max_t:             # <<<<<<<<<<<<<<
  *                 if random_uniform() > 0.5:
  *                     choices_view[n, k, 0] = choices_view[n, k, 0] + 2
  */
         goto __pyx_L20;
       }
 
-      /* "cssm.pyx":1786
+      /* "cssm.pyx":1898
  * 
  *             else:
  *                 if sign(y_h) < 0: # Store intermediate choice             # <<<<<<<<<<<<<<
  *                     choices_view[n, k, 0] = 0
  *                     y_l = (-1) * boundary_view[ix] + (z_l_1_view[k] * 2 * (boundary_view[ix]))
  */
       /*else*/ {
         __pyx_t_18 = ((__pyx_f_4cssm_sign(__pyx_v_y_h) < 0) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":1787
+          /* "cssm.pyx":1899
  *             else:
  *                 if sign(y_h) < 0: # Store intermediate choice
  *                     choices_view[n, k, 0] = 0             # <<<<<<<<<<<<<<
  *                     y_l = (-1) * boundary_view[ix] + (z_l_1_view[k] * 2 * (boundary_view[ix]))
  *                     v_l = v_l_1_view[k]
  */
           __pyx_t_19 = __pyx_v_n;
           __pyx_t_21 = __pyx_v_k;
           __pyx_t_20 = 0;
           *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = 0;
 
-          /* "cssm.pyx":1788
+          /* "cssm.pyx":1900
  *                 if sign(y_h) < 0: # Store intermediate choice
  *                     choices_view[n, k, 0] = 0
  *                     y_l = (-1) * boundary_view[ix] + (z_l_1_view[k] * 2 * (boundary_view[ix]))             # <<<<<<<<<<<<<<
  *                     v_l = v_l_1_view[k]
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_21 = __pyx_v_k;
           __pyx_t_19 = __pyx_v_ix;
           __pyx_v_y_l = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_l_1_view.data + __pyx_t_21 * __pyx_v_z_l_1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
 
-          /* "cssm.pyx":1789
+          /* "cssm.pyx":1901
  *                     choices_view[n, k, 0] = 0
  *                     y_l = (-1) * boundary_view[ix] + (z_l_1_view[k] * 2 * (boundary_view[ix]))
  *                     v_l = v_l_1_view[k]             # <<<<<<<<<<<<<<
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):
  */
           __pyx_t_19 = __pyx_v_k;
-          __pyx_t_11 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_v_l_1_view.data + __pyx_t_19 * __pyx_v_v_l_1_view.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1789, __pyx_L1_error)
+          __pyx_t_11 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_v_l_1_view.data + __pyx_t_19 * __pyx_v_v_l_1_view.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1901, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_XDECREF_SET(__pyx_v_v_l, __pyx_t_11);
           __pyx_t_11 = 0;
 
-          /* "cssm.pyx":1791
+          /* "cssm.pyx":1903
  *                     v_l = v_l_1_view[k]
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                         if random_uniform() < z_l_1_view[k]:
  *                             choices_view[n, k, 0] += 1
  */
           __pyx_t_19 = __pyx_v_ix;
@@ -27347,104 +28846,104 @@
           }
           __pyx_t_19 = __pyx_v_ix;
           __pyx_t_22 = ((__pyx_v_y_l <= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))))) != 0);
           __pyx_t_18 = __pyx_t_22;
           __pyx_L25_bool_binop_done:;
           if (__pyx_t_18) {
 
-            /* "cssm.pyx":1792
+            /* "cssm.pyx":1904
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):
  *                         if random_uniform() < z_l_1_view[k]:             # <<<<<<<<<<<<<<
  *                             choices_view[n, k, 0] += 1
  * 
  */
             __pyx_t_19 = __pyx_v_k;
             __pyx_t_18 = ((__pyx_f_4cssm_random_uniform() < (*((float *) ( /* dim=0 */ (__pyx_v_z_l_1_view.data + __pyx_t_19 * __pyx_v_z_l_1_view.strides[0]) )))) != 0);
             if (__pyx_t_18) {
 
-              /* "cssm.pyx":1793
+              /* "cssm.pyx":1905
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):
  *                         if random_uniform() < z_l_1_view[k]:
  *                             choices_view[n, k, 0] += 1             # <<<<<<<<<<<<<<
  * 
  *                 else:
  */
               __pyx_t_19 = __pyx_v_n;
               __pyx_t_21 = __pyx_v_k;
               __pyx_t_20 = 0;
               *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 1;
 
-              /* "cssm.pyx":1792
+              /* "cssm.pyx":1904
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):
  *                         if random_uniform() < z_l_1_view[k]:             # <<<<<<<<<<<<<<
  *                             choices_view[n, k, 0] += 1
  * 
  */
             }
 
-            /* "cssm.pyx":1791
+            /* "cssm.pyx":1903
  *                     v_l = v_l_1_view[k]
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                         if random_uniform() < z_l_1_view[k]:
  *                             choices_view[n, k, 0] += 1
  */
           }
 
-          /* "cssm.pyx":1786
+          /* "cssm.pyx":1898
  * 
  *             else:
  *                 if sign(y_h) < 0: # Store intermediate choice             # <<<<<<<<<<<<<<
  *                     choices_view[n, k, 0] = 0
  *                     y_l = (-1) * boundary_view[ix] + (z_l_1_view[k] * 2 * (boundary_view[ix]))
  */
           goto __pyx_L23;
         }
 
-        /* "cssm.pyx":1796
+        /* "cssm.pyx":1908
  * 
  *                 else:
  *                     choices_view[n, k, 0] = 2             # <<<<<<<<<<<<<<
  *                     y_l = (-1) * boundary_view[ix] + (z_l_2_view[k] * 2 * (boundary_view[ix]))
  *                     v_l = v_l_2_view[k]
  */
         /*else*/ {
           __pyx_t_20 = __pyx_v_n;
           __pyx_t_21 = __pyx_v_k;
           __pyx_t_19 = 0;
           *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) = 2;
 
-          /* "cssm.pyx":1797
+          /* "cssm.pyx":1909
  *                 else:
  *                     choices_view[n, k, 0] = 2
  *                     y_l = (-1) * boundary_view[ix] + (z_l_2_view[k] * 2 * (boundary_view[ix]))             # <<<<<<<<<<<<<<
  *                     v_l = v_l_2_view[k]
  * 
  */
           __pyx_t_19 = __pyx_v_ix;
           __pyx_t_21 = __pyx_v_k;
           __pyx_t_20 = __pyx_v_ix;
           __pyx_v_y_l = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_l_2_view.data + __pyx_t_21 * __pyx_v_z_l_2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
 
-          /* "cssm.pyx":1798
+          /* "cssm.pyx":1910
  *                     choices_view[n, k, 0] = 2
  *                     y_l = (-1) * boundary_view[ix] + (z_l_2_view[k] * 2 * (boundary_view[ix]))
  *                     v_l = v_l_2_view[k]             # <<<<<<<<<<<<<<
  * 
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  */
           __pyx_t_20 = __pyx_v_k;
-          __pyx_t_11 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_v_l_2_view.data + __pyx_t_20 * __pyx_v_v_l_2_view.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1798, __pyx_L1_error)
+          __pyx_t_11 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_v_l_2_view.data + __pyx_t_20 * __pyx_v_v_l_2_view.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1910, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_XDECREF_SET(__pyx_v_v_l, __pyx_t_11);
           __pyx_t_11 = 0;
 
-          /* "cssm.pyx":1801
+          /* "cssm.pyx":1913
  * 
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                         if random_uniform() < z_l_2_view[k]:
  *                             choices_view[n, k, 0] += 1
  */
           __pyx_t_20 = __pyx_v_ix;
@@ -27456,58 +28955,58 @@
           }
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_22 = ((__pyx_v_y_l <= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))))) != 0);
           __pyx_t_18 = __pyx_t_22;
           __pyx_L29_bool_binop_done:;
           if (__pyx_t_18) {
 
-            /* "cssm.pyx":1802
+            /* "cssm.pyx":1914
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):
  *                         if random_uniform() < z_l_2_view[k]:             # <<<<<<<<<<<<<<
  *                             choices_view[n, k, 0] += 1
  * 
  */
             __pyx_t_20 = __pyx_v_k;
             __pyx_t_18 = ((__pyx_f_4cssm_random_uniform() < (*((float *) ( /* dim=0 */ (__pyx_v_z_l_2_view.data + __pyx_t_20 * __pyx_v_z_l_2_view.strides[0]) )))) != 0);
             if (__pyx_t_18) {
 
-              /* "cssm.pyx":1803
+              /* "cssm.pyx":1915
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):
  *                         if random_uniform() < z_l_2_view[k]:
  *                             choices_view[n, k, 0] += 1             # <<<<<<<<<<<<<<
  * 
  *                 # Random walker 2
  */
               __pyx_t_20 = __pyx_v_n;
               __pyx_t_21 = __pyx_v_k;
               __pyx_t_19 = 0;
               *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 1;
 
-              /* "cssm.pyx":1802
+              /* "cssm.pyx":1914
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):
  *                         if random_uniform() < z_l_2_view[k]:             # <<<<<<<<<<<<<<
  *                             choices_view[n, k, 0] += 1
  * 
  */
             }
 
-            /* "cssm.pyx":1801
+            /* "cssm.pyx":1913
  * 
  *                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter
  *                     if (y_l >= boundary_view[ix]) or (y_l <= ((-1) * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                         if random_uniform() < z_l_2_view[k]:
  *                             choices_view[n, k, 0] += 1
  */
           }
         }
         __pyx_L23:;
 
-        /* "cssm.pyx":1806
+        /* "cssm.pyx":1918
  * 
  *                 # Random walker 2
  *                 while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_particle <= max_t):             # <<<<<<<<<<<<<<
  *                     y_l += (v_l * delta_t) + (sqrt_st * gaussian_values[m])
  *                     t_particle += delta_t
  */
         while (1) {
@@ -27526,358 +29025,358 @@
             goto __pyx_L34_bool_binop_done;
           }
           __pyx_t_22 = ((__pyx_v_t_particle <= __pyx_v_max_t) != 0);
           __pyx_t_18 = __pyx_t_22;
           __pyx_L34_bool_binop_done:;
           if (!__pyx_t_18) break;
 
-          /* "cssm.pyx":1807
+          /* "cssm.pyx":1919
  *                 # Random walker 2
  *                 while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_particle <= max_t):
  *                     y_l += (v_l * delta_t) + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                     t_particle += delta_t
  *                     ix += 1
  */
-          __pyx_t_11 = PyFloat_FromDouble(__pyx_v_y_l); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1807, __pyx_L1_error)
+          __pyx_t_11 = PyFloat_FromDouble(__pyx_v_y_l); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1919, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
-          __pyx_t_9 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1807, __pyx_L1_error)
+          __pyx_t_9 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1919, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_3 = PyNumber_Multiply(__pyx_v_v_l, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1807, __pyx_L1_error)
+          __pyx_t_3 = PyNumber_Multiply(__pyx_v_v_l, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1919, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __pyx_t_19 = __pyx_v_m;
-          __pyx_t_9 = PyFloat_FromDouble((__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) ))))); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1807, __pyx_L1_error)
+          __pyx_t_9 = PyFloat_FromDouble((__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) ))))); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1919, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1807, __pyx_L1_error)
+          __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1919, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_t_11, __pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1807, __pyx_L1_error)
+          __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_t_11, __pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1919, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __pyx_t_26 = __pyx_PyFloat_AsFloat(__pyx_t_9); if (unlikely((__pyx_t_26 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1807, __pyx_L1_error)
+          __pyx_t_26 = __pyx_PyFloat_AsFloat(__pyx_t_9); if (unlikely((__pyx_t_26 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1919, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __pyx_v_y_l = __pyx_t_26;
 
-          /* "cssm.pyx":1808
+          /* "cssm.pyx":1920
  *                 while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_particle <= max_t):
  *                     y_l += (v_l * delta_t) + (sqrt_st * gaussian_values[m])
  *                     t_particle += delta_t             # <<<<<<<<<<<<<<
  *                     ix += 1
  *                     m += 1
  */
           __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
 
-          /* "cssm.pyx":1809
+          /* "cssm.pyx":1921
  *                     y_l += (v_l * delta_t) + (sqrt_st * gaussian_values[m])
  *                     t_particle += delta_t
  *                     ix += 1             # <<<<<<<<<<<<<<
  *                     m += 1
  *                     if m == num_draws:
  */
           __pyx_v_ix = (__pyx_v_ix + 1);
 
-          /* "cssm.pyx":1810
+          /* "cssm.pyx":1922
  *                     t_particle += delta_t
  *                     ix += 1
  *                     m += 1             # <<<<<<<<<<<<<<
  *                     if m == num_draws:
  *                         gaussian_values = draw_gaussian(num_draws)
  */
           __pyx_v_m = (__pyx_v_m + 1);
 
-          /* "cssm.pyx":1811
+          /* "cssm.pyx":1923
  *                     ix += 1
  *                     m += 1
  *                     if m == num_draws:             # <<<<<<<<<<<<<<
  *                         gaussian_values = draw_gaussian(num_draws)
  *                         m = 0
  */
           __pyx_t_18 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
           if (__pyx_t_18) {
 
-            /* "cssm.pyx":1812
+            /* "cssm.pyx":1924
  *                     m += 1
  *                     if m == num_draws:
  *                         gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                         m = 0
  * 
  */
-            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1812, __pyx_L1_error)
+            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1924, __pyx_L1_error)
             __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
             __pyx_v_gaussian_values = __pyx_t_2;
             __pyx_t_2.memview = NULL;
             __pyx_t_2.data = NULL;
 
-            /* "cssm.pyx":1813
+            /* "cssm.pyx":1925
  *                     if m == num_draws:
  *                         gaussian_values = draw_gaussian(num_draws)
  *                         m = 0             # <<<<<<<<<<<<<<
  * 
  *                 rts_view[n, k, 0] = t_particle + t_view[k]
  */
             __pyx_v_m = 0;
 
-            /* "cssm.pyx":1811
+            /* "cssm.pyx":1923
  *                     ix += 1
  *                     m += 1
  *                     if m == num_draws:             # <<<<<<<<<<<<<<
  *                         gaussian_values = draw_gaussian(num_draws)
  *                         m = 0
  */
           }
         }
 
-        /* "cssm.pyx":1815
+        /* "cssm.pyx":1927
  *                         m = 0
  * 
  *                 rts_view[n, k, 0] = t_particle + t_view[k]             # <<<<<<<<<<<<<<
  *                 if sign(y_l) >= 0: # store choice update
  *                     choices_view[n, k, 0] += 1
  */
         __pyx_t_19 = __pyx_v_k;
         __pyx_t_21 = __pyx_v_n;
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_23 = 0;
         *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_21 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_23 * __pyx_v_rts_view.strides[2]) )) = (__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_19 * __pyx_v_t_view.strides[0]) ))));
 
-        /* "cssm.pyx":1816
+        /* "cssm.pyx":1928
  * 
  *                 rts_view[n, k, 0] = t_particle + t_view[k]
  *                 if sign(y_l) >= 0: # store choice update             # <<<<<<<<<<<<<<
  *                     choices_view[n, k, 0] += 1
  * 
  */
         __pyx_t_18 = ((__pyx_f_4cssm_sign(__pyx_v_y_l) >= 0) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":1817
+          /* "cssm.pyx":1929
  *                 rts_view[n, k, 0] = t_particle + t_view[k]
  *                 if sign(y_l) >= 0: # store choice update
  *                     choices_view[n, k, 0] += 1             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  */
           __pyx_t_19 = __pyx_v_n;
           __pyx_t_23 = __pyx_v_k;
           __pyx_t_20 = 0;
           *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_23 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 1;
 
-          /* "cssm.pyx":1816
+          /* "cssm.pyx":1928
  * 
  *                 rts_view[n, k, 0] = t_particle + t_view[k]
  *                 if sign(y_l) >= 0: # store choice update             # <<<<<<<<<<<<<<
  *                     choices_view[n, k, 0] += 1
  * 
  */
         }
       }
       __pyx_L20:;
     }
   }
 
-  /* "cssm.pyx":1819
+  /* "cssm.pyx":1931
  *                     choices_view[n, k, 0] += 1
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,             # <<<<<<<<<<<<<<
  *                                                          'vl1': v_l_1,
  *                                                          'vl2': v_l_2,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_9 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1819, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1931, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
-  __pyx_t_11 = __Pyx_PyDict_NewPresized(9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyDict_NewPresized(9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1931, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_vh, ((PyObject *)__pyx_v_v_h)) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_vh, ((PyObject *)__pyx_v_v_h)) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
 
-  /* "cssm.pyx":1820
+  /* "cssm.pyx":1932
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  *                                                          'vl1': v_l_1,             # <<<<<<<<<<<<<<
  *                                                          'vl2': v_l_2,
  *                                                          'a': a,
  */
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_vl1, ((PyObject *)__pyx_v_v_l_1)) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_vl1, ((PyObject *)__pyx_v_v_l_1)) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
 
-  /* "cssm.pyx":1821
+  /* "cssm.pyx":1933
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  *                                                          'vl1': v_l_1,
  *                                                          'vl2': v_l_2,             # <<<<<<<<<<<<<<
  *                                                          'a': a,
  *                                                          'zh': z_h,
  */
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_vl2, ((PyObject *)__pyx_v_v_l_2)) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_vl2, ((PyObject *)__pyx_v_v_l_2)) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
 
-  /* "cssm.pyx":1822
+  /* "cssm.pyx":1934
  *                                                          'vl1': v_l_1,
  *                                                          'vl2': v_l_2,
  *                                                          'a': a,             # <<<<<<<<<<<<<<
  *                                                          'zh': z_h,
  *                                                          'zl1': z_l_1,
  */
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
 
-  /* "cssm.pyx":1823
+  /* "cssm.pyx":1935
  *                                                          'vl2': v_l_2,
  *                                                          'a': a,
  *                                                          'zh': z_h,             # <<<<<<<<<<<<<<
  *                                                          'zl1': z_l_1,
  *                                                          'zl2': z_l_2,
  */
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_zh, ((PyObject *)__pyx_v_z_h)) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_zh, ((PyObject *)__pyx_v_z_h)) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
 
-  /* "cssm.pyx":1824
+  /* "cssm.pyx":1936
  *                                                          'a': a,
  *                                                          'zh': z_h,
  *                                                          'zl1': z_l_1,             # <<<<<<<<<<<<<<
  *                                                          'zl2': z_l_2,
  *                                                          't': t,
  */
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_zl1, ((PyObject *)__pyx_v_z_l_1)) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_zl1, ((PyObject *)__pyx_v_z_l_1)) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
 
-  /* "cssm.pyx":1825
+  /* "cssm.pyx":1937
  *                                                          'zh': z_h,
  *                                                          'zl1': z_l_1,
  *                                                          'zl2': z_l_2,             # <<<<<<<<<<<<<<
  *                                                          't': t,
  *                                                          's': s,
  */
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_zl2, ((PyObject *)__pyx_v_z_l_2)) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_zl2, ((PyObject *)__pyx_v_z_l_2)) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
 
-  /* "cssm.pyx":1826
+  /* "cssm.pyx":1938
  *                                                          'zl1': z_l_1,
  *                                                          'zl2': z_l_2,
  *                                                          't': t,             # <<<<<<<<<<<<<<
  *                                                          's': s,
  *                                                          **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
 
-  /* "cssm.pyx":1827
+  /* "cssm.pyx":1939
  *                                                          'zl2': z_l_2,
  *                                                          't': t,
  *                                                          's': s,             # <<<<<<<<<<<<<<
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1827, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1939, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_s, __pyx_t_3) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_s, __pyx_t_3) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_1 = __pyx_t_11;
   __pyx_t_11 = 0;
 
-  /* "cssm.pyx":1828
+  /* "cssm.pyx":1940
  *                                                          't': t,
  *                                                          's': s,
  *                                                          **boundary_params,             # <<<<<<<<<<<<<<
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 1828, __pyx_L1_error)
+    __PYX_ERR(0, 1940, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_1, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 1828, __pyx_L1_error)
+    __PYX_ERR(0, 1940, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":1829
+  /* "cssm.pyx":1941
  *                                                          's': s,
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,
  */
-  __pyx_t_11 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1829, __pyx_L1_error)
+  __pyx_t_11 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1941, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_delta_t, __pyx_t_11) < 0) __PYX_ERR(0, 1829, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_delta_t, __pyx_t_11) < 0) __PYX_ERR(0, 1941, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-  /* "cssm.pyx":1830
+  /* "cssm.pyx":1942
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                          'n_samples': n_samples,
  *                                                          'simulator': 'ddm_flexbound',
  */
-  __pyx_t_11 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1830, __pyx_L1_error)
+  __pyx_t_11 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1942, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_max_t, __pyx_t_11) < 0) __PYX_ERR(0, 1830, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_max_t, __pyx_t_11) < 0) __PYX_ERR(0, 1942, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-  /* "cssm.pyx":1831
+  /* "cssm.pyx":1943
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                          'simulator': 'ddm_flexbound',
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1831, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1943, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_11) < 0) __PYX_ERR(0, 1831, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_11) < 0) __PYX_ERR(0, 1943, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) < 0) __PYX_ERR(0, 1832, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) < 0) __PYX_ERR(0, 1944, __pyx_L1_error)
 
-  /* "cssm.pyx":1833
+  /* "cssm.pyx":1945
  *                                                          'n_samples': n_samples,
  *                                                          'simulator': 'ddm_flexbound',
  *                                                          'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                          'trajectory': 'This simulator does not yet allow for trajectory simulation',
  *                                                          'possible_choices': [0, 1, 2, 3],
  */
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1833, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1945, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_t_11) < 0) __PYX_ERR(0, 1833, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_t_11) < 0) __PYX_ERR(0, 1945, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_trajectory, __pyx_kp_u_This_simulator_does_not_yet_allo) < 0) __PYX_ERR(0, 1834, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_trajectory, __pyx_kp_u_This_simulator_does_not_yet_allo) < 0) __PYX_ERR(0, 1946, __pyx_L1_error)
 
-  /* "cssm.pyx":1835
+  /* "cssm.pyx":1947
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  *                                                          'trajectory': 'This simulator does not yet allow for trajectory simulation',
  *                                                          'possible_choices': [0, 1, 2, 3],             # <<<<<<<<<<<<<<
  *                                                          'boundary': boundary}}
  * # -----------------------------------------------------------------------------------------------
  */
-  __pyx_t_11 = PyList_New(4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1835, __pyx_L1_error)
+  __pyx_t_11 = PyList_New(4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyList_SET_ITEM(__pyx_t_11, 0, __pyx_int_0);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_11, 1, __pyx_int_1);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyList_SET_ITEM(__pyx_t_11, 2, __pyx_int_2);
   __Pyx_INCREF(__pyx_int_3);
   __Pyx_GIVEREF(__pyx_int_3);
   PyList_SET_ITEM(__pyx_t_11, 3, __pyx_int_3);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_11) < 0) __PYX_ERR(0, 1835, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_11) < 0) __PYX_ERR(0, 1947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-  /* "cssm.pyx":1836
+  /* "cssm.pyx":1948
  *                                                          'trajectory': 'This simulator does not yet allow for trajectory simulation',
  *                                                          'possible_choices': [0, 1, 2, 3],
  *                                                          'boundary': boundary}}             # <<<<<<<<<<<<<<
  * # -----------------------------------------------------------------------------------------------
  * 
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1836, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_metadata, __pyx_t_1) < 0) __PYX_ERR(0, 1819, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1948, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_metadata, __pyx_t_1) < 0) __PYX_ERR(0, 1931, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_9;
   __pyx_t_9 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":1696
+  /* "cssm.pyx":1808
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_seq2(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] v_l_1,
  *                        np.ndarray[float, ndim = 1] v_l_2,
  */
 
@@ -27933,32 +29432,32 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
   __Pyx_XDECREF(__pyx_v_v_l);
-  __Pyx_XDECREF(__pyx_9genexpr10__pyx_v_key);
+  __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":1842
+/* "cssm.pyx":1954
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_par2(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] v_l_1,
  *                        np.ndarray[float, ndim = 1] v_l_2,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_31ddm_flexbound_par2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_31ddm_flexbound_par2 = {"ddm_flexbound_par2", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_31ddm_flexbound_par2, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_31ddm_flexbound_par2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_33ddm_flexbound_par2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_33ddm_flexbound_par2 = {"ddm_flexbound_par2", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_33ddm_flexbound_par2, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_33ddm_flexbound_par2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v_h = 0;
   PyArrayObject *__pyx_v_v_l_1 = 0;
   PyArrayObject *__pyx_v_v_l_2 = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z_h = 0;
   PyArrayObject *__pyx_v_z_l_1 = 0;
   PyArrayObject *__pyx_v_z_l_2 = 0;
@@ -27979,43 +29478,43 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ddm_flexbound_par2 (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v_h,&__pyx_n_s_v_l_1,&__pyx_n_s_v_l_2,&__pyx_n_s_a,&__pyx_n_s_z_h,&__pyx_n_s_z_l_1,&__pyx_n_s_z_l_2,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_print_info,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[18] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":1855
+    /* "cssm.pyx":1967
  *                        int n_samples = 20000,
  *                        int n_trials = 1,
  *                        print_info = True,             # <<<<<<<<<<<<<<
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                        boundary_multiplicative = True,
  */
     values[13] = ((PyObject *)Py_True);
 
-    /* "cssm.pyx":1856
+    /* "cssm.pyx":1968
  *                        int n_trials = 1,
  *                        print_info = True,
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *                        boundary_multiplicative = True,
  *                        boundary_params = {},
  */
     values[14] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":1857
+    /* "cssm.pyx":1969
  *                        print_info = True,
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                        boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *                        boundary_params = {},
  *                        random_state = None,
  */
     values[15] = ((PyObject *)Py_True);
-    values[16] = __pyx_k__15;
+    values[16] = __pyx_k__16;
 
-    /* "cssm.pyx":1859
+    /* "cssm.pyx":1971
  *                        boundary_multiplicative = True,
  *                        boundary_params = {},
  *                        random_state = None,             # <<<<<<<<<<<<<<
  *                        ):
  * 
  */
     values[17] = ((PyObject *)Py_None);
@@ -28067,51 +29566,51 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_h)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_l_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 1); __PYX_ERR(0, 1842, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 1); __PYX_ERR(0, 1954, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_l_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 2); __PYX_ERR(0, 1842, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 2); __PYX_ERR(0, 1954, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 3); __PYX_ERR(0, 1842, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 3); __PYX_ERR(0, 1954, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_h)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 4); __PYX_ERR(0, 1842, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 4); __PYX_ERR(0, 1954, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_l_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 5); __PYX_ERR(0, 1842, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 5); __PYX_ERR(0, 1954, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_l_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 6); __PYX_ERR(0, 1842, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 6); __PYX_ERR(0, 1954, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 7); __PYX_ERR(0, 1842, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, 7); __PYX_ERR(0, 1954, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[8] = value; kw_args--; }
         }
@@ -28167,15 +29666,15 @@
         case 17:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[17] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_par2") < 0)) __PYX_ERR(0, 1842, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_par2") < 0)) __PYX_ERR(0, 1954, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 18: values[17] = PyTuple_GET_ITEM(__pyx_args, 17);
         CYTHON_FALLTHROUGH;
         case 17: values[16] = PyTuple_GET_ITEM(__pyx_args, 16);
         CYTHON_FALLTHROUGH;
@@ -28212,63 +29711,63 @@
     __pyx_v_v_l_2 = ((PyArrayObject *)values[2]);
     __pyx_v_a = ((PyArrayObject *)values[3]);
     __pyx_v_z_h = ((PyArrayObject *)values[4]);
     __pyx_v_z_l_1 = ((PyArrayObject *)values[5]);
     __pyx_v_z_l_2 = ((PyArrayObject *)values[6]);
     __pyx_v_t = ((PyArrayObject *)values[7]);
     if (values[8]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1850, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[8]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1962, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[9]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1851, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1963, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[10]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[10]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1852, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[10]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1964, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[11]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[11]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1853, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[11]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1965, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[12]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[12]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1854, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[12]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1966, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_print_info = values[13];
     __pyx_v_boundary_fun = values[14];
     __pyx_v_boundary_multiplicative = values[15];
     __pyx_v_boundary_params = values[16];
     __pyx_v_random_state = values[17];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1842, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_par2", 0, 8, 18, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1954, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ddm_flexbound_par2", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_h), __pyx_ptype_5numpy_ndarray, 1, "v_h", 0))) __PYX_ERR(0, 1842, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_1), __pyx_ptype_5numpy_ndarray, 1, "v_l_1", 0))) __PYX_ERR(0, 1843, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_2), __pyx_ptype_5numpy_ndarray, 1, "v_l_2", 0))) __PYX_ERR(0, 1844, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1845, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_h), __pyx_ptype_5numpy_ndarray, 1, "z_h", 0))) __PYX_ERR(0, 1846, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_1), __pyx_ptype_5numpy_ndarray, 1, "z_l_1", 0))) __PYX_ERR(0, 1847, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_2), __pyx_ptype_5numpy_ndarray, 1, "z_l_2", 0))) __PYX_ERR(0, 1848, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1849, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_30ddm_flexbound_par2(__pyx_self, __pyx_v_v_h, __pyx_v_v_l_1, __pyx_v_v_l_2, __pyx_v_a, __pyx_v_z_h, __pyx_v_z_l_1, __pyx_v_z_l_2, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_h), __pyx_ptype_5numpy_ndarray, 1, "v_h", 0))) __PYX_ERR(0, 1954, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_1), __pyx_ptype_5numpy_ndarray, 1, "v_l_1", 0))) __PYX_ERR(0, 1955, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_2), __pyx_ptype_5numpy_ndarray, 1, "v_l_2", 0))) __PYX_ERR(0, 1956, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1957, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_h), __pyx_ptype_5numpy_ndarray, 1, "z_h", 0))) __PYX_ERR(0, 1958, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_1), __pyx_ptype_5numpy_ndarray, 1, "z_l_1", 0))) __PYX_ERR(0, 1959, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_2), __pyx_ptype_5numpy_ndarray, 1, "z_l_2", 0))) __PYX_ERR(0, 1960, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1961, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_32ddm_flexbound_par2(__pyx_self, __pyx_v_v_h, __pyx_v_v_l_1, __pyx_v_v_l_2, __pyx_v_a, __pyx_v_z_h, __pyx_v_z_l_1, __pyx_v_z_l_2, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":1842
+  /* "cssm.pyx":1954
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_par2(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] v_l_1,
  *                        np.ndarray[float, ndim = 1] v_l_2,
  */
 
@@ -28277,15 +29776,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_30ddm_flexbound_par2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_32ddm_flexbound_par2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_h_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_v_l_1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_v_l_2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_h_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_l_1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_l_2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -28307,15 +29806,15 @@
   float __pyx_v_t_l;
   int __pyx_v_n;
   int __pyx_v_ix;
   int __pyx_v_m;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_v_k;
   PyObject *__pyx_v_boundary_params_tmp = NULL;
-  PyObject *__pyx_9genexpr11__pyx_v_key = NULL;
+  PyObject *__pyx_9genexpr12__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
   __Pyx_Buffer __pyx_pybuffer_t;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v_h;
   __Pyx_Buffer __pyx_pybuffer_v_h;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v_l_1;
@@ -28390,321 +29889,321 @@
   __pyx_pybuffernd_z_l_2.rcbuffer = &__pyx_pybuffer_z_l_2;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1842, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1954, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_h.diminfo[0].strides = __pyx_pybuffernd_v_h.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_h.diminfo[0].shape = __pyx_pybuffernd_v_h.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1842, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1954, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_l_1.diminfo[0].strides = __pyx_pybuffernd_v_l_1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_l_1.diminfo[0].shape = __pyx_pybuffernd_v_l_1.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1842, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1954, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_l_2.diminfo[0].strides = __pyx_pybuffernd_v_l_2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_l_2.diminfo[0].shape = __pyx_pybuffernd_v_l_2.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1842, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1954, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1842, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1954, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_h.diminfo[0].strides = __pyx_pybuffernd_z_h.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_h.diminfo[0].shape = __pyx_pybuffernd_z_h.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1842, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1954, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_l_1.diminfo[0].strides = __pyx_pybuffernd_z_l_1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_l_1.diminfo[0].shape = __pyx_pybuffernd_z_l_1.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1842, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1954, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_l_2.diminfo[0].strides = __pyx_pybuffernd_z_l_2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_l_2.diminfo[0].shape = __pyx_pybuffernd_z_l_2.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1842, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1954, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":1862
+  /* "cssm.pyx":1974
  *                        ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Param views
  *     cdef float[:] v_h_view = v_h
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1862, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1974, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1864
+  /* "cssm.pyx":1976
  *     set_seed(random_state)
  *     # Param views
  *     cdef float[:] v_h_view = v_h             # <<<<<<<<<<<<<<
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1976, __pyx_L1_error)
   __pyx_v_v_h_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1865
+  /* "cssm.pyx":1977
  *     # Param views
  *     cdef float[:] v_h_view = v_h
  *     cdef float[:] v_l_1_view = v_l_1             # <<<<<<<<<<<<<<
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1865, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1977, __pyx_L1_error)
   __pyx_v_v_l_1_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1866
+  /* "cssm.pyx":1978
  *     cdef float[:] v_h_view = v_h
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1866, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1978, __pyx_L1_error)
   __pyx_v_v_l_2_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1867
+  /* "cssm.pyx":1979
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1867, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1979, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1868
+  /* "cssm.pyx":1980
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h             # <<<<<<<<<<<<<<
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1868, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1980, __pyx_L1_error)
   __pyx_v_z_h_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1869
+  /* "cssm.pyx":1981
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1             # <<<<<<<<<<<<<<
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1869, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1981, __pyx_L1_error)
   __pyx_v_z_l_1_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1870
+  /* "cssm.pyx":1982
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1870, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1982, __pyx_L1_error)
   __pyx_v_z_l_2_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1871
+  /* "cssm.pyx":1983
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     # TD: Add trajectory --> Tricky here because the simulator is optimized to include only two instead of three particles (high dimension choice determines which low dimension choice will matter for ultimate choice)
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1871, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1983, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1875
+  /* "cssm.pyx":1987
  *     # TD: Add trajectory --> Tricky here because the simulator is optimized to include only two instead of three particles (high dimension choice determines which low dimension choice will matter for ultimate choice)
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1875, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1875, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1875, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1875, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1875, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1875, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1875, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1875, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 1875, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 1987, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1875, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_rts = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1876
+  /* "cssm.pyx":1988
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1876, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1876, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1876, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1876, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1876, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1876, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1876, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1876, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1876, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 1876, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1876, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1988, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_choices = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "cssm.pyx":1878
+  /* "cssm.pyx":1990
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1878, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1990, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "cssm.pyx":1879
+  /* "cssm.pyx":1991
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1879, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1991, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":1881
+  /* "cssm.pyx":1993
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":1882
+  /* "cssm.pyx":1994
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage for the upper bound
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":1885
+  /* "cssm.pyx":1997
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  * 
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":1887
+  /* "cssm.pyx":1999
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  * 
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1887, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1887, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1887, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1887, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_9 = NULL;
   __pyx_t_10 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_9)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -28713,231 +30212,231 @@
       __Pyx_DECREF_SET(__pyx_t_5, function);
       __pyx_t_10 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_1};
-    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1887, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1999, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_1};
-    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1887, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1999, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else
   #endif
   {
-    __pyx_t_11 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1887, __pyx_L1_error)
+    __pyx_t_11 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1999, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     if (__pyx_t_9) {
       __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_10, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_10, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_10, __pyx_t_1);
     __pyx_t_4 = 0;
     __pyx_t_1 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1887, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1999, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1887, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1887, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_11 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_11)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_11);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_11, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1887, __pyx_L1_error)
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_t_s = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "cssm.pyx":1888
+  /* "cssm.pyx":2000
  * 
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1888, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1888, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1888, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1888, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1888, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1888, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 1888, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 2000, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1888, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_boundary = __pyx_t_11;
   __pyx_t_11 = 0;
 
-  /* "cssm.pyx":1889
+  /* "cssm.pyx":2001
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     cdef float y_h, y_l, v_l, t_h, t_l
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1889, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2001, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1893
+  /* "cssm.pyx":2005
  *     cdef float y_h, y_l, v_l, t_h, t_l
  *     cdef int n, ix
  *     cdef int m = 0             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":1894
+  /* "cssm.pyx":2006
  *     cdef int n, ix
  *     cdef int m = 0
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
-  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1894, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2006, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":1896
+  /* "cssm.pyx":2008
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_10 = __pyx_v_n_trials;
   __pyx_t_12 = __pyx_t_10;
   for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
     __pyx_v_k = __pyx_t_13;
 
-    /* "cssm.pyx":1898
+    /* "cssm.pyx":2010
  *     for k in range(n_trials):
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         # Precompute boundary evaluations
  */
     { /* enter inner scope */
-      __pyx_t_11 = PyDict_New(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1898, __pyx_L7_error)
+      __pyx_t_11 = PyDict_New(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2010, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_11);
       __pyx_t_14 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 1898, __pyx_L7_error)
+        __PYX_ERR(0, 2010, __pyx_L7_error)
       }
-      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_15), (&__pyx_t_16)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1898, __pyx_L7_error)
+      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_15), (&__pyx_t_16)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2010, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_XDECREF(__pyx_t_6);
       __pyx_t_6 = __pyx_t_3;
       __pyx_t_3 = 0;
       while (1) {
         __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_6, __pyx_t_15, &__pyx_t_14, &__pyx_t_3, NULL, NULL, __pyx_t_16);
         if (unlikely(__pyx_t_17 == 0)) break;
-        if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 1898, __pyx_L7_error)
+        if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 2010, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_XDECREF_SET(__pyx_9genexpr11__pyx_v_key, __pyx_t_3);
+        __Pyx_XDECREF_SET(__pyx_9genexpr12__pyx_v_key, __pyx_t_3);
         __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_9genexpr11__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1898, __pyx_L7_error)
+        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_9genexpr12__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2010, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1898, __pyx_L7_error)
+        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2010, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_11, (PyObject*)__pyx_9genexpr11__pyx_v_key, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 1898, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_11, (PyObject*)__pyx_9genexpr12__pyx_v_key, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 2010, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       }
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_key); __pyx_9genexpr11__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_key); __pyx_9genexpr12__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_key); __pyx_9genexpr11__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_key); __pyx_9genexpr12__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_11));
     __pyx_t_11 = 0;
 
-    /* "cssm.pyx":1901
+    /* "cssm.pyx":2013
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 1901, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 2013, __pyx_L1_error)
     if (__pyx_t_18) {
 
-      /* "cssm.pyx":1903
+      /* "cssm.pyx":2015
  *         if boundary_multiplicative:
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             # print(a)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1903, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2015, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1903, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2015, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_19 = __pyx_v_k;
-      __pyx_t_5 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1903, __pyx_L1_error)
+      __pyx_t_5 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2015, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1903, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2015, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1903, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 2015, __pyx_L1_error)
       __pyx_t_1 = __pyx_t_4;
       __pyx_t_4 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1903, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1903, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 2015, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2015, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       __pyx_t_16 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_1)) {
@@ -28947,105 +30446,105 @@
           __Pyx_DECREF_SET(__pyx_t_3, function);
           __pyx_t_16 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_5, __pyx_t_4};
-        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1903, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2015, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_5, __pyx_t_4};
-        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1903, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2015, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_9 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1903, __pyx_L1_error)
+        __pyx_t_9 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2015, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         if (__pyx_t_1) {
           __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_1); __pyx_t_1 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_5);
         PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_16, __pyx_t_5);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_16, __pyx_t_4);
         __pyx_t_5 = 0;
         __pyx_t_4 = 0;
-        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1903, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2015, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1903, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2015, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1903, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2015, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __pyx_t_9 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_9)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_11 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_9, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1903, __pyx_L1_error)
+      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2015, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_11, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1903, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_11, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 2015, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-      /* "cssm.pyx":1901
+      /* "cssm.pyx":2013
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             # print(a)
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":1906
+    /* "cssm.pyx":2018
  *         else:
  *             # print(a)
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Loop over samples
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1906, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2018, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_add); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1906, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_add); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2018, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __pyx_t_19 = __pyx_v_k;
-      __pyx_t_6 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1906, __pyx_L1_error)
+      __pyx_t_6 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2018, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1906, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2018, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 1906, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 2018, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_5;
       __pyx_t_5 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 1906, __pyx_L1_error)
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1906, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 2018, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2018, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_16 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_9);
         if (likely(__pyx_t_4)) {
@@ -29055,126 +30554,126 @@
           __Pyx_DECREF_SET(__pyx_t_9, function);
           __pyx_t_16 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_9)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_6, __pyx_t_5};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1906, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2018, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_6, __pyx_t_5};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1906, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2018, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       } else
       #endif
       {
-        __pyx_t_1 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1906, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2018, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_16, __pyx_t_6);
         __Pyx_GIVEREF(__pyx_t_5);
         PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_16, __pyx_t_5);
         __pyx_t_6 = 0;
         __pyx_t_5 = 0;
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1906, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2018, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       }
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1906, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2018, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1906, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2018, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_9);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
           __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_9, function);
         }
       }
       __pyx_t_11 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1906, __pyx_L1_error)
+      if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2018, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_11, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 1906, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_11, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 2018, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":1909
+    /* "cssm.pyx":2021
  * 
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             t_h = 0.0 # reset time high dimension
  *             t_l = 0.0 # reset time low dimension
  */
     __pyx_t_16 = __pyx_v_n_samples;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_17; __pyx_t_20+=1) {
       __pyx_v_n = __pyx_t_20;
 
-      /* "cssm.pyx":1910
+      /* "cssm.pyx":2022
  *         # Loop over samples
  *         for n in range(n_samples):
  *             t_h = 0.0 # reset time high dimension             # <<<<<<<<<<<<<<
  *             t_l = 0.0 # reset time low dimension
  *             ix = 0 # reset boundary index
  */
       __pyx_v_t_h = 0.0;
 
-      /* "cssm.pyx":1911
+      /* "cssm.pyx":2023
  *         for n in range(n_samples):
  *             t_h = 0.0 # reset time high dimension
  *             t_l = 0.0 # reset time low dimension             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_l = 0.0;
 
-      /* "cssm.pyx":1912
+      /* "cssm.pyx":2024
  *             t_h = 0.0 # reset time high dimension
  *             t_l = 0.0 # reset time low dimension
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             # Initialize walkers
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":1915
+      /* "cssm.pyx":2027
  * 
  *             # Initialize walkers
  *             y_h = (-1) * boundary_view[0] + (z_h_view[k] * 2 * (boundary_view[0]))             # <<<<<<<<<<<<<<
  * 
  *             # Random walks until y_h hits bound
  */
       __pyx_t_19 = 0;
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_22 = 0;
       __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_h_view.data + __pyx_t_21 * __pyx_v_z_h_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_22 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":1918
+      /* "cssm.pyx":2030
  * 
  *             # Random walks until y_h hits bound
  *             while y_h >= (-1) * boundary_view[ix] and y_h <= boundary_view[ix] and t_h <= max_t:             # <<<<<<<<<<<<<<
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_h += delta_t
  */
       while (1) {
@@ -29193,195 +30692,195 @@
           goto __pyx_L16_bool_binop_done;
         }
         __pyx_t_23 = ((__pyx_v_t_h <= __pyx_v_max_t) != 0);
         __pyx_t_18 = __pyx_t_23;
         __pyx_L16_bool_binop_done:;
         if (!__pyx_t_18) break;
 
-        /* "cssm.pyx":1919
+        /* "cssm.pyx":2031
  *             # Random walks until y_h hits bound
  *             while y_h >= (-1) * boundary_view[ix] and y_h <= boundary_view[ix] and t_h <= max_t:
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                 t_h += delta_t
  *                 ix += 1
  */
         __pyx_t_22 = __pyx_v_k;
         __pyx_t_21 = __pyx_v_m;
         __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_v_h_view.data + __pyx_t_22 * __pyx_v_v_h_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_21 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":1920
+        /* "cssm.pyx":2032
  *             while y_h >= (-1) * boundary_view[ix] and y_h <= boundary_view[ix] and t_h <= max_t:
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_h += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_h = (__pyx_v_t_h + __pyx_v_delta_t);
 
-        /* "cssm.pyx":1921
+        /* "cssm.pyx":2033
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_h += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  *                 if m == num_draws:
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":1922
+        /* "cssm.pyx":2034
  *                 t_h += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":1923
+        /* "cssm.pyx":2035
  *                 ix += 1
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_18 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":1924
+          /* "cssm.pyx":2036
  *                 m += 1
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1924, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2036, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":1925
+          /* "cssm.pyx":2037
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             if sign(y_h) < 0: # Store intermediate choice
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":1923
+          /* "cssm.pyx":2035
  *                 ix += 1
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":1927
+      /* "cssm.pyx":2039
  *                     m = 0
  * 
  *             if sign(y_h) < 0: # Store intermediate choice             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] = 0
  *                 y_l = (-1) * boundary_view[0] + (z_l_1_view[k] * 2 * (boundary_view[0]))
  */
       __pyx_t_18 = ((__pyx_f_4cssm_sign(__pyx_v_y_h) < 0) != 0);
       if (__pyx_t_18) {
 
-        /* "cssm.pyx":1928
+        /* "cssm.pyx":2040
  * 
  *             if sign(y_h) < 0: # Store intermediate choice
  *                 choices_view[n, k, 0] = 0             # <<<<<<<<<<<<<<
  *                 y_l = (-1) * boundary_view[0] + (z_l_1_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_1_view[k]
  */
         __pyx_t_21 = __pyx_v_n;
         __pyx_t_22 = __pyx_v_k;
         __pyx_t_19 = 0;
         *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_22 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) = 0;
 
-        /* "cssm.pyx":1929
+        /* "cssm.pyx":2041
  *             if sign(y_h) < 0: # Store intermediate choice
  *                 choices_view[n, k, 0] = 0
  *                 y_l = (-1) * boundary_view[0] + (z_l_1_view[k] * 2 * (boundary_view[0]))             # <<<<<<<<<<<<<<
  *                 v_l = v_l_1_view[k]
  * 
  */
         __pyx_t_19 = 0;
         __pyx_t_22 = __pyx_v_k;
         __pyx_t_21 = 0;
         __pyx_v_y_l = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_l_1_view.data + __pyx_t_22 * __pyx_v_z_l_1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))));
 
-        /* "cssm.pyx":1930
+        /* "cssm.pyx":2042
  *                 choices_view[n, k, 0] = 0
  *                 y_l = (-1) * boundary_view[0] + (z_l_1_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_1_view[k]             # <<<<<<<<<<<<<<
  * 
  *             else:
  */
         __pyx_t_21 = __pyx_v_k;
         __pyx_v_v_l = (*((float *) ( /* dim=0 */ (__pyx_v_v_l_1_view.data + __pyx_t_21 * __pyx_v_v_l_1_view.strides[0]) )));
 
-        /* "cssm.pyx":1927
+        /* "cssm.pyx":2039
  *                     m = 0
  * 
  *             if sign(y_h) < 0: # Store intermediate choice             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] = 0
  *                 y_l = (-1) * boundary_view[0] + (z_l_1_view[k] * 2 * (boundary_view[0]))
  */
         goto __pyx_L20;
       }
 
-      /* "cssm.pyx":1933
+      /* "cssm.pyx":2045
  * 
  *             else:
  *                 choices_view[n, k, 0] = 2             # <<<<<<<<<<<<<<
  *                 y_l = (-1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_2_view[k]
  */
       /*else*/ {
         __pyx_t_21 = __pyx_v_n;
         __pyx_t_22 = __pyx_v_k;
         __pyx_t_19 = 0;
         *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_22 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) = 2;
 
-        /* "cssm.pyx":1934
+        /* "cssm.pyx":2046
  *             else:
  *                 choices_view[n, k, 0] = 2
  *                 y_l = (-1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))             # <<<<<<<<<<<<<<
  *                 v_l = v_l_2_view[k]
  * 
  */
         __pyx_t_19 = 0;
         __pyx_t_22 = __pyx_v_k;
         __pyx_t_21 = 0;
         __pyx_v_y_l = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_l_2_view.data + __pyx_t_22 * __pyx_v_z_l_2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))));
 
-        /* "cssm.pyx":1935
+        /* "cssm.pyx":2047
  *                 choices_view[n, k, 0] = 2
  *                 y_l = (-1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_2_view[k]             # <<<<<<<<<<<<<<
  * 
  *             # Random walks until the y_l corresponding to y_h hits bound
  */
         __pyx_t_21 = __pyx_v_k;
         __pyx_v_v_l = (*((float *) ( /* dim=0 */ (__pyx_v_v_l_2_view.data + __pyx_t_21 * __pyx_v_v_l_2_view.strides[0]) )));
       }
       __pyx_L20:;
 
-      /* "cssm.pyx":1938
+      /* "cssm.pyx":2050
  * 
  *             # Random walks until the y_l corresponding to y_h hits bound
  *             ix = 0             # <<<<<<<<<<<<<<
  *             while y_l >= (-1) * boundary_view[ix] and y_l <= boundary_view[ix] and t_l <= max_t:
  *                 y_l += (v_l * delta_t) + (sqrt_st * gaussian_values[m])
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":1939
+      /* "cssm.pyx":2051
  *             # Random walks until the y_l corresponding to y_h hits bound
  *             ix = 0
  *             while y_l >= (-1) * boundary_view[ix] and y_l <= boundary_view[ix] and t_l <= max_t:             # <<<<<<<<<<<<<<
  *                 y_l += (v_l * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_l += delta_t
  */
       while (1) {
@@ -29400,340 +30899,340 @@
           goto __pyx_L23_bool_binop_done;
         }
         __pyx_t_23 = ((__pyx_v_t_l <= __pyx_v_max_t) != 0);
         __pyx_t_18 = __pyx_t_23;
         __pyx_L23_bool_binop_done:;
         if (!__pyx_t_18) break;
 
-        /* "cssm.pyx":1940
+        /* "cssm.pyx":2052
  *             ix = 0
  *             while y_l >= (-1) * boundary_view[ix] and y_l <= boundary_view[ix] and t_l <= max_t:
  *                 y_l += (v_l * delta_t) + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                 t_l += delta_t
  *                 ix += 1
  */
         __pyx_t_21 = __pyx_v_m;
         __pyx_v_y_l = (__pyx_v_y_l + ((__pyx_v_v_l * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_21 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":1941
+        /* "cssm.pyx":2053
  *             while y_l >= (-1) * boundary_view[ix] and y_l <= boundary_view[ix] and t_l <= max_t:
  *                 y_l += (v_l * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_l += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_l = (__pyx_v_t_l + __pyx_v_delta_t);
 
-        /* "cssm.pyx":1942
+        /* "cssm.pyx":2054
  *                 y_l += (v_l * delta_t) + (sqrt_st * gaussian_values[m])
  *                 t_l += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  *                 if m == num_draws:
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":1943
+        /* "cssm.pyx":2055
  *                 t_l += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":1944
+        /* "cssm.pyx":2056
  *                 ix += 1
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_18 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":1945
+          /* "cssm.pyx":2057
  *                 m += 1
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1945, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2057, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":1946
+          /* "cssm.pyx":2058
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":1944
+          /* "cssm.pyx":2056
  *                 ix += 1
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":1948
+      /* "cssm.pyx":2060
  *                     m = 0
  * 
  *             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]             # <<<<<<<<<<<<<<
  * 
  *             if sign(y_l) >= 0: # store choice update
  */
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_22 = __pyx_v_n;
       __pyx_t_19 = __pyx_v_k;
       __pyx_t_24 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_22 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = (fmax(__pyx_v_t_h, __pyx_v_t_l) + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":1950
+      /* "cssm.pyx":2062
  *             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]
  * 
  *             if sign(y_l) >= 0: # store choice update             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] = choices_view[n, k, 0] + 1
  * 
  */
       __pyx_t_18 = ((__pyx_f_4cssm_sign(__pyx_v_y_l) >= 0) != 0);
       if (__pyx_t_18) {
 
-        /* "cssm.pyx":1951
+        /* "cssm.pyx":2063
  * 
  *             if sign(y_l) >= 0: # store choice update
  *                 choices_view[n, k, 0] = choices_view[n, k, 0] + 1             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  */
         __pyx_t_21 = __pyx_v_n;
         __pyx_t_24 = __pyx_v_k;
         __pyx_t_19 = 0;
         __pyx_t_22 = __pyx_v_n;
         __pyx_t_25 = __pyx_v_k;
         __pyx_t_26 = 0;
         *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_22 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_25 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[2]) )) = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) + 1);
 
-        /* "cssm.pyx":1950
+        /* "cssm.pyx":2062
  *             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]
  * 
  *             if sign(y_l) >= 0: # store choice update             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] = choices_view[n, k, 0] + 1
  * 
  */
       }
     }
   }
 
-  /* "cssm.pyx":1953
+  /* "cssm.pyx":2065
  *                 choices_view[n, k, 0] = choices_view[n, k, 0] + 1
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,             # <<<<<<<<<<<<<<
  *                                                         'vl1': v_l_1,
  *                                                         'vl2': v_l_2,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_11 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1953, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2065, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2065, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vh, ((PyObject *)__pyx_v_v_h)) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vh, ((PyObject *)__pyx_v_v_h)) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
 
-  /* "cssm.pyx":1954
+  /* "cssm.pyx":2066
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  *                                                         'vl1': v_l_1,             # <<<<<<<<<<<<<<
  *                                                         'vl2': v_l_2,
  *                                                         'a': a,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl1, ((PyObject *)__pyx_v_v_l_1)) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl1, ((PyObject *)__pyx_v_v_l_1)) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
 
-  /* "cssm.pyx":1955
+  /* "cssm.pyx":2067
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  *                                                         'vl1': v_l_1,
  *                                                         'vl2': v_l_2,             # <<<<<<<<<<<<<<
  *                                                         'a': a,
  *                                                         'zh': z_h,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl2, ((PyObject *)__pyx_v_v_l_2)) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl2, ((PyObject *)__pyx_v_v_l_2)) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
 
-  /* "cssm.pyx":1956
+  /* "cssm.pyx":2068
  *                                                         'vl1': v_l_1,
  *                                                         'vl2': v_l_2,
  *                                                         'a': a,             # <<<<<<<<<<<<<<
  *                                                         'zh': z_h,
  *                                                         'zl1': z_l_1,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
 
-  /* "cssm.pyx":1957
+  /* "cssm.pyx":2069
  *                                                         'vl2': v_l_2,
  *                                                         'a': a,
  *                                                         'zh': z_h,             # <<<<<<<<<<<<<<
  *                                                         'zl1': z_l_1,
  *                                                         'zl2': z_l_2,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zh, ((PyObject *)__pyx_v_z_h)) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zh, ((PyObject *)__pyx_v_z_h)) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
 
-  /* "cssm.pyx":1958
+  /* "cssm.pyx":2070
  *                                                         'a': a,
  *                                                         'zh': z_h,
  *                                                         'zl1': z_l_1,             # <<<<<<<<<<<<<<
  *                                                         'zl2': z_l_2,
  *                                                         't': t,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl1, ((PyObject *)__pyx_v_z_l_1)) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl1, ((PyObject *)__pyx_v_z_l_1)) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
 
-  /* "cssm.pyx":1959
+  /* "cssm.pyx":2071
  *                                                         'zh': z_h,
  *                                                         'zl1': z_l_1,
  *                                                         'zl2': z_l_2,             # <<<<<<<<<<<<<<
  *                                                         't': t,
  *                                                         's': s,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl2, ((PyObject *)__pyx_v_z_l_2)) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl2, ((PyObject *)__pyx_v_z_l_2)) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
 
-  /* "cssm.pyx":1960
+  /* "cssm.pyx":2072
  *                                                         'zl1': z_l_1,
  *                                                         'zl2': z_l_2,
  *                                                         't': t,             # <<<<<<<<<<<<<<
  *                                                         's': s,
  *                                                         **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
 
-  /* "cssm.pyx":1961
+  /* "cssm.pyx":2073
  *                                                         'zl2': z_l_2,
  *                                                         't': t,
  *                                                         's': s,             # <<<<<<<<<<<<<<
  *                                                         **boundary_params,
  *                                                         'delta_t': delta_t,
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1961, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2073, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_1) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_1) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_9 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1962
+  /* "cssm.pyx":2074
  *                                                         't': t,
  *                                                         's': s,
  *                                                         **boundary_params,             # <<<<<<<<<<<<<<
  *                                                         'delta_t': delta_t,
  *                                                         'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 1962, __pyx_L1_error)
+    __PYX_ERR(0, 2074, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_9, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 1962, __pyx_L1_error)
+    __PYX_ERR(0, 2074, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":1963
+  /* "cssm.pyx":2075
  *                                                         's': s,
  *                                                         **boundary_params,
  *                                                         'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                         'max_t': max_t,
  *                                                         'n_samples': n_samples,
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1963, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2075, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 1963, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 2075, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1964
+  /* "cssm.pyx":2076
  *                                                         **boundary_params,
  *                                                         'delta_t': delta_t,
  *                                                         'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                         'n_samples': n_samples,
  *                                                         'simulator': 'ddm_flexbound',
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1964, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2076, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 1964, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 2076, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1965
+  /* "cssm.pyx":2077
  *                                                         'delta_t': delta_t,
  *                                                         'max_t': max_t,
  *                                                         'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                         'simulator': 'ddm_flexbound',
  *                                                         'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1965, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 1965, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 2077, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) < 0) __PYX_ERR(0, 1966, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) < 0) __PYX_ERR(0, 2078, __pyx_L1_error)
 
-  /* "cssm.pyx":1967
+  /* "cssm.pyx":2079
  *                                                         'n_samples': n_samples,
  *                                                         'simulator': 'ddm_flexbound',
  *                                                         'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                         'possible_choices': [0, 1, 2, 3],
  *                                                         'trajectory': 'This simulator does not yet allow for trajectory simulation',
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1967, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2079, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary_fun_type, __pyx_t_3) < 0) __PYX_ERR(0, 1967, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary_fun_type, __pyx_t_3) < 0) __PYX_ERR(0, 2079, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":1968
+  /* "cssm.pyx":2080
  *                                                         'simulator': 'ddm_flexbound',
  *                                                         'boundary_fun_type': boundary_fun.__name__,
  *                                                         'possible_choices': [0, 1, 2, 3],             # <<<<<<<<<<<<<<
  *                                                         'trajectory': 'This simulator does not yet allow for trajectory simulation',
  *                                                         'boundary': boundary}}
  */
-  __pyx_t_3 = PyList_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1968, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2080, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyList_SET_ITEM(__pyx_t_3, 2, __pyx_int_2);
   __Pyx_INCREF(__pyx_int_3);
   __Pyx_GIVEREF(__pyx_int_3);
   PyList_SET_ITEM(__pyx_t_3, 3, __pyx_int_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 1968, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 2080, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_trajectory, __pyx_kp_u_This_simulator_does_not_yet_allo) < 0) __PYX_ERR(0, 1969, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_trajectory, __pyx_kp_u_This_simulator_does_not_yet_allo) < 0) __PYX_ERR(0, 2081, __pyx_L1_error)
 
-  /* "cssm.pyx":1970
+  /* "cssm.pyx":2082
  *                                                         'possible_choices': [0, 1, 2, 3],
  *                                                         'trajectory': 'This simulator does not yet allow for trajectory simulation',
  *                                                         'boundary': boundary}}             # <<<<<<<<<<<<<<
  * # -----------------------------------------------------------------------------------------------
  * 
  */
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 1970, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_metadata, __pyx_t_9) < 0) __PYX_ERR(0, 1953, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 2082, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_u_metadata, __pyx_t_9) < 0) __PYX_ERR(0, 2065, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __pyx_r = __pyx_t_11;
   __pyx_t_11 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":1842
+  /* "cssm.pyx":1954
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_par2(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] v_l_1,
  *                        np.ndarray[float, ndim = 1] v_l_2,
  */
 
@@ -29788,32 +31287,32 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_rts_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_choices_view, 1);
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
-  __Pyx_XDECREF(__pyx_9genexpr11__pyx_v_key);
+  __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":1976
+/* "cssm.pyx":2088
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_mic2_adj(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                            np.ndarray[float, ndim = 1] v_l_1,
  *                            np.ndarray[float, ndim = 1] v_l_2,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_33ddm_flexbound_mic2_adj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_33ddm_flexbound_mic2_adj = {"ddm_flexbound_mic2_adj", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_33ddm_flexbound_mic2_adj, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_33ddm_flexbound_mic2_adj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_35ddm_flexbound_mic2_adj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_35ddm_flexbound_mic2_adj = {"ddm_flexbound_mic2_adj", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_35ddm_flexbound_mic2_adj, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_35ddm_flexbound_mic2_adj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v_h = 0;
   PyArrayObject *__pyx_v_v_l_1 = 0;
   PyArrayObject *__pyx_v_v_l_2 = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z_h = 0;
   PyArrayObject *__pyx_v_z_l_1 = 0;
   PyArrayObject *__pyx_v_z_l_2 = 0;
@@ -29835,43 +31334,43 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ddm_flexbound_mic2_adj (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v_h,&__pyx_n_s_v_l_1,&__pyx_n_s_v_l_2,&__pyx_n_s_a,&__pyx_n_s_z_h,&__pyx_n_s_z_l_1,&__pyx_n_s_z_l_2,&__pyx_n_s_d,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_print_info,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[19] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":1990
+    /* "cssm.pyx":2102
  *                            int n_samples = 20000,
  *                            int n_trials = 1,
  *                            print_info = True,             # <<<<<<<<<<<<<<
  *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                            boundary_multiplicative = True,
  */
     values[14] = ((PyObject *)Py_True);
 
-    /* "cssm.pyx":1991
+    /* "cssm.pyx":2103
  *                            int n_trials = 1,
  *                            print_info = True,
  *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *                            boundary_multiplicative = True,
  *                            boundary_params = {},
  */
     values[15] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":1992
+    /* "cssm.pyx":2104
  *                            print_info = True,
  *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                            boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *                            boundary_params = {},
  *                            random_state = None,
  */
     values[16] = ((PyObject *)Py_True);
-    values[17] = __pyx_k__16;
+    values[17] = __pyx_k__17;
 
-    /* "cssm.pyx":1994
+    /* "cssm.pyx":2106
  *                            boundary_multiplicative = True,
  *                            boundary_params = {},
  *                            random_state = None,             # <<<<<<<<<<<<<<
  *                            ):
  * 
  */
     values[18] = ((PyObject *)Py_None);
@@ -29925,57 +31424,57 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_h)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_l_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 1); __PYX_ERR(0, 1976, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 1); __PYX_ERR(0, 2088, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_l_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 2); __PYX_ERR(0, 1976, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 2); __PYX_ERR(0, 2088, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 3); __PYX_ERR(0, 1976, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 3); __PYX_ERR(0, 2088, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_h)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 4); __PYX_ERR(0, 1976, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 4); __PYX_ERR(0, 2088, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_l_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 5); __PYX_ERR(0, 1976, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 5); __PYX_ERR(0, 2088, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_l_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 6); __PYX_ERR(0, 1976, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 6); __PYX_ERR(0, 2088, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_d)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 7); __PYX_ERR(0, 1976, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 7); __PYX_ERR(0, 2088, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 8); __PYX_ERR(0, 1976, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, 8); __PYX_ERR(0, 2088, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[9] = value; kw_args--; }
         }
@@ -30031,15 +31530,15 @@
         case 18:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[18] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_mic2_adj") < 0)) __PYX_ERR(0, 1976, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_mic2_adj") < 0)) __PYX_ERR(0, 2088, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 19: values[18] = PyTuple_GET_ITEM(__pyx_args, 18);
         CYTHON_FALLTHROUGH;
         case 18: values[17] = PyTuple_GET_ITEM(__pyx_args, 17);
         CYTHON_FALLTHROUGH;
@@ -30078,64 +31577,64 @@
     __pyx_v_a = ((PyArrayObject *)values[3]);
     __pyx_v_z_h = ((PyArrayObject *)values[4]);
     __pyx_v_z_l_1 = ((PyArrayObject *)values[5]);
     __pyx_v_z_l_2 = ((PyArrayObject *)values[6]);
     __pyx_v_d = ((PyArrayObject *)values[7]);
     __pyx_v_t = ((PyArrayObject *)values[8]);
     if (values[9]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1985, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 2097, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[10]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[10]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1986, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[10]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 2098, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[11]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[11]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 1987, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[11]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 2099, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[12]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[12]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1988, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[12]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2100, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[13]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[13]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1989, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[13]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2101, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_print_info = values[14];
     __pyx_v_boundary_fun = values[15];
     __pyx_v_boundary_multiplicative = values[16];
     __pyx_v_boundary_params = values[17];
     __pyx_v_random_state = values[18];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1976, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_mic2_adj", 0, 9, 19, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 2088, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ddm_flexbound_mic2_adj", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_h), __pyx_ptype_5numpy_ndarray, 1, "v_h", 0))) __PYX_ERR(0, 1976, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_1), __pyx_ptype_5numpy_ndarray, 1, "v_l_1", 0))) __PYX_ERR(0, 1977, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_2), __pyx_ptype_5numpy_ndarray, 1, "v_l_2", 0))) __PYX_ERR(0, 1978, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 1979, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_h), __pyx_ptype_5numpy_ndarray, 1, "z_h", 0))) __PYX_ERR(0, 1980, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_1), __pyx_ptype_5numpy_ndarray, 1, "z_l_1", 0))) __PYX_ERR(0, 1981, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_2), __pyx_ptype_5numpy_ndarray, 1, "z_l_2", 0))) __PYX_ERR(0, 1982, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_d), __pyx_ptype_5numpy_ndarray, 1, "d", 0))) __PYX_ERR(0, 1983, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 1984, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_32ddm_flexbound_mic2_adj(__pyx_self, __pyx_v_v_h, __pyx_v_v_l_1, __pyx_v_v_l_2, __pyx_v_a, __pyx_v_z_h, __pyx_v_z_l_1, __pyx_v_z_l_2, __pyx_v_d, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_h), __pyx_ptype_5numpy_ndarray, 1, "v_h", 0))) __PYX_ERR(0, 2088, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_1), __pyx_ptype_5numpy_ndarray, 1, "v_l_1", 0))) __PYX_ERR(0, 2089, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_2), __pyx_ptype_5numpy_ndarray, 1, "v_l_2", 0))) __PYX_ERR(0, 2090, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 2091, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_h), __pyx_ptype_5numpy_ndarray, 1, "z_h", 0))) __PYX_ERR(0, 2092, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_1), __pyx_ptype_5numpy_ndarray, 1, "z_l_1", 0))) __PYX_ERR(0, 2093, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_2), __pyx_ptype_5numpy_ndarray, 1, "z_l_2", 0))) __PYX_ERR(0, 2094, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_d), __pyx_ptype_5numpy_ndarray, 1, "d", 0))) __PYX_ERR(0, 2095, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 2096, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_34ddm_flexbound_mic2_adj(__pyx_self, __pyx_v_v_h, __pyx_v_v_l_1, __pyx_v_v_l_2, __pyx_v_a, __pyx_v_z_h, __pyx_v_z_l_1, __pyx_v_z_l_2, __pyx_v_d, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":1976
+  /* "cssm.pyx":2088
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_mic2_adj(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                            np.ndarray[float, ndim = 1] v_l_1,
  *                            np.ndarray[float, ndim = 1] v_l_2,
  */
 
@@ -30144,15 +31643,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_32ddm_flexbound_mic2_adj(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_34ddm_flexbound_mic2_adj(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_h_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_v_l_1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_v_l_2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_h_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_l_1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_l_2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -30178,15 +31677,15 @@
   Py_ssize_t __pyx_v_n;
   Py_ssize_t __pyx_v_ix;
   Py_ssize_t __pyx_v_ix_tmp;
   Py_ssize_t __pyx_v_k;
   Py_ssize_t __pyx_v_m;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
-  PyObject *__pyx_9genexpr12__pyx_v_key = NULL;
+  PyObject *__pyx_9genexpr13__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_d;
   __Pyx_Buffer __pyx_pybuffer_d;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
   __Pyx_Buffer __pyx_pybuffer_t;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v_h;
@@ -30264,338 +31763,338 @@
   __pyx_pybuffernd_d.rcbuffer = &__pyx_pybuffer_d;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1976, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2088, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_h.diminfo[0].strides = __pyx_pybuffernd_v_h.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_h.diminfo[0].shape = __pyx_pybuffernd_v_h.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1976, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2088, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_l_1.diminfo[0].strides = __pyx_pybuffernd_v_l_1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_l_1.diminfo[0].shape = __pyx_pybuffernd_v_l_1.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1976, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2088, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_l_2.diminfo[0].strides = __pyx_pybuffernd_v_l_2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_l_2.diminfo[0].shape = __pyx_pybuffernd_v_l_2.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1976, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2088, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1976, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2088, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_h.diminfo[0].strides = __pyx_pybuffernd_z_h.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_h.diminfo[0].shape = __pyx_pybuffernd_z_h.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1976, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2088, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_l_1.diminfo[0].strides = __pyx_pybuffernd_z_l_1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_l_1.diminfo[0].shape = __pyx_pybuffernd_z_l_1.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1976, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2088, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_l_2.diminfo[0].strides = __pyx_pybuffernd_z_l_2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_l_2.diminfo[0].shape = __pyx_pybuffernd_z_l_2.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_d.rcbuffer->pybuffer, (PyObject*)__pyx_v_d, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1976, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_d.rcbuffer->pybuffer, (PyObject*)__pyx_v_d, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2088, __pyx_L1_error)
   }
   __pyx_pybuffernd_d.diminfo[0].strides = __pyx_pybuffernd_d.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_d.diminfo[0].shape = __pyx_pybuffernd_d.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1976, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2088, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":1997
+  /* "cssm.pyx":2109
  *                            ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Param views
  *     cdef float[:] v_h_view = v_h
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1997, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":1999
+  /* "cssm.pyx":2111
  *     set_seed(random_state)
  *     # Param views
  *     cdef float[:] v_h_view = v_h             # <<<<<<<<<<<<<<
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1999, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2111, __pyx_L1_error)
   __pyx_v_v_h_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2000
+  /* "cssm.pyx":2112
  *     # Param views
  *     cdef float[:] v_h_view = v_h
  *     cdef float[:] v_l_1_view = v_l_1             # <<<<<<<<<<<<<<
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2000, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2112, __pyx_L1_error)
   __pyx_v_v_l_1_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2001
+  /* "cssm.pyx":2113
  *     cdef float[:] v_h_view = v_h
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2001, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2113, __pyx_L1_error)
   __pyx_v_v_l_2_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2002
+  /* "cssm.pyx":2114
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2002, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2114, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2003
+  /* "cssm.pyx":2115
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h             # <<<<<<<<<<<<<<
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2003, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2115, __pyx_L1_error)
   __pyx_v_z_h_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2004
+  /* "cssm.pyx":2116
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1             # <<<<<<<<<<<<<<
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] d_view = d
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2004, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2116, __pyx_L1_error)
   __pyx_v_z_l_1_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2005
+  /* "cssm.pyx":2117
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2             # <<<<<<<<<<<<<<
  *     cdef float[:] d_view = d
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2005, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2117, __pyx_L1_error)
   __pyx_v_z_l_2_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2006
+  /* "cssm.pyx":2118
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] d_view = d             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_d), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2006, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_d), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2118, __pyx_L1_error)
   __pyx_v_d_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2007
+  /* "cssm.pyx":2119
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] d_view = d
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     # TD: Add trajectory --> same issue as with par2 model above... might need to make a separate simulator for trajectories
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2007, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2119, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2011
+  /* "cssm.pyx":2123
  *     # TD: Add trajectory --> same issue as with par2 model above... might need to make a separate simulator for trajectories
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2011, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2011, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2011, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2011, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2011, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2011, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2011, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2011, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 2011, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 2123, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2011, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_rts = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "cssm.pyx":2012
+  /* "cssm.pyx":2124
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2012, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2012, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2012, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2012, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2012, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2012, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2012, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2012, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2012, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 2012, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2012, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_choices = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "cssm.pyx":2014
+  /* "cssm.pyx":2126
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2014, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2126, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "cssm.pyx":2015
+  /* "cssm.pyx":2127
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 2015, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 2127, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":2017
+  /* "cssm.pyx":2129
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":2018
+  /* "cssm.pyx":2130
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage for the upper bound
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":2021
+  /* "cssm.pyx":2133
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":2022
+  /* "cssm.pyx":2134
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2022, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2022, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2022, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2022, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_9 = NULL;
   __pyx_t_10 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_9)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -30604,276 +32103,276 @@
       __Pyx_DECREF_SET(__pyx_t_5, function);
       __pyx_t_10 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_1};
-    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2022, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2134, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_1};
-    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2022, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2134, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else
   #endif
   {
-    __pyx_t_11 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2022, __pyx_L1_error)
+    __pyx_t_11 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     if (__pyx_t_9) {
       __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_10, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_10, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_10, __pyx_t_1);
     __pyx_t_4 = 0;
     __pyx_t_1 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2022, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2022, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2022, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_11 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_11)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_11);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_11, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2022, __pyx_L1_error)
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_t_s = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "cssm.pyx":2023
+  /* "cssm.pyx":2135
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2023, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2023, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2023, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2023, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2023, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2023, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 2023, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 2135, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2023, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_boundary = __pyx_t_11;
   __pyx_t_11 = 0;
 
-  /* "cssm.pyx":2024
+  /* "cssm.pyx":2136
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     # Y particle trace
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2024, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2136, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2027
+  /* "cssm.pyx":2139
  * 
  *     # Y particle trace
  *     bias_trace = np.zeros(num_draws, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] bias_trace_view = bias_trace
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2027, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2027, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_num_draws); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2027, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_num_draws); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2027, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_11);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_11);
   __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2027, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2027, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 2027, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 2139, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2027, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_v_bias_trace = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":2028
+  /* "cssm.pyx":2140
  *     # Y particle trace
  *     bias_trace = np.zeros(num_draws, dtype = DTYPE)
  *     cdef float[:] bias_trace_view = bias_trace             # <<<<<<<<<<<<<<
  * 
  *     cdef float y_h, y_l, v_l, t_h, t_l
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_bias_trace, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2028, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_bias_trace, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2140, __pyx_L1_error)
   __pyx_v_bias_trace_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2032
+  /* "cssm.pyx":2144
  *     cdef float y_h, y_l, v_l, t_h, t_l
  *     cdef Py_ssize_t n, ix, ix_tmp, k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":2033
+  /* "cssm.pyx":2145
  *     cdef Py_ssize_t n, ix, ix_tmp, k
  *     cdef Py_ssize_t m = 0
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
-  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2033, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2145, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2035
+  /* "cssm.pyx":2147
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_10 = __pyx_v_n_trials;
   __pyx_t_12 = __pyx_t_10;
   for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
     __pyx_v_k = __pyx_t_13;
 
-    /* "cssm.pyx":2037
+    /* "cssm.pyx":2149
  *     for k in range(n_trials):
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         # Precompute boundary evaluations
  */
     { /* enter inner scope */
-      __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2037, __pyx_L7_error)
+      __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2149, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_t_14 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 2037, __pyx_L7_error)
+        __PYX_ERR(0, 2149, __pyx_L7_error)
       }
-      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_15), (&__pyx_t_16)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2037, __pyx_L7_error)
+      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_15), (&__pyx_t_16)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2149, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_XDECREF(__pyx_t_11);
       __pyx_t_11 = __pyx_t_3;
       __pyx_t_3 = 0;
       while (1) {
         __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_11, __pyx_t_15, &__pyx_t_14, &__pyx_t_3, NULL, NULL, __pyx_t_16);
         if (unlikely(__pyx_t_17 == 0)) break;
-        if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 2037, __pyx_L7_error)
+        if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 2149, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_XDECREF_SET(__pyx_9genexpr12__pyx_v_key, __pyx_t_3);
+        __Pyx_XDECREF_SET(__pyx_9genexpr13__pyx_v_key, __pyx_t_3);
         __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_9genexpr12__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2037, __pyx_L7_error)
+        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_9genexpr13__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2149, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2037, __pyx_L7_error)
+        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2149, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_5, (PyObject*)__pyx_9genexpr12__pyx_v_key, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 2037, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_5, (PyObject*)__pyx_9genexpr13__pyx_v_key, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 2149, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       }
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_key); __pyx_9genexpr12__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_key); __pyx_9genexpr13__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_key); __pyx_9genexpr12__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_key); __pyx_9genexpr13__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
     __pyx_t_5 = 0;
 
-    /* "cssm.pyx":2040
+    /* "cssm.pyx":2152
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  */
-    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 2040, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 2152, __pyx_L1_error)
     if (__pyx_t_18) {
 
-      /* "cssm.pyx":2041
+      /* "cssm.pyx":2153
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2041, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2153, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2041, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2153, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __pyx_t_19 = __pyx_v_k;
-      __pyx_t_6 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2041, __pyx_L1_error)
+      __pyx_t_6 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2153, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2041, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2153, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 2041, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 2153, __pyx_L1_error)
       __pyx_t_1 = __pyx_t_4;
       __pyx_t_4 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 2041, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2041, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 2153, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2153, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       __pyx_t_16 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_1)) {
@@ -30883,105 +32382,105 @@
           __Pyx_DECREF_SET(__pyx_t_3, function);
           __pyx_t_16 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_6, __pyx_t_4};
-        __pyx_t_11 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2041, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2153, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_6, __pyx_t_4};
-        __pyx_t_11 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2041, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2153, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_9 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2041, __pyx_L1_error)
+        __pyx_t_9 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2153, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         if (__pyx_t_1) {
           __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_1); __pyx_t_1 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_16, __pyx_t_6);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_16, __pyx_t_4);
         __pyx_t_6 = 0;
         __pyx_t_4 = 0;
-        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2041, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2153, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2041, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2153, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2041, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2153, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __pyx_t_9 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_9)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_5 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_9, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_11);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2041, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2153, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 2041, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 2153, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-      /* "cssm.pyx":2040
+      /* "cssm.pyx":2152
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":2043
+    /* "cssm.pyx":2155
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Loop over samples
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2043, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_add); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2043, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_add); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __pyx_t_19 = __pyx_v_k;
-      __pyx_t_11 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2043, __pyx_L1_error)
+      __pyx_t_11 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2043, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 2043, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 2155, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_6;
       __pyx_t_6 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 2043, __pyx_L1_error)
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2043, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 2155, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_16 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_9);
         if (likely(__pyx_t_4)) {
@@ -30991,150 +32490,150 @@
           __Pyx_DECREF_SET(__pyx_t_9, function);
           __pyx_t_16 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_9)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_6};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2043, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2155, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_6};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2043, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2155, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       } else
       #endif
       {
-        __pyx_t_1 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2043, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2155, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_11);
         PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_16, __pyx_t_11);
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_16, __pyx_t_6);
         __pyx_t_11 = 0;
         __pyx_t_6 = 0;
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2043, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2155, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       }
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2043, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2043, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_9);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
           __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_9, function);
         }
       }
       __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2043, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 2043, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 2155, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":2046
+    /* "cssm.pyx":2158
  * 
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = 0 # reset choice
  *             t_h = 0 # reset time high dimension
  */
     __pyx_t_16 = __pyx_v_n_samples;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_17; __pyx_t_15+=1) {
       __pyx_v_n = __pyx_t_15;
 
-      /* "cssm.pyx":2047
+      /* "cssm.pyx":2159
  *         # Loop over samples
  *         for n in range(n_samples):
  *             choices_view[n, k, 0] = 0 # reset choice             # <<<<<<<<<<<<<<
  *             t_h = 0 # reset time high dimension
  *             t_l = 0 # reset time low dimension
  */
       __pyx_t_19 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_21 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) = 0;
 
-      /* "cssm.pyx":2048
+      /* "cssm.pyx":2160
  *         for n in range(n_samples):
  *             choices_view[n, k, 0] = 0 # reset choice
  *             t_h = 0 # reset time high dimension             # <<<<<<<<<<<<<<
  *             t_l = 0 # reset time low dimension
  *             ix = 0 # reset boundary index
  */
       __pyx_v_t_h = 0.0;
 
-      /* "cssm.pyx":2049
+      /* "cssm.pyx":2161
  *             choices_view[n, k, 0] = 0 # reset choice
  *             t_h = 0 # reset time high dimension
  *             t_l = 0 # reset time low dimension             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_l = 0.0;
 
-      /* "cssm.pyx":2050
+      /* "cssm.pyx":2162
  *             t_h = 0 # reset time high dimension
  *             t_l = 0 # reset time low dimension
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             # Initialize walkers
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":2053
+      /* "cssm.pyx":2165
  * 
  *             # Initialize walkers
  *             y_h = (-1) * boundary_view[0] + (z_h_view[k] * 2 * (boundary_view[0]))             # <<<<<<<<<<<<<<
  *             bias_trace_view[0] = ((y_h + boundary_view[0]) / (2 * boundary_view[0]))
  * 
  */
       __pyx_t_21 = 0;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_19 = 0;
       __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_h_view.data + __pyx_t_20 * __pyx_v_z_h_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":2054
+      /* "cssm.pyx":2166
  *             # Initialize walkers
  *             y_h = (-1) * boundary_view[0] + (z_h_view[k] * 2 * (boundary_view[0]))
  *             bias_trace_view[0] = ((y_h + boundary_view[0]) / (2 * boundary_view[0]))             # <<<<<<<<<<<<<<
  * 
  *             # Random walks until y_h hits bound
  */
       __pyx_t_19 = 0;
       __pyx_t_20 = 0;
       __pyx_t_21 = 0;
       *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_21 * __pyx_v_bias_trace_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":2057
+      /* "cssm.pyx":2169
  * 
  *             # Random walks until y_h hits bound
  *             while (y_h >= ((-1) * boundary_view[ix])) and ((y_h <= boundary_view[ix])) and (t_h <= max_t):             # <<<<<<<<<<<<<<
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))
  */
       while (1) {
@@ -31153,340 +32652,340 @@
           goto __pyx_L16_bool_binop_done;
         }
         __pyx_t_22 = ((__pyx_v_t_h <= __pyx_v_max_t) != 0);
         __pyx_t_18 = __pyx_t_22;
         __pyx_L16_bool_binop_done:;
         if (!__pyx_t_18) break;
 
-        /* "cssm.pyx":2058
+        /* "cssm.pyx":2170
  *             # Random walks until y_h hits bound
  *             while (y_h >= ((-1) * boundary_view[ix])) and ((y_h <= boundary_view[ix])) and (t_h <= max_t):
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))
  *                 t_h += delta_t
  */
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_19 = __pyx_v_m;
         __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_v_h_view.data + __pyx_t_20 * __pyx_v_v_h_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":2059
+        /* "cssm.pyx":2171
  *             while (y_h >= ((-1) * boundary_view[ix])) and ((y_h <= boundary_view[ix])) and (t_h <= max_t):
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))             # <<<<<<<<<<<<<<
  *                 t_h += delta_t
  *                 ix += 1
  */
         __pyx_t_19 = __pyx_v_ix;
         __pyx_t_20 = __pyx_v_ix;
         __pyx_t_21 = __pyx_v_ix;
         *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_21 * __pyx_v_bias_trace_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
 
-        /* "cssm.pyx":2060
+        /* "cssm.pyx":2172
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))
  *                 t_h += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_h = (__pyx_v_t_h + __pyx_v_delta_t);
 
-        /* "cssm.pyx":2061
+        /* "cssm.pyx":2173
  *                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))
  *                 t_h += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  *                 if m == num_draws:
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":2062
+        /* "cssm.pyx":2174
  *                 t_h += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":2063
+        /* "cssm.pyx":2175
  *                 ix += 1
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_18 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":2064
+          /* "cssm.pyx":2176
  *                 m += 1
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2064, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2176, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":2065
+          /* "cssm.pyx":2177
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             # The probability of making a 'mistake' 1 - (relative y position)
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":2063
+          /* "cssm.pyx":2175
  *                 ix += 1
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":2070
+      /* "cssm.pyx":2182
  *             # y at upper bound --> choices_view[n, k, 0] add 2 deterministically
  *             # y at lower bound --> choice_view[n, k, 0] stay the same deterministically
  *             if random_uniform() <= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] += 2
  * 
  */
       __pyx_t_20 = __pyx_v_ix;
       __pyx_t_19 = __pyx_v_ix;
       __pyx_t_18 = ((__pyx_f_4cssm_random_uniform() <= ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))))) != 0);
       if (__pyx_t_18) {
 
-        /* "cssm.pyx":2071
+        /* "cssm.pyx":2183
  *             # y at lower bound --> choice_view[n, k, 0] stay the same deterministically
  *             if random_uniform() <= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):
  *                 choices_view[n, k, 0] += 2             # <<<<<<<<<<<<<<
  * 
  *             if choices_view[n, k, 0] == 2:
  */
         __pyx_t_19 = __pyx_v_n;
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_21 = 0;
         *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) += 2;
 
-        /* "cssm.pyx":2070
+        /* "cssm.pyx":2182
  *             # y at upper bound --> choices_view[n, k, 0] add 2 deterministically
  *             # y at lower bound --> choice_view[n, k, 0] stay the same deterministically
  *             if random_uniform() <= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] += 2
  * 
  */
       }
 
-      /* "cssm.pyx":2073
+      /* "cssm.pyx":2185
  *                 choices_view[n, k, 0] += 2
  * 
  *             if choices_view[n, k, 0] == 2:             # <<<<<<<<<<<<<<
  *                 y_l = (- 1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_2_view[k]
  */
       __pyx_t_21 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_19 = 0;
       __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 2) != 0);
       if (__pyx_t_18) {
 
-        /* "cssm.pyx":2074
+        /* "cssm.pyx":2186
  * 
  *             if choices_view[n, k, 0] == 2:
  *                 y_l = (- 1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))             # <<<<<<<<<<<<<<
  *                 v_l = v_l_2_view[k]
  * 
  */
         __pyx_t_19 = 0;
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_21 = 0;
         __pyx_v_y_l = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_l_2_view.data + __pyx_t_20 * __pyx_v_z_l_2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))));
 
-        /* "cssm.pyx":2075
+        /* "cssm.pyx":2187
  *             if choices_view[n, k, 0] == 2:
  *                 y_l = (- 1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_2_view[k]             # <<<<<<<<<<<<<<
  * 
  *                 # Fill bias trace until max_rt reached
  */
         __pyx_t_21 = __pyx_v_k;
         __pyx_v_v_l = (*((float *) ( /* dim=0 */ (__pyx_v_v_l_2_view.data + __pyx_t_21 * __pyx_v_v_l_2_view.strides[0]) )));
 
-        /* "cssm.pyx":2078
+        /* "cssm.pyx":2190
  * 
  *                 # Fill bias trace until max_rt reached
  *                 ix_tmp = ix + 1             # <<<<<<<<<<<<<<
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0
  */
         __pyx_v_ix_tmp = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":2079
+        /* "cssm.pyx":2191
  *                 # Fill bias trace until max_rt reached
  *                 ix_tmp = ix + 1
  *                 while ix_tmp < num_draws:             # <<<<<<<<<<<<<<
  *                     bias_trace_view[ix_tmp] = 1.0
  *                     ix_tmp += 1
  */
         while (1) {
           __pyx_t_18 = ((__pyx_v_ix_tmp < __pyx_v_num_draws) != 0);
           if (!__pyx_t_18) break;
 
-          /* "cssm.pyx":2080
+          /* "cssm.pyx":2192
  *                 ix_tmp = ix + 1
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0             # <<<<<<<<<<<<<<
  *                     ix_tmp += 1
  * 
  */
           __pyx_t_21 = __pyx_v_ix_tmp;
           *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_21 * __pyx_v_bias_trace_view.strides[0]) )) = 1.0;
 
-          /* "cssm.pyx":2081
+          /* "cssm.pyx":2193
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0
  *                     ix_tmp += 1             # <<<<<<<<<<<<<<
  * 
  *             else: # Store intermediate choice
  */
           __pyx_v_ix_tmp = (__pyx_v_ix_tmp + 1);
         }
 
-        /* "cssm.pyx":2073
+        /* "cssm.pyx":2185
  *                 choices_view[n, k, 0] += 2
  * 
  *             if choices_view[n, k, 0] == 2:             # <<<<<<<<<<<<<<
  *                 y_l = (- 1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_2_view[k]
  */
         goto __pyx_L21;
       }
 
-      /* "cssm.pyx":2084
+      /* "cssm.pyx":2196
  * 
  *             else: # Store intermediate choice
  *                 y_l = (- 1) * boundary_view[0] + (z_l_1_view[k] * 2 * (boundary_view[0]))             # <<<<<<<<<<<<<<
  *                 v_l = v_l_1_view[k]
  * 
  */
       /*else*/ {
         __pyx_t_21 = 0;
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_19 = 0;
         __pyx_v_y_l = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_l_1_view.data + __pyx_t_20 * __pyx_v_z_l_1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
 
-        /* "cssm.pyx":2085
+        /* "cssm.pyx":2197
  *             else: # Store intermediate choice
  *                 y_l = (- 1) * boundary_view[0] + (z_l_1_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_1_view[k]             # <<<<<<<<<<<<<<
  * 
  *                 # Fill bias trace until max_rt reached
  */
         __pyx_t_19 = __pyx_v_k;
         __pyx_v_v_l = (*((float *) ( /* dim=0 */ (__pyx_v_v_l_1_view.data + __pyx_t_19 * __pyx_v_v_l_1_view.strides[0]) )));
 
-        /* "cssm.pyx":2088
+        /* "cssm.pyx":2200
  * 
  *                 # Fill bias trace until max_rt reached
  *                 ix_tmp = ix + 1             # <<<<<<<<<<<<<<
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 0.0
  */
         __pyx_v_ix_tmp = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":2089
+        /* "cssm.pyx":2201
  *                 # Fill bias trace until max_rt reached
  *                 ix_tmp = ix + 1
  *                 while ix_tmp < num_draws:             # <<<<<<<<<<<<<<
  *                     bias_trace_view[ix_tmp] = 0.0
  *                     ix_tmp += 1
  */
         while (1) {
           __pyx_t_18 = ((__pyx_v_ix_tmp < __pyx_v_num_draws) != 0);
           if (!__pyx_t_18) break;
 
-          /* "cssm.pyx":2090
+          /* "cssm.pyx":2202
  *                 ix_tmp = ix + 1
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 0.0             # <<<<<<<<<<<<<<
  *                     ix_tmp += 1
  * 
  */
           __pyx_t_19 = __pyx_v_ix_tmp;
           *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_19 * __pyx_v_bias_trace_view.strides[0]) )) = 0.0;
 
-          /* "cssm.pyx":2091
+          /* "cssm.pyx":2203
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 0.0
  *                     ix_tmp += 1             # <<<<<<<<<<<<<<
  * 
  *                 #We need to reverse the bias_trace if we took the lower choice
  */
           __pyx_v_ix_tmp = (__pyx_v_ix_tmp + 1);
         }
 
-        /* "cssm.pyx":2094
+        /* "cssm.pyx":2206
  * 
  *                 #We need to reverse the bias_trace if we took the lower choice
  *                 ix_tmp = 0             # <<<<<<<<<<<<<<
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0 - bias_trace_view[ix_tmp]
  */
         __pyx_v_ix_tmp = 0;
 
-        /* "cssm.pyx":2095
+        /* "cssm.pyx":2207
  *                 #We need to reverse the bias_trace if we took the lower choice
  *                 ix_tmp = 0
  *                 while ix_tmp < num_draws:             # <<<<<<<<<<<<<<
  *                     bias_trace_view[ix_tmp] = 1.0 - bias_trace_view[ix_tmp]
  *                     ix_tmp += 1
  */
         while (1) {
           __pyx_t_18 = ((__pyx_v_ix_tmp < __pyx_v_num_draws) != 0);
           if (!__pyx_t_18) break;
 
-          /* "cssm.pyx":2096
+          /* "cssm.pyx":2208
  *                 ix_tmp = 0
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0 - bias_trace_view[ix_tmp]             # <<<<<<<<<<<<<<
  *                     ix_tmp += 1
  * 
  */
           __pyx_t_19 = __pyx_v_ix_tmp;
           __pyx_t_20 = __pyx_v_ix_tmp;
           *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_20 * __pyx_v_bias_trace_view.strides[0]) )) = (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_19 * __pyx_v_bias_trace_view.strides[0]) ))));
 
-          /* "cssm.pyx":2097
+          /* "cssm.pyx":2209
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0 - bias_trace_view[ix_tmp]
  *                     ix_tmp += 1             # <<<<<<<<<<<<<<
  * 
  *                 #print('new bias_trace: ', bias_trace)
  */
           __pyx_v_ix_tmp = (__pyx_v_ix_tmp + 1);
         }
       }
       __pyx_L21:;
 
-      /* "cssm.pyx":2102
+      /* "cssm.pyx":2214
  * 
  *             # Random walks until the y_l corresponding to y_h hits bound
  *             ix = 0             # <<<<<<<<<<<<<<
  *             while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_l <= max_t):
  *                 if (bias_trace_view[ix] < 1) and (bias_trace_view[ix] > 0):
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":2103
+      /* "cssm.pyx":2215
  *             # Random walks until the y_l corresponding to y_h hits bound
  *             ix = 0
  *             while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_l <= max_t):             # <<<<<<<<<<<<<<
  *                 if (bias_trace_view[ix] < 1) and (bias_trace_view[ix] > 0):
  *                     y_l += ((v_l * bias_trace_view[ix] * d_view[k]) * delta_t)
  */
       while (1) {
@@ -31505,15 +33004,15 @@
           goto __pyx_L30_bool_binop_done;
         }
         __pyx_t_22 = ((__pyx_v_t_l <= __pyx_v_max_t) != 0);
         __pyx_t_18 = __pyx_t_22;
         __pyx_L30_bool_binop_done:;
         if (!__pyx_t_18) break;
 
-        /* "cssm.pyx":2104
+        /* "cssm.pyx":2216
  *             ix = 0
  *             while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_l <= max_t):
  *                 if (bias_trace_view[ix] < 1) and (bias_trace_view[ix] > 0):             # <<<<<<<<<<<<<<
  *                     y_l += ((v_l * bias_trace_view[ix] * d_view[k]) * delta_t)
  *                 else:
  */
         __pyx_t_19 = __pyx_v_ix;
@@ -31525,381 +33024,381 @@
         }
         __pyx_t_19 = __pyx_v_ix;
         __pyx_t_22 = (((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_19 * __pyx_v_bias_trace_view.strides[0]) ))) > 0.0) != 0);
         __pyx_t_18 = __pyx_t_22;
         __pyx_L34_bool_binop_done:;
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":2105
+          /* "cssm.pyx":2217
  *             while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_l <= max_t):
  *                 if (bias_trace_view[ix] < 1) and (bias_trace_view[ix] > 0):
  *                     y_l += ((v_l * bias_trace_view[ix] * d_view[k]) * delta_t)             # <<<<<<<<<<<<<<
  *                 else:
  *                     y_l += (v_l * delta_t)
  */
           __pyx_t_19 = __pyx_v_ix;
           __pyx_t_20 = __pyx_v_k;
           __pyx_v_y_l = (__pyx_v_y_l + (((__pyx_v_v_l * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_19 * __pyx_v_bias_trace_view.strides[0]) )))) * (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_20 * __pyx_v_d_view.strides[0]) )))) * __pyx_v_delta_t));
 
-          /* "cssm.pyx":2104
+          /* "cssm.pyx":2216
  *             ix = 0
  *             while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_l <= max_t):
  *                 if (bias_trace_view[ix] < 1) and (bias_trace_view[ix] > 0):             # <<<<<<<<<<<<<<
  *                     y_l += ((v_l * bias_trace_view[ix] * d_view[k]) * delta_t)
  *                 else:
  */
           goto __pyx_L33;
         }
 
-        /* "cssm.pyx":2107
+        /* "cssm.pyx":2219
  *                     y_l += ((v_l * bias_trace_view[ix] * d_view[k]) * delta_t)
  *                 else:
  *                     y_l += (v_l * delta_t)             # <<<<<<<<<<<<<<
  *                 y_l += (sqrt_st * gaussian_values[m])
  * 
  */
         /*else*/ {
           __pyx_v_y_l = (__pyx_v_y_l + (__pyx_v_v_l * __pyx_v_delta_t));
         }
         __pyx_L33:;
 
-        /* "cssm.pyx":2108
+        /* "cssm.pyx":2220
  *                 else:
  *                     y_l += (v_l * delta_t)
  *                 y_l += (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  * 
  *                 t_l += delta_t
  */
         __pyx_t_20 = __pyx_v_m;
         __pyx_v_y_l = (__pyx_v_y_l + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) )))));
 
-        /* "cssm.pyx":2110
+        /* "cssm.pyx":2222
  *                 y_l += (sqrt_st * gaussian_values[m])
  * 
  *                 t_l += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_l = (__pyx_v_t_l + __pyx_v_delta_t);
 
-        /* "cssm.pyx":2111
+        /* "cssm.pyx":2223
  * 
  *                 t_l += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  *                 if m == num_draws:
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":2112
+        /* "cssm.pyx":2224
  *                 t_l += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":2113
+        /* "cssm.pyx":2225
  *                 ix += 1
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_18 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":2114
+          /* "cssm.pyx":2226
  *                 m += 1
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2114, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2226, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":2115
+          /* "cssm.pyx":2227
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":2113
+          /* "cssm.pyx":2225
  *                 ix += 1
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":2117
+      /* "cssm.pyx":2229
  *                     m = 0
  * 
  *             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]             # <<<<<<<<<<<<<<
  * 
  *             # The probability of making a 'mistake' 1 - (relative y position)
  */
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_19 = __pyx_v_n;
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_23 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_19 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_23 * __pyx_v_rts_view.strides[2]) )) = (fmax(__pyx_v_t_h, __pyx_v_t_l) + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":2122
+      /* "cssm.pyx":2234
  *             # y at upper bound --> choices_view[n, k, 0] add one deterministically
  *             # y at lower bound --> choice_view[n, k, 0] stays the same deterministically
  *             if random_uniform() <= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] += 1
  * 
  */
       __pyx_t_20 = __pyx_v_ix;
       __pyx_t_23 = __pyx_v_ix;
       __pyx_t_18 = ((__pyx_f_4cssm_random_uniform() <= ((__pyx_v_y_l + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_23 * __pyx_v_boundary_view.strides[0]) )))))) != 0);
       if (__pyx_t_18) {
 
-        /* "cssm.pyx":2123
+        /* "cssm.pyx":2235
  *             # y at lower bound --> choice_view[n, k, 0] stays the same deterministically
  *             if random_uniform() <= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):
  *                 choices_view[n, k, 0] += 1             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  */
         __pyx_t_23 = __pyx_v_n;
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_21 = 0;
         *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_23 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) += 1;
 
-        /* "cssm.pyx":2122
+        /* "cssm.pyx":2234
  *             # y at upper bound --> choices_view[n, k, 0] add one deterministically
  *             # y at lower bound --> choice_view[n, k, 0] stays the same deterministically
  *             if random_uniform() <= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] += 1
  * 
  */
       }
     }
   }
 
-  /* "cssm.pyx":2125
+  /* "cssm.pyx":2237
  *                 choices_view[n, k, 0] += 1
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,             # <<<<<<<<<<<<<<
  *                                                          'vl1': v_l_1,
  *                                                          'vl2': v_l_2,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2125, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2237, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2237, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vh, ((PyObject *)__pyx_v_v_h)) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vh, ((PyObject *)__pyx_v_v_h)) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
 
-  /* "cssm.pyx":2126
+  /* "cssm.pyx":2238
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  *                                                          'vl1': v_l_1,             # <<<<<<<<<<<<<<
  *                                                          'vl2': v_l_2,
  *                                                          'a': a,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl1, ((PyObject *)__pyx_v_v_l_1)) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl1, ((PyObject *)__pyx_v_v_l_1)) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
 
-  /* "cssm.pyx":2127
+  /* "cssm.pyx":2239
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  *                                                          'vl1': v_l_1,
  *                                                          'vl2': v_l_2,             # <<<<<<<<<<<<<<
  *                                                          'a': a,
  *                                                          'zh': z_h,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl2, ((PyObject *)__pyx_v_v_l_2)) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl2, ((PyObject *)__pyx_v_v_l_2)) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
 
-  /* "cssm.pyx":2128
+  /* "cssm.pyx":2240
  *                                                          'vl1': v_l_1,
  *                                                          'vl2': v_l_2,
  *                                                          'a': a,             # <<<<<<<<<<<<<<
  *                                                          'zh': z_h,
  *                                                          'zl1': z_l_1,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
 
-  /* "cssm.pyx":2129
+  /* "cssm.pyx":2241
  *                                                          'vl2': v_l_2,
  *                                                          'a': a,
  *                                                          'zh': z_h,             # <<<<<<<<<<<<<<
  *                                                          'zl1': z_l_1,
  *                                                          'zl2': z_l_2,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zh, ((PyObject *)__pyx_v_z_h)) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zh, ((PyObject *)__pyx_v_z_h)) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
 
-  /* "cssm.pyx":2130
+  /* "cssm.pyx":2242
  *                                                          'a': a,
  *                                                          'zh': z_h,
  *                                                          'zl1': z_l_1,             # <<<<<<<<<<<<<<
  *                                                          'zl2': z_l_2,
  *                                                          'd': d,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl1, ((PyObject *)__pyx_v_z_l_1)) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl1, ((PyObject *)__pyx_v_z_l_1)) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
 
-  /* "cssm.pyx":2131
+  /* "cssm.pyx":2243
  *                                                          'zh': z_h,
  *                                                          'zl1': z_l_1,
  *                                                          'zl2': z_l_2,             # <<<<<<<<<<<<<<
  *                                                          'd': d,
  *                                                          't': t,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl2, ((PyObject *)__pyx_v_z_l_2)) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl2, ((PyObject *)__pyx_v_z_l_2)) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
 
-  /* "cssm.pyx":2132
+  /* "cssm.pyx":2244
  *                                                          'zl1': z_l_1,
  *                                                          'zl2': z_l_2,
  *                                                          'd': d,             # <<<<<<<<<<<<<<
  *                                                          't': t,
  *                                                          's': s,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_d, ((PyObject *)__pyx_v_d)) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_d, ((PyObject *)__pyx_v_d)) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
 
-  /* "cssm.pyx":2133
+  /* "cssm.pyx":2245
  *                                                          'zl2': z_l_2,
  *                                                          'd': d,
  *                                                          't': t,             # <<<<<<<<<<<<<<
  *                                                          's': s,
  *                                                          **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
 
-  /* "cssm.pyx":2134
+  /* "cssm.pyx":2246
  *                                                          'd': d,
  *                                                          't': t,
  *                                                          's': s,             # <<<<<<<<<<<<<<
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2134, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2246, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_1) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_1) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_9 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":2135
+  /* "cssm.pyx":2247
  *                                                          't': t,
  *                                                          's': s,
  *                                                          **boundary_params,             # <<<<<<<<<<<<<<
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 2135, __pyx_L1_error)
+    __PYX_ERR(0, 2247, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_9, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 2135, __pyx_L1_error)
+    __PYX_ERR(0, 2247, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":2136
+  /* "cssm.pyx":2248
  *                                                          's': s,
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2136, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2248, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 2136, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 2248, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":2137
+  /* "cssm.pyx":2249
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                          'n_samples': n_samples,
  *                                                          'simulator': 'ddm_flexbound_mic2_adj',
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2137, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2249, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 2137, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 2249, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":2138
+  /* "cssm.pyx":2250
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                          'simulator': 'ddm_flexbound_mic2_adj',
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2138, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2250, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 2138, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 2250, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) < 0) __PYX_ERR(0, 2139, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) < 0) __PYX_ERR(0, 2251, __pyx_L1_error)
 
-  /* "cssm.pyx":2140
+  /* "cssm.pyx":2252
  *                                                          'n_samples': n_samples,
  *                                                          'simulator': 'ddm_flexbound_mic2_adj',
  *                                                          'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                          'possible_choices': [0, 1, 2, 3],
  *                                                          'trajectory': 'This simulator does not yet allow for trajectory simulation',
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2140, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2252, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary_fun_type, __pyx_t_3) < 0) __PYX_ERR(0, 2140, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary_fun_type, __pyx_t_3) < 0) __PYX_ERR(0, 2252, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":2141
+  /* "cssm.pyx":2253
  *                                                          'simulator': 'ddm_flexbound_mic2_adj',
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  *                                                          'possible_choices': [0, 1, 2, 3],             # <<<<<<<<<<<<<<
  *                                                          'trajectory': 'This simulator does not yet allow for trajectory simulation',
  *                                                          'boundary': boundary}}
  */
-  __pyx_t_3 = PyList_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2141, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2253, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyList_SET_ITEM(__pyx_t_3, 2, __pyx_int_2);
   __Pyx_INCREF(__pyx_int_3);
   __Pyx_GIVEREF(__pyx_int_3);
   PyList_SET_ITEM(__pyx_t_3, 3, __pyx_int_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 2141, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 2253, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_trajectory, __pyx_kp_u_This_simulator_does_not_yet_allo) < 0) __PYX_ERR(0, 2142, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_trajectory, __pyx_kp_u_This_simulator_does_not_yet_allo) < 0) __PYX_ERR(0, 2254, __pyx_L1_error)
 
-  /* "cssm.pyx":2143
+  /* "cssm.pyx":2255
  *                                                          'possible_choices': [0, 1, 2, 3],
  *                                                          'trajectory': 'This simulator does not yet allow for trajectory simulation',
  *                                                          'boundary': boundary}}             # <<<<<<<<<<<<<<
  * # -----------------------------------------------------------------------------------------------
  * 
  */
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 2143, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_9) < 0) __PYX_ERR(0, 2125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 2255, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_9) < 0) __PYX_ERR(0, 2237, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":1976
+  /* "cssm.pyx":2088
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_mic2_adj(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                            np.ndarray[float, ndim = 1] v_l_1,
  *                            np.ndarray[float, ndim = 1] v_l_2,
  */
 
@@ -31959,32 +33458,32 @@
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __Pyx_XDECREF(__pyx_v_bias_trace);
   __PYX_XDEC_MEMVIEW(&__pyx_v_bias_trace_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
-  __Pyx_XDECREF(__pyx_9genexpr12__pyx_v_key);
+  __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "cssm.pyx":2149
+/* "cssm.pyx":2261
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_tradeoff(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                            np.ndarray[float, ndim = 1] v_l_1,
  *                            np.ndarray[float, ndim = 1] v_l_2,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_4cssm_35ddm_flexbound_tradeoff(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_4cssm_35ddm_flexbound_tradeoff = {"ddm_flexbound_tradeoff", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_35ddm_flexbound_tradeoff, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_4cssm_35ddm_flexbound_tradeoff(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_4cssm_37ddm_flexbound_tradeoff(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_4cssm_37ddm_flexbound_tradeoff = {"ddm_flexbound_tradeoff", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4cssm_37ddm_flexbound_tradeoff, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_4cssm_37ddm_flexbound_tradeoff(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_v_h = 0;
   PyArrayObject *__pyx_v_v_l_1 = 0;
   PyArrayObject *__pyx_v_v_l_2 = 0;
   PyArrayObject *__pyx_v_a = 0;
   PyArrayObject *__pyx_v_z_h = 0;
   PyArrayObject *__pyx_v_z_l_1 = 0;
   PyArrayObject *__pyx_v_z_l_2 = 0;
@@ -32006,43 +33505,43 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ddm_flexbound_tradeoff (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v_h,&__pyx_n_s_v_l_1,&__pyx_n_s_v_l_2,&__pyx_n_s_a,&__pyx_n_s_z_h,&__pyx_n_s_z_l_1,&__pyx_n_s_z_l_2,&__pyx_n_s_d,&__pyx_n_s_t,&__pyx_n_s_s,&__pyx_n_s_delta_t,&__pyx_n_s_max_t,&__pyx_n_s_n_samples,&__pyx_n_s_n_trials,&__pyx_n_s_print_info,&__pyx_n_s_boundary_fun,&__pyx_n_s_boundary_multiplicative,&__pyx_n_s_boundary_params,&__pyx_n_s_random_state,0};
     PyObject* values[19] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 
-    /* "cssm.pyx":2163
+    /* "cssm.pyx":2275
  *                            int n_samples = 20000,
  *                            int n_trials = 1,
  *                            print_info = True,             # <<<<<<<<<<<<<<
  *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                            boundary_multiplicative = True,
  */
     values[14] = ((PyObject *)Py_True);
 
-    /* "cssm.pyx":2164
+    /* "cssm.pyx":2276
  *                            int n_trials = 1,
  *                            print_info = True,
  *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)             # <<<<<<<<<<<<<<
  *                            boundary_multiplicative = True,
  *                            boundary_params = {},
  */
     values[15] = ((PyObject *)Py_None);
 
-    /* "cssm.pyx":2165
+    /* "cssm.pyx":2277
  *                            print_info = True,
  *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                            boundary_multiplicative = True,             # <<<<<<<<<<<<<<
  *                            boundary_params = {},
  *                            random_state = None,
  */
     values[16] = ((PyObject *)Py_True);
-    values[17] = __pyx_k__17;
+    values[17] = __pyx_k__18;
 
-    /* "cssm.pyx":2167
+    /* "cssm.pyx":2279
  *                            boundary_multiplicative = True,
  *                            boundary_params = {},
  *                            random_state = None,             # <<<<<<<<<<<<<<
  *                            ):
  * 
  */
     values[18] = ((PyObject *)Py_None);
@@ -32096,57 +33595,57 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_h)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_l_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 1); __PYX_ERR(0, 2149, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 1); __PYX_ERR(0, 2261, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v_l_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 2); __PYX_ERR(0, 2149, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 2); __PYX_ERR(0, 2261, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 3); __PYX_ERR(0, 2149, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 3); __PYX_ERR(0, 2261, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_h)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 4); __PYX_ERR(0, 2149, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 4); __PYX_ERR(0, 2261, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_l_1)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 5); __PYX_ERR(0, 2149, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 5); __PYX_ERR(0, 2261, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_l_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 6); __PYX_ERR(0, 2149, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 6); __PYX_ERR(0, 2261, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_d)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 7); __PYX_ERR(0, 2149, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 7); __PYX_ERR(0, 2261, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_t)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 8); __PYX_ERR(0, 2149, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, 8); __PYX_ERR(0, 2261, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_s);
           if (value) { values[9] = value; kw_args--; }
         }
@@ -32202,15 +33701,15 @@
         case 18:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_random_state);
           if (value) { values[18] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_tradeoff") < 0)) __PYX_ERR(0, 2149, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ddm_flexbound_tradeoff") < 0)) __PYX_ERR(0, 2261, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 19: values[18] = PyTuple_GET_ITEM(__pyx_args, 18);
         CYTHON_FALLTHROUGH;
         case 18: values[17] = PyTuple_GET_ITEM(__pyx_args, 17);
         CYTHON_FALLTHROUGH;
@@ -32249,64 +33748,64 @@
     __pyx_v_a = ((PyArrayObject *)values[3]);
     __pyx_v_z_h = ((PyArrayObject *)values[4]);
     __pyx_v_z_l_1 = ((PyArrayObject *)values[5]);
     __pyx_v_z_l_2 = ((PyArrayObject *)values[6]);
     __pyx_v_d = ((PyArrayObject *)values[7]);
     __pyx_v_t = ((PyArrayObject *)values[8]);
     if (values[9]) {
-      __pyx_v_s = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 2158, __pyx_L3_error)
+      __pyx_v_s = __pyx_PyFloat_AsFloat(values[9]); if (unlikely((__pyx_v_s == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 2270, __pyx_L3_error)
     } else {
       __pyx_v_s = ((float)1.0);
     }
     if (values[10]) {
-      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[10]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 2159, __pyx_L3_error)
+      __pyx_v_delta_t = __pyx_PyFloat_AsFloat(values[10]); if (unlikely((__pyx_v_delta_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 2271, __pyx_L3_error)
     } else {
       __pyx_v_delta_t = ((float)0.001);
     }
     if (values[11]) {
-      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[11]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 2160, __pyx_L3_error)
+      __pyx_v_max_t = __pyx_PyFloat_AsFloat(values[11]); if (unlikely((__pyx_v_max_t == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 2272, __pyx_L3_error)
     } else {
       __pyx_v_max_t = ((float)20.0);
     }
     if (values[12]) {
-      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[12]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2161, __pyx_L3_error)
+      __pyx_v_n_samples = __Pyx_PyInt_As_int(values[12]); if (unlikely((__pyx_v_n_samples == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2273, __pyx_L3_error)
     } else {
       __pyx_v_n_samples = ((int)0x4E20);
     }
     if (values[13]) {
-      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[13]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2162, __pyx_L3_error)
+      __pyx_v_n_trials = __Pyx_PyInt_As_int(values[13]); if (unlikely((__pyx_v_n_trials == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 2274, __pyx_L3_error)
     } else {
       __pyx_v_n_trials = ((int)1);
     }
     __pyx_v_print_info = values[14];
     __pyx_v_boundary_fun = values[15];
     __pyx_v_boundary_multiplicative = values[16];
     __pyx_v_boundary_params = values[17];
     __pyx_v_random_state = values[18];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 2149, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("ddm_flexbound_tradeoff", 0, 9, 19, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 2261, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("cssm.ddm_flexbound_tradeoff", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_h), __pyx_ptype_5numpy_ndarray, 1, "v_h", 0))) __PYX_ERR(0, 2149, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_1), __pyx_ptype_5numpy_ndarray, 1, "v_l_1", 0))) __PYX_ERR(0, 2150, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_2), __pyx_ptype_5numpy_ndarray, 1, "v_l_2", 0))) __PYX_ERR(0, 2151, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 2152, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_h), __pyx_ptype_5numpy_ndarray, 1, "z_h", 0))) __PYX_ERR(0, 2153, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_1), __pyx_ptype_5numpy_ndarray, 1, "z_l_1", 0))) __PYX_ERR(0, 2154, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_2), __pyx_ptype_5numpy_ndarray, 1, "z_l_2", 0))) __PYX_ERR(0, 2155, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_d), __pyx_ptype_5numpy_ndarray, 1, "d", 0))) __PYX_ERR(0, 2156, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 2157, __pyx_L1_error)
-  __pyx_r = __pyx_pf_4cssm_34ddm_flexbound_tradeoff(__pyx_self, __pyx_v_v_h, __pyx_v_v_l_1, __pyx_v_v_l_2, __pyx_v_a, __pyx_v_z_h, __pyx_v_z_l_1, __pyx_v_z_l_2, __pyx_v_d, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_h), __pyx_ptype_5numpy_ndarray, 1, "v_h", 0))) __PYX_ERR(0, 2261, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_1), __pyx_ptype_5numpy_ndarray, 1, "v_l_1", 0))) __PYX_ERR(0, 2262, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v_l_2), __pyx_ptype_5numpy_ndarray, 1, "v_l_2", 0))) __PYX_ERR(0, 2263, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) __PYX_ERR(0, 2264, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_h), __pyx_ptype_5numpy_ndarray, 1, "z_h", 0))) __PYX_ERR(0, 2265, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_1), __pyx_ptype_5numpy_ndarray, 1, "z_l_1", 0))) __PYX_ERR(0, 2266, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_l_2), __pyx_ptype_5numpy_ndarray, 1, "z_l_2", 0))) __PYX_ERR(0, 2267, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_d), __pyx_ptype_5numpy_ndarray, 1, "d", 0))) __PYX_ERR(0, 2268, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) __PYX_ERR(0, 2269, __pyx_L1_error)
+  __pyx_r = __pyx_pf_4cssm_36ddm_flexbound_tradeoff(__pyx_self, __pyx_v_v_h, __pyx_v_v_l_1, __pyx_v_v_l_2, __pyx_v_a, __pyx_v_z_h, __pyx_v_z_l_1, __pyx_v_z_l_2, __pyx_v_d, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state);
 
-  /* "cssm.pyx":2149
+  /* "cssm.pyx":2261
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_tradeoff(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                            np.ndarray[float, ndim = 1] v_l_1,
  *                            np.ndarray[float, ndim = 1] v_l_2,
  */
 
@@ -32315,15 +33814,15 @@
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_4cssm_34ddm_flexbound_tradeoff(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
+static PyObject *__pyx_pf_4cssm_36ddm_flexbound_tradeoff(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_h, PyArrayObject *__pyx_v_v_l_1, PyArrayObject *__pyx_v_v_l_2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z_h, PyArrayObject *__pyx_v_z_l_1, PyArrayObject *__pyx_v_z_l_2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state) {
   __Pyx_memviewslice __pyx_v_v_h_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_v_l_1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_v_l_2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_h_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_l_1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_v_z_l_2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -32350,15 +33849,15 @@
   Py_ssize_t __pyx_v_n;
   Py_ssize_t __pyx_v_ix;
   Py_ssize_t __pyx_v_ix_tmp;
   Py_ssize_t __pyx_v_k;
   Py_ssize_t __pyx_v_m;
   __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_boundary_params_tmp = NULL;
-  PyObject *__pyx_9genexpr13__pyx_v_key = NULL;
+  PyObject *__pyx_9genexpr14__pyx_v_key = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
   __Pyx_Buffer __pyx_pybuffer_a;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_d;
   __Pyx_Buffer __pyx_pybuffer_d;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
   __Pyx_Buffer __pyx_pybuffer_t;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_v_h;
@@ -32436,338 +33935,338 @@
   __pyx_pybuffernd_d.rcbuffer = &__pyx_pybuffer_d;
   __pyx_pybuffer_t.pybuffer.buf = NULL;
   __pyx_pybuffer_t.refcount = 0;
   __pyx_pybuffernd_t.data = NULL;
   __pyx_pybuffernd_t.rcbuffer = &__pyx_pybuffer_t;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2149, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2261, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_h.diminfo[0].strides = __pyx_pybuffernd_v_h.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_h.diminfo[0].shape = __pyx_pybuffernd_v_h.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2149, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2261, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_l_1.diminfo[0].strides = __pyx_pybuffernd_v_l_1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_l_1.diminfo[0].shape = __pyx_pybuffernd_v_l_1.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2149, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_v_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_v_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2261, __pyx_L1_error)
   }
   __pyx_pybuffernd_v_l_2.diminfo[0].strides = __pyx_pybuffernd_v_l_2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_v_l_2.diminfo[0].shape = __pyx_pybuffernd_v_l_2.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2149, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2261, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2149, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_h.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_h, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2261, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_h.diminfo[0].strides = __pyx_pybuffernd_z_h.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_h.diminfo[0].shape = __pyx_pybuffernd_z_h.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2149, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_1.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_1, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2261, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_l_1.diminfo[0].strides = __pyx_pybuffernd_z_l_1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_l_1.diminfo[0].shape = __pyx_pybuffernd_z_l_1.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2149, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_l_2.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_l_2, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2261, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_l_2.diminfo[0].strides = __pyx_pybuffernd_z_l_2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_l_2.diminfo[0].shape = __pyx_pybuffernd_z_l_2.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_d.rcbuffer->pybuffer, (PyObject*)__pyx_v_d, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2149, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_d.rcbuffer->pybuffer, (PyObject*)__pyx_v_d, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2261, __pyx_L1_error)
   }
   __pyx_pybuffernd_d.diminfo[0].strides = __pyx_pybuffernd_d.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_d.diminfo[0].shape = __pyx_pybuffernd_d.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2149, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_t.rcbuffer->pybuffer, (PyObject*)__pyx_v_t, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 2261, __pyx_L1_error)
   }
   __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer->pybuffer.shape[0];
 
-  /* "cssm.pyx":2170
+  /* "cssm.pyx":2282
  *                            ):
  * 
  *     set_seed(random_state)             # <<<<<<<<<<<<<<
  *     # Param views
  *     cdef float[:] v_h_view = v_h
  */
-  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2170, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2282, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "cssm.pyx":2172
+  /* "cssm.pyx":2284
  *     set_seed(random_state)
  *     # Param views
  *     cdef float[:] v_h_view = v_h             # <<<<<<<<<<<<<<
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2172, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2284, __pyx_L1_error)
   __pyx_v_v_h_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2173
+  /* "cssm.pyx":2285
  *     # Param views
  *     cdef float[:] v_h_view = v_h
  *     cdef float[:] v_l_1_view = v_l_1             # <<<<<<<<<<<<<<
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2173, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2285, __pyx_L1_error)
   __pyx_v_v_l_1_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2174
+  /* "cssm.pyx":2286
  *     cdef float[:] v_h_view = v_h
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2             # <<<<<<<<<<<<<<
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2174, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_v_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2286, __pyx_L1_error)
   __pyx_v_v_l_2_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2175
+  /* "cssm.pyx":2287
  *     cdef float[:] v_l_1_view = v_l_1
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a             # <<<<<<<<<<<<<<
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2175, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_a), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2287, __pyx_L1_error)
   __pyx_v_a_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2176
+  /* "cssm.pyx":2288
  *     cdef float[:] v_l_2_view = v_l_2
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h             # <<<<<<<<<<<<<<
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2176, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_h), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2288, __pyx_L1_error)
   __pyx_v_z_h_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2177
+  /* "cssm.pyx":2289
  *     cdef float[:] a_view = a
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1             # <<<<<<<<<<<<<<
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] d_view = d
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2177, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_1), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2289, __pyx_L1_error)
   __pyx_v_z_l_1_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2178
+  /* "cssm.pyx":2290
  *     cdef float[:] z_h_view = z_h
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2             # <<<<<<<<<<<<<<
  *     cdef float[:] d_view = d
  *     cdef float[:] t_view = t
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2178, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_z_l_2), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2290, __pyx_L1_error)
   __pyx_v_z_l_2_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2179
+  /* "cssm.pyx":2291
  *     cdef float[:] z_l_1_view = z_l_1
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] d_view = d             # <<<<<<<<<<<<<<
  *     cdef float[:] t_view = t
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_d), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2179, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_d), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2291, __pyx_L1_error)
   __pyx_v_d_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2180
+  /* "cssm.pyx":2292
  *     cdef float[:] z_l_2_view = z_l_2
  *     cdef float[:] d_view = d
  *     cdef float[:] t_view = t             # <<<<<<<<<<<<<<
  * 
  *     # TD: Add trajectory --> same issue as with par2 model above... might need to make a separate simulator for trajectories
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2180, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(((PyObject *)__pyx_v_t), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2292, __pyx_L1_error)
   __pyx_v_t_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2184
+  /* "cssm.pyx":2296
  *     # TD: Add trajectory --> same issue as with par2 model above... might need to make a separate simulator for trajectories
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2184, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2184, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2184, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2184, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2184, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2184, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2184, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2184, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 2184, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 2296, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2184, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_rts = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "cssm.pyx":2185
+  /* "cssm.pyx":2297
  * 
  *     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)             # <<<<<<<<<<<<<<
  * 
  *     cdef float[:, :, :] rts_view = rts
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2185, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2185, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2185, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2185, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n_trials); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2185, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2185, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2185, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2185, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2185, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_intc); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 2185, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2185, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_choices = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "cssm.pyx":2187
+  /* "cssm.pyx":2299
  *     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
  * 
  *     cdef float[:, :, :] rts_view = rts             # <<<<<<<<<<<<<<
  *     cdef int[:, :, :] choices_view = choices
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2187, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_rts, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2299, __pyx_L1_error)
   __pyx_v_rts_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "cssm.pyx":2188
+  /* "cssm.pyx":2300
  * 
  *     cdef float[:, :, :] rts_view = rts
  *     cdef int[:, :, :] choices_view = choices             # <<<<<<<<<<<<<<
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 2188, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_int(__pyx_v_choices, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 2300, __pyx_L1_error)
   __pyx_v_choices_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "cssm.pyx":2190
+  /* "cssm.pyx":2302
  *     cdef int[:, :, :] choices_view = choices
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion             # <<<<<<<<<<<<<<
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
  * 
  */
   __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
 
-  /* "cssm.pyx":2191
+  /* "cssm.pyx":2303
  * 
  *     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
  *     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step             # <<<<<<<<<<<<<<
  * 
  *     # Boundary storage for the upper bound
  */
   __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
 
-  /* "cssm.pyx":2194
+  /* "cssm.pyx":2306
  * 
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)             # <<<<<<<<<<<<<<
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  */
   __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
 
-  /* "cssm.pyx":2195
+  /* "cssm.pyx":2307
  *     # Boundary storage for the upper bound
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)             # <<<<<<<<<<<<<<
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2195, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2307, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2195, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arange); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2307, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2195, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_max_t + __pyx_v_delta_t)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2307, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2195, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2307, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_9 = NULL;
   __pyx_t_10 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_9)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -32776,276 +34275,276 @@
       __Pyx_DECREF_SET(__pyx_t_5, function);
       __pyx_t_10 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_1};
-    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2195, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2307, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
     PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_1};
-    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2195, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2307, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else
   #endif
   {
-    __pyx_t_11 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2195, __pyx_L1_error)
+    __pyx_t_11 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2307, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     if (__pyx_t_9) {
       __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
     }
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_10, __pyx_int_0);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_10, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_10, __pyx_t_1);
     __pyx_t_4 = 0;
     __pyx_t_1 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2195, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2307, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2195, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2307, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2195, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2307, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_11 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_11)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_11);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_11, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2195, __pyx_L1_error)
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2307, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_t_s = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "cssm.pyx":2196
+  /* "cssm.pyx":2308
  *     cdef int num_draws = int((max_t / delta_t) + 1)
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] boundary_view = boundary
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2196, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2196, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2196, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_t_s, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2196, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2196, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2196, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 2196, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) < 0) __PYX_ERR(0, 2308, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2196, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2308, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_boundary = __pyx_t_11;
   __pyx_t_11 = 0;
 
-  /* "cssm.pyx":2197
+  /* "cssm.pyx":2309
  *     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
  *     boundary = np.zeros(t_s.shape, dtype = DTYPE)
  *     cdef float[:] boundary_view = boundary             # <<<<<<<<<<<<<<
  * 
  *     # Y particle trace
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2197, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_boundary, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2309, __pyx_L1_error)
   __pyx_v_boundary_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2200
+  /* "cssm.pyx":2312
  * 
  *     # Y particle trace
  *     bias_trace = np.zeros(num_draws, dtype = DTYPE)             # <<<<<<<<<<<<<<
  *     cdef float[:] bias_trace_view = bias_trace
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2200, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2200, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_num_draws); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2200, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_num_draws); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2200, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_11);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_11);
   __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2200, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2200, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 2200, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 2312, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2200, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_v_bias_trace = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "cssm.pyx":2201
+  /* "cssm.pyx":2313
  *     # Y particle trace
  *     bias_trace = np.zeros(num_draws, dtype = DTYPE)
  *     cdef float[:] bias_trace_view = bias_trace             # <<<<<<<<<<<<<<
  * 
  *     cdef float y_h, y_l, v_l, t_h, t_l, tmp_pos_dep
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_bias_trace, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2201, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_float(__pyx_v_bias_trace, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2313, __pyx_L1_error)
   __pyx_v_bias_trace_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2205
+  /* "cssm.pyx":2317
  *     cdef float y_h, y_l, v_l, t_h, t_l, tmp_pos_dep
  *     cdef Py_ssize_t n, ix, ix_tmp, k
  *     cdef Py_ssize_t m = 0             # <<<<<<<<<<<<<<
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  */
   __pyx_v_m = 0;
 
-  /* "cssm.pyx":2206
+  /* "cssm.pyx":2318
  *     cdef Py_ssize_t n, ix, ix_tmp, k
  *     cdef Py_ssize_t m = 0
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  * 
  *     for k in range(n_trials):
  */
-  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2206, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2318, __pyx_L1_error)
   __pyx_v_gaussian_values = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "cssm.pyx":2208
+  /* "cssm.pyx":2320
  *     cdef float[:] gaussian_values = draw_gaussian(num_draws)
  * 
  *     for k in range(n_trials):             # <<<<<<<<<<<<<<
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
  */
   __pyx_t_10 = __pyx_v_n_trials;
   __pyx_t_12 = __pyx_t_10;
   for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
     __pyx_v_k = __pyx_t_13;
 
-    /* "cssm.pyx":2210
+    /* "cssm.pyx":2322
  *     for k in range(n_trials):
  *         # Precompute boundary evaluations
  *         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}             # <<<<<<<<<<<<<<
  * 
  *         # Precompute boundary evaluations
  */
     { /* enter inner scope */
-      __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2210, __pyx_L7_error)
+      __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2322, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_t_14 = 0;
       if (unlikely(__pyx_v_boundary_params == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-        __PYX_ERR(0, 2210, __pyx_L7_error)
+        __PYX_ERR(0, 2322, __pyx_L7_error)
       }
-      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_15), (&__pyx_t_16)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2210, __pyx_L7_error)
+      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&__pyx_t_15), (&__pyx_t_16)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2322, __pyx_L7_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_XDECREF(__pyx_t_11);
       __pyx_t_11 = __pyx_t_3;
       __pyx_t_3 = 0;
       while (1) {
         __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_11, __pyx_t_15, &__pyx_t_14, &__pyx_t_3, NULL, NULL, __pyx_t_16);
         if (unlikely(__pyx_t_17 == 0)) break;
-        if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 2210, __pyx_L7_error)
+        if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 2322, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_XDECREF_SET(__pyx_9genexpr13__pyx_v_key, __pyx_t_3);
+        __Pyx_XDECREF_SET(__pyx_9genexpr14__pyx_v_key, __pyx_t_3);
         __pyx_t_3 = 0;
-        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_9genexpr13__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2210, __pyx_L7_error)
+        __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_boundary_params, __pyx_9genexpr14__pyx_v_key); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2322, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2210, __pyx_L7_error)
+        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2322, __pyx_L7_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_t_5, (PyObject*)__pyx_9genexpr13__pyx_v_key, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 2210, __pyx_L7_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_5, (PyObject*)__pyx_9genexpr14__pyx_v_key, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 2322, __pyx_L7_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       }
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_key); __pyx_9genexpr13__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_9genexpr14__pyx_v_key); __pyx_9genexpr14__pyx_v_key = 0;
       goto __pyx_L10_exit_scope;
       __pyx_L7_error:;
-      __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_key); __pyx_9genexpr13__pyx_v_key = 0;
+      __Pyx_XDECREF(__pyx_9genexpr14__pyx_v_key); __pyx_9genexpr14__pyx_v_key = 0;
       goto __pyx_L1_error;
       __pyx_L10_exit_scope:;
     } /* exit inner scope */
     __Pyx_XDECREF_SET(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
     __pyx_t_5 = 0;
 
-    /* "cssm.pyx":2213
+    /* "cssm.pyx":2325
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  */
-    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 2213, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_IsTrue(__pyx_v_boundary_multiplicative); if (unlikely(__pyx_t_18 < 0)) __PYX_ERR(0, 2325, __pyx_L1_error)
     if (__pyx_t_18) {
 
-      /* "cssm.pyx":2214
+      /* "cssm.pyx":2326
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  *         else:
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2214, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2326, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2214, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_multiply); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2326, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __pyx_t_19 = __pyx_v_k;
-      __pyx_t_6 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2214, __pyx_L1_error)
+      __pyx_t_6 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2326, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2214, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2326, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 2214, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 2326, __pyx_L1_error)
       __pyx_t_1 = __pyx_t_4;
       __pyx_t_4 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 2214, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2214, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_1, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 2326, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2326, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       __pyx_t_16 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_1)) {
@@ -33055,105 +34554,105 @@
           __Pyx_DECREF_SET(__pyx_t_3, function);
           __pyx_t_16 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_6, __pyx_t_4};
-        __pyx_t_11 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2214, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2326, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_6, __pyx_t_4};
-        __pyx_t_11 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2214, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2326, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_9 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2214, __pyx_L1_error)
+        __pyx_t_9 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2326, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         if (__pyx_t_1) {
           __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_1); __pyx_t_1 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_16, __pyx_t_6);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_16, __pyx_t_4);
         __pyx_t_6 = 0;
         __pyx_t_4 = 0;
-        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2214, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2326, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2214, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2326, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2214, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2326, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __pyx_t_9 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_9)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_5 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_9, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_11);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2214, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2326, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 2214, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 2326, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-      /* "cssm.pyx":2213
+      /* "cssm.pyx":2325
  * 
  *         # Precompute boundary evaluations
  *         if boundary_multiplicative:             # <<<<<<<<<<<<<<
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  */
       goto __pyx_L11;
     }
 
-    /* "cssm.pyx":2216
+    /* "cssm.pyx":2328
  *             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
  *         else:
  *             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)             # <<<<<<<<<<<<<<
  * 
  *         # Loop over samples
  */
     /*else*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2216, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2328, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_add); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2216, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_add); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2328, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __pyx_t_19 = __pyx_v_k;
-      __pyx_t_11 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2216, __pyx_L1_error)
+      __pyx_t_11 = PyFloat_FromDouble((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2328, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2216, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2328, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 2216, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_t, __pyx_v_t_s) < 0) __PYX_ERR(0, 2328, __pyx_L1_error)
       __pyx_t_4 = __pyx_t_6;
       __pyx_t_6 = 0;
-      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 2216, __pyx_L1_error)
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2216, __pyx_L1_error)
+      if (__Pyx_MergeKeywords(__pyx_t_4, __pyx_v_boundary_params_tmp) < 0) __PYX_ERR(0, 2328, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2328, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       __pyx_t_16 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_9);
         if (likely(__pyx_t_4)) {
@@ -33163,150 +34662,150 @@
           __Pyx_DECREF_SET(__pyx_t_9, function);
           __pyx_t_16 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_9)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_6};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2216, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2328, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
         PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_11, __pyx_t_6};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2216, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2328, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       } else
       #endif
       {
-        __pyx_t_1 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2216, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2328, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_11);
         PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_16, __pyx_t_11);
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_16, __pyx_t_6);
         __pyx_t_11 = 0;
         __pyx_t_6 = 0;
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2216, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2328, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       }
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2216, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2328, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2216, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2328, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_9);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
           __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_9, function);
         }
       }
       __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2216, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2328, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 2216, __pyx_L1_error)
+      if (__Pyx_PyObject_SetSlice(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &__pyx_slice_, 0, 0, 0) < 0) __PYX_ERR(0, 2328, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __pyx_L11:;
 
-    /* "cssm.pyx":2219
+    /* "cssm.pyx":2331
  * 
  *         # Loop over samples
  *         for n in range(n_samples):             # <<<<<<<<<<<<<<
  *             choices_view[n, k, 0] = 0 # reset choice
  *             t_h = 0 # reset time high dimension
  */
     __pyx_t_16 = __pyx_v_n_samples;
     __pyx_t_17 = __pyx_t_16;
     for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_17; __pyx_t_15+=1) {
       __pyx_v_n = __pyx_t_15;
 
-      /* "cssm.pyx":2220
+      /* "cssm.pyx":2332
  *         # Loop over samples
  *         for n in range(n_samples):
  *             choices_view[n, k, 0] = 0 # reset choice             # <<<<<<<<<<<<<<
  *             t_h = 0 # reset time high dimension
  *             t_l = 0 # reset time low dimension
  */
       __pyx_t_19 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_21 = 0;
       *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) = 0;
 
-      /* "cssm.pyx":2221
+      /* "cssm.pyx":2333
  *         for n in range(n_samples):
  *             choices_view[n, k, 0] = 0 # reset choice
  *             t_h = 0 # reset time high dimension             # <<<<<<<<<<<<<<
  *             t_l = 0 # reset time low dimension
  *             ix = 0 # reset boundary index
  */
       __pyx_v_t_h = 0.0;
 
-      /* "cssm.pyx":2222
+      /* "cssm.pyx":2334
  *             choices_view[n, k, 0] = 0 # reset choice
  *             t_h = 0 # reset time high dimension
  *             t_l = 0 # reset time low dimension             # <<<<<<<<<<<<<<
  *             ix = 0 # reset boundary index
  * 
  */
       __pyx_v_t_l = 0.0;
 
-      /* "cssm.pyx":2223
+      /* "cssm.pyx":2335
  *             t_h = 0 # reset time high dimension
  *             t_l = 0 # reset time low dimension
  *             ix = 0 # reset boundary index             # <<<<<<<<<<<<<<
  * 
  *             # Initialize walkers
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":2226
+      /* "cssm.pyx":2338
  * 
  *             # Initialize walkers
  *             y_h = (-1) * boundary_view[0] + (z_h_view[k] * 2 * (boundary_view[0]))             # <<<<<<<<<<<<<<
  *             bias_trace_view[0] = ((y_h + boundary_view[0]) / (2 * boundary_view[0]))
  * 
  */
       __pyx_t_21 = 0;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_19 = 0;
       __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_h_view.data + __pyx_t_20 * __pyx_v_z_h_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":2227
+      /* "cssm.pyx":2339
  *             # Initialize walkers
  *             y_h = (-1) * boundary_view[0] + (z_h_view[k] * 2 * (boundary_view[0]))
  *             bias_trace_view[0] = ((y_h + boundary_view[0]) / (2 * boundary_view[0]))             # <<<<<<<<<<<<<<
  * 
  *             # Random walks until y_h hits bound
  */
       __pyx_t_19 = 0;
       __pyx_t_20 = 0;
       __pyx_t_21 = 0;
       *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_21 * __pyx_v_bias_trace_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
 
-      /* "cssm.pyx":2230
+      /* "cssm.pyx":2342
  * 
  *             # Random walks until y_h hits bound
  *             while (y_h >= ((-1) * boundary_view[ix])) and ((y_h <= boundary_view[ix])) and (t_h <= max_t):             # <<<<<<<<<<<<<<
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))
  */
       while (1) {
@@ -33325,340 +34824,340 @@
           goto __pyx_L16_bool_binop_done;
         }
         __pyx_t_22 = ((__pyx_v_t_h <= __pyx_v_max_t) != 0);
         __pyx_t_18 = __pyx_t_22;
         __pyx_L16_bool_binop_done:;
         if (!__pyx_t_18) break;
 
-        /* "cssm.pyx":2231
+        /* "cssm.pyx":2343
  *             # Random walks until y_h hits bound
  *             while (y_h >= ((-1) * boundary_view[ix])) and ((y_h <= boundary_view[ix])) and (t_h <= max_t):
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])             # <<<<<<<<<<<<<<
  *                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))
  *                 t_h += delta_t
  */
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_19 = __pyx_v_m;
         __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_v_h_view.data + __pyx_t_20 * __pyx_v_v_h_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) ))))));
 
-        /* "cssm.pyx":2232
+        /* "cssm.pyx":2344
  *             while (y_h >= ((-1) * boundary_view[ix])) and ((y_h <= boundary_view[ix])) and (t_h <= max_t):
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))             # <<<<<<<<<<<<<<
  *                 t_h += delta_t
  *                 ix += 1
  */
         __pyx_t_19 = __pyx_v_ix;
         __pyx_t_20 = __pyx_v_ix;
         __pyx_t_21 = __pyx_v_ix;
         *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_21 * __pyx_v_bias_trace_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
 
-        /* "cssm.pyx":2233
+        /* "cssm.pyx":2345
  *                 y_h += (v_h_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
  *                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))
  *                 t_h += delta_t             # <<<<<<<<<<<<<<
  *                 ix += 1
  *                 m += 1
  */
         __pyx_v_t_h = (__pyx_v_t_h + __pyx_v_delta_t);
 
-        /* "cssm.pyx":2234
+        /* "cssm.pyx":2346
  *                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))
  *                 t_h += delta_t
  *                 ix += 1             # <<<<<<<<<<<<<<
  *                 m += 1
  *                 if m == num_draws:
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":2235
+        /* "cssm.pyx":2347
  *                 t_h += delta_t
  *                 ix += 1
  *                 m += 1             # <<<<<<<<<<<<<<
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":2236
+        /* "cssm.pyx":2348
  *                 ix += 1
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_18 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":2237
+          /* "cssm.pyx":2349
  *                 m += 1
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2237, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2349, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":2238
+          /* "cssm.pyx":2350
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             # The probability of making a 'mistake' 1 - (relative y position)
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":2236
+          /* "cssm.pyx":2348
  *                 ix += 1
  *                 m += 1
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":2243
+      /* "cssm.pyx":2355
  *             # y at upper bound --> choices_view[n, k, 0] add 2 deterministically
  *             # y at lower bound --> choice_view[n, k, 0] stay the same deterministically
  *             if random_uniform() <= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] += 2
  * 
  */
       __pyx_t_20 = __pyx_v_ix;
       __pyx_t_19 = __pyx_v_ix;
       __pyx_t_18 = ((__pyx_f_4cssm_random_uniform() <= ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))))) != 0);
       if (__pyx_t_18) {
 
-        /* "cssm.pyx":2244
+        /* "cssm.pyx":2356
  *             # y at lower bound --> choice_view[n, k, 0] stay the same deterministically
  *             if random_uniform() <= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):
  *                 choices_view[n, k, 0] += 2             # <<<<<<<<<<<<<<
  * 
  *             if choices_view[n, k, 0] == 2:
  */
         __pyx_t_19 = __pyx_v_n;
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_21 = 0;
         *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) += 2;
 
-        /* "cssm.pyx":2243
+        /* "cssm.pyx":2355
  *             # y at upper bound --> choices_view[n, k, 0] add 2 deterministically
  *             # y at lower bound --> choice_view[n, k, 0] stay the same deterministically
  *             if random_uniform() <= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] += 2
  * 
  */
       }
 
-      /* "cssm.pyx":2246
+      /* "cssm.pyx":2358
  *                 choices_view[n, k, 0] += 2
  * 
  *             if choices_view[n, k, 0] == 2:             # <<<<<<<<<<<<<<
  *                 y_l = (- 1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_2_view[k]
  */
       __pyx_t_21 = __pyx_v_n;
       __pyx_t_20 = __pyx_v_k;
       __pyx_t_19 = 0;
       __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_21 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 2) != 0);
       if (__pyx_t_18) {
 
-        /* "cssm.pyx":2247
+        /* "cssm.pyx":2359
  * 
  *             if choices_view[n, k, 0] == 2:
  *                 y_l = (- 1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))             # <<<<<<<<<<<<<<
  *                 v_l = v_l_2_view[k]
  * 
  */
         __pyx_t_19 = 0;
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_21 = 0;
         __pyx_v_y_l = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_l_2_view.data + __pyx_t_20 * __pyx_v_z_l_2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))));
 
-        /* "cssm.pyx":2248
+        /* "cssm.pyx":2360
  *             if choices_view[n, k, 0] == 2:
  *                 y_l = (- 1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_2_view[k]             # <<<<<<<<<<<<<<
  * 
  *                 # Fill bias trace until max_rt reached
  */
         __pyx_t_21 = __pyx_v_k;
         __pyx_v_v_l = (*((float *) ( /* dim=0 */ (__pyx_v_v_l_2_view.data + __pyx_t_21 * __pyx_v_v_l_2_view.strides[0]) )));
 
-        /* "cssm.pyx":2251
+        /* "cssm.pyx":2363
  * 
  *                 # Fill bias trace until max_rt reached
  *                 ix_tmp = ix + 1             # <<<<<<<<<<<<<<
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0
  */
         __pyx_v_ix_tmp = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":2252
+        /* "cssm.pyx":2364
  *                 # Fill bias trace until max_rt reached
  *                 ix_tmp = ix + 1
  *                 while ix_tmp < num_draws:             # <<<<<<<<<<<<<<
  *                     bias_trace_view[ix_tmp] = 1.0
  *                     ix_tmp += 1
  */
         while (1) {
           __pyx_t_18 = ((__pyx_v_ix_tmp < __pyx_v_num_draws) != 0);
           if (!__pyx_t_18) break;
 
-          /* "cssm.pyx":2253
+          /* "cssm.pyx":2365
  *                 ix_tmp = ix + 1
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0             # <<<<<<<<<<<<<<
  *                     ix_tmp += 1
  * 
  */
           __pyx_t_21 = __pyx_v_ix_tmp;
           *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_21 * __pyx_v_bias_trace_view.strides[0]) )) = 1.0;
 
-          /* "cssm.pyx":2254
+          /* "cssm.pyx":2366
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0
  *                     ix_tmp += 1             # <<<<<<<<<<<<<<
  * 
  *             else: # Store intermediate choice
  */
           __pyx_v_ix_tmp = (__pyx_v_ix_tmp + 1);
         }
 
-        /* "cssm.pyx":2246
+        /* "cssm.pyx":2358
  *                 choices_view[n, k, 0] += 2
  * 
  *             if choices_view[n, k, 0] == 2:             # <<<<<<<<<<<<<<
  *                 y_l = (- 1) * boundary_view[0] + (z_l_2_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_2_view[k]
  */
         goto __pyx_L21;
       }
 
-      /* "cssm.pyx":2257
+      /* "cssm.pyx":2369
  * 
  *             else: # Store intermediate choice
  *                 y_l = (- 1) * boundary_view[0] + (z_l_1_view[k] * 2 * (boundary_view[0]))             # <<<<<<<<<<<<<<
  *                 v_l = v_l_1_view[k]
  * 
  */
       /*else*/ {
         __pyx_t_21 = 0;
         __pyx_t_20 = __pyx_v_k;
         __pyx_t_19 = 0;
         __pyx_v_y_l = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_l_1_view.data + __pyx_t_20 * __pyx_v_z_l_1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
 
-        /* "cssm.pyx":2258
+        /* "cssm.pyx":2370
  *             else: # Store intermediate choice
  *                 y_l = (- 1) * boundary_view[0] + (z_l_1_view[k] * 2 * (boundary_view[0]))
  *                 v_l = v_l_1_view[k]             # <<<<<<<<<<<<<<
  * 
  *                 # Fill bias trace until max_rt reached
  */
         __pyx_t_19 = __pyx_v_k;
         __pyx_v_v_l = (*((float *) ( /* dim=0 */ (__pyx_v_v_l_1_view.data + __pyx_t_19 * __pyx_v_v_l_1_view.strides[0]) )));
 
-        /* "cssm.pyx":2261
+        /* "cssm.pyx":2373
  * 
  *                 # Fill bias trace until max_rt reached
  *                 ix_tmp = ix + 1             # <<<<<<<<<<<<<<
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 0.0
  */
         __pyx_v_ix_tmp = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":2262
+        /* "cssm.pyx":2374
  *                 # Fill bias trace until max_rt reached
  *                 ix_tmp = ix + 1
  *                 while ix_tmp < num_draws:             # <<<<<<<<<<<<<<
  *                     bias_trace_view[ix_tmp] = 0.0
  *                     ix_tmp += 1
  */
         while (1) {
           __pyx_t_18 = ((__pyx_v_ix_tmp < __pyx_v_num_draws) != 0);
           if (!__pyx_t_18) break;
 
-          /* "cssm.pyx":2263
+          /* "cssm.pyx":2375
  *                 ix_tmp = ix + 1
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 0.0             # <<<<<<<<<<<<<<
  *                     ix_tmp += 1
  * 
  */
           __pyx_t_19 = __pyx_v_ix_tmp;
           *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_19 * __pyx_v_bias_trace_view.strides[0]) )) = 0.0;
 
-          /* "cssm.pyx":2264
+          /* "cssm.pyx":2376
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 0.0
  *                     ix_tmp += 1             # <<<<<<<<<<<<<<
  * 
  *                 #We need to reverse the bias_trace if we took the lower choice
  */
           __pyx_v_ix_tmp = (__pyx_v_ix_tmp + 1);
         }
 
-        /* "cssm.pyx":2267
+        /* "cssm.pyx":2379
  * 
  *                 #We need to reverse the bias_trace if we took the lower choice
  *                 ix_tmp = 0             # <<<<<<<<<<<<<<
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0 - bias_trace_view[ix_tmp]
  */
         __pyx_v_ix_tmp = 0;
 
-        /* "cssm.pyx":2268
+        /* "cssm.pyx":2380
  *                 #We need to reverse the bias_trace if we took the lower choice
  *                 ix_tmp = 0
  *                 while ix_tmp < num_draws:             # <<<<<<<<<<<<<<
  *                     bias_trace_view[ix_tmp] = 1.0 - bias_trace_view[ix_tmp]
  *                     ix_tmp += 1
  */
         while (1) {
           __pyx_t_18 = ((__pyx_v_ix_tmp < __pyx_v_num_draws) != 0);
           if (!__pyx_t_18) break;
 
-          /* "cssm.pyx":2269
+          /* "cssm.pyx":2381
  *                 ix_tmp = 0
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0 - bias_trace_view[ix_tmp]             # <<<<<<<<<<<<<<
  *                     ix_tmp += 1
  * 
  */
           __pyx_t_19 = __pyx_v_ix_tmp;
           __pyx_t_20 = __pyx_v_ix_tmp;
           *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_20 * __pyx_v_bias_trace_view.strides[0]) )) = (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_19 * __pyx_v_bias_trace_view.strides[0]) ))));
 
-          /* "cssm.pyx":2270
+          /* "cssm.pyx":2382
  *                 while ix_tmp < num_draws:
  *                     bias_trace_view[ix_tmp] = 1.0 - bias_trace_view[ix_tmp]
  *                     ix_tmp += 1             # <<<<<<<<<<<<<<
  * 
  *                 #print('new bias_trace: ', bias_trace)
  */
           __pyx_v_ix_tmp = (__pyx_v_ix_tmp + 1);
         }
       }
       __pyx_L21:;
 
-      /* "cssm.pyx":2275
+      /* "cssm.pyx":2387
  * 
  *             # Random walks until the y_l corresponding to y_h hits bound
  *             ix = 0             # <<<<<<<<<<<<<<
  *             while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_l <= max_t):
  *                 # Compute local position dependence
  */
       __pyx_v_ix = 0;
 
-      /* "cssm.pyx":2276
+      /* "cssm.pyx":2388
  *             # Random walks until the y_l corresponding to y_h hits bound
  *             ix = 0
  *             while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_l <= max_t):             # <<<<<<<<<<<<<<
  *                 # Compute local position dependence
  *                 tmp_pos_dep = (1 + (d_view[k] * (bias_trace_view[ix] - 1.0))) / (2 - d_view[k])
  */
       while (1) {
@@ -33677,27 +35176,27 @@
           goto __pyx_L30_bool_binop_done;
         }
         __pyx_t_22 = ((__pyx_v_t_l <= __pyx_v_max_t) != 0);
         __pyx_t_18 = __pyx_t_22;
         __pyx_L30_bool_binop_done:;
         if (!__pyx_t_18) break;
 
-        /* "cssm.pyx":2278
+        /* "cssm.pyx":2390
  *             while (y_l >= ((-1) * boundary_view[ix])) and (y_l <= boundary_view[ix]) and (t_l <= max_t):
  *                 # Compute local position dependence
  *                 tmp_pos_dep = (1 + (d_view[k] * (bias_trace_view[ix] - 1.0))) / (2 - d_view[k])             # <<<<<<<<<<<<<<
  * 
  *                 if (bias_trace_view[ix] < 1) and (bias_trace_view[ix] > 0):
  */
         __pyx_t_19 = __pyx_v_k;
         __pyx_t_20 = __pyx_v_ix;
         __pyx_t_21 = __pyx_v_k;
         __pyx_v_tmp_pos_dep = ((1.0 + ((*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_19 * __pyx_v_d_view.strides[0]) ))) * ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_20 * __pyx_v_bias_trace_view.strides[0]) ))) - 1.0))) / ((double)(2.0 - (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_21 * __pyx_v_d_view.strides[0]) ))))));
 
-        /* "cssm.pyx":2280
+        /* "cssm.pyx":2392
  *                 tmp_pos_dep = (1 + (d_view[k] * (bias_trace_view[ix] - 1.0))) / (2 - d_view[k])
  * 
  *                 if (bias_trace_view[ix] < 1) and (bias_trace_view[ix] > 0):             # <<<<<<<<<<<<<<
  *                     # Before high-dim choice is taken
  *                     y_l += tmp_pos_dep * (v_l * delta_t) # Add drift
  */
         __pyx_t_21 = __pyx_v_ix;
@@ -33709,389 +35208,389 @@
         }
         __pyx_t_21 = __pyx_v_ix;
         __pyx_t_22 = (((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_21 * __pyx_v_bias_trace_view.strides[0]) ))) > 0.0) != 0);
         __pyx_t_18 = __pyx_t_22;
         __pyx_L34_bool_binop_done:;
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":2282
+          /* "cssm.pyx":2394
  *                 if (bias_trace_view[ix] < 1) and (bias_trace_view[ix] > 0):
  *                     # Before high-dim choice is taken
  *                     y_l += tmp_pos_dep * (v_l * delta_t) # Add drift             # <<<<<<<<<<<<<<
  *                     y_l += tmp_pos_dep * sqrt_st * gaussian_values[m] # Add noise
  *                 else:
  */
           __pyx_v_y_l = (__pyx_v_y_l + (__pyx_v_tmp_pos_dep * (__pyx_v_v_l * __pyx_v_delta_t)));
 
-          /* "cssm.pyx":2283
+          /* "cssm.pyx":2395
  *                     # Before high-dim choice is taken
  *                     y_l += tmp_pos_dep * (v_l * delta_t) # Add drift
  *                     y_l += tmp_pos_dep * sqrt_st * gaussian_values[m] # Add noise             # <<<<<<<<<<<<<<
  *                 else:
  *                     # After high-dim choice is taken
  */
           __pyx_t_21 = __pyx_v_m;
           __pyx_v_y_l = (__pyx_v_y_l + ((__pyx_v_tmp_pos_dep * __pyx_v_sqrt_st) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_21 * __pyx_v_gaussian_values.strides[0]) )))));
 
-          /* "cssm.pyx":2280
+          /* "cssm.pyx":2392
  *                 tmp_pos_dep = (1 + (d_view[k] * (bias_trace_view[ix] - 1.0))) / (2 - d_view[k])
  * 
  *                 if (bias_trace_view[ix] < 1) and (bias_trace_view[ix] > 0):             # <<<<<<<<<<<<<<
  *                     # Before high-dim choice is taken
  *                     y_l += tmp_pos_dep * (v_l * delta_t) # Add drift
  */
           goto __pyx_L33;
         }
 
-        /* "cssm.pyx":2286
+        /* "cssm.pyx":2398
  *                 else:
  *                     # After high-dim choice is taken
  *                     y_l += (v_l * delta_t) # Add drift             # <<<<<<<<<<<<<<
  *                     y_l += sqrt_st * gaussian_values[m] # Add noise
  * 
  */
         /*else*/ {
           __pyx_v_y_l = (__pyx_v_y_l + (__pyx_v_v_l * __pyx_v_delta_t));
 
-          /* "cssm.pyx":2287
+          /* "cssm.pyx":2399
  *                     # After high-dim choice is taken
  *                     y_l += (v_l * delta_t) # Add drift
  *                     y_l += sqrt_st * gaussian_values[m] # Add noise             # <<<<<<<<<<<<<<
  * 
  *                 t_l += delta_t # update time for low_dim choice
  */
           __pyx_t_21 = __pyx_v_m;
           __pyx_v_y_l = (__pyx_v_y_l + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_21 * __pyx_v_gaussian_values.strides[0]) )))));
         }
         __pyx_L33:;
 
-        /* "cssm.pyx":2289
+        /* "cssm.pyx":2401
  *                     y_l += sqrt_st * gaussian_values[m] # Add noise
  * 
  *                 t_l += delta_t # update time for low_dim choice             # <<<<<<<<<<<<<<
  *                 ix += 1 # update time index
  *                 m += 1 # update rv couter
  */
         __pyx_v_t_l = (__pyx_v_t_l + __pyx_v_delta_t);
 
-        /* "cssm.pyx":2290
+        /* "cssm.pyx":2402
  * 
  *                 t_l += delta_t # update time for low_dim choice
  *                 ix += 1 # update time index             # <<<<<<<<<<<<<<
  *                 m += 1 # update rv couter
  * 
  */
         __pyx_v_ix = (__pyx_v_ix + 1);
 
-        /* "cssm.pyx":2291
+        /* "cssm.pyx":2403
  *                 t_l += delta_t # update time for low_dim choice
  *                 ix += 1 # update time index
  *                 m += 1 # update rv couter             # <<<<<<<<<<<<<<
  * 
  *                 if m == num_draws:
  */
         __pyx_v_m = (__pyx_v_m + 1);
 
-        /* "cssm.pyx":2293
+        /* "cssm.pyx":2405
  *                 m += 1 # update rv couter
  * 
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         __pyx_t_18 = ((__pyx_v_m == __pyx_v_num_draws) != 0);
         if (__pyx_t_18) {
 
-          /* "cssm.pyx":2294
+          /* "cssm.pyx":2406
  * 
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)             # <<<<<<<<<<<<<<
  *                     m = 0
  * 
  */
-          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2294, __pyx_L1_error)
+          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2406, __pyx_L1_error)
           __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
           __pyx_v_gaussian_values = __pyx_t_2;
           __pyx_t_2.memview = NULL;
           __pyx_t_2.data = NULL;
 
-          /* "cssm.pyx":2295
+          /* "cssm.pyx":2407
  *                 if m == num_draws:
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0             # <<<<<<<<<<<<<<
  * 
  *             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]
  */
           __pyx_v_m = 0;
 
-          /* "cssm.pyx":2293
+          /* "cssm.pyx":2405
  *                 m += 1 # update rv couter
  * 
  *                 if m == num_draws:             # <<<<<<<<<<<<<<
  *                     gaussian_values = draw_gaussian(num_draws)
  *                     m = 0
  */
         }
       }
 
-      /* "cssm.pyx":2297
+      /* "cssm.pyx":2409
  *                     m = 0
  * 
  *             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]             # <<<<<<<<<<<<<<
  * 
  *             # The probability of making a 'mistake' 1 - (relative y position)
  */
       __pyx_t_21 = __pyx_v_k;
       __pyx_t_20 = __pyx_v_n;
       __pyx_t_19 = __pyx_v_k;
       __pyx_t_23 = 0;
       *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_23 * __pyx_v_rts_view.strides[2]) )) = (fmax(__pyx_v_t_h, __pyx_v_t_l) + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) ))));
 
-      /* "cssm.pyx":2302
+      /* "cssm.pyx":2414
  *             # y at upper bound --> choices_view[n, k, 0] add one deterministically
  *             # y at lower bound --> choice_view[n, k, 0] stays the same deterministically
  *             if random_uniform() <= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] += 1
  * 
  */
       __pyx_t_21 = __pyx_v_ix;
       __pyx_t_23 = __pyx_v_ix;
       __pyx_t_18 = ((__pyx_f_4cssm_random_uniform() <= ((__pyx_v_y_l + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_23 * __pyx_v_boundary_view.strides[0]) )))))) != 0);
       if (__pyx_t_18) {
 
-        /* "cssm.pyx":2303
+        /* "cssm.pyx":2415
  *             # y at lower bound --> choice_view[n, k, 0] stays the same deterministically
  *             if random_uniform() <= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):
  *                 choices_view[n, k, 0] += 1             # <<<<<<<<<<<<<<
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  */
         __pyx_t_23 = __pyx_v_n;
         __pyx_t_21 = __pyx_v_k;
         __pyx_t_19 = 0;
         *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_23 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 1;
 
-        /* "cssm.pyx":2302
+        /* "cssm.pyx":2414
  *             # y at upper bound --> choices_view[n, k, 0] add one deterministically
  *             # y at lower bound --> choice_view[n, k, 0] stays the same deterministically
  *             if random_uniform() <= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):             # <<<<<<<<<<<<<<
  *                 choices_view[n, k, 0] += 1
  * 
  */
       }
     }
   }
 
-  /* "cssm.pyx":2305
+  /* "cssm.pyx":2417
  *                 choices_view[n, k, 0] += 1
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,             # <<<<<<<<<<<<<<
  *                                                          'vl1': v_l_1,
  *                                                          'vl2': v_l_2,
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2305, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2417, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2417, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vh, ((PyObject *)__pyx_v_v_h)) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vh, ((PyObject *)__pyx_v_v_h)) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
 
-  /* "cssm.pyx":2306
+  /* "cssm.pyx":2418
  * 
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  *                                                          'vl1': v_l_1,             # <<<<<<<<<<<<<<
  *                                                          'vl2': v_l_2,
  *                                                          'a': a,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl1, ((PyObject *)__pyx_v_v_l_1)) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl1, ((PyObject *)__pyx_v_v_l_1)) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
 
-  /* "cssm.pyx":2307
+  /* "cssm.pyx":2419
  *     return {'rts': rts, 'choices': choices, 'metadata': {'vh': v_h,
  *                                                          'vl1': v_l_1,
  *                                                          'vl2': v_l_2,             # <<<<<<<<<<<<<<
  *                                                          'a': a,
  *                                                          'zh': z_h,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl2, ((PyObject *)__pyx_v_v_l_2)) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_vl2, ((PyObject *)__pyx_v_v_l_2)) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
 
-  /* "cssm.pyx":2308
+  /* "cssm.pyx":2420
  *                                                          'vl1': v_l_1,
  *                                                          'vl2': v_l_2,
  *                                                          'a': a,             # <<<<<<<<<<<<<<
  *                                                          'zh': z_h,
  *                                                          'zl1': z_l_1,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
 
-  /* "cssm.pyx":2309
+  /* "cssm.pyx":2421
  *                                                          'vl2': v_l_2,
  *                                                          'a': a,
  *                                                          'zh': z_h,             # <<<<<<<<<<<<<<
  *                                                          'zl1': z_l_1,
  *                                                          'zl2': z_l_2,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zh, ((PyObject *)__pyx_v_z_h)) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zh, ((PyObject *)__pyx_v_z_h)) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
 
-  /* "cssm.pyx":2310
+  /* "cssm.pyx":2422
  *                                                          'a': a,
  *                                                          'zh': z_h,
  *                                                          'zl1': z_l_1,             # <<<<<<<<<<<<<<
  *                                                          'zl2': z_l_2,
  *                                                          'd': d,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl1, ((PyObject *)__pyx_v_z_l_1)) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl1, ((PyObject *)__pyx_v_z_l_1)) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
 
-  /* "cssm.pyx":2311
+  /* "cssm.pyx":2423
  *                                                          'zh': z_h,
  *                                                          'zl1': z_l_1,
  *                                                          'zl2': z_l_2,             # <<<<<<<<<<<<<<
  *                                                          'd': d,
  *                                                          't': t,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl2, ((PyObject *)__pyx_v_z_l_2)) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_zl2, ((PyObject *)__pyx_v_z_l_2)) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
 
-  /* "cssm.pyx":2312
+  /* "cssm.pyx":2424
  *                                                          'zl1': z_l_1,
  *                                                          'zl2': z_l_2,
  *                                                          'd': d,             # <<<<<<<<<<<<<<
  *                                                          't': t,
  *                                                          's': s,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_d, ((PyObject *)__pyx_v_d)) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_d, ((PyObject *)__pyx_v_d)) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
 
-  /* "cssm.pyx":2313
+  /* "cssm.pyx":2425
  *                                                          'zl2': z_l_2,
  *                                                          'd': d,
  *                                                          't': t,             # <<<<<<<<<<<<<<
  *                                                          's': s,
  *                                                          **boundary_params,
  */
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
 
-  /* "cssm.pyx":2314
+  /* "cssm.pyx":2426
  *                                                          'd': d,
  *                                                          't': t,
  *                                                          's': s,             # <<<<<<<<<<<<<<
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2314, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2426, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_1) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_u_s, __pyx_t_1) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_9 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "cssm.pyx":2315
+  /* "cssm.pyx":2427
  *                                                          't': t,
  *                                                          's': s,
  *                                                          **boundary_params,             # <<<<<<<<<<<<<<
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  */
   if (unlikely(__pyx_v_boundary_params == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
-    __PYX_ERR(0, 2315, __pyx_L1_error)
+    __PYX_ERR(0, 2427, __pyx_L1_error)
   }
   if (unlikely(PyDict_Update(__pyx_t_9, __pyx_v_boundary_params) < 0)) {
     if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseMappingExpectedError(__pyx_v_boundary_params);
-    __PYX_ERR(0, 2315, __pyx_L1_error)
+    __PYX_ERR(0, 2427, __pyx_L1_error)
   }
 
-  /* "cssm.pyx":2316
+  /* "cssm.pyx":2428
  *                                                          's': s,
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,             # <<<<<<<<<<<<<<
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2316, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_delta_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2428, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 2316, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_delta_t, __pyx_t_3) < 0) __PYX_ERR(0, 2428, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":2317
+  /* "cssm.pyx":2429
  *                                                          **boundary_params,
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,             # <<<<<<<<<<<<<<
  *                                                          'n_samples': n_samples,
  *                                                          'simulator': 'ddm_flexbound_mic2_adj',
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2317, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_max_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2429, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 2317, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_max_t, __pyx_t_3) < 0) __PYX_ERR(0, 2429, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":2318
+  /* "cssm.pyx":2430
  *                                                          'delta_t': delta_t,
  *                                                          'max_t': max_t,
  *                                                          'n_samples': n_samples,             # <<<<<<<<<<<<<<
  *                                                          'simulator': 'ddm_flexbound_mic2_adj',
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2318, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n_samples); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 2318, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_n_samples, __pyx_t_3) < 0) __PYX_ERR(0, 2430, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) < 0) __PYX_ERR(0, 2319, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) < 0) __PYX_ERR(0, 2431, __pyx_L1_error)
 
-  /* "cssm.pyx":2320
+  /* "cssm.pyx":2432
  *                                                          'n_samples': n_samples,
  *                                                          'simulator': 'ddm_flexbound_mic2_adj',
  *                                                          'boundary_fun_type': boundary_fun.__name__,             # <<<<<<<<<<<<<<
  *                                                          'possible_choices': [0, 1, 2, 3],
  *                                                          'trajectory': 'This simulator does not yet allow for trajectory simulation',
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2320, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_boundary_fun, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2432, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary_fun_type, __pyx_t_3) < 0) __PYX_ERR(0, 2320, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary_fun_type, __pyx_t_3) < 0) __PYX_ERR(0, 2432, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "cssm.pyx":2321
+  /* "cssm.pyx":2433
  *                                                          'simulator': 'ddm_flexbound_mic2_adj',
  *                                                          'boundary_fun_type': boundary_fun.__name__,
  *                                                          'possible_choices': [0, 1, 2, 3],             # <<<<<<<<<<<<<<
  *                                                          'trajectory': 'This simulator does not yet allow for trajectory simulation',
  *                                                          'boundary': boundary}}
  */
-  __pyx_t_3 = PyList_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2321, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2433, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
   __Pyx_INCREF(__pyx_int_1);
   __Pyx_GIVEREF(__pyx_int_1);
   PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyList_SET_ITEM(__pyx_t_3, 2, __pyx_int_2);
   __Pyx_INCREF(__pyx_int_3);
   __Pyx_GIVEREF(__pyx_int_3);
   PyList_SET_ITEM(__pyx_t_3, 3, __pyx_int_3);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 2321, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_possible_choices, __pyx_t_3) < 0) __PYX_ERR(0, 2433, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_trajectory, __pyx_kp_u_This_simulator_does_not_yet_allo) < 0) __PYX_ERR(0, 2322, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_trajectory, __pyx_kp_u_This_simulator_does_not_yet_allo) < 0) __PYX_ERR(0, 2434, __pyx_L1_error)
 
-  /* "cssm.pyx":2323
+  /* "cssm.pyx":2435
  *                                                          'possible_choices': [0, 1, 2, 3],
  *                                                          'trajectory': 'This simulator does not yet allow for trajectory simulation',
  *                                                          'boundary': boundary}}             # <<<<<<<<<<<<<<
  * # -----------------------------------------------------------------------------------------------
  * 
  */
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 2323, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_9) < 0) __PYX_ERR(0, 2305, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_u_boundary, __pyx_v_boundary) < 0) __PYX_ERR(0, 2435, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_9) < 0) __PYX_ERR(0, 2417, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "cssm.pyx":2149
+  /* "cssm.pyx":2261
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_tradeoff(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                            np.ndarray[float, ndim = 1] v_l_1,
  *                            np.ndarray[float, ndim = 1] v_l_2,
  */
 
@@ -34151,21 +35650,21 @@
   __Pyx_XDECREF(__pyx_v_t_s);
   __Pyx_XDECREF(__pyx_v_boundary);
   __PYX_XDEC_MEMVIEW(&__pyx_v_boundary_view, 1);
   __Pyx_XDECREF(__pyx_v_bias_trace);
   __PYX_XDEC_MEMVIEW(&__pyx_v_bias_trace_view, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_gaussian_values, 1);
   __Pyx_XDECREF(__pyx_v_boundary_params_tmp);
-  __Pyx_XDECREF(__pyx_9genexpr13__pyx_v_key);
+  __Pyx_XDECREF(__pyx_9genexpr14__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":734
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -34174,29 +35673,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":735
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":735
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":734
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":734
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -34207,15 +35706,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":737
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -34224,29 +35723,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":738
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":738
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":737
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":737
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -34257,15 +35756,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":740
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -34274,29 +35773,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":741
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":741
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 741, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":740
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":740
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -34307,15 +35806,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":743
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -34324,29 +35823,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":744
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":744
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":743
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":743
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -34357,15 +35856,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":746
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -34374,29 +35873,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":747
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":747
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":746
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":746
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -34407,212 +35906,212 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":749
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":750
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":751
+    /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":751
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":750
+    /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":750
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":753
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":753
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":749
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":749
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":928
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("set_array_base", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":929
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":929
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":930
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":930
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":928
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":928
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":932
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":933
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":933
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":934
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":935
+    /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":935
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":934
+    /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":934
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":936
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":936
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":932
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":932
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":940
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -34628,15 +36127,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":941
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -34644,84 +36143,84 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":942
+      /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":942
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 942, __pyx_L3_error)
 
-      /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":941
+      /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":943
+    /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":943
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 943, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":944
+      /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 944, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 944, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 944, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":941
+    /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":941
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":940
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":940
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -34736,15 +36235,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":946
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -34760,15 +36259,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":947
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -34776,84 +36275,84 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":948
+      /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":948
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 948, __pyx_L3_error)
 
-      /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":947
+      /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":949
+    /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":949
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 949, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":950
+      /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 950, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 950, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 950, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":947
+    /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":947
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":946
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":946
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -34868,15 +36367,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":952
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -34892,15 +36391,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":953
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -34908,84 +36407,84 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":954
+      /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":954
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 954, __pyx_L3_error)
 
-      /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":953
+      /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":955
+    /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":955
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 955, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":956
+      /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":956
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 956, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 956, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 956, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":953
+    /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":953
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":952
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":952
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -35000,176 +36499,176 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":966
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":978
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":978
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":966
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":966
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":981
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_datetime64_object", 0);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":993
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":993
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":981
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":981
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":996
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":1003
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":1003
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":996
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":996
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":1006
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":1010
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":1010
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":1006
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":1006
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":1013
+/* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":1017
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":1017
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":1013
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":1013
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -35377,15 +36876,15 @@
     /* "View.MemoryView":134
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 134, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 134, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 134, __pyx_L1_error)
 
     /* "View.MemoryView":133
  *         self.itemsize = itemsize
@@ -35409,15 +36908,15 @@
     /* "View.MemoryView":137
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 137, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 137, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 137, __pyx_L1_error)
 
     /* "View.MemoryView":136
  *             raise ValueError("Empty shape tuple for cython.array")
@@ -35536,15 +37035,15 @@
     /* "View.MemoryView":149
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 149, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 149, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 149, __pyx_L1_error)
 
     /* "View.MemoryView":148
  *         self._strides = self._shape + self.ndim
@@ -35810,15 +37309,15 @@
       /* "View.MemoryView":177
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(2, 177, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(2, 177, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_Raise(__pyx_t_10, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __PYX_ERR(2, 177, __pyx_L1_error)
 
       /* "View.MemoryView":176
  * 
@@ -36054,15 +37553,15 @@
     /* "View.MemoryView":193
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 193, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 193, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 193, __pyx_L1_error)
 
     /* "View.MemoryView":192
  *         elif self.mode == u"fortran":
@@ -36788,15 +38287,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -36844,15 +38343,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -38573,15 +40072,15 @@
     /* "View.MemoryView":420
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 420, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 420, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_ERR(2, 420, __pyx_L1_error)
 
     /* "View.MemoryView":419
  * 
@@ -39621,15 +41120,15 @@
       /* "View.MemoryView":497
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(2, 497, __pyx_L5_except_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(2, 497, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __PYX_ERR(2, 497, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -39983,15 +41482,15 @@
     /* "View.MemoryView":522
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 522, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 522, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 522, __pyx_L1_error)
 
     /* "View.MemoryView":521
  *     @cname('getbuffer')
@@ -40532,15 +42031,15 @@
     /* "View.MemoryView":572
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 572, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_ERR(2, 572, __pyx_L1_error)
 
     /* "View.MemoryView":570
  *     @property
@@ -40649,15 +42148,15 @@
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__31, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 579, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__32, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
     /* "View.MemoryView":578
@@ -41687,15 +43186,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__32, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__33, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -41743,15 +43242,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__33, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -42404,15 +43903,15 @@
       /* "View.MemoryView":705
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(2, 705, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(2, 705, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_Raise(__pyx_t_5, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __PYX_ERR(2, 705, __pyx_L1_error)
 
       /* "View.MemoryView":704
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
@@ -44588,15 +46087,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__36, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -44644,15 +46143,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__36, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__37, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -47921,15 +49420,15 @@
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  */
   __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__37, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__38, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (__pyx_t_3) {
 
     /* "(tree fragment)":5
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):
@@ -49065,22 +50564,28 @@
   {&__pyx_n_s_ddm, __pyx_k_ddm, sizeof(__pyx_k_ddm), 0, 0, 1, 1},
   {&__pyx_n_u_ddm, __pyx_k_ddm, sizeof(__pyx_k_ddm), 0, 1, 0, 1},
   {&__pyx_n_s_ddm_cov, __pyx_k_ddm_cov, sizeof(__pyx_k_ddm_cov), 0, 0, 1, 1},
   {&__pyx_n_s_ddm_flex, __pyx_k_ddm_flex, sizeof(__pyx_k_ddm_flex), 0, 0, 1, 1},
   {&__pyx_n_u_ddm_flex, __pyx_k_ddm_flex, sizeof(__pyx_k_ddm_flex), 0, 1, 0, 1},
   {&__pyx_n_s_ddm_flexbound, __pyx_k_ddm_flexbound, sizeof(__pyx_k_ddm_flexbound), 0, 0, 1, 1},
   {&__pyx_n_u_ddm_flexbound, __pyx_k_ddm_flexbound, sizeof(__pyx_k_ddm_flexbound), 0, 1, 0, 1},
+  {&__pyx_n_s_ddm_flexbound_deadline, __pyx_k_ddm_flexbound_deadline, sizeof(__pyx_k_ddm_flexbound_deadline), 0, 0, 1, 1},
+  {&__pyx_n_u_ddm_flexbound_deadline, __pyx_k_ddm_flexbound_deadline, sizeof(__pyx_k_ddm_flexbound_deadline), 0, 1, 0, 1},
   {&__pyx_n_s_ddm_flexbound_max, __pyx_k_ddm_flexbound_max, sizeof(__pyx_k_ddm_flexbound_max), 0, 0, 1, 1},
   {&__pyx_n_s_ddm_flexbound_mic2_adj, __pyx_k_ddm_flexbound_mic2_adj, sizeof(__pyx_k_ddm_flexbound_mic2_adj), 0, 0, 1, 1},
   {&__pyx_n_u_ddm_flexbound_mic2_adj, __pyx_k_ddm_flexbound_mic2_adj, sizeof(__pyx_k_ddm_flexbound_mic2_adj), 0, 1, 0, 1},
   {&__pyx_n_s_ddm_flexbound_par2, __pyx_k_ddm_flexbound_par2, sizeof(__pyx_k_ddm_flexbound_par2), 0, 0, 1, 1},
   {&__pyx_n_s_ddm_flexbound_seq2, __pyx_k_ddm_flexbound_seq2, sizeof(__pyx_k_ddm_flexbound_seq2), 0, 0, 1, 1},
   {&__pyx_n_s_ddm_flexbound_tradeoff, __pyx_k_ddm_flexbound_tradeoff, sizeof(__pyx_k_ddm_flexbound_tradeoff), 0, 0, 1, 1},
   {&__pyx_n_s_ddm_sdv, __pyx_k_ddm_sdv, sizeof(__pyx_k_ddm_sdv), 0, 0, 1, 1},
   {&__pyx_n_u_ddm_sdv, __pyx_k_ddm_sdv, sizeof(__pyx_k_ddm_sdv), 0, 1, 0, 1},
+  {&__pyx_n_s_deadline, __pyx_k_deadline, sizeof(__pyx_k_deadline), 0, 0, 1, 1},
+  {&__pyx_n_u_deadline, __pyx_k_deadline, sizeof(__pyx_k_deadline), 0, 1, 0, 1},
+  {&__pyx_n_s_deadline_adj, __pyx_k_deadline_adj, sizeof(__pyx_k_deadline_adj), 0, 0, 1, 1},
+  {&__pyx_n_s_deadline_view, __pyx_k_deadline_view, sizeof(__pyx_k_deadline_view), 0, 0, 1, 1},
   {&__pyx_n_s_delta_t, __pyx_k_delta_t, sizeof(__pyx_k_delta_t), 0, 0, 1, 1},
   {&__pyx_n_u_delta_t, __pyx_k_delta_t, sizeof(__pyx_k_delta_t), 0, 1, 0, 1},
   {&__pyx_n_s_delta_t_alpha, __pyx_k_delta_t_alpha, sizeof(__pyx_k_delta_t_alpha), 0, 0, 1, 1},
   {&__pyx_n_s_delta_t_sqrt, __pyx_k_delta_t_sqrt, sizeof(__pyx_k_delta_t_sqrt), 0, 0, 1, 1},
   {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
   {&__pyx_n_s_drift, __pyx_k_drift, sizeof(__pyx_k_drift), 0, 0, 1, 1},
   {&__pyx_n_u_drift, __pyx_k_drift, sizeof(__pyx_k_drift), 0, 1, 0, 1},
@@ -49265,15 +50770,15 @@
   {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {&__pyx_n_u_zh, __pyx_k_zh, sizeof(__pyx_k_zh), 0, 1, 0, 1},
   {&__pyx_n_u_zl1, __pyx_k_zl1, sizeof(__pyx_k_zl1), 0, 1, 0, 1},
   {&__pyx_n_u_zl2, __pyx_k_zl2, sizeof(__pyx_k_zl2), 0, 1, 0, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 62, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 56, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(1, 944, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(2, 134, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(2, 149, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(2, 152, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(2, 2, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(2, 406, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(2, 615, __pyx_L1_error)
@@ -49283,514 +50788,526 @@
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "cssm.pyx":226
+  /* "cssm.pyx":220
  *     # Data-structs for trajectory storage
  *     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
  *     traj[:, :] = -999             # <<<<<<<<<<<<<<
  *     cdef float[:, :] traj_view = traj
  * 
  */
-  __pyx_slice_ = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice_)) __PYX_ERR(0, 226, __pyx_L1_error)
+  __pyx_slice_ = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice_)) __PYX_ERR(0, 220, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice_);
   __Pyx_GIVEREF(__pyx_slice_);
-  __pyx_tuple__2 = PyTuple_Pack(2, __pyx_slice_, __pyx_slice_); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 226, __pyx_L1_error)
+  __pyx_tuple__2 = PyTuple_Pack(2, __pyx_slice_, __pyx_slice_); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 220, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__2);
   __Pyx_GIVEREF(__pyx_tuple__2);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":944
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
-  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(1, 944, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__18);
-  __Pyx_GIVEREF(__pyx_tuple__18);
+  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(1, 944, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__19);
+  __Pyx_GIVEREF(__pyx_tuple__19);
 
-  /* "../../../../../private/var/folders/gx/s43vynx550qbypcxm83fv56dzq4hgg/T/pip-build-env-qvpohc0o/overlay/lib/python3.10/site-packages/numpy/__init__.pxd":950
+  /* "../../../.local/lib/python3.10/site-packages/numpy/__init__.pxd":950
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
-  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(1, 950, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__19);
-  __Pyx_GIVEREF(__pyx_tuple__19);
+  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(1, 950, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__20);
+  __Pyx_GIVEREF(__pyx_tuple__20);
 
   /* "View.MemoryView":134
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(2, 134, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__20);
-  __Pyx_GIVEREF(__pyx_tuple__20);
+  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(2, 134, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__21);
+  __Pyx_GIVEREF(__pyx_tuple__21);
 
   /* "View.MemoryView":137
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(2, 137, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
+  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(2, 137, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__22);
+  __Pyx_GIVEREF(__pyx_tuple__22);
 
   /* "View.MemoryView":149
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(2, 149, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__22);
-  __Pyx_GIVEREF(__pyx_tuple__22);
+  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(2, 149, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
 
   /* "View.MemoryView":177
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(2, 177, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
+  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(2, 177, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
 
   /* "View.MemoryView":193
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(2, 193, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__24);
-  __Pyx_GIVEREF(__pyx_tuple__24);
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(2, 193, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(2, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__25);
-  __Pyx_GIVEREF(__pyx_tuple__25);
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__26);
+  __Pyx_GIVEREF(__pyx_tuple__26);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
+  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__27);
+  __Pyx_GIVEREF(__pyx_tuple__27);
 
   /* "View.MemoryView":420
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(2, 420, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__27);
-  __Pyx_GIVEREF(__pyx_tuple__27);
+  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(2, 420, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__28);
+  __Pyx_GIVEREF(__pyx_tuple__28);
 
   /* "View.MemoryView":497
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(2, 497, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__28);
-  __Pyx_GIVEREF(__pyx_tuple__28);
+  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(2, 497, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__29);
+  __Pyx_GIVEREF(__pyx_tuple__29);
 
   /* "View.MemoryView":522
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(2, 522, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__29);
-  __Pyx_GIVEREF(__pyx_tuple__29);
+  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(2, 522, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__30);
+  __Pyx_GIVEREF(__pyx_tuple__30);
 
   /* "View.MemoryView":572
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(2, 572, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__30);
-  __Pyx_GIVEREF(__pyx_tuple__30);
+  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(2, 572, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__31);
+  __Pyx_GIVEREF(__pyx_tuple__31);
 
   /* "View.MemoryView":579
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
-  __pyx_tuple__31 = PyTuple_New(1); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(2, 579, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__31);
+  __pyx_tuple__32 = PyTuple_New(1); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(2, 579, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__32);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_tuple__31, 0, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_tuple__31);
+  PyTuple_SET_ITEM(__pyx_tuple__32, 0, __pyx_int_neg_1);
+  __Pyx_GIVEREF(__pyx_tuple__32);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(2, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__32);
-  __Pyx_GIVEREF(__pyx_tuple__32);
+  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__33);
+  __Pyx_GIVEREF(__pyx_tuple__33);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__33);
-  __Pyx_GIVEREF(__pyx_tuple__33);
+  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__34);
+  __Pyx_GIVEREF(__pyx_tuple__34);
 
   /* "View.MemoryView":705
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(2, 705, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__34);
-  __Pyx_GIVEREF(__pyx_tuple__34);
+  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(2, 705, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__35);
+  __Pyx_GIVEREF(__pyx_tuple__35);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(2, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__35);
-  __Pyx_GIVEREF(__pyx_tuple__35);
+  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__36);
+  __Pyx_GIVEREF(__pyx_tuple__36);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__36);
-  __Pyx_GIVEREF(__pyx_tuple__36);
-  __pyx_tuple__37 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_tuple__37 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__37);
   __Pyx_GIVEREF(__pyx_tuple__37);
+  __pyx_tuple__38 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__38);
+  __Pyx_GIVEREF(__pyx_tuple__38);
 
-  /* "cssm.pyx":125
+  /* "cssm.pyx":119
  * #@cython.wraparound(False)
  * 
  * def test(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *          np.ndarray[float, ndim = 1] a, # boundary separation
  *          np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
-  __pyx_tuple__38 = PyTuple_Pack(27, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 125, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__38);
-  __Pyx_GIVEREF(__pyx_tuple__38);
-  __pyx_codeobj__39 = (PyObject*)__Pyx_PyCode_New(10, 0, 27, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_test, 125, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 125, __pyx_L1_error)
+  __pyx_tuple__39 = PyTuple_Pack(27, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 119, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
+  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(10, 0, 27, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_test, 119, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 119, __pyx_L1_error)
 
-  /* "cssm.pyx":197
+  /* "cssm.pyx":191
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def full_ddm_hddm_base(np.ndarray[float, ndim = 1] v, # = 0,             # <<<<<<<<<<<<<<
  *                      np.ndarray[float, ndim = 1] a, # = 1,
  *                      np.ndarray[float, ndim = 1] z, # = 0.5,
  */
-  __pyx_tuple__40 = PyTuple_Pack(39, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_sz, __pyx_n_s_sv, __pyx_n_s_st, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_sz_view, __pyx_n_s_sv_view, __pyx_n_s_st_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_t_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_drift_increment, __pyx_n_s_gaussian_values); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 197, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__40);
-  __Pyx_GIVEREF(__pyx_tuple__40);
-  __pyx_codeobj__41 = (PyObject*)__Pyx_PyCode_New(13, 0, 39, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__40, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_full_ddm_hddm_base, 197, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__41)) __PYX_ERR(0, 197, __pyx_L1_error)
+  __pyx_tuple__41 = PyTuple_Pack(39, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_sz, __pyx_n_s_sv, __pyx_n_s_st, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_sz_view, __pyx_n_s_sv_view, __pyx_n_s_st_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_t_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_drift_increment, __pyx_n_s_gaussian_values); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 191, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
+  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(13, 0, 39, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_full_ddm_hddm_base, 191, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 191, __pyx_L1_error)
 
-  /* "cssm.pyx":320
+  /* "cssm.pyx":314
  * #@cython.wraparound(False)
  * 
  * def ddm(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *         np.ndarray[float, ndim = 1] a, # boundary separation
  *         np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
-  __pyx_tuple__42 = PyTuple_Pack(30, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 320, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__42);
-  __Pyx_GIVEREF(__pyx_tuple__42);
-  __pyx_codeobj__43 = (PyObject*)__Pyx_PyCode_New(10, 0, 30, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__42, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm, 320, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__43)) __PYX_ERR(0, 320, __pyx_L1_error)
+  __pyx_tuple__43 = PyTuple_Pack(30, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 314, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
+  __pyx_codeobj__44 = (PyObject*)__Pyx_PyCode_New(10, 0, 30, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm, 314, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(0, 314, __pyx_L1_error)
 
-  /* "cssm.pyx":410
+  /* "cssm.pyx":404
  * #@cython.wraparound(False)
  * 
  * def ddm_cov(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *             np.ndarray[float, ndim = 1] a, # boundary separation
  *             np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
-  __pyx_tuple__44 = PyTuple_Pack(27, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 410, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__44);
-  __Pyx_GIVEREF(__pyx_tuple__44);
-  __pyx_codeobj__45 = (PyObject*)__Pyx_PyCode_New(10, 0, 27, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_cov, 410, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__45)) __PYX_ERR(0, 410, __pyx_L1_error)
+  __pyx_tuple__45 = PyTuple_Pack(27, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 404, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__45);
+  __Pyx_GIVEREF(__pyx_tuple__45);
+  __pyx_codeobj__46 = (PyObject*)__Pyx_PyCode_New(10, 0, 27, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_cov, 404, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 404, __pyx_L1_error)
+
+  /* "cssm.pyx":478
+ * # @cythonwraparound(False)
+ * 
+ * def ddm_flexbound_deadline(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
+ *                            np.ndarray[float, ndim = 1] a,
+ *                            np.ndarray[float, ndim = 1] z,
+ */
+  __pyx_tuple__47 = PyTuple_Pack(41, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_deadline_adj, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_k, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_view, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 478, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__47);
+  __Pyx_GIVEREF(__pyx_tuple__47);
+  __pyx_codeobj__48 = (PyObject*)__Pyx_PyCode_New(14, 0, 41, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_deadline, 478, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__48)) __PYX_ERR(0, 478, __pyx_L1_error)
 
-  /* "cssm.pyx":481
+  /* "cssm.pyx":601
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                   np.ndarray[float, ndim = 1] a,
  *                   np.ndarray[float, ndim = 1] z,
  */
-  __pyx_tuple__46 = PyTuple_Pack(38, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_k, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_view, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 481, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__46);
-  __Pyx_GIVEREF(__pyx_tuple__46);
-  __pyx_codeobj__47 = (PyObject*)__Pyx_PyCode_New(13, 0, 38, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__46, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound, 481, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__47)) __PYX_ERR(0, 481, __pyx_L1_error)
+  __pyx_tuple__49 = PyTuple_Pack(38, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_k, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_view, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 601, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__49);
+  __Pyx_GIVEREF(__pyx_tuple__49);
+  __pyx_codeobj__50 = (PyObject*)__Pyx_PyCode_New(13, 0, 38, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound, 601, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__50)) __PYX_ERR(0, 601, __pyx_L1_error)
 
-  /* "cssm.pyx":595
+  /* "cssm.pyx":715
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flex(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *              np.ndarray[float, ndim = 1] a,
  *              np.ndarray[float, ndim = 1] z,
  */
-  __pyx_tuple__48 = PyTuple_Pack(44, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_drift_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_drift_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_drift, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_k, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_view, __pyx_n_s_drift_view, __pyx_n_s_drift_params_tmp, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key, __pyx_n_s_key); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 595, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__48);
-  __Pyx_GIVEREF(__pyx_tuple__48);
-  __pyx_codeobj__49 = (PyObject*)__Pyx_PyCode_New(15, 0, 44, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__48, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flex, 595, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__49)) __PYX_ERR(0, 595, __pyx_L1_error)
+  __pyx_tuple__51 = PyTuple_Pack(44, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_drift_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_drift_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_drift, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_k, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_view, __pyx_n_s_drift_view, __pyx_n_s_drift_params_tmp, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key, __pyx_n_s_key); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__51);
+  __Pyx_GIVEREF(__pyx_tuple__51);
+  __pyx_codeobj__52 = (PyObject*)__Pyx_PyCode_New(15, 0, 44, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__51, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flex, 715, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__52)) __PYX_ERR(0, 715, __pyx_L1_error)
 
-  /* "cssm.pyx":716
+  /* "cssm.pyx":836
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_max(float v = 0.0,             # <<<<<<<<<<<<<<
  *                       float a = 1.0,
  *                       float z = 0.5,
  */
-  __pyx_tuple__50 = PyTuple_Pack(29, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_k, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_view); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 716, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__50);
-  __Pyx_GIVEREF(__pyx_tuple__50);
-  __pyx_codeobj__51 = (PyObject*)__Pyx_PyCode_New(12, 0, 29, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__50, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_max, 716, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__51)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __pyx_tuple__53 = PyTuple_Pack(29, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_k, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_view); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__53);
+  __Pyx_GIVEREF(__pyx_tuple__53);
+  __pyx_codeobj__54 = (PyObject*)__Pyx_PyCode_New(12, 0, 29, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__53, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_max, 836, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__54)) __PYX_ERR(0, 836, __pyx_L1_error)
 
-  /* "cssm.pyx":803
+  /* "cssm.pyx":923
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def glob_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                    np.ndarray[float, ndim = 1] a,
  *                    np.ndarray[float, ndim = 1] z,
  */
-  __pyx_tuple__52 = PyTuple_Pack(41, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_alphar, __pyx_n_s_g, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_alphar_view, __pyx_n_s_g_view, __pyx_n_s_t_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_alpha, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_alpha_stable_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 803, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__52);
-  __Pyx_GIVEREF(__pyx_tuple__52);
-  __pyx_codeobj__53 = (PyObject*)__Pyx_PyCode_New(15, 0, 41, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__52, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_glob_flexbound, 803, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__53)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_tuple__55 = PyTuple_Pack(41, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_alphar, __pyx_n_s_g, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_alphar_view, __pyx_n_s_g_view, __pyx_n_s_t_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_alpha, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_alpha_stable_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 923, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__55);
+  __Pyx_GIVEREF(__pyx_tuple__55);
+  __pyx_codeobj__56 = (PyObject*)__Pyx_PyCode_New(15, 0, 41, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__55, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_glob_flexbound, 923, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__56)) __PYX_ERR(0, 923, __pyx_L1_error)
 
-  /* "cssm.pyx":917
+  /* "cssm.pyx":1037
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def levy_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                    np.ndarray[float, ndim = 1] a,
  *                    np.ndarray[float, ndim = 1] z,
  */
-  __pyx_tuple__54 = PyTuple_Pack(39, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_alpha_diff, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_alpha_diff_view, __pyx_n_s_t_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_alpha, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_alpha_stable_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 917, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__54);
-  __Pyx_GIVEREF(__pyx_tuple__54);
-  __pyx_codeobj__55 = (PyObject*)__Pyx_PyCode_New(14, 0, 39, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__54, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_levy_flexbound, 917, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__55)) __PYX_ERR(0, 917, __pyx_L1_error)
+  __pyx_tuple__57 = PyTuple_Pack(39, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_alpha_diff, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_alpha_diff_view, __pyx_n_s_t_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_alpha, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_alpha_stable_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 1037, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__57);
+  __Pyx_GIVEREF(__pyx_tuple__57);
+  __pyx_codeobj__58 = (PyObject*)__Pyx_PyCode_New(14, 0, 39, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__57, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_levy_flexbound, 1037, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__58)) __PYX_ERR(0, 1037, __pyx_L1_error)
 
-  /* "cssm.pyx":1027
+  /* "cssm.pyx":1147
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def full_ddm(np.ndarray[float, ndim = 1] v, # = 0,             # <<<<<<<<<<<<<<
  *              np.ndarray[float, ndim = 1] a, # = 1,
  *              np.ndarray[float, ndim = 1] z, # = 0.5,
  */
-  __pyx_tuple__56 = PyTuple_Pack(46, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_sz, __pyx_n_s_sv, __pyx_n_s_st, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_sz_view, __pyx_n_s_sv_view, __pyx_n_s_st_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_t_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_drift_increment, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 1027, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__56);
-  __Pyx_GIVEREF(__pyx_tuple__56);
-  __pyx_codeobj__57 = (PyObject*)__Pyx_PyCode_New(16, 0, 46, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__56, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_full_ddm, 1027, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__57)) __PYX_ERR(0, 1027, __pyx_L1_error)
+  __pyx_tuple__59 = PyTuple_Pack(46, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_sz, __pyx_n_s_sv, __pyx_n_s_st, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_sz_view, __pyx_n_s_sv_view, __pyx_n_s_st_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_t_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_drift_increment, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 1147, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__59);
+  __Pyx_GIVEREF(__pyx_tuple__59);
+  __pyx_codeobj__60 = (PyObject*)__Pyx_PyCode_New(16, 0, 46, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__59, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_full_ddm, 1147, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__60)) __PYX_ERR(0, 1147, __pyx_L1_error)
 
-  /* "cssm.pyx":1159
+  /* "cssm.pyx":1279
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_sdv(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *             np.ndarray[float, ndim = 1] a,
  *             np.ndarray[float, ndim = 1] z,
  */
-  __pyx_tuple__58 = PyTuple_Pack(41, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_sv, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_sv_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_drift_increment, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 1159, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__58);
-  __Pyx_GIVEREF(__pyx_tuple__58);
-  __pyx_codeobj__59 = (PyObject*)__Pyx_PyCode_New(14, 0, 41, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__58, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_sdv, 1159, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__59)) __PYX_ERR(0, 1159, __pyx_L1_error)
+  __pyx_tuple__61 = PyTuple_Pack(41, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_sv, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_sv_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_drift_increment, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 1279, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__61);
+  __Pyx_GIVEREF(__pyx_tuple__61);
+  __pyx_codeobj__62 = (PyObject*)__Pyx_PyCode_New(14, 0, 41, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__61, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_sdv, 1279, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__62)) __PYX_ERR(0, 1279, __pyx_L1_error)
 
-  /* "cssm.pyx":1288
+  /* "cssm.pyx":1400
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ornstein_uhlenbeck(np.ndarray[float, ndim = 1] v, # drift parameter             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] a, # initial boundary separation
  *                        np.ndarray[float, ndim = 1] z, # starting point bias
  */
-  __pyx_tuple__60 = PyTuple_Pack(40, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_g, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_g_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 1288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__60);
-  __Pyx_GIVEREF(__pyx_tuple__60);
-  __pyx_codeobj__61 = (PyObject*)__Pyx_PyCode_New(14, 0, 40, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ornstein_uhlenbeck, 1288, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__61)) __PYX_ERR(0, 1288, __pyx_L1_error)
+  __pyx_tuple__63 = PyTuple_Pack(40, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_g, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_g_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 1400, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__63);
+  __Pyx_GIVEREF(__pyx_tuple__63);
+  __pyx_codeobj__64 = (PyObject*)__Pyx_PyCode_New(14, 0, 40, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__63, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ornstein_uhlenbeck, 1400, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__64)) __PYX_ERR(0, 1400, __pyx_L1_error)
 
-  /* "cssm.pyx":1426
+  /* "cssm.pyx":1538
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def race_model(np.ndarray[float, ndim = 2] v,  # np.array expected, one column of floats             # <<<<<<<<<<<<<<
  *                np.ndarray[float, ndim = 2] a, # initial boundary separation
  *                np.ndarray[float, ndim = 2] z, # np.array expected, one column of floats
  */
-  __pyx_tuple__62 = PyTuple_Pack(47, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_z_view, __pyx_n_s_a_view, __pyx_n_s_t_view, __pyx_n_s_s_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_sqrt_st_view, __pyx_n_s_n_particles, __pyx_n_s_rts, __pyx_n_s_rts_view, __pyx_n_s_choices, __pyx_n_s_choices_view, __pyx_n_s_particles, __pyx_n_s_particles_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_num_steps, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_v_dict, __pyx_n_s_z_dict, __pyx_n_s_i, __pyx_n_s_key); if (unlikely(!__pyx_tuple__62)) __PYX_ERR(0, 1426, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__62);
-  __Pyx_GIVEREF(__pyx_tuple__62);
-  __pyx_codeobj__63 = (PyObject*)__Pyx_PyCode_New(13, 0, 47, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__62, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_race_model, 1426, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__63)) __PYX_ERR(0, 1426, __pyx_L1_error)
+  __pyx_tuple__65 = PyTuple_Pack(47, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_z_view, __pyx_n_s_a_view, __pyx_n_s_t_view, __pyx_n_s_s_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_sqrt_st_view, __pyx_n_s_n_particles, __pyx_n_s_rts, __pyx_n_s_rts_view, __pyx_n_s_choices, __pyx_n_s_choices_view, __pyx_n_s_particles, __pyx_n_s_particles_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_num_steps, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_t_particle, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_v_dict, __pyx_n_s_z_dict, __pyx_n_s_i, __pyx_n_s_key); if (unlikely(!__pyx_tuple__65)) __PYX_ERR(0, 1538, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__65);
+  __Pyx_GIVEREF(__pyx_tuple__65);
+  __pyx_codeobj__66 = (PyObject*)__Pyx_PyCode_New(13, 0, 47, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__65, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_race_model, 1538, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__66)) __PYX_ERR(0, 1538, __pyx_L1_error)
 
-  /* "cssm.pyx":1553
+  /* "cssm.pyx":1665
  * 
  * # Simulate (rt, choice) tuples from: Leaky Competing Accumulator Model -----------------------------
  * def lca(np.ndarray[float, ndim = 2] v, # drift parameters (np.array expect: one column of floats)             # <<<<<<<<<<<<<<
  *         np.ndarray[float, ndim = 2] a, # criterion height
  *         np.ndarray[float, ndim = 2] z, # initial bias parameters (np.array expect: one column of floats)
  */
-  __pyx_tuple__64 = PyTuple_Pack(54, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_g, __pyx_n_s_b, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_g_view, __pyx_n_s_b_view, __pyx_n_s_t_view, __pyx_n_s_s_view, __pyx_n_s_n_particles, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_rts_view, __pyx_n_s_choices, __pyx_n_s_choices_view, __pyx_n_s_particles, __pyx_n_s_particles_view, __pyx_n_s_particles_reduced_sum, __pyx_n_s_particles_reduced_sum_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_sqrt_st_view, __pyx_n_s_n, __pyx_n_s_i, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_t_par, __pyx_n_s_particles_sum, __pyx_n_s_num_steps, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_t_particle, __pyx_n_s_v_dict, __pyx_n_s_z_dict, __pyx_n_s_key); if (unlikely(!__pyx_tuple__64)) __PYX_ERR(0, 1553, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__64);
-  __Pyx_GIVEREF(__pyx_tuple__64);
-  __pyx_codeobj__65 = (PyObject*)__Pyx_PyCode_New(15, 0, 54, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__64, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_lca, 1553, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__65)) __PYX_ERR(0, 1553, __pyx_L1_error)
+  __pyx_tuple__67 = PyTuple_Pack(54, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_g, __pyx_n_s_b, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_g_view, __pyx_n_s_b_view, __pyx_n_s_t_view, __pyx_n_s_s_view, __pyx_n_s_n_particles, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_rts_view, __pyx_n_s_choices, __pyx_n_s_choices_view, __pyx_n_s_particles, __pyx_n_s_particles_view, __pyx_n_s_particles_reduced_sum, __pyx_n_s_particles_reduced_sum_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_sqrt_st_view, __pyx_n_s_n, __pyx_n_s_i, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_t_par, __pyx_n_s_particles_sum, __pyx_n_s_num_steps, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_t_particle, __pyx_n_s_v_dict, __pyx_n_s_z_dict, __pyx_n_s_key); if (unlikely(!__pyx_tuple__67)) __PYX_ERR(0, 1665, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__67);
+  __Pyx_GIVEREF(__pyx_tuple__67);
+  __pyx_codeobj__68 = (PyObject*)__Pyx_PyCode_New(15, 0, 54, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__67, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_lca, 1665, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__68)) __PYX_ERR(0, 1665, __pyx_L1_error)
 
-  /* "cssm.pyx":1696
+  /* "cssm.pyx":1808
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_seq2(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] v_l_1,
  *                        np.ndarray[float, ndim = 1] v_l_2,
  */
-  __pyx_tuple__66 = PyTuple_Pack(47, __pyx_n_s_v_h, __pyx_n_s_v_l_1, __pyx_n_s_v_l_2, __pyx_n_s_a, __pyx_n_s_z_h, __pyx_n_s_z_l_1, __pyx_n_s_z_l_2, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_h_view, __pyx_n_s_v_l_1_view, __pyx_n_s_v_l_2_view, __pyx_n_s_a_view, __pyx_n_s_z_h_view, __pyx_n_s_z_l_1_view, __pyx_n_s_z_l_2_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y_h, __pyx_n_s_t_particle, __pyx_n_s_y_l, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_v_l, __pyx_n_s_key); if (unlikely(!__pyx_tuple__66)) __PYX_ERR(0, 1696, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__66);
-  __Pyx_GIVEREF(__pyx_tuple__66);
-  __pyx_codeobj__67 = (PyObject*)__Pyx_PyCode_New(18, 0, 47, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__66, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_seq2, 1696, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__67)) __PYX_ERR(0, 1696, __pyx_L1_error)
+  __pyx_tuple__69 = PyTuple_Pack(47, __pyx_n_s_v_h, __pyx_n_s_v_l_1, __pyx_n_s_v_l_2, __pyx_n_s_a, __pyx_n_s_z_h, __pyx_n_s_z_l_1, __pyx_n_s_z_l_2, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_h_view, __pyx_n_s_v_l_1_view, __pyx_n_s_v_l_2_view, __pyx_n_s_a_view, __pyx_n_s_z_h_view, __pyx_n_s_z_l_1_view, __pyx_n_s_z_l_2_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y_h, __pyx_n_s_t_particle, __pyx_n_s_y_l, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_v_l, __pyx_n_s_key); if (unlikely(!__pyx_tuple__69)) __PYX_ERR(0, 1808, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__69);
+  __Pyx_GIVEREF(__pyx_tuple__69);
+  __pyx_codeobj__70 = (PyObject*)__Pyx_PyCode_New(18, 0, 47, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__69, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_seq2, 1808, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__70)) __PYX_ERR(0, 1808, __pyx_L1_error)
 
-  /* "cssm.pyx":1842
+  /* "cssm.pyx":1954
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_par2(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] v_l_1,
  *                        np.ndarray[float, ndim = 1] v_l_2,
  */
-  __pyx_tuple__68 = PyTuple_Pack(48, __pyx_n_s_v_h, __pyx_n_s_v_l_1, __pyx_n_s_v_l_2, __pyx_n_s_a, __pyx_n_s_z_h, __pyx_n_s_z_l_1, __pyx_n_s_z_l_2, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_h_view, __pyx_n_s_v_l_1_view, __pyx_n_s_v_l_2_view, __pyx_n_s_a_view, __pyx_n_s_z_h_view, __pyx_n_s_z_l_1_view, __pyx_n_s_z_l_2_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_v_l, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_k, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__68)) __PYX_ERR(0, 1842, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__68);
-  __Pyx_GIVEREF(__pyx_tuple__68);
-  __pyx_codeobj__69 = (PyObject*)__Pyx_PyCode_New(18, 0, 48, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__68, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_par2, 1842, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__69)) __PYX_ERR(0, 1842, __pyx_L1_error)
+  __pyx_tuple__71 = PyTuple_Pack(48, __pyx_n_s_v_h, __pyx_n_s_v_l_1, __pyx_n_s_v_l_2, __pyx_n_s_a, __pyx_n_s_z_h, __pyx_n_s_z_l_1, __pyx_n_s_z_l_2, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_h_view, __pyx_n_s_v_l_1_view, __pyx_n_s_v_l_2_view, __pyx_n_s_a_view, __pyx_n_s_z_h_view, __pyx_n_s_z_l_1_view, __pyx_n_s_z_l_2_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_v_l, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_k, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__71)) __PYX_ERR(0, 1954, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__71);
+  __Pyx_GIVEREF(__pyx_tuple__71);
+  __pyx_codeobj__72 = (PyObject*)__Pyx_PyCode_New(18, 0, 48, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__71, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_par2, 1954, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__72)) __PYX_ERR(0, 1954, __pyx_L1_error)
 
-  /* "cssm.pyx":1976
+  /* "cssm.pyx":2088
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_mic2_adj(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                            np.ndarray[float, ndim = 1] v_l_1,
  *                            np.ndarray[float, ndim = 1] v_l_2,
  */
-  __pyx_tuple__70 = PyTuple_Pack(53, __pyx_n_s_v_h, __pyx_n_s_v_l_1, __pyx_n_s_v_l_2, __pyx_n_s_a, __pyx_n_s_z_h, __pyx_n_s_z_l_1, __pyx_n_s_z_l_2, __pyx_n_s_d, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_h_view, __pyx_n_s_v_l_1_view, __pyx_n_s_v_l_2_view, __pyx_n_s_a_view, __pyx_n_s_z_h_view, __pyx_n_s_z_l_1_view, __pyx_n_s_z_l_2_view, __pyx_n_s_d_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_bias_trace, __pyx_n_s_bias_trace_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_v_l, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_ix_tmp, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__70)) __PYX_ERR(0, 1976, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__70);
-  __Pyx_GIVEREF(__pyx_tuple__70);
-  __pyx_codeobj__71 = (PyObject*)__Pyx_PyCode_New(19, 0, 53, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__70, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_mic2_adj, 1976, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__71)) __PYX_ERR(0, 1976, __pyx_L1_error)
+  __pyx_tuple__73 = PyTuple_Pack(53, __pyx_n_s_v_h, __pyx_n_s_v_l_1, __pyx_n_s_v_l_2, __pyx_n_s_a, __pyx_n_s_z_h, __pyx_n_s_z_l_1, __pyx_n_s_z_l_2, __pyx_n_s_d, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_h_view, __pyx_n_s_v_l_1_view, __pyx_n_s_v_l_2_view, __pyx_n_s_a_view, __pyx_n_s_z_h_view, __pyx_n_s_z_l_1_view, __pyx_n_s_z_l_2_view, __pyx_n_s_d_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_bias_trace, __pyx_n_s_bias_trace_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_v_l, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_ix_tmp, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__73)) __PYX_ERR(0, 2088, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__73);
+  __Pyx_GIVEREF(__pyx_tuple__73);
+  __pyx_codeobj__74 = (PyObject*)__Pyx_PyCode_New(19, 0, 53, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__73, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_mic2_adj, 2088, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__74)) __PYX_ERR(0, 2088, __pyx_L1_error)
 
-  /* "cssm.pyx":2149
+  /* "cssm.pyx":2261
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_tradeoff(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                            np.ndarray[float, ndim = 1] v_l_1,
  *                            np.ndarray[float, ndim = 1] v_l_2,
  */
-  __pyx_tuple__72 = PyTuple_Pack(54, __pyx_n_s_v_h, __pyx_n_s_v_l_1, __pyx_n_s_v_l_2, __pyx_n_s_a, __pyx_n_s_z_h, __pyx_n_s_z_l_1, __pyx_n_s_z_l_2, __pyx_n_s_d, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_h_view, __pyx_n_s_v_l_1_view, __pyx_n_s_v_l_2_view, __pyx_n_s_a_view, __pyx_n_s_z_h_view, __pyx_n_s_z_l_1_view, __pyx_n_s_z_l_2_view, __pyx_n_s_d_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_bias_trace, __pyx_n_s_bias_trace_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_v_l, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_tmp_pos_dep, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_ix_tmp, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__72)) __PYX_ERR(0, 2149, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__72);
-  __Pyx_GIVEREF(__pyx_tuple__72);
-  __pyx_codeobj__73 = (PyObject*)__Pyx_PyCode_New(19, 0, 54, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__72, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_tradeoff, 2149, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__73)) __PYX_ERR(0, 2149, __pyx_L1_error)
+  __pyx_tuple__75 = PyTuple_Pack(54, __pyx_n_s_v_h, __pyx_n_s_v_l_1, __pyx_n_s_v_l_2, __pyx_n_s_a, __pyx_n_s_z_h, __pyx_n_s_z_l_1, __pyx_n_s_z_l_2, __pyx_n_s_d, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_v_h_view, __pyx_n_s_v_l_1_view, __pyx_n_s_v_l_2_view, __pyx_n_s_a_view, __pyx_n_s_z_h_view, __pyx_n_s_z_l_1_view, __pyx_n_s_z_l_2_view, __pyx_n_s_d_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_bias_trace, __pyx_n_s_bias_trace_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_v_l, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_tmp_pos_dep, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_ix_tmp, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key); if (unlikely(!__pyx_tuple__75)) __PYX_ERR(0, 2261, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__75);
+  __Pyx_GIVEREF(__pyx_tuple__75);
+  __pyx_codeobj__76 = (PyObject*)__Pyx_PyCode_New(19, 0, 54, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__75, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_tradeoff, 2261, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__76)) __PYX_ERR(0, 2261, __pyx_L1_error)
 
   /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_tuple__74 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__74)) __PYX_ERR(2, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__74);
-  __Pyx_GIVEREF(__pyx_tuple__74);
+  __pyx_tuple__77 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__77)) __PYX_ERR(2, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__77);
+  __Pyx_GIVEREF(__pyx_tuple__77);
 
   /* "View.MemoryView":288
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_tuple__75 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__75)) __PYX_ERR(2, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__75);
-  __Pyx_GIVEREF(__pyx_tuple__75);
+  __pyx_tuple__78 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__78)) __PYX_ERR(2, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__78);
+  __Pyx_GIVEREF(__pyx_tuple__78);
 
   /* "View.MemoryView":289
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__76 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__76)) __PYX_ERR(2, 289, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__76);
-  __Pyx_GIVEREF(__pyx_tuple__76);
+  __pyx_tuple__79 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__79)) __PYX_ERR(2, 289, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__79);
+  __Pyx_GIVEREF(__pyx_tuple__79);
 
   /* "View.MemoryView":292
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_tuple__77 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__77)) __PYX_ERR(2, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__77);
-  __Pyx_GIVEREF(__pyx_tuple__77);
+  __pyx_tuple__80 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__80)) __PYX_ERR(2, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__80);
+  __Pyx_GIVEREF(__pyx_tuple__80);
 
   /* "View.MemoryView":293
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__78 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__78)) __PYX_ERR(2, 293, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__78);
-  __Pyx_GIVEREF(__pyx_tuple__78);
+  __pyx_tuple__81 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__81)) __PYX_ERR(2, 293, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__81);
+  __Pyx_GIVEREF(__pyx_tuple__81);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_tuple__79 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__79)) __PYX_ERR(2, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__79);
-  __Pyx_GIVEREF(__pyx_tuple__79);
-  __pyx_codeobj__80 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__79, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__80)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __pyx_tuple__82 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__82)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__82);
+  __Pyx_GIVEREF(__pyx_tuple__82);
+  __pyx_codeobj__83 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__82, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__83)) __PYX_ERR(2, 1, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -50225,423 +51742,448 @@
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float32); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 18, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":125
+  /* "cssm.pyx":119
  * #@cython.wraparound(False)
  * 
  * def test(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *          np.ndarray[float, ndim = 1] a, # boundary separation
  *          np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_1test, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 125, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_1test, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":197
+  /* "cssm.pyx":191
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def full_ddm_hddm_base(np.ndarray[float, ndim = 1] v, # = 0,             # <<<<<<<<<<<<<<
  *                      np.ndarray[float, ndim = 1] a, # = 1,
  *                      np.ndarray[float, ndim = 1] z, # = 0.5,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_3full_ddm_hddm_base, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 197, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_3full_ddm_hddm_base, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 191, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_full_ddm_hddm_base, __pyx_t_2) < 0) __PYX_ERR(0, 197, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_full_ddm_hddm_base, __pyx_t_2) < 0) __PYX_ERR(0, 191, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":320
+  /* "cssm.pyx":314
  * #@cython.wraparound(False)
  * 
  * def ddm(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *         np.ndarray[float, ndim = 1] a, # boundary separation
  *         np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_5ddm, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_5ddm, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 314, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm, __pyx_t_2) < 0) __PYX_ERR(0, 320, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm, __pyx_t_2) < 0) __PYX_ERR(0, 314, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":410
+  /* "cssm.pyx":404
  * #@cython.wraparound(False)
  * 
  * def ddm_cov(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'             # <<<<<<<<<<<<<<
  *             np.ndarray[float, ndim = 1] a, # boundary separation
  *             np.ndarray[float, ndim = 1] z,  # between 0 and 1
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_7ddm_cov, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 410, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_7ddm_cov, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 404, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_cov, __pyx_t_2) < 0) __PYX_ERR(0, 404, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+  /* "cssm.pyx":490
+ *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
+ *                            boundary_multiplicative = True,
+ *                            boundary_params = {},             # <<<<<<<<<<<<<<
+ *                            random_state = None,
+ *                            ):
+ */
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 490, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_k__3 = __pyx_t_2;
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "cssm.pyx":478
+ * # @cythonwraparound(False)
+ * 
+ * def ddm_flexbound_deadline(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
+ *                            np.ndarray[float, ndim = 1] a,
+ *                            np.ndarray[float, ndim = 1] z,
+ */
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_9ddm_flexbound_deadline, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 478, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_cov, __pyx_t_2) < 0) __PYX_ERR(0, 410, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_deadline, __pyx_t_2) < 0) __PYX_ERR(0, 478, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":492
+  /* "cssm.pyx":612
  *                   boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                   boundary_multiplicative = True,
  *                   boundary_params = {},             # <<<<<<<<<<<<<<
  *                   random_state = None,
  *                   ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 492, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 612, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__3 = __pyx_t_2;
+  __pyx_k__4 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":481
+  /* "cssm.pyx":601
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                   np.ndarray[float, ndim = 1] a,
  *                   np.ndarray[float, ndim = 1] z,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_9ddm_flexbound, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 481, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_11ddm_flexbound, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 601, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound, __pyx_t_2) < 0) __PYX_ERR(0, 481, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound, __pyx_t_2) < 0) __PYX_ERR(0, 601, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":607
+  /* "cssm.pyx":727
  *              drift_fun = None,
  *              boundary_multiplicative = True,
  *              boundary_params = {},             # <<<<<<<<<<<<<<
  *              drift_params = {},
  *              random_state = None,
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 607, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__4 = __pyx_t_2;
+  __pyx_k__5 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":608
+  /* "cssm.pyx":728
  *              boundary_multiplicative = True,
  *              boundary_params = {},
  *              drift_params = {},             # <<<<<<<<<<<<<<
  *              random_state = None,
  *              ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 608, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 728, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__5 = __pyx_t_2;
+  __pyx_k__6 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":595
+  /* "cssm.pyx":715
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flex(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *              np.ndarray[float, ndim = 1] a,
  *              np.ndarray[float, ndim = 1] z,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_11ddm_flex, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 595, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_13ddm_flex, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flex, __pyx_t_2) < 0) __PYX_ERR(0, 595, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flex, __pyx_t_2) < 0) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":726
+  /* "cssm.pyx":846
  *                       boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                       boundary_multiplicative = True,
  *                       boundary_params = {},             # <<<<<<<<<<<<<<
  *                       random_state = None,
  *                       ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__6 = __pyx_t_2;
+  __pyx_k__7 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":716
+  /* "cssm.pyx":836
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_max(float v = 0.0,             # <<<<<<<<<<<<<<
  *                       float a = 1.0,
  *                       float z = 0.5,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_13ddm_flexbound_max, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_15ddm_flexbound_max, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 836, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_max, __pyx_t_2) < 0) __PYX_ERR(0, 716, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_max, __pyx_t_2) < 0) __PYX_ERR(0, 836, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":816
+  /* "cssm.pyx":936
  *                    boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                    boundary_multiplicative = True,
  *                    boundary_params = {},             # <<<<<<<<<<<<<<
  *                    random_state = None,
  *                    ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 936, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__7 = __pyx_t_2;
+  __pyx_k__8 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":803
+  /* "cssm.pyx":923
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def glob_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                    np.ndarray[float, ndim = 1] a,
  *                    np.ndarray[float, ndim = 1] z,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_15glob_flexbound, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_17glob_flexbound, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 923, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_glob_flexbound, __pyx_t_2) < 0) __PYX_ERR(0, 803, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_glob_flexbound, __pyx_t_2) < 0) __PYX_ERR(0, 923, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":929
+  /* "cssm.pyx":1049
  *                    boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                    boundary_multiplicative = True,
  *                    boundary_params = {},             # <<<<<<<<<<<<<<
  *                    random_state = None,
  *                    ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__8 = __pyx_t_2;
+  __pyx_k__9 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":917
+  /* "cssm.pyx":1037
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def levy_flexbound(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *                    np.ndarray[float, ndim = 1] a,
  *                    np.ndarray[float, ndim = 1] z,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_17levy_flexbound, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 917, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_19levy_flexbound, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1037, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_levy_flexbound, __pyx_t_2) < 0) __PYX_ERR(0, 917, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_levy_flexbound, __pyx_t_2) < 0) __PYX_ERR(0, 1037, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1041
+  /* "cssm.pyx":1161
  *              boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *              boundary_multiplicative = True,
  *              boundary_params = {},             # <<<<<<<<<<<<<<
  *              random_state = None,):
  * 
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1161, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__9 = __pyx_t_2;
+  __pyx_k__10 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1027
+  /* "cssm.pyx":1147
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def full_ddm(np.ndarray[float, ndim = 1] v, # = 0,             # <<<<<<<<<<<<<<
  *              np.ndarray[float, ndim = 1] a, # = 1,
  *              np.ndarray[float, ndim = 1] z, # = 0.5,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_19full_ddm, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1027, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_21full_ddm, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_full_ddm, __pyx_t_2) < 0) __PYX_ERR(0, 1027, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_full_ddm, __pyx_t_2) < 0) __PYX_ERR(0, 1147, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1171
+  /* "cssm.pyx":1291
  *             boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *             boundary_multiplicative = True,
  *             boundary_params = {},             # <<<<<<<<<<<<<<
  *             random_state = None,
  *             ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1171, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__10 = __pyx_t_2;
+  __pyx_k__11 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1159
+  /* "cssm.pyx":1279
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_sdv(np.ndarray[float, ndim = 1] v,             # <<<<<<<<<<<<<<
  *             np.ndarray[float, ndim = 1] a,
  *             np.ndarray[float, ndim = 1] z,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_21ddm_sdv, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1159, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_23ddm_sdv, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1279, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_sdv, __pyx_t_2) < 0) __PYX_ERR(0, 1159, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_sdv, __pyx_t_2) < 0) __PYX_ERR(0, 1279, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1300
+  /* "cssm.pyx":1412
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                        boundary_multiplicative = True,
  *                        boundary_params = {},             # <<<<<<<<<<<<<<
  *                        random_state = None,
  *                       ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1300, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1412, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__11 = __pyx_t_2;
+  __pyx_k__12 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1288
+  /* "cssm.pyx":1400
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ornstein_uhlenbeck(np.ndarray[float, ndim = 1] v, # drift parameter             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] a, # initial boundary separation
  *                        np.ndarray[float, ndim = 1] z, # starting point bias
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_23ornstein_uhlenbeck, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1288, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_25ornstein_uhlenbeck, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1400, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ornstein_uhlenbeck, __pyx_t_2) < 0) __PYX_ERR(0, 1288, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ornstein_uhlenbeck, __pyx_t_2) < 0) __PYX_ERR(0, 1400, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1437
+  /* "cssm.pyx":1549
  *                boundary_fun = None,
  *                boundary_multiplicative = True,
  *                boundary_params = {},             # <<<<<<<<<<<<<<
  *                random_state = None,):
  * 
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1437, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__12 = __pyx_t_2;
+  __pyx_k__13 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1426
+  /* "cssm.pyx":1538
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def race_model(np.ndarray[float, ndim = 2] v,  # np.array expected, one column of floats             # <<<<<<<<<<<<<<
  *                np.ndarray[float, ndim = 2] a, # initial boundary separation
  *                np.ndarray[float, ndim = 2] z, # np.array expected, one column of floats
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_25race_model, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1426, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_27race_model, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1538, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_race_model, __pyx_t_2) < 0) __PYX_ERR(0, 1426, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_race_model, __pyx_t_2) < 0) __PYX_ERR(0, 1538, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1566
+  /* "cssm.pyx":1678
  *         boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *         boundary_multiplicative = True,
  *         boundary_params = {},             # <<<<<<<<<<<<<<
  *         random_state = None,):
  * 
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1566, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__13 = __pyx_t_2;
+  __pyx_k__14 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1553
+  /* "cssm.pyx":1665
  * 
  * # Simulate (rt, choice) tuples from: Leaky Competing Accumulator Model -----------------------------
  * def lca(np.ndarray[float, ndim = 2] v, # drift parameters (np.array expect: one column of floats)             # <<<<<<<<<<<<<<
  *         np.ndarray[float, ndim = 2] a, # criterion height
  *         np.ndarray[float, ndim = 2] z, # initial bias parameters (np.array expect: one column of floats)
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_27lca, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1553, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_29lca, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1665, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_lca, __pyx_t_2) < 0) __PYX_ERR(0, 1553, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_lca, __pyx_t_2) < 0) __PYX_ERR(0, 1665, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1712
+  /* "cssm.pyx":1824
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                        boundary_multiplicative = True,
  *                        boundary_params = {},             # <<<<<<<<<<<<<<
  *                        random_state = None,
  *                        ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1712, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1824, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__14 = __pyx_t_2;
+  __pyx_k__15 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1696
+  /* "cssm.pyx":1808
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_seq2(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] v_l_1,
  *                        np.ndarray[float, ndim = 1] v_l_2,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_29ddm_flexbound_seq2, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1696, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_31ddm_flexbound_seq2, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_seq2, __pyx_t_2) < 0) __PYX_ERR(0, 1696, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_seq2, __pyx_t_2) < 0) __PYX_ERR(0, 1808, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1858
+  /* "cssm.pyx":1970
  *                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                        boundary_multiplicative = True,
  *                        boundary_params = {},             # <<<<<<<<<<<<<<
  *                        random_state = None,
  *                        ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1858, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1970, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__15 = __pyx_t_2;
+  __pyx_k__16 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1842
+  /* "cssm.pyx":1954
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_par2(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                        np.ndarray[float, ndim = 1] v_l_1,
  *                        np.ndarray[float, ndim = 1] v_l_2,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_31ddm_flexbound_par2, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1842, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_33ddm_flexbound_par2, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1954, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_par2, __pyx_t_2) < 0) __PYX_ERR(0, 1842, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_par2, __pyx_t_2) < 0) __PYX_ERR(0, 1954, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1993
+  /* "cssm.pyx":2105
  *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                            boundary_multiplicative = True,
  *                            boundary_params = {},             # <<<<<<<<<<<<<<
  *                            random_state = None,
  *                            ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1993, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2105, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__16 = __pyx_t_2;
+  __pyx_k__17 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":1976
+  /* "cssm.pyx":2088
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_mic2_adj(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                            np.ndarray[float, ndim = 1] v_l_1,
  *                            np.ndarray[float, ndim = 1] v_l_2,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_33ddm_flexbound_mic2_adj, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1976, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_35ddm_flexbound_mic2_adj, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2088, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_mic2_adj, __pyx_t_2) < 0) __PYX_ERR(0, 1976, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_mic2_adj, __pyx_t_2) < 0) __PYX_ERR(0, 2088, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "cssm.pyx":2166
+  /* "cssm.pyx":2278
  *                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
  *                            boundary_multiplicative = True,
  *                            boundary_params = {},             # <<<<<<<<<<<<<<
  *                            random_state = None,
  *                            ):
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2166, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_k__17 = __pyx_t_2;
+  __pyx_k__18 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "cssm.pyx":2149
+  /* "cssm.pyx":2261
  * # @cythonboundscheck(False)
  * # @cythonwraparound(False)
  * def ddm_flexbound_tradeoff(np.ndarray[float, ndim = 1] v_h,             # <<<<<<<<<<<<<<
  *                            np.ndarray[float, ndim = 1] v_l_1,
  *                            np.ndarray[float, ndim = 1] v_l_2,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_35ddm_flexbound_tradeoff, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2149, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_4cssm_37ddm_flexbound_tradeoff, NULL, __pyx_n_s_cssm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2261, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_tradeoff, __pyx_t_2) < 0) __PYX_ERR(0, 2149, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ddm_flexbound_tradeoff, __pyx_t_2) < 0) __PYX_ERR(0, 2261, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "cssm.pyx":1
  * # Globaly settings for cython             # <<<<<<<<<<<<<<
  * # cython: cdivision=True
  * # cython: wraparound=False
  */
@@ -50666,71 +52208,71 @@
   /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__74, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 287, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__77, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 287, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(generic);
   __Pyx_DECREF_SET(generic, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
   /* "View.MemoryView":288
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__75, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 288, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__78, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(strided);
   __Pyx_DECREF_SET(strided, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
   /* "View.MemoryView":289
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__76, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 289, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__79, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(indirect);
   __Pyx_DECREF_SET(indirect, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
   /* "View.MemoryView":292
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__77, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 292, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__80, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 292, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(contiguous);
   __Pyx_DECREF_SET(contiguous, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
   /* "View.MemoryView":293
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__78, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 293, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__81, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 293, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(indirect_contiguous);
   __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
   /* "View.MemoryView":317
```

### Comparing `ssm-simulators-0.3.0/src/cssm.pyx` & `ssm-simulators-0.3.1/src/cssm.pyx`

 * *Files 2% similar despite different names*

```diff
@@ -33,29 +33,23 @@
     return r / RAND_MAX
 
 cdef float random_exponential():
     return - log(random_uniform())
 
 cdef float random_stable(float alpha_diff):
     cdef float eta, u, w, x
-    # chi = - tan(M_PI_2 * alpha_diff)
 
     u = M_PI * (random_uniform() - 0.5)
     w = random_exponential()
 
     if alpha_diff == 1.0:
         eta = M_PI_2 # useless but kept to remain faithful to wikipedia entry
         x = (1.0 / eta) * ((M_PI_2) * tan(u))
-        # x = (1.0 / eta) * ((M_PI_2 + u) * tan(u) - log((M_PI_2 * w * cos(u)) / (M_PI_2 + u)))
     else:
-        # eta = (1.0 / alpha_diff) * atan(- chi)
         x = (sin(alpha_diff * u) / (pow(cos(u), 1 / alpha_diff))) * pow(cos(u - (alpha_diff * u)) / w, (1.0 - alpha_diff) / alpha_diff)
-        # x = pow((1.0 + chi * chi), 1.0 / (2.0 * alpha_diff)) * \
-        #        (sin(alpha_diff * (u + eta)) / pow(cos(u), 1.0 / alpha_diff)) * \
-        #        pow(cos(u - (alpha_diff * (u + eta))) / w, (1.0 - alpha_diff) / alpha_diff)
     return x
 
 cdef float[:] draw_random_stable(int n, float alpha_diff):
 
     cdef int i
     cdef float[:] result = np.zeros(n, dtype = DTYPE)
 
@@ -471,14 +465,140 @@
                                                          'delta_t': delta_t,
                                                          'max_t': max_t,
                                                          'n_samples': n_samples,
                                                          'simulator': 'ddm',
                                                          'boundary_fun_type': 'constant',
                                                          'possible_choices': [-1, 1]}}
 
+# Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES, 
+# but also apply a DEADLINE to rts. Any rt that exceeds the deadline is treated
+# as a miss.
+# @cythonboundscheck(False)
+# @cythonwraparound(False)
+
+def ddm_flexbound_deadline(np.ndarray[float, ndim = 1] v,
+                           np.ndarray[float, ndim = 1] a,
+                           np.ndarray[float, ndim = 1] z,
+                           np.ndarray[float, ndim = 1] t,
+                           np.ndarray[float, ndim = 1] deadline,
+                           float s = 1,
+                           float delta_t = 0.001,
+                           float max_t = 20,
+                           int n_samples = 20000,
+                           int n_trials = 1,
+                           boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)
+                           boundary_multiplicative = True,
+                           boundary_params = {},
+                           random_state = None,
+                           ):
+
+    set_seed(random_state)
+    #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)
+    # Param views:
+    cdef float[:] v_view  = v
+    cdef float[:] a_view = a
+    cdef float[:] z_view = z
+    cdef float[:] t_view = t
+    cdef float[:] deadline_view = deadline
+
+    traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)
+    traj[:, :] = -999 
+    cdef float[:,:] traj_view = traj
+
+    rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)
+    choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)
+
+    cdef float[:, :, :] rts_view = rts
+    cdef int[:, :, :] choices_view = choices
+
+    cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion
+    cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step
+
+    # Boundary storage for the upper bound
+    cdef int num_draws = int((max_t / delta_t) + 1)
+    t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
+    boundary = np.zeros(t_s.shape, dtype = DTYPE)
+
+    cdef float y, t_particle, deadline_adj
+    cdef Py_ssize_t n 
+    cdef Py_ssize_t ix
+    cdef Py_ssize_t m = 0
+    cdef Py_ssize_t k
+    cdef float[:] gaussian_values = draw_gaussian(num_draws)
+    cdef float[:] boundary_view = boundary
+
+    # Loop over samples
+    for k in range(n_trials):
+        # Precompute boundary evaluations
+        boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}
+
+        if boundary_multiplicative:
+            # print('passed')
+            boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
+        else:
+            boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)
+
+        # subtract current non-decision-time from current deadline
+        deadline_adj = deadline_view[k] - t_view[k]
+        for n in range(n_samples):
+            y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position 
+            t_particle = 0.0 # reset time
+            ix = 0 # reset boundary index
+            
+            # Can improve with less checks
+            if n == 0:
+                if k == 0:
+                    traj_view[0, 0] = y
+
+            # Random walker
+            while (y >= (-1) * boundary_view[ix]) and (y <= boundary_view[ix]) and (t_particle <= max_t) and (t_particle <= deadline_adj):
+                y += (v_view[k] * delta_t) + (sqrt_st * gaussian_values[m])
+                t_particle += delta_t
+                ix += 1
+                m += 1
+                
+                if n == 0:
+                    if k == 0:
+                        traj_view[ix, 0] = y
+                
+                # Can improve with less checks
+                if m == num_draws:
+                    gaussian_values = draw_gaussian(num_draws)
+                    m = 0
+
+            if t_particle > deadline_adj:
+                rts_view[n, k, 0] = -999
+                choices_view[n, k, 0] = -1
+            elif t_particle == deadline_adj:
+                rts_view[n, k, 0] = t_particle + t_view[k] - ((delta_t / 2) * random_uniform()) # Store rt
+                choices_view[n, k, 0] = sign(y) # Store choice
+            else:
+                rts_view[n, k, 0] = t_particle + t_view[k] + ((delta_t * random_uniform()) - (delta_t / 2)) # Store rt
+                choices_view[n, k, 0] = sign(y) # Store choice
+    
+    return {'rts': rts, 'choices': choices,  'metadata': {'v': v,
+                                                          'a': a,
+                                                          'z': z,
+                                                          't': t,
+                                                          'deadline': deadline,
+                                                          's': s,
+                                                          **boundary_params,
+                                                          'delta_t': delta_t,
+                                                          'max_t': max_t,
+                                                          'n_samples': n_samples,
+                                                          'simulator': 'ddm_flexbound_deadline',
+                                                          'boundary_fun_type': boundary_fun.__name__,
+                                                          'possible_choices': [-1, 1],
+                                                          'trajectory': traj,
+                                                          'boundary': boundary,
+                                                          }}
+# ----------------------------------------------------------------------------------------------------
+
+
+
 # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------
 # @cythonboundscheck(False)
 # @cythonwraparound(False)
 def ddm_flexbound(np.ndarray[float, ndim = 1] v,
                   np.ndarray[float, ndim = 1] a,
                   np.ndarray[float, ndim = 1] z,
                   np.ndarray[float, ndim = 1] t,
@@ -1196,22 +1316,14 @@
 
     # Boundary storage for the upper bound
     cdef int num_draws = int((max_t / delta_t) + 1)
     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)
     boundary = np.zeros(t_s.shape, dtype = DTYPE)
     cdef float[:] boundary_view = boundary
 
-    # Precompute boundary evaluations
-    if boundary_multiplicative:
-        # print(a)
-        boundary_view[:] = np.multiply(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)
-    else:
-        # print(a)
-        boundary_view[:] = np.add(a, boundary_fun(t = t_s, **boundary_params)).astype(DTYPE)
-    
     cdef float y, t_particle
     cdef Py_ssize_t n, ix, k
     cdef Py_ssize_t m = 0
     cdef float drift_increment = 0.0
     cdef float[:] gaussian_values = draw_gaussian(num_draws)
 
     for k in range(n_trials):
```

### Comparing `ssm-simulators-0.3.0/ssm_simulators.egg-info/PKG-INFO` & `ssm-simulators-0.3.1/ssm_simulators.egg-info/PKG-INFO`

 * *Files 18% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: ssm-simulators
-Version: 0.3.0
+Version: 0.3.1
 Summary: SSMS is a package collecting simulators and training data generators for a bunch of generative models of interest in the cognitive science / neuroscience and approximate bayesian computation communities
 Home-page: https://github.com/AlexanderFengler/ssms
 Author: Alexander Fenger
 Classifier: Development Status :: 1 - Planning
 Classifier: Environment :: Console
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python
```

### Comparing `ssm-simulators-0.3.0/ssm_simulators.egg-info/SOURCES.txt` & `ssm-simulators-0.3.1/ssm_simulators.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `ssm-simulators-0.3.0/ssms/basic_simulators/boundary_functions.py` & `ssm-simulators-0.3.1/ssms/basic_simulators/boundary_functions.py`

 * *Files identical despite different names*

### Comparing `ssm-simulators-0.3.0/ssms/basic_simulators/drift_functions.py` & `ssm-simulators-0.3.1/ssms/basic_simulators/drift_functions.py`

 * *Files identical despite different names*

### Comparing `ssm-simulators-0.3.0/ssms/basic_simulators/simulator.py` & `ssm-simulators-0.3.1/ssms/basic_simulators/simulator.py`

 * *Files 0% similar despite different names*

```diff
@@ -212,15 +212,15 @@
     # Useful for sbi
     if type(theta) == list:
         # print('theta is supplied as list --> simulator assumes n_trials = 1')
         theta = np.asarray(theta).astype(np.float32)
     elif type(theta) == np.ndarray:
         theta = theta.astype(np.float32)
     else:
-        theta = theta.numpy()
+        theta = theta.numpy().astype(np.float32)     
 
     if len(theta.shape) < 2:
         theta = np.expand_dims(theta, axis=0)
 
     n_trials = theta.shape[0]
 
     # 2 choice models
@@ -261,14 +261,32 @@
             boundary_params={},
             boundary_fun=bf.constant,
             boundary_multiplicative=True,
             max_t=max_t,
             random_state=random_state,
         )
 
+    if model == "ddm_deadline":
+        x = cssm.ddm_flexbound_deadline(
+            v=theta[:, 0],
+            a=theta[:, 1],
+            z=theta[:, 2],
+            t=theta[:, 3],
+            deadline=theta[:, 4],
+            s=s,
+            n_samples=n_samples,
+            n_trials=n_trials,
+            delta_t=delta_t,
+            boundary_params={},
+            boundary_fun=bf.constant,
+            boundary_multiplicative=True,
+            max_t=max_t,
+            random_state=random_state,
+        )
+
     if model == "ddm":
         x = cssm.ddm_flexbound(
             v=theta[:, 0],
             a=theta[:, 1],
             z=theta[:, 2],
             t=theta[:, 3],
             s=s,
@@ -527,14 +545,15 @@
             a=theta[:, 0],
             z=theta[:, 1],
             t=theta[:, 2],
             s=s,
             boundary_fun=bf.angle,
             drift_fun=df.ds_conflict_drift,
             boundary_params={"theta": theta[:, 10]},
+            boundary_multiplicative=False,
             drift_params={
                 "init_p_t": theta[:, 3],
                 "init_p_d": theta[:, 4],
                 "slope_t": theta[:, 5],
                 "slope_d": theta[:, 6],
                 "fixed_p_t": theta[:, 7],
                 "coherence_t": theta[:, 8],
```

### Comparing `ssm-simulators-0.3.0/ssms/config/config.py` & `ssm-simulators-0.3.1/ssms/config/config.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,11 +1,12 @@
 from ssms.basic_simulators import boundary_functions as bf
 from ssms.basic_simulators import drift_functions as df
 import numpy as np
 
+# Configuration dictionary for simulators
 model_config = {
     "ddm": {
         "name": "ddm",
         "params": ["v", "a", "z", "t"],
         "param_bounds": [[-3.0, 0.3, 0.1, 0.0], [3.0, 2.5, 0.9, 2.0]],
         "boundary": bf.constant,
         "n_params": 4,
@@ -19,14 +20,24 @@
         "param_bounds": [[-3.0, 0.3, 0.1, 0.0], [3.0, 2.5, 0.9, 2.0]],
         "boundary": bf.constant,
         "n_params": 4,
         "default_params": [0.0, 1.0, 0.5, 1e-3],
         "hddm_include": ["z"],
         "nchoices": 2,
     },
+    "ddm_deadline": {
+        "name": "ddm_deadline",
+        "params": ["v", "a", "z", "t", "deadline"],
+        "param_bounds": [[-3.0, 0.3, 0.1, 0.0, 0.1], [3.0, 2.5, 0.9, 2.0, 5.0]],
+        "boundary": bf.constant,
+        "n_params": 5,
+        "default_params": [0.0, 1.0, 0.5, 1e-3, 5.0],
+        "hddm_include": ["z", "deadline"],
+        "nchoices": 2,
+    },
     "angle": {
         "name": "angle",
         "params": ["v", "a", "z", "t", "theta"],
         "param_bounds": [[-3.0, 0.3, 0.1, 1e-3, -0.1], [3.0, 3.0, 0.9, 2.0, 1.3]],
         "boundary": bf.angle,
         "n_params": 5,
         "default_params": [0.0, 1.0, 0.5, 1e-3, 0.0],
@@ -121,15 +132,15 @@
             "tslope",
             "dslope",
             "tfixedp",
             "tcoh",
             "dcoh",
         ],
         "param_bounds": [
-            [0.3, 0.1, 1e-3, 0, 0, 0.01, 0.01, 0, -1.0, -1.0],
+            [0.3, 0.1, 1e-3, 0.0, 0.0, 0.01, 0.01, 0.0, -1.0, -1.0],
             [3.0, 0.9, 2.0, 5.0, 5.0, 5.0, 5.0, 5.0, 1.0, 1.0],
         ],
         "boundary": bf.constant,
         "drift_fun": df.ds_conflict_drift,
         "n_params": 10,
         "default_params": [2.0, 0.5, 1.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.5, -0.5],
         "hddm_include": [
@@ -158,15 +169,15 @@
             "dslope",
             "tfixedp",
             "tcoh",
             "dcoh",
             "theta",
         ],
         "param_bounds": [
-            [0.3, 0.1, 1e-3, 0.0, 0.0, 0.01, 0.01, 0, -1.0, -1.0, -0.1],
+            [0.3, 0.1, 1e-3, 0.0, 0.0, 0.01, 0.01, 0.0, -1.0, -1.0, 0.0],
             [3.0, 0.9, 2.0, 5.0, 5.0, 5.0, 5.0, 5.0, 1.0, 1.0, 1.3],
         ],
         "boundary": bf.angle,
         "drift_fun": df.ds_conflict_drift,
         "n_params": 10,
         "default_params": [2.0, 0.5, 1.0, 2.0, 2.0, 2.0, 2.0, 3.0, 0.5, -0.5, 0.0],
         "hddm_include": [
@@ -765,14 +776,28 @@
     "choice_cnt": 0,  # > (each choice receive at least 10 samples in simulator)
     "mean_rt": 17,  # < (mean_rt is smaller than specified value
     "std": 0,  # > (std is positive for each choice)
     "mode_cnt_rel": 0.9,  # < (mode does not receive more than a proportion of samples for each choice)
 }
 
 data_generator_config = {
+    "cpn_only": {
+        "output_folder": "data/cpn_only/",
+        "dgp_list": "ddm",  # should be ['ddm'],
+        "n_samples": 100000,  # eventually should be {'low': 100000, 'high': 100000},
+        "n_parameter_sets": 10000,
+        "n_parameter_sets_rejected": 100,
+        "n_training_samples_by_parameter_set": 1000,
+        "max_t": 20.0,
+        "delta_t": 0.001,
+        "pickleprotocol": 4,
+        "n_cpus": "all",
+        "negative_rt_cutoff": -66.77497,
+        "n_subruns": 10,
+    },
     "lan": {
         "output_folder": "data/lan_mlp/",
         "dgp_list": "ddm",  # should be ['ddm'],
         "nbins": 0,
         "n_samples": 100000,  # eventually should be {'low': 100000, 'high': 100000},
         "n_parameter_sets": 10000,
         "n_parameter_sets_rejected": 100,
```

### Comparing `ssm-simulators-0.3.0/ssms/dataset_generators/lan_mlp.py` & `ssm-simulators-0.3.1/ssms/dataset_generators/lan_mlp.py`

 * *Files 2% similar despite different names*

```diff
@@ -71,15 +71,15 @@
         )
 
     def get_simulations(self, theta=None, random_seed=None):
         out = self.simulator(
             theta=theta,
             model=self.model_config["name"],
             random_state=random_seed,
-        )  # AF-TODO Want to change this so that we accept
+        ) 
         return out
 
     def _filter_simulations(
         self,
         simulations=None,
     ):
         keep = 1
@@ -190,15 +190,14 @@
         )
 
         rt_tmp = np.random.uniform(low=-1.0, high=0.0001, size=n_unif_down)
 
         out[(n_kde + n_unif_up) :, -3] = rt_tmp
         out[(n_kde + n_unif_up) :, -2] = choice_tmp
         out[(n_kde + n_unif_up) :, -1] = self.generator_config["negative_rt_cutoff"]
-
         return out.astype(np.float32)
 
     def _mlp_get_processed_data_for_theta(self, random_seed_tuple):
         np.random.seed(random_seed_tuple[0])
         keep = 0
         while not keep:
             theta = np.float32(
@@ -235,14 +234,42 @@
             "labels": kde_data[:, -1],
             "choice_p": choice_p,
             "binned_128": binned_128,
             "binned_256": binned_256,
             "theta": np.expand_dims(theta, axis=0),
         }
 
+    def _cpn_get_processed_data_for_theta(self, random_seed_tuple):
+        np.random.seed(random_seed_tuple[0])
+        
+        # Get a random parameter set
+        theta = np.float32(
+            np.random.uniform(
+                low=self.model_config["param_bounds"][0],
+                high=self.model_config["param_bounds"][1],
+            )
+        )
+        # Run the simulator
+        simulations = self.get_simulations(
+            theta=theta, random_seed=random_seed_tuple[1]
+        )
+
+        # Compute the choice probabilities
+        choice_p = np.array(
+            [
+                (simulations["choices"] == 1.0).sum()
+                / simulations["choices"].flatten().shape[0]
+            ]
+        )
+
+        return {
+            "choice_p": choice_p,
+            "theta": np.expand_dims(theta, axis=0),
+        }
+    
     def _get_rejected_parameter_setups(self, random_seed_tuple):
         np.random.seed(random_seed_tuple[0])
         rejected_thetas = []
         keep = 1
         rej_cnt = 0
         while rej_cnt < 100:
             theta = np.float32(
@@ -260,16 +287,16 @@
                 print("simulation rejected")
                 print("stats: ", stats)
                 print("theta", theta)
                 rejected_thetas.append(theta)
             rej_cnt += 1
 
         return rejected_thetas
-
-    def generate_data_training_uniform(self, save=False, verbose=True):
+ 
+    def generate_data_training_uniform(self, save=False, verbose=True, cpn_only=False):
         seeds_1 = np.random.choice(
             400000000, size=self.generator_config["n_parameter_sets"]
         )
         seeds_2 = np.random.choice(
             400000000, size=self.generator_config["n_parameter_sets"]
         )
         seed_args = [(seeds_1[i], seeds_2[i]) for i in range(seeds_1.shape[0])]
@@ -286,39 +313,53 @@
             if verbose:
                 print(
                     "simulation round:",
                     i + 1,
                     " of",
                     self.generator_config["n_subruns"],
                 )
-            with Pool(processes=self.generator_config["n_cpus"] - 1) as pool:
-                out_list += pool.map(
-                    self._mlp_get_processed_data_for_theta,
-                    [k for k in seed_args[(i * subrun_n) : ((i + 1) * subrun_n)]],
-                )
+            
+            if cpn_only:
+                with Pool(processes=self.generator_config["n_cpus"] - 1) as pool:
+                    out_list += pool.map(
+                        self._cpn_get_processed_data_for_theta,
+                        [k for k in seed_args[(i * subrun_n) : ((i + 1) * subrun_n)]],
+                    )
+            else:
+                with Pool(processes=self.generator_config["n_cpus"] - 1) as pool:
+                    out_list += pool.map(
+                        self._mlp_get_processed_data_for_theta,
+                        [k for k in seed_args[(i * subrun_n) : ((i + 1) * subrun_n)]],
+                    )
 
         data = {}
-        data["data"] = np.concatenate(
-            [out_list[k]["data"] for k in range(len(out_list))]
-        ).astype(np.float32)
-        data["labels"] = np.concatenate(
-            [out_list[k]["labels"] for k in range(len(out_list))]
-        ).astype(np.float32)
+        
+        # Choice probabilities and theta are always needed
         data["choice_p"] = np.concatenate(
             [out_list[k]["choice_p"] for k in range(len(out_list))]
         ).astype(np.float32)
         data["thetas"] = np.concatenate(
             [out_list[k]["theta"] for k in range(len(out_list))]
-        ).astype(np.float32)
-        data["binned_128"] = np.concatenate(
-            [out_list[k]["binned_128"] for k in range(len(out_list))]
-        ).astype(np.float32)
-        data["binned_256"] = np.concatenate(
-            [out_list[k]["binned_256"] for k in range(len(out_list))]
-        ).astype(np.float32)
+        ).astype(np.float32)    
+        
+        # Only if not cpn_only, do we need the rest of the data 
+        # (which is not computed if cpn_only is selected)
+        if not cpn_only:
+            data["data"] = np.concatenate(
+                [out_list[k]["data"] for k in range(len(out_list))]
+            ).astype(np.float32)
+            data["labels"] = np.concatenate(
+                [out_list[k]["labels"] for k in range(len(out_list))]
+            ).astype(np.float32)
+            data["binned_128"] = np.concatenate(
+                [out_list[k]["binned_128"] for k in range(len(out_list))]
+            ).astype(np.float32)
+            data["binned_256"] = np.concatenate(
+                [out_list[k]["binned_256"] for k in range(len(out_list))]
+            ).astype(np.float32)
 
         # Add metadata to training_data
         data["generator_config"] = self.generator_config
         data["model_config"] = self.model_config
 
         if save:
             if not os.path.exists(self.generator_config["output_folder"]):
```

### Comparing `ssm-simulators-0.3.0/ssms/dataset_generators/snpe.py` & `ssm-simulators-0.3.1/ssms/dataset_generators/snpe.py`

 * *Files identical despite different names*

### Comparing `ssm-simulators-0.3.0/ssms/support_utils/kde_class.py` & `ssm-simulators-0.3.1/ssms/support_utils/kde_class.py`

 * *Files identical despite different names*

